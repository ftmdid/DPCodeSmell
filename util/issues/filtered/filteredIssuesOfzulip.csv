id,Title,Body,User,Label,Created At,Updated At
16415,Outgoing webhook: sender_realm_id is not set but it is used set_sender_avatar function,"Using an outgoing webhook I got the following error:
```
Logger root, from module zerver.worker.queue_processors line 151:
Error generated by Anonymous user (not logged in) on ip-172-26-3-8 deployment

Traceback (most recent call last):
  File ""/home/zulip/deployments/2020-07-20-06-57-59/zerver/worker/queue_processors.py"", line 134, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2020-07-20-06-57-59/zerver/worker/queue_processors.py"", line 613, in consume
    request_data = service_handler.build_bot_request(dup_event)
  File ""/home/zulip/deployments/2020-07-20-06-57-59/zerver/lib/outgoing_webhook.py"", line 36, in build_bot_request
    keep_rendered_content=True)
  File ""/home/zulip/deployments/2020-07-20-06-57-59/zerver/lib/message.py"", line 204, in finalize_payload
    MessageDict.set_sender_avatar(obj, client_gravatar)
  File ""/home/zulip/deployments/2020-07-20-06-57-59/zerver/lib/message.py"", line 493, in set_sender_avatar
    sender_realm_id = obj['sender_realm_id']
KeyError: 'sender_realm_id'


Deployed code:
- ZULIP_VERSION: 2.1.x
- version: 2.1.3


Request info: none
```

It looks like the *sender_realm_id* is required although the webhook format that is described here:
https://zulipchat.com/api/outgoing-webhooks does not reference such a field.

As a quick and dirty work around for my production server, in the _finalize_payload method of message.py, I added a try / except around the set_sender_avatar and I checked dictionary values existed first before deleting them (see lemoineat:fix_outgoing_missing_sender_realm_id). But there is probably more to do.

",miredo,b'area: integrations bug help wanted',2020-09-25T07:09:12Z,2020-10-02T00:55:16Z
16400,emoji_picker: Fix search input length.,"This was probably a regression from our upgrade to bootstrap 2.3.2.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
before:
![image](https://user-images.githubusercontent.com/47354597/93967996-c1ea3800-fd68-11ea-9151-d8b78bd72a26.png)

after:
![image](https://user-images.githubusercontent.com/47354597/93968029-d8908f00-fd68-11ea-8d46-32ed6918f35a.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: emoji bug size: XS',2020-09-23T04:52:02Z,2020-09-23T18:33:34Z
16328,Clipboard tooltip not disappearing ,"Hey , Noticed this small error of clipboard tooltip not immediately hiding once clipboard has been pressed .
For more clarification : 


![error](https://user-images.githubusercontent.com/53977614/92965450-6def7180-f493-11ea-8f19-7ba7930b33e3.gif)

Would love to dive into it as to resolve this issue , if it seems legit :)",aryanshridhar,b'area: message view bug',2020-09-11T19:39:11Z,2020-09-12T19:04:25Z
16301,Compose box resize issue while uploading file and while editing messages,"**Commit 1:**

On uploading a few files from markdown_preview mode of compose box and
then switching back to edit mode, the compose box doesn't get resized.
It even doesn't allow to scroll through the content.

Fixed this by switching back to the edit mode everytime user uploads
some file in markdown_preview mode as there's no use of staying in
markdown_preview mode anyways after uploading a file as the preview
doesn't get updated.

Fixes: zulip#16296.

**Commit 2:**

Currently compose_ui.autosize_textarea doesn't seem to work while
editing messages in many cases (uploading files, typeaheads, keydown
handling, etc.).

Refactored the autosize_textarea function in compose_ui to work
while editing messages too and added appropriate argument for the
introduced function parameter at all occurences of the function
use.",garg3133,b'area: compose bug size: L',2020-09-04T22:07:39Z,2020-09-21T22:44:14Z
16296,Compose box resize issue while inserting files in preview mode,"If we insert some files from `markdown_preview` mode and then switches back to `edit` mode, the compose box doesn't get resized automatically (neither do it allows scrolling).
![chrome-capture-1](https://user-images.githubusercontent.com/39924567/92223474-22026280-eebe-11ea-8b18-d05689f47980.gif)

Actual size
![Annotation-2020-09-04-014948](https://user-images.githubusercontent.com/39924567/92223464-1fa00880-eebe-11ea-80df-24a390fb60c8.png)
",garg3133,b'area: compose bug in progress',2020-09-04T09:25:02Z,2020-09-21T22:46:51Z
16295,ComposeBox : Fixed Textarea covering latest messages .,"Fixed Textarea in ComposeBox covering up latest messages in a stream while writing long messages .
CZO topic: <a href = 'https://chat.zulip.org/#narrow/stream/9-issues/topic/Long.20reply.20covers.20previous.20messages'>here</a>
 
Fixes #16038

<strong>Screenshots</strong> :

<strong>Before</strong>

![Screenshot from 2020-09-03 11-42-36](https://user-images.githubusercontent.com/53977614/92208870-b1e9e180-eea9-11ea-85b2-76d95cee36f0.png)
<strong>After</strong>

![Screenshot from 2020-09-03 11-46-21](https://user-images.githubusercontent.com/53977614/92208901-bc0be000-eea9-11ea-9369-c332faa7cabf.png)

",aryanshridhar,b'area: compose bug size: M',2020-09-04T06:56:48Z,2020-09-22T16:34:33Z
16270,fixed devlogin when a # is present in the url,"closes #16215

As # is the property of browser in the url so i added the next parameter in all the form action to solve this issue.

Now the redirection also works successfully.

The main cause of this issue is not with the next parameter but it's with the url('zerver.views.auth.dev_direct_login') because it adds //#scholarship in the form action which is an invalid url. Therefore after adding `?next=` the redirection works successfully. Also if a next parameter is not present in the url then i have tested this for that also and it work successfully.


",codesankalp,b'area: authentication area: provision bug size: S',2020-09-02T07:32:29Z,2020-09-16T21:38:41Z
16256,api: Fix trailing '/' at end of jitsi server url.,"Some users setup zulip with trailing / at end, like 'https://meet.jit.si/
leading to extra / on clients while generating video chat link.

This commit removes trailing '/' if it exists to make it consistent. Manual
testing was done by generating jitsi url.

Fixes #16225

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
https://github.com/zulip/zulip/issues/16225


**Testing Plan:** <!-- How have you tested? -->
Manually tested locally by creating the jitsi link.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",S-Abhishek,b'area: api bug size: XS',2020-09-01T09:22:11Z,2020-09-02T00:31:42Z
16255,settings: Don't use css classes starting with `icon`.,"Fixes #16252.

icon* classes are used by bootstrap for displaying glyphicons.
We removed these classes in our custom version of bootstrap 2.1.1;
but since our reset to v2.3.2, they have been added again and hence
any classes starting with icon* in zulip will have to be renamed.
",amanagr,b'area: settings (admin/org) area: settings UI bug priority: blocker size: M',2020-09-01T06:00:01Z,2020-09-01T17:56:07Z
16252,"Save/discard buttons in ""organization settings"" busted after Bootstrap upgrade","I'm guessing the Bootstrap upgrade is responsible; we have this super weird CSS for our ""save/discard"" widget buttons in the settings UI:

![image](https://user-images.githubusercontent.com/2746074/91780291-f32d7900-ebab-11ea-9399-65d474ef1780.png)

@amanagr FYI.",timabbott,b'area: settings (admin/org) area: settings UI bug in progress priority: blocker',2020-09-01T00:04:42Z,2020-09-01T17:59:05Z
16242,hotspots: Use ugettext_lazy for i18n.,"Since ALL_HOTSPOTS is a global object, it is initialized at the time the backend server is started. Hence, the
title and description is translated only once. Using ugettext_lazy makes sure that the strings are translated in each and every request according to the language of the user.

Also did a quick search for other similar occurrences by doing `git grep -wn ""_(""` and going through files which have matches in with line nos less than 40. There do not seem to be any other occurrences.

Fixes #16224

",hackerkid,b'area: i18n bug size: S',2020-08-31T15:21:41Z,2020-08-31T18:23:02Z
16241,compose: Restore Tab+Enter sending in Safari.,"Safari doesn't make <button>s tab-accessible by default,
so this commit adds back the manual focus removed in
3b0694693b15ea862d41ff0959e28e71c4ecb3dc.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->

I have not tested this because I do not have Safari. Somebody should test this on Safari before we merge it.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: compose bug size: M',2020-08-31T04:57:42Z,2020-08-31T06:51:28Z
16225,Normalize jitsi_server_url at the API level,"Currently, the `jitsi_server_url` field of the realm state that the Zulip API sends to clients as part of the `/register` API response doesn't consistently end with or without a trailing slash. As a result, clients are creating Jitsi meeting URLs with an additional slash. If the API removed the trailing slash from the value read from Django settings before adding it to the realm state, this issue would be fixed without the need for making additional changes to client code.

The relevant code to handle this appears to be here: https://github.com/zulip/zulip/blob/372e010dbb7ddf0b08d736aa274323d83d7d8486/zerver/lib/events.py#L168",wpj,b'area: api bug good first issue help wanted in progress',2020-08-28T21:14:50Z,2020-09-02T00:32:41Z
16224,Enable translations for hotspots subsystem,"There are unused translations at the hotspots subsystem, which could be enabled due to finished and available translations. At the moment there is a mix of English and the configured user language.

Affected file: zerver/lib/hotspots.py

Example (mixed English/German):
![grafik](https://user-images.githubusercontent.com/7988080/91609700-28518580-e978-11ea-8073-c8f368253595.png)
",theraser,b'area: i18n bug in progress',2020-08-28T19:53:18Z,2020-08-31T18:25:57Z
16215,Devlogin breaks if a hash is present in the URL,"Opening the following link foe example and trying to login as one of the existing users results in a 404
 http://realm-24.zulipdev.com:9991/devlogin/?next=/upgrade/#sponsorship

",hackerkid,b'area: authentication area: provision bug in progress',2020-08-27T19:10:04Z,2020-09-16T21:40:55Z
16198,Overlapping text while creating new Organization,"Hi all , 
Encountered this error of <strong>alert</strong> message and text message overlapping while creating a new organization .

To Produce this error , head over <a href = 'https://zulipchat.com/accounts/register/' target = '_blank'>here</a> ( After receiving email )
For reference , I am attaching an image for the same .

![Screenshot from 2020-08-25 23-02-44](https://user-images.githubusercontent.com/53977614/91208528-f5b14e00-e727-11ea-9bc2-d92ece43ac73.png)
",aryanshridhar,b'bug',2020-08-25T18:05:54Z,2020-08-26T04:34:49Z
16191,message_list: Live update trailing bookend on stream deactivation.,"We were not updating the trailing bookend on deactivation of stream
if the user was narrowed to deactivated stream and this commit fixes
this.

For subscribed streams, we just show the trailing bookend with
content as 'This stream has been deactivated' and hide the
Unsubscribe button.

For unsubscribed streams, we change the content of trailing bookend
to 'This stream has been deactivated' and hide the Subscribe button.

Fixes #15999.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? --> Tested manually in the development environment.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![trailing-bookend](https://user-images.githubusercontent.com/35494118/90967339-8f47e800-e4fb-11ea-983a-b43b6c751a76.gif)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'bug size: M',2020-08-22T23:17:08Z,2020-09-01T05:28:40Z
16188,api: Fix require_post decorator not returning 405 error body.,"require_post decorator returns an empty body when POST-only routes
are requested with GET.

Fixes: #16164.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",shanukun,b'area: api bug size: L',2020-08-22T11:57:46Z,2020-08-31T23:47:45Z
16183,webhooks/gitlab: Use information about all assignees.,"Previously, the GitLab webhook code, namely the `get_objects_assignee`
method first tried to get a single assignee and if that failed then it
looks for multiple assignees and then it would return the first
assignee that it found (there's actually a code smell here - a loop
which would always return on the first iteration).

Instead, this commit will change that behavior to first check for
multiple assignees first then for a single assignee if we can't find
multiple assignees. Ultimately it will return a list of all of the
assignees (however many that might be [0, n]). This method has then
aptly been renamed to `get_assignees`.

Finally, we tweked the code using this method to always use it's
output as an ""assignees"" parameter to templates (there's also an
assignee parameter which we want to avoid here for consistency).

Fixes #16173.",Hypro999,b'area: integrations bug size: XL',2020-08-21T16:17:36Z,2020-09-14T07:36:46Z
16180,zulipchat.com doesn't detect whether I am on free or standard plan when visiting /upgrade page.,"My research group is already on standard plan, yet when I visited the /upgrade page, I was greeted with ""Upgrade to Zulip Standard"" implying that my realm is not yet on standard plan.",rht,b'area: billing bug in progress',2020-08-21T11:16:35Z,2020-08-25T01:35:00Z
16177,ui: Add loading indicator for message edits.,"Fixes #16143.
![message_edit_indicator](https://user-images.githubusercontent.com/40122794/90857877-afb05f00-e3a2-11ea-83b0-ca8d57f992dd.gif)
",ryanreh99,b'area: message-editing bug priority: high size: M',2020-08-21T06:09:39Z,2020-09-01T02:05:48Z
16176,Handle trailing slashes when creating Jitsi video meeting URLs,"When creating video call links for Jitsi, an additional slash is getting added between the base Jitsi server URL and the video call ID, i.e. `https://meet.jit.si//141518590623948` instead of `https://meet.jit.si/141518590623948`",wpj,b'area: compose bug good first issue in progress',2020-08-21T04:24:05Z,2020-08-26T19:04:46Z
16173,GitLab webhook reports single assignee for MR when there are several,"It looks like the GitLab webhook reports assignees for merge requests, but it only gives one assignee, even if there are several. This gets particularly confusing when the only change is in the assignees (say, from A and B to A and C), but the bot reports no change (only A). I think this may be a problem [here](https://github.com/zulip/zulip/blob/ad8943a64aab3f21ba692fe3842232291e222838/zerver/webhooks/gitlab/view.py#L150):

```python
def get_objects_assignee(payload: Dict[str, Any]) -> Optional[str]:
    assignee_object = payload.get('assignee')
    if assignee_object:
        return assignee_object.get('name')
    else:
        assignee_object = payload.get('assignees')
        if assignee_object:
            for assignee in assignee_object:
                return assignee['name']
```

At least in my MRs, the GitLab response contains both `assignee` and `assignees`, but Zulip takes only the former. It should probably be the other wey around, and it should return all assignees, not just the name of the first one!

Link to chat: https://chat.zulip.org/#narrow/stream/127-integrations/topic/GitLab.20webhook.3A.20MR.20assignees",Jellby,b'area: integrations bug in progress',2020-08-20T12:30:40Z,2020-09-14T03:57:17Z
16164,Missing 405 error bodies,"The following POST-only routes return an empty body when requested with GET. Instead they should return an error message:

* https://chat.zulip.org/accounts/logout/
* https://chat.zulip.org/accounts/register/
* https://chat.zulip.org/json/subscriptions/exists
* https://zulip.com/json/remotes/server/register
* https://chat.zulip.org/api/v1/dev_fetch_api_key

All of these seem to be caused by using the `@require_post` decorator, without restricting the route to `POST` in `zerver/urls.py`.

An example of where a body is returned as expected is:

* https://chat.zulip.org/json/fetch_api_key",Gittenburg,b'area: api bug in progress',2020-08-19T12:55:15Z,2020-08-31T23:46:49Z
16143,"Add spinner on the ""Save"" button in message editing UI","When moving topics between streams on very large Zulip servers, the API call to move the topic can take a few seconds.  To avoid confusion, we should show a clear loading spinner for this operation (probably similar to our ""Send message"" spinner when we're not doing local echo).  The most important part of this is disabling the ""Save"" button so one can't double-click it, but it's also important to give clear feedback to users on this.

@ryanreh99 this might be a good quick project for you.",timabbott,b'area: message-editing bug in progress priority: high',2020-08-14T23:20:23Z,2020-08-26T00:24:42Z
16126,filters: Fix has:image and avoid future issues for other has filters.,"This commit solves a bug due non working find() for a html element
which was not a descendant and fixes it by wrapping a virtual div
around the message content so that find works as intended in any
case whatsoever. This solution even protects from future cases of
html content or hierarchy changes.

Fixes #16118.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",thedeveloperr,b'area: search bug priority: blocker size: L',2020-08-12T23:24:29Z,2020-08-14T23:51:58Z
16125,"filter: Fix bug of not showing results on using ""has:image"".","There was a bug where filtering using ""has:image"" does not show
any messages, while filtering using ""has:attachments"" includes
messages with images.

This commit fixes the bug by changing message_util.message_has_image
to use 'hasClass' for checking if element with 'message_inline_image'
class exists or not instead of using find.

This change is done because '.find' searches for descendants of the
element, whereas in this case the '.message_inline_image' element is
not a descendant of a element in 'message.content', but it is one of
the elements of 'message.content'.

Fixes #16118.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'area: search bug priority: blocker size: S',2020-08-12T23:04:31Z,2020-08-12T23:51:53Z
16118,has:image broken?,"I've just discovered `has:image` and `has:attachment`. But in our own realm `has:image` gives me nothing, while a lot of images show up in `has:attachment`. On CZO `has:image`gives me two messages, and again `has:attachment` gives me a lot of messages that I would say has an image.

I figure an image counts as an attachment, but images aren't properly detected.",xendk,b'area: search bug priority: blocker',2020-08-12T11:51:12Z,2020-08-14T23:51:44Z
16114,Fix image panning no longer working due to some regression,"Due to a currently unknown regression, image panning no longer works in the main branch. The image can be zoomed, and shows the panning cursor, but it doesn't actually pan. It's working on my self-hosted 3.0 server, which indicates that the regression was introduced some time after d74664a60346e8e425ed0d33a0b42a391d13969d.

This was originally reported by someone else [on CZO](https://chat.zulip.org/#narrow/stream/9-issues/topic/Panning.20not.20working.20in.20attachment.20preview/near/977275).",cyphase,b'area: message view area: uploads bug priority: blocker',2020-08-12T04:31:27Z,2020-08-12T23:17:09Z
16109,OpenAPI schema and validation is built on a fundamental misunderstanding of allOf,"The `yamole` library preprocesses our OpenAPI schema by expanding `$ref` (incorrectly: #16106) and then naïvely merging all the objects in an `allOf` array together. This fails to capture the meaning of [`allOf`](https://swagger.io/docs/specification/data-models/oneof-anyof-allof-not/) according to the specification.

For example, consider

```yaml
components:
  # …
  schemas:
    # …
    JsonResponse:
      type: object
      additionalProperties: false
      properties:
        result:
          type: string
    JsonSuccess:
      allOf:
        - $ref: ""#/components/schemas/JsonResponse""
        - required:
            - result
            - msg
        - properties:
            result:
              enum:
                - success
            msg:
              type: string
        - example: {""msg"": """", ""result"": ""success""}
```

In order for `{""msg"": """", ""result"": ""success""}` to validate against `JsonSuccess`, it must validate against `JsonSuccess.allOf[0]` and validate against `JsonSuccess.allOf[1]` and validate against `JsonSuccess.allOf[2]` and validate against `JsonSuccess.allOf[3]`. But it does not validate against `JsonSuccess.allOf[0] == JsonResponse` because `JsonResponse` specifies that the object must have a `result` property and no other properties (`additionalProperties: false`).

`yamole`’s merging before validation obscures this failure in a way that’s not supported by the specification: “`allOf` takes an array of object definitions that are used for **independent** validation… To be valid against `allOf`, the data provided by the client must be valid against all of the given subschemas.”

Cc @orientor @YagoGG ",andersk,b'area: documentation (api and integrations) bug',2020-08-11T22:19:31Z,2020-09-29T23:47:12Z
16106,check-openapi: Disallow siblings of $ref,"The specification says “any sibling elements of a `$ref` are ignored”, so their presence, although not invalid, indicates a mistake.  `yamole` incorrectly merges these siblings into the referenced object, but we should not rely on this nonstandard behavior.

https://swagger.io/docs/specification/using-ref/#sibling

**Testing Plan:** This test currently fails. We need to fix `zulip.yaml` before merging.

```
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/get_stream_id"",""get"",""parameters"",0]: {
openapi   |   ""$ref"": ""#/components/parameters/Stream"",
openapi   |   ""required"": true
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/mark_stream_as_read"",""post"",""parameters"",0]: {
openapi   |   ""$ref"": ""#/components/parameters/StreamIdInQuery"",
openapi   |   ""required"": true
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/mark_topic_as_read"",""post"",""parameters"",0]: {
openapi   |   ""$ref"": ""#/components/parameters/StreamIdInQuery"",
openapi   |   ""required"": true
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/messages/{message_id}/reactions"",""post"",""parameters"",1]: {
openapi   |   ""$ref"": ""#/components/parameters/EmojiName"",
openapi   |   ""required"": true
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/messages/{message_id}/reactions"",""delete"",""parameters"",1]: {
openapi   |   ""$ref"": ""#/components/parameters/EmojiName"",
openapi   |   ""required"": false
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/users/{user_id}/subscriptions/{stream_id}"",""get"",""parameters"",0]: {
openapi   |   ""$ref"": ""#/components/parameters/UserId"",
openapi   |   ""example"": 7
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/users/{user_id}/subscriptions/{stream_id}"",""get"",""parameters"",1]: {
openapi   |   ""$ref"": ""#/components/parameters/StreamIdInPath"",
openapi   |   ""example"": 1
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/users/me/subscriptions/muted_topics"",""patch"",""parameters"",0]: {
openapi   |   ""$ref"": ""#/components/parameters/Stream"",
openapi   |   ""required"": false
openapi   | }
openapi   | zerver/openapi/zulip.yaml: Siblings of $ref have no effect at [""paths"",""/users/me/subscriptions/muted_topics"",""patch"",""parameters"",1]: {
openapi   |   ""$ref"": ""#/components/parameters/StreamIdInQuery"",
openapi   |   ""required"": false
openapi   | }
```

Cc @orientor @YagoGG ",andersk,b'area: documentation (api and integrations) bug size: XL',2020-08-11T21:04:51Z,2020-09-15T22:07:26Z
16077,Fix accessibility / UX of Invite Users modal,"* Focus email input when modal is opened.
* Allow submitting the form with `Ctrl+Enter` (so that keyboard users don't need to tab through all checkboxes).
* On form submission scroll to top of modal (so that you can see the success or error message) and focus the email textarea (so that you can invite more users or correct an error). (I am assuming that the textarea is the only error source).
* Fix the following focus bug: Open the compose box and then the Invite more users popup. If you now click on Check all or Uncheck all the compose box textarea is focused (and you can type there).

Ideally these points are addressed in separate commits.
",Gittenburg,b'UX accessibility area: settings UI bug good first issue in progress',2020-08-09T04:23:17Z,2020-09-04T20:10:29Z
16067,realm_audit_log: Fix malformed RealmAuditLog entries.,"In f8bcf39014e4aa44564998119aea7bdf3f13ab08, we fixed buggy
marshalling of Streams and similar data structures where we were
including the Stream object rather than its ID in dictionaries passed
to ujson, and ujson happily wrote that large object dump into the
RealmAuditLog.extra_data field.

This commit includes a migration to fix those corrupted RealmAuditLog
entries, and because the migration loop is the same, also fixes the
format of similar RealmAuditLog entries to be in a more natural format
that doesn't weirdly nest and duplicate the ""property"" field.

See the migration for detailed comments, but this fixes the format of
various RealmAuditLog entries to be in a more intuitive format.

I've tested the code for the migration part manually pretty extensively using both development and
production data, but it's definitely worth a read and probably worth one of you testing as well.

Fixes #16066.
",timabbott,b'bug priority: high size: XL',2020-08-07T20:04:36Z,2020-08-09T23:51:35Z
16066,Add migration to fix RealmAuditLog entries from bad JSON serialization,"Apparently, the RealmAuditLog work in #15601 resulted in corrupted entries being stored to the new RealmAuditLog entries (See f8bcf39014e4aa44564998119aea7bdf3f13ab08 for details).  We should write a migration to clean up this format.  I think there are two changes I'd like to do:
* Move the `property` key to the top-level of `extra_data`
* Find these corrupted keys and fix them.

I'm going to do a bit of investigation to see how many corrupted objects we have.

@arpit551 @mateuszmandera FYI",timabbott,b'bug in progress priority: high',2020-08-07T18:25:29Z,2020-08-09T23:54:32Z
16057,streams: Mark all messages as read when deactivating a stream.,"Fixes #15770.

I went with approach (1) from https://github.com/zulip/zulip/issues/15770#issuecomment-662176897 Stream deactivation is a pretty ""strong"" action akin to basically deleting it, in that it even removes all user subscriptions to it. Given that, it makes perfect sense to me that messages in such a stream should be marked as read.

I tested manually, both the change and the migration and verified that it fixes the #15770 issue for users already facing it, and prevents it from recurring on future stream deactivations.",mateuszmandera,b'area: message view bug priority: high size: L',2020-08-06T16:31:39Z,2020-09-01T18:26:22Z
16027,stream_edit: Send values of changed settings only to backend.,"This PR changes change_stream_privacy function to only
send the values of changed settings to backend.
We also avoid sending PATCH request if none of the settings
in stream privacy modal are changed.

This change also fixes the bug in changing stream permissions
for realms with limited plans.

Fixes #16024.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'area: stream settings bug size: L',2020-08-04T14:51:21Z,2020-08-05T23:17:16Z
16024,Stream - Change stream permissions - No changes applied / Try again message button,"**Describe the bug**
<!-- A clear and concise description of what the bug is. -->
On ""Stream Settings""/""Change stream permissions"" if you change ""Who can post on the stream"" instead of changing it the button ""Save changes"" turns into ""Try again"" but nothing is changed.

**To Reproduce**
<!-- Clear steps to reproduce the issue. -->
- Create a new stream
- On ""Stream Settings""/""Change stream permissions"", change ""Who can post on the stream"" to ""Only organization administrators can post""
- Click on ""Save changes""
- Button ""Save changes"" turns into ""Try again""
- No changes applied

**Expected behavior**
<!-- A clear and concise description of what you expected to happen. -->
Changes applied to stream settings, in this case ""Who can post on the stream"" from ""All stream members can post"" to ""Only organization administrators can post"".

**Screenshots**
<!-- If applicable, add screenshots to help explain your problem. -->

**Desktop (please complete the following information):**
 - Operating System: Windows 10 (1909)
 <!-- (Platform and Version) e.g. macOS 10.13.6 / Windows 10 (1803) / Ubuntu 18.04 x64 -->
 - Zulip Desktop Version: 5.4.0
<!-- e.g. 5.2.0 --> 

**Additional context**
<!-- Add any other context about the problem here. -->
",pablorq,b'area: stream settings bug',2020-08-03T05:04:44Z,2020-08-05T23:17:05Z
16008,stream_topic_history: Update topic last msg_id after msg deletion.,"Fixes #15992.
If the last message of the topic was deleted, we update the stored
message_id in the topic history so that the topic order in topic_list
is updated correctly.
",amanagr,b'area: message-editing bug size: L',2020-08-01T10:20:09Z,2020-08-04T22:29:53Z
15999,"Remove ""Subscribe"" button from trailing bookend and also change its content on live update on deactivating stream.","Steps to reproduce in dev env-
1. Login as Hamlet and unsubscribe from Denmark stream.
2. Narrow to Denmark stream.
3. Login as Iago in a different window and deactivate the Denmark stream.
4. Go to the window where hamlet is logged in. Subscribe button is still shown in the trailing bookend.

The ""Subscribe"" button in trailing bookend should be removed as the stream is deactivated.
Also the content for trailing bookend should be changed to ""This stream has been deactivated"".

Please note that we do not show messages and trailing bookend after the screen is reloaded.",sahil839,b'bug in progress',2020-07-31T20:34:31Z,2020-09-01T05:31:22Z
15992,Posting and deleting a message in an old topic leaves the topic higher than it should be in the stream topic list,"If you post a message in a topic that's long been buried in the topic list to the left, and then delete your new message, the topic stays on top of the list, even if the latest message is months old.",SaschaMann,b'area: message-editing bug in progress',2020-07-31T11:15:38Z,2020-08-04T22:29:04Z
15971,emoji: Make :stuck_out_tongue: have open eyes.,":stuck_out_tongue: should be the most general version, which is the one
with open eyes. Other apps do the same and it also means that :P, which
is converted to :stuck_out_tongue: is rendered like the emoticon.

Fixes #15970.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: emoji bug size: S',2020-07-29T10:21:42Z,2020-07-29T18:18:50Z
15970,Use 😛 as :P emoticon translation,"#15590 added the (optional) translation of `:P` to `:stuck_out_tongue:`. However, Zulip renders `:stuck_out_tongue:` as [`😝 U+1F61D`](https://emojipedia.org/squinting-face-with-tongue/), while I would expect `:P`/`:p` to render as [`😛 U+1F61B`](https://emojipedia.org/face-with-tongue/) (called `:mischievous:` in Zulip). `U+1F61B` is what gets rendered for `:P`/`:p` on any other platform I am on (e.g. Slack, FB, Hangouts).

I guess https://github.com/zulip/zulip/commit/32d234ef8ae7421e1c0f1ef7e9b36bf1026967f0 would be a way to fix this, but actually maybe the emoji names for these ones should be changed. I find it strange that `😛 U+1F61B` would be called `:mischievous:`, and I think a more conventional name for it would be `:stuck_out_tongue:`.",mortenpi,b'area: emoji bug in progress',2020-07-29T07:26:44Z,2020-07-29T18:21:47Z
15960,integrations: Autofocus the search input.,"There were two problems preventing the autofocus:

* The focus was triggered at the wrong time.
* transition: all; affected the visibility, making browsers
  abort the focus since the input was still hidden.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'bug size: S',2020-07-28T20:34:44Z,2020-07-28T22:17:05Z
15937,compose: Update compose placeholder text if recipients are changed.,"The placeholder text is now updated every time recipients of Private Messages are changed (added or removed).

Fixes #15897.

**GIFs or Screenshots:** 

For PMs:

![compose_placeholder_group_pms](https://user-images.githubusercontent.com/25329595/88553993-90444180-d043-11ea-896f-251d328ea614.gif)

EDIT:

For stream messages:

![compose_placeholder_streams_fixed](https://user-images.githubusercontent.com/25329595/88933754-71d98280-d29d-11ea-800f-574805165f6c.gif)
",vinitS101,b'area: compose bug size: M',2020-07-27T14:29:03Z,2020-09-25T23:50:14Z
15923,saml: Fix incorrect settings object being passed in get_issuing_idp.,"Fixes #15904.

settings is supposed to be a proper OneLogin_Saml2_Settings object,
rather than an empty dictionary. This bug wasn't easy to spot because
the codepath that causes this to demonstrate runs only if the
SAMLResponse contains encrypted assertions.

Tested manually, since this was a simple ""object of completely wrong type"" bug, plus we don't have any good utilities for manipulating/generating SAMLResponses so triggering the codepath would be hard, as that requires a SAMLResponse with encrypted assertions.",mateuszmandera,b'area: authentication bug size: S',2020-07-25T13:08:48Z,2020-07-27T18:58:46Z
15910,compose: Message control buttons are unaccessible.,"* The message control buttons should be focusable with Tab and clickable with Enter.
* The message control buttons should have `role=button`.",Gittenburg,b'accessibility area: compose bug in progress priority: high',2020-07-24T15:55:33Z,2020-08-15T04:48:13Z
15907,compose: Typeaheads don't close when closing compose box.,"![compose_popover_closing](https://user-images.githubusercontent.com/47354597/88402560-94662a00-cdcb-11ea-999d-1113f73480d9.gif)
",Gittenburg,b'area: compose bug in progress priority: high',2020-07-24T14:35:11Z,2020-07-28T00:56:54Z
15905,navbar: Typeahead does not close unless we select an option from it.,"Typeahead in the navbar does not close unless an option is selected from typeahead itself. 

Steps to reproduce-
1. Click on the navbar. Typeahead opens on clicking.
2. Click on the close icon on the navbar or anywhere outside like on a message or sidebars. The typeahead does not close by clicking on any of them.

The correct behaviour should be that the typeahead should close when we click on the close icon or anywhere outside the navbar like the sidebar or on a message.",sahil839,b'UX area: search bug priority: high',2020-07-24T13:09:14Z,2020-07-28T00:52:21Z
15904,"SAML: First call of /complete/saml/ fails, settings missing?","With the new Version 3.0 the first call of /complete/saml/ (callback from IDP) fails with the following error. It seems that OneLogin_Saml2_Response is called with a empty Settings-Object. But when i call ""Login"" again everything is working fine.

**ERROR**
2020-07-24 08:35:03.823 ERR  [django.request] Internal Server Error: /complete/saml/
Traceback (most recent call last):
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/django/core/handlers/exception.py"", line 34, in inner
    response = get_response(request)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/django/core/handlers/base.py"", line 115, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/django/core/handlers/base.py"", line 113, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/django/views/decorators/cache.py"", line 44, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/django/views/decorators/csrf.py"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/social_django/utils.py"", line 49, in wrapper
    return func(request, backend, *args, **kwargs)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/social_django/views.py"", line 33, in complete
    *args, **kwargs)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/social_core/actions.py"", line 45, in do_complete
    user = backend.complete(user=user, *args, **kwargs)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/social_core/backends/base.py"", line 40, in complete
    return self.auth_complete(*args, **kwargs)
  File ""./zproject/backends.py"", line 1912, in auth_complete
    idp_name = self.get_issuing_idp(SAMLResponse)
  File ""./zproject/backends.py"", line 1793, in get_issuing_idp
    resp = OneLogin_Saml2_Response(settings={}, response=SAMLResponse)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/onelogin/saml2/response.py"", line 49, in __init__
    self.decrypted_document = self.__decrypt_assertion(decrypted_document)
  File ""/srv/zulip-venv-cache/99ce7a22e72bf7ac1fd2eb4428af7f7f69b4ac9a/zulip-py3-venv/lib/python3.7/site-packages/onelogin/saml2/response.py"", line 823, in __decrypt_assertion
    key = self.__settings.get_sp_key()
AttributeError: 'dict' object has no attribute 'get_sp_key'",codebit-de,b'area: authentication bug in progress',2020-07-24T08:53:02Z,2020-07-27T18:59:00Z
15897,Compose box does not update placeholder when changing recipients,"![placeholder](https://user-images.githubusercontent.com/47354597/88334546-3cc7b000-cd32-11ea-9be2-67bd02f9365b.gif)
![placeholder2](https://user-images.githubusercontent.com/47354597/88334555-40f3cd80-cd32-11ea-9937-8f9d95ff927d.gif)
",Gittenburg,b'area: compose bug in progress',2020-07-23T20:17:33Z,2020-09-04T19:48:54Z
15891,upload: Do not open compose box when editing.,"Previously editing a message and uploading a file in
the edit textarea opened the message compose box.

Fixes #15890.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: compose bug priority: high size: XS',2020-07-23T08:22:48Z,2020-07-23T18:30:24Z
15890,Uploading image while editing message opens stream message compose.,"![edit_message](https://user-images.githubusercontent.com/44665669/88263566-dddd4900-cce7-11ea-9169-73a5b48a1813.gif)
",chdinesh1089,b'area: compose bug in progress priority: high',2020-07-23T07:55:59Z,2020-07-23T18:32:35Z
15887,emoji: Switch to `user_profile.realm` for cross-realm reactions.,"A temporary fix to enable cross-realm emoji reactions till `Message.realm`
is denormalized.

Fixes #15866.",majordwarf,b'area: emoji bug priority: high size: XS',2020-07-23T05:21:01Z,2020-07-24T20:12:04Z
15877,"Upgrade to Zulip 3 ""django.db.utils.OperationalError: FATAL:  role ""zulip"" does not exist""","I've tried several times and even tried changing the order around but the Debian Stretch to Buster upgrade instructions don't work for me:
https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-debian-stretch-to-debian-buster

It is unclear when to upgrade Zulip to 3.0, is it after step 5?

Step 5: (rm -rf /srv/zulip-venv-cache/*
/home/zulip/deployments/current/scripts/lib/upgrade-zulip-stage-2 \
    /home/zulip/deployments/current/ --ignore-static-assets --audit-fts-indexes)
fails as --audit-fts-indexes is not recognised.

Upgrading to Zulip 3.0 before Step 5 fails with 
django.db.utils.OperationalError: FATAL:  role ""zulip"" does not exist

But that does allow me to run --audit-fts-indexes (if I re-link /home/zulip/deployments/current)

It's also unclear to me when to run:
/home/zulip/deployments/current/scripts/setup/upgrade-postgres
If indeed I need to run it at all (I assume I do)

I think that you have all the right instructions on the page but not necessarily in the right order?
",nanathlor,b'area: documentation (production) bug priority: high question',2020-07-22T13:54:34Z,2020-08-13T15:03:19Z
15869,email_mirror: fix exception when getting addresses,"This commit rewrites the way addresses are collected. If
the header with the address is not an AddressHeader (for instance,
Delivered-To and Envelope-To), we take its string representation.

Fixes: #15864 (""Error in email_mirror - _UnstructuredHeader has no attribute addresses"")

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->

I have only tested this with emails with `Envelope-To`. I don't expect breakage for emails with `AddressHeader` headers (`Resent-To`, `Resent-CC`, `CC`). I have not checked the format of `X-Gm-Original-To` and `Delivered-To`.",elopez,b'area: emails bug priority: high size: S',2020-07-21T23:26:41Z,2020-07-22T19:11:26Z
15866,Cannot react with a custom emoji to a bot message ,"Attempting to react to a bot message with a custom emoji appears to work but if you refresh the page it's gone. Inspecting the network requests reveals that the request to add the reaction fails with a 400 Bad Request error `Reaction doesn't exist.`.

This can be easily reproduced with the Notification Bot. Note that the `zulip` reaction works since it's not really a custom emoji, but you can reproduce the problem with any other custom emoji.",Gittenburg,b'area: emoji bug priority: high',2020-07-21T17:43:27Z,2020-07-24T20:11:28Z
15865,Add horizontal scroll bars for table on overflow,"Currently, if the table text overflows due to too many columns, there is no way to scroll horizontally to see the whole table. The text is rendered properly since it can be selected and copied

Here's a markdown snippet that you can use to reproduce the issue.

```
dsdhdbcbbfoo|vzdvdhsdbvbar|sdvdsdhbdsbbaz|asadgdgdrsgdffefdsdf|basfsdfsdf|csadnstjdncsdsd|dszvgdgvxcvdvvsf|esadvsdvsddvgsvxv
---|---|---|---|---|---|---|---
dfbdsfbdbdb1|2sdvdrgerv|3sdvdgdrbxfd|4svvdgvxcv|5asvvvvvdv|sdvsvS|svsdvdgdr|vadsvssasvasvs|vdgdvrgr this is cut off
```

When pasted in a Zulip chat, it renders as below, with no way to scroll horizontally. I'm running Zulip in Firefox 78.0.2 on Linux, in case that is relevant.

![image](https://user-images.githubusercontent.com/11322718/88075960-7e483780-cb47-11ea-9309-2cdb9ae68891.png)
",munircontractor,b'area: markdown bug good first issue in progress',2020-07-21T15:44:59Z,2020-09-01T01:47:17Z
15864,Error in email_mirror - _UnstructuredHeader has no attribute addresses,"Since updating to Zulip 3.0 emails fetched by the email_mirror setup are not processed properly any more. The following error occurs:

```
File ""/home/zulip/deployments/2020-07-17-22-37-44/zerver/management/commands/email_mirror.py"", line 96, in handle
    for addr in header_value.addresses:
AttributeError: '_UnstructuredHeader' object has no attribute 'addresses'
```
The issue (in my case) is caused by an email with the header `Delivered-To`, which belongs to the type `'email.headerregistry._UnstructuredHeader'`. Probably one should test for the type of the class returned by the function `message.get_all(header_name, [])` and react accordingly.",tobiasjj,b'area: emails bug priority: high',2020-07-21T11:20:59Z,2020-07-22T19:14:28Z
15852,ui: Fix loading spinner glitch.,"On calling `loading.make_indicator` for the second
time or more no spinner is being displayed.

This bug can be viewed on visiting a `near: 1` narrow
and the spinner for the newer messages is displayed
only once (i.e. the first time it is rendered), while
the logo is displayed every time.

This happens because `loading.destroy_indicator` sets
the css of that container to display: ""none"". This can
be removed as we are emptying the container just above.

Introduced in 953d475274368ceed0c9584e71498a3cd2c93d41.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",ryanreh99,b'bug size: XS',2020-07-19T05:59:28Z,2020-07-20T18:25:57Z
15850,composebox: Blur PM recipient input after close.,"Previously the private_message_recipient input remained focused after
closing the composebox with Escape. On Firefox this resulted in it
gobbling up all further keyboard shortcuts (until you clicked
somewhere). On Chromium this bug didn't occur because it automatically
blurs hidden inputs.

Fixes #15849.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: keyboard UI bug size: XS',2020-07-18T19:10:50Z,2020-07-21T19:09:11Z
15849,Keyboard shortcuts stop working in Firefox after closing private message compose with Escape,"1. Open the private message compose box by clicking `New private message` or by pressing `x`.
2. Close the compose box by pressing `Escape`.
3. All keyboard shortcuts don't work anymore until you click somewhere.

This apparently only happens with Firefox ... it doesn't happen with Chromium.",Gittenburg,b'area: keyboard UI bug in progress',2020-07-18T18:22:45Z,2020-07-21T19:11:55Z
15814,timestamp: Observe user's 24-hour clock setting.,"Fixes #15791.

The `render_markdown_timestamp` function always used 12-hour format before.",blinry,b'area: markdown bug size: M',2020-07-15T19:45:43Z,2020-07-16T00:01:55Z
15808,Avoid closing compose box when opening long messages,"As reported in https://news.ycombinator.com/item?id=23842137, apparently the compose box closes when you click the ""more"" link to open long messages; this doesn't seem like the right tradeoff.",timabbott,b'UX area: message view bug',2020-07-15T17:39:37Z,2020-07-15T17:50:18Z
15807,migrations: Add case-insensitive unique indexes on realm and email.,"Fixes #15772.

This will prevent future occurences of this issue with creating multiple accounts for the same email in one realm, but this won't fix the deployments where this has already happened and are getting exceptions due to this. That should be extremely rare though, sufficiently rare for it to be reasonable to just help out those folks debug and fix the situation on a case-by-case basis rather than trying to come up with some fancy general migration that will handle all possible variants safely without losing meaningful data from the duplicated UserProfiles. So probably it'll be sufficient to, as Tim suggested in a chat, to just put a relevant mention of this in the upgrade notes. Something like:

> Previous versions had a bug which could lead to multiple user accounts being created with the same email address in one realm, corrupting the state of the database. We believe this to be an extremely rare scenario and few, if any, of self-hosted installations will have been affected. This upgrade contains a database migration that will prevent future occurrences of this bug, but the migration will fail if the server has already been affected. If you want to ensure to avoid unexpected downtime due to that, you can run the following code in the Django shell (`/home/zulip/deployments/current/manage.py shell` ):
````
from django.db.models.functions import Lower
UserProfile.objects.all().annotate(email_lower=Lower(""delivery_email"")).values('realm_id', 'email_lower').annotate(Count('id')).filter(id__count__gte=2)
````
> and if it outputs any emails, contact us on chat.zulip.org and we'll help you fix the situation before proceeding with the upgrade.",mateuszmandera,b'area: production bug priority: high size: S',2020-07-15T15:54:26Z,2020-07-15T16:55:18Z
15804,styles: Make focus outline work reliably.,"For a:focus Bootstrap sets the following rules:

    outline: thin dotted #333;
    outline: 5px auto -webkit-focus-ring-color;

Firefox does not know -webkit-focus-ring-color and falls back to the
previous rule, making the outline invisible in darkmode.

Chromium has a bug[1] that makes outline: auto invisible when focussing
elements programmatically (which we do for the up & down arrow keys).

[1]: https://bugs.chromium.org/p/chromium/issues/detail?id=1105822

Fixes #15768.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'UX bug design priority: blocker size: S',2020-07-15T11:17:07Z,2020-07-15T16:57:24Z
15792,settings: Fix saving indicator glitch.,"jQuery's fadeOut() sets display: none using inline CSS.
This was overriden by .alert-notification since it used !important
to override the display: block set in loading.js.  Removing the latter
allows us to remove the !important, and doesn't seem to break anything.

Fixes #15759.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: settings UI bug size: XS',2020-07-14T20:43:32Z,2020-07-24T20:18:39Z
15791,Make <time syntax adhere to 24-hour clock setting,"I have activated 24-hour time format in my Zulip profile.

Expected behavior: <time markup is rendered as `Sat, Aug 8 2020, 22:00`.
Actual behavior: it's rendered as `Sat, Aug 8 2020, 10:00 PM`",blinry,b'area: markdown bug',2020-07-14T19:57:03Z,2020-07-16T00:01:43Z
15790,Make <time syntax report the timezone used for display,"I just used the <time syntax for the first time, and it caused *more* confusion instead of less, because a person was not currently in the timezone configured in their profile. :P

I'd suggest that Zulip should display the user's timezone next to the time, like so: `Sat, Aug 8 2020, 10:00 PM (Europe/Berlin)`",blinry,b'UX area: markdown bug priority: blocker',2020-07-14T19:54:15Z,2020-07-16T00:01:46Z
15785,settings-ui: Fix 'Saved' alert-notification re-apperance after fading out.,"The modified jQuery code adds 'display: none;' style with 'important' tag
to the message element just after fadeOut is completed which overrides the
'display: inline-block !important' property of .alert-notification class
specified in settings.scss and thus completely hides the message element
after fadeOut.

Tested on my local Ubuntu development server in Chrome and Firefox browsers
by modifying various settings.

Stream Settings:
![settings1](https://user-images.githubusercontent.com/39924567/87332500-45adca00-c559-11ea-847a-955db263d305.gif)

User Settings:
![settings2](https://user-images.githubusercontent.com/39924567/87332510-4b0b1480-c559-11ea-936c-c4f4dc79a54c.gif)

Display Settings:
![settings3](https://user-images.githubusercontent.com/39924567/87332516-4cd4d800-c559-11ea-88f0-2658f720435f.gif)

Error Notification display:
![settings4](https://user-images.githubusercontent.com/39924567/87332529-4e060500-c559-11ea-9aed-3b6acb2d27f7.gif)


Fixes: #15759.",garg3133,b'area: settings UI bug size: XS',2020-07-14T07:35:52Z,2020-09-12T20:58:17Z
15774,settings-ui: Fix 'Saved' alert-notification re-apperance after fading out.,"Removed important tag from display property of .alert-notification class in settings.scss
due to which the display property appearing from loading.js as an inline-style in alert-notification
elements was not working. Also, changed the display property appearing from loading.js from
block to inline-block so as to display the notification as it was being displayed before.

Tested on my local Ubuntu development server by modifying various settings where .alert-notification
class is being used for displaying notification. Results of a few tests are attached below. The success
notification fades away after a while whereas the error notification stays.

Stream Settings:
![settings1](https://user-images.githubusercontent.com/39924567/87332500-45adca00-c559-11ea-847a-955db263d305.gif)

User Settings:
![settings2](https://user-images.githubusercontent.com/39924567/87332510-4b0b1480-c559-11ea-936c-c4f4dc79a54c.gif)

Display Settings:
![settings3](https://user-images.githubusercontent.com/39924567/87332516-4cd4d800-c559-11ea-88f0-2658f720435f.gif)

Error Notification display:
![settings4](https://user-images.githubusercontent.com/39924567/87332529-4e060500-c559-11ea-9aed-3b6acb2d27f7.gif)


Fixes: #15759.",garg3133,b'area: settings UI bug size: XS',2020-07-13T17:10:50Z,2020-07-14T21:13:23Z
15773,Inline Twitter Previews,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->

As a part of fixing #15518, this is an improved approach for the issue making the twitter previews behave like our image previews. Overall the experience feels more consistent and the spoiler-preview interaction is fixed as a consequence of the overall change here.

![image](https://user-images.githubusercontent.com/8033238/87332138-c7512800-c558-11ea-8b1b-a8bba3656c44.png)

For most chat-like cases (where people just send a single paragraph/message), the behavior should remain the same as before and for longer messages, now the previews wouldn't appear as if they are footnotes.

(We might have similar bugs in link previews, I've yet to test for those.)",aero31aero,b'area: markdown bug size: XL',2020-07-13T17:04:21Z,2020-07-13T20:24:47Z
15772,psycopg2.errors.UniqueViolation duplicate key value violates unique constraint,"Hey guys,

might be related to #10579.

* git: 2b95f54593a2d226c25b0a24a4b85a44399c24de (2.1.4)
* two realms
* account `zulip.zerver_userprofile`.`email` are all like `userNN`@domain.tld

When inviting a new user via email clicking the registration url results in http 500 internal server error. As I delegated admin control to non-tech guys I'm unaware what might have happened.

What I see from the database (`zerver_userprofile`) is that there is one email address (`delivery_email`) available in both realms, with `id` being empty (see stack below) in one of the realms (id 2).

```sql
delete from zulip.zerver_userprofile where id = 123;
```

fails with 

```
ERROR:  update or delete on table ""zerver_userprofile"" violates foreign key constraint ""zerver_useractivity_user_profile_id_3f3c3ea8_fk_zerver_us"" on table ""zerver_useractivity""
DETAIL:  Key (id)=(123) is still referenced from table ""zerver_useractivity"".
```

I'm interested in two things:
* You understand the error and can fix its origins.
* I can invite people to the zulip instance again.

Any help greatly appreciated!


Logs from clicking a registration url:

```
==> errors.log <==
2020-07-13 15:08:16.577 ERR  pid:7320 [django.request] Internal Server Error: /accounts/register/
Traceback (most recent call last):
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 64, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 31, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 18, in wrapper_execute
    return action(sql, params)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint ""zerver_userprofile_realm_id_email_13360e45_uniq""
DETAIL:  Key (realm_id, email)=(2, ) already exists.
```

```
Traceback (most recent call last):
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/decorator.py"", line 133, in wrapper
    return func(request, *args, **kwargs)
  File ""./zerver/views/registration.py"", line 332, in accounts_register
    realm_creation=realm_creation)
  File ""./zerver/lib/actions.py"", line 522, in do_create_user
    source_profile=source_profile)
  File ""./zerver/lib/create_user.py"", line 115, in create_user
    user_profile.save()
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/base_user.py"", line 80, in save
    super(AbstractBaseUser, self).save(*args, **kwargs)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 808, in save
    force_update=force_update, update_fields=update_fields)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 838, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 924, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 963, in _do_insert
    using=using, raw=raw)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 1079, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 1112, in execute_sql
    cursor.execute(sql, params)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 64, in execute
    return self.cursor.execute(sql, params)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/utils.py"", line 94, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/utils/six.py"", line 685, in reraise
    raise value.with_traceback(tb)
  File ""/srv/zulip-venv-cache/6176a52fab8737c09656fc8ad0352547e9801c07/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 64, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 31, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 18, in wrapper_execute
    return action(sql, params)
django.db.utils.IntegrityError: duplicate key value violates unique constraint ""zerver_userprofile_realm_id_email_13360e45_uniq""
DETAIL:  Key (realm_id, email)=(2, ) already exists.
```",transferkraM,b'area: production bug in progress priority: high',2020-07-13T15:58:05Z,2020-07-15T17:10:04Z
15771,message send: Update failed message ui on re-send success.,"Fixes #15351.

Tested by changing network to offline while sending a message and by
changing network to slow 3G in dev tools while re-sending the message.",ryanreh99,b'area: compose area: message-editing bug size: S',2020-07-13T12:33:04Z,2020-07-13T19:32:25Z
15770,All messages view always starts at a certain day for me,"I've been using the `rust-lang` zulip for some months and recently every time I open Zulip the all messages view starts at June 19 at specifically [this message](https://rust-lang.zulipchat.com/#narrow/stream/122649-announce/topic/new.20streams/near/201404922). I don't know why it is stuck there and even when I scroll down to the very bottom, the next time I reload zulip it pops right back up there.",retep998,b'area: message view bug in progress priority: high',2020-07-13T05:08:29Z,2020-09-01T18:29:08Z
15768,popovers bug: Focused element not highlighting in popover menu.,"Notice the left chat menu and the value of `document.activeElement` [live expression](https://developers.google.com/web/tools/chrome-devtools/accessibility/focus) in chrome console opened in right.

As you can see the element is getting focus (value of document.activeElement is changing constantly as I move my up down arrow keys in keyboard) but for some reason the highlight is not happening.

Steps I followed:
1. Use mouse to open the message action popover menu.
2. Use up down arrow keys to navigate the menu (Sometimes it does highlight, not sure why this is not consistent bug )
3. Now used ""i"" shortcut to open menu popover. Used up down arrow key, but still no highlighting of menu.

Using chrome Version 83.0.4103.116 and browsing chat.zulip.org
GIF:
![Kapture 2020-07-13 at 4 36 48](https://user-images.githubusercontent.com/23462580/87258611-97574580-c4c2-11ea-80a5-9b497a016641.gif)


",thedeveloperr,b'bug design priority: blocker',2020-07-12T23:06:19Z,2020-07-15T16:57:20Z
15759,Remove the persistent savings indicator text after a successful response.,"![indicator_bug](https://user-images.githubusercontent.com/40122794/87219985-bac4a800-c37d-11ea-9a08-c6cafcbeb272.gif)

As shown in the gif above, the ""Saved"" text re-appears after fading out and just stays there.
The previous behaviour was that, on successful response the container faded out.
While for an error response it remained.
Introduced in https://github.com/zulip/zulip/commit/f97d35ebd244ee83744b0fb2194dc1f32e0f92ab.",ryanreh99,b'area: settings UI bug help wanted in progress',2020-07-11T08:24:23Z,2020-07-14T23:32:42Z
15746,Improve virtualenv-clone hashing logic,"Fixes #12868
@timabbott I am not sure if we should  increase the provision version for this. ",amanagr,b'area: production area: tooling bug priority: high size: L',2020-07-10T05:55:17Z,2020-07-14T05:28:37Z
15721,upgrade: Add management command to fix FTS indexes.,"Fixes #14982.

`update_fts_indexes` is a weird background process that care of index updates on new messages in the background, it doesn't feel right to make it also a command for one-time audit and fix after an upgrade - I think it's more natural to just have a management command for that - especially since the changes to the code of `update_Fts_indexes` that would be needed would make it much less readable.

Doesn't check pgroonga records, as I don't think we're aware of any breakage happening there? And given that I haven't worked with pgroonga, I don't know what such hypothetical breakages would be that we should audit for. I can try to dive into it if we decide we need it for the release - or could leave it for a follow-up.",mateuszmandera,b'area: production bug difficult priority: high size: M',2020-07-08T14:56:14Z,2020-07-13T19:45:33Z
15691,message_header: Fix overlap on mobile with flex.,"Fixes #15501.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

before:

![Screenshot_2020-07-06 leased database wasn't over-heating slowly - Zulip Dev - Zulip](https://user-images.githubusercontent.com/47354597/86602131-85494480-bfa2-11ea-8959-4250430f2c8a.png)

after:

![Screenshot_2020-07-06 leased database wasn't over-heating slowly - Zulip Dev - Zulip(1)](https://user-images.githubusercontent.com/47354597/86602144-88dccb80-bfa2-11ea-86b9-56de861f02c8.png)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: mobile web bug size: S',2020-07-06T14:08:25Z,2020-07-09T20:13:48Z
15687,puppet: Don't run thumbor services in production.,"Fixes #15649.
Currently, no production services use thumbor; so, it makes sense
to not run them in production systems.

This also avoids users facing issues like #15649.",amanagr,b'area: production bug priority: blocker size: XS',2020-07-06T09:17:10Z,2020-07-10T21:23:11Z
15683,move_topic_to_stream: Apply the event to the fetched state.,"Fixes #14101.

We fix the unread count for the messages which were moved to
the new stream too.",amanagr,b'area: api area: message-editing bug difficult size: L',2020-07-06T07:48:30Z,2020-07-07T07:42:38Z
15680,message list: Fix exception re-rendering messages following local echo.,"Fixes #15346.

Step to reproduce:
1. Set 10 secs delay in [`do_send_messages`](https://github.com/zulip/zulip/blob/master/zerver/lib/actions.py#L1365)
2. Update the setTimeout timer to 5000ms from 0 in [`change_message_id`](https://github.com/zulip/zulip/blob/master/static/js/message_list_data.js#L554)
3. [OPTIONAL] Comment out the [re-selection](https://github.com/zulip/zulip/blob/master/static/js/message_list_view.js#L1092).
(The first 2 points are enough to always reproduce this exception.
Added this to test out the other code path which raises the exception,
which isn't necessary, but it is helpful to know when to create the race by scrolling or clicking,
i.e. when the message pointer loses focus. )
4. Send a message to the narrow / all messages, from a user.
5. Using a different user, send a message to the same message list. This message gets locally echoed.
6. Select the locally echoed message. The other users message gets displayed out of order, just below it.
7. Our sent message is received and the message is still selected, thus raising the exception.
(If point 3 was done, then we would have to manually re-select the message).
This PR allows the re-ordering of the message without raising the exception.

**Previously:**
![echo_bug_before](https://user-images.githubusercontent.com/40122794/86536157-094bef80-bf03-11ea-8b0a-ba52a8b1ef01.gif)
**Now:**
![echo_bug_after](https://user-images.githubusercontent.com/40122794/86536161-123cc100-bf03-11ea-888c-710adf32e63f.gif)",ryanreh99,b'area: compose bug size: M',2020-07-05T15:39:13Z,2020-07-07T05:28:25Z
15655,urls: Support simple slugs for stream/PM narrows,,showell,b'area: misc bug priority: high size: L',2020-07-03T15:17:47Z,2020-07-03T23:50:24Z
15654,stream_edit: Fix scrolling in subscribers list.,"We had a bug in subscribers list, where the scrolling worked only till
first 80 subscribers (which is the initial render count of list_render
widget) in the list even when stream has more subscribers. Ideally
more subscribers should be rendered on scrolling.

This was happening because the scrolling events in list_render.js was
being registered for element with ""subscriber_list_container"" class
instead of the element with ""simplebar-content-wrapper"" class, as
simplebar is added to the element only after it is loaded into the DOM
and we were calling list_render.create before that.

We fix the bug by extracting the code for creating lists to
render_subscribers_list and calling it only after the element is
loaded into DOM, which is done by using "".ready()"" method of jquery.

Fixes #15637.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'area: stream settings bug priority: blocker size: L',2020-07-03T14:50:33Z,2020-07-07T01:38:58Z
15649,restart server fails: zulip-thumbor: ERROR (no such process),"```
# su zulip -c '/home/zulip/deployments/current/scripts/restart-server'
2020-07-03 07:30:06,609 restart-server: Restarting Tornado process
zulip-tornado: stopped
zulip-tornado: started
2020-07-03 07:30:08,360 restart-server: Stopping workers
zulip-workers:zulip_deliver_enqueued_emails: stopped
zulip-workers:zulip_deliver_scheduled_messages: stopped
zulip-workers:zulip_events_email_mirror: stopped
zulip-workers:zulip_events_outgoing_webhooks: stopped
zulip-workers:zulip_events_user_activity: stopped
zulip-workers:zulip_events_missedmessage_emails: stopped
zulip-workers:zulip_events_digest_emails: stopped
zulip-workers:zulip_events_email_senders: stopped
zulip-workers:zulip_events_deferred_work: stopped
zulip-workers:zulip_events_embed_links: stopped
zulip-workers:zulip_events_embedded_bots: stopped
zulip-workers:zulip_events_error_reports: stopped
zulip-workers:zulip_events_signups: stopped
zulip-workers:zulip_events_invites: stopped
zulip-workers:zulip_events_missedmessage_mobile_notifications: stopped
zulip-workers:zulip_events_user_activity_interval: stopped
zulip-workers:zulip_events_user_presence: stopped
2020-07-03 07:30:12,841 restart-server: Stopping server core
zulip-django: stopped
zulip-thumbor: ERROR (no such process)
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/restart-server"", line 78, in <module>
    subprocess.check_call([""supervisorctl"", ""stop""] + core_server_services)
  File ""/usr/lib/python3.8/subprocess.py"", line 364, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['supervisorctl', 'stop', 'zulip-django', 'zulip-thumbor']' returned non-zero exit status 1.
```",holtzermann17,b'area: production bug priority: blocker',2020-07-03T07:32:17Z,2020-07-10T21:22:18Z
15648,postgres-init-db: Read terminate-psql-sessions script as root,"Fixes #15646.

**Testing plan:** Ran a production install from `/root`.",andersk,b'area: production installer bug priority: blocker size: XS',2020-07-02T21:03:44Z,2020-08-03T19:08:32Z
15647,date_row: Update color via update_table_stream_color.,"This fixes a UI issue with the stream color update for the time reader.

**Videos**
Before:-
![zulip](https://user-images.githubusercontent.com/48093317/86408383-87767f00-bcd4-11ea-8861-76cd7112df67.gif)

After:-
![zulip2](https://user-images.githubusercontent.com/48093317/86408573-d91f0980-bcd4-11ea-81c8-7dde4a65ec5c.gif)
",PawBud,b'area: message view bug design size: XS',2020-07-02T20:59:32Z,2020-07-07T01:38:32Z
15646,"installation errors: terminate-psql-sessions: Permission denied, and zulip user already exists","I'm attempting to install by cloning the Github repo onto a box upgraded to Ubuntu 20.04.

I'm running the installation command as root: 

```
# ./zulip/scripts/setup/install --certbot --email=myemail@gmail.com --hostname=zulip.mydomain.org
```

The first error I got was this:

```
+ has_class zulip::postgres_common
+ grep -qx zulip::postgres_common /var/lib/puppet/classes.txt
+ '[' -z '' ']'
+ /tmp/tmp.hsRNDO5fPh/zulip/scripts/setup/postgres-init-db
+ POSTGRES_USER=postgres
++ cd /
++ su postgres -c 'psql -v ON_ERROR_STOP=1 -Atc '\''SELECT COUNT(*) FROM zulip.zerver_message;'\'' zulip'
psql: error: could not connect to server: FATAL:  database ""zulip"" does not exist
+ records=
+ '[' -e /var/run/supervisor.sock ']'
+ supervisorctl stop all
process-fts-updates: stopped
++ dirname /tmp/tmp.hsRNDO5fPh/zulip/scripts/setup/postgres-init-db
+ su -s /usr/bin/env - -- postgres /tmp/tmp.hsRNDO5fPh/zulip/scripts/setup/terminate-psql-sessions zulip zulip_base
-env: ‘/tmp/tmp.hsRNDO5fPh/zulip/scripts/setup/terminate-psql-sessions’: Permission denied

Zulip installation failed (exit code 126)!

The install process is designed to be idempotent, so you can retry after resolving whatever issue caused the failure (there should be a traceback above). A log of this installation is available in /var/log/zulip/install.log
```

The second error I got (when I tried rerunning) was this:

```
+ useradd -m zulip --home-dir /home/zulip
useradd: user 'zulip' already exists

Zulip installation failed (exit code 9)!

The install process is designed to be idempotent, so you can retry after resolving whatever issue caused the failure (there should be a traceback above). A log of this installation is available in /var/log/zulip/install.log
```

",holtzermann17,b'area: production installer bug priority: blocker',2020-07-02T17:53:34Z,2020-07-02T21:54:37Z
15642,settings: Fix modal out of screen on mobile.,"For the email and full name modals we simply change width to max-width.

The password modal used a flex-row class for no apparent reason,
the class wasn't used anywhere else and removing it fixes the UI bug.

Fixes #15311.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
before:
![modal_broken](https://user-images.githubusercontent.com/47354597/86320902-2731ff80-bc38-11ea-850a-6204c95c2a37.gif)

after:
![modal_fixed](https://user-images.githubusercontent.com/47354597/86320914-2b5e1d00-bc38-11ea-97b1-d84ee5a9faf0.gif)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: mobile web bug size: M',2020-07-02T05:46:57Z,2020-07-02T20:47:38Z
15637,Cannot scroll through complete list of subscribers for a stream with large number of subscribers.,"There is a bug while scrolling in the list of subscribers shown in stream settings modal. After scrolling till the bottom initial rendered list of subscribers (which is probably of 80 subscribers), we can not scroll down further and cannot see other subscribers.

Ideally subscribers should be added to the list as we scroll down.

Related discussions [here](https://chat.zulip.org/#narrow/stream/9-issues/topic/subscribers.20list.20in.20stream.20settings).",sahil839,b'area: stream settings bug in progress priority: blocker',2020-07-01T19:14:10Z,2020-07-15T17:20:12Z
15554,Code blocks are not very readable in night mode,"When using the night mode color scheme on the desktop client, I find that code blocks are very hard to read. The background of the code block is rendered in white, but the foreground behind the text is dark and has poor contrast with the code. The resulting view is sort of jarring and difficult to read. As an example:
<img width=""354"" alt=""Screen Shot 2020-06-24 at 3 04 46 PM"" src=""https://user-images.githubusercontent.com/17734409/85616649-124bdf80-b62c-11ea-863b-8ebf0339ec1e.png"">
",nathanwhit,b'area: markdown area: settings (user) bug design',2020-06-24T19:12:33Z,2020-06-25T00:32:07Z
15528,"message view: Fix erroneous ""message outside current narrow"" notice.","Fixes #15497.
tested using the details mentioned in the issue.
![ci](https://user-images.githubusercontent.com/40122794/85339995-e2ed8380-b502-11ea-8ed9-04386150409b.png)
",ryanreh99,b'area: message view bug priority: blocker size: S',2020-06-22T22:08:40Z,2020-06-24T15:01:50Z
15520,emoji_picker: Fix no hover effect when filtering.,"Fixes #15487.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: emoji bug priority: blocker size: XS',2020-06-21T21:43:36Z,2020-06-22T11:03:08Z
15518,Twitter preview embeds show outside of spoiler blocks,"When a tweet is linked to inside of a spoiler block, the embedded preview for the tweet shows up outside of the spoiler block (at the end of the post as is typical for non-spoilered links to tweets). The preview should probably show up inside of the spoiler block (perhaps at the end of the inside of the block, if there are concerns about tweet previews breaking the flow of a post).

(Previews for uploaded images appear to respect spoiler blocks.)",jdherg,b'area: markdown bug in progress',2020-06-21T19:53:25Z,2020-07-13T19:27:37Z
15511,Scrolling to the end of recent topics is bugged,"With **Firefox**: (Notice how the last entry is cut off and the scroll bar goes further down than it should)

![scroll_bug](https://user-images.githubusercontent.com/47354597/85229904-decf4200-b3ec-11ea-8d6b-c9a4212468a4.gif)

With **Chromium** (Notice how the knob of the scroll bar goes further down than it should)

![scroll_bug_chromium](https://user-images.githubusercontent.com/47354597/85230098-17235000-b3ee-11ea-8530-03f7244c7863.gif)
",Gittenburg,b'bug',2020-06-21T16:37:11Z,2020-07-06T18:54:54Z
15506,import: Fix import and export parallelism defaults.,"I went with the""half of the number of (available) cpus"" approach https://docs.python.org/3/library/os.html#os.sched_getaffinity Or do we want to just use `2`?

Fixes #14960.
The default of 6 thread may not be appropriate in certain
configurations. Taking half of the numer of CPUs available to the
process will be more flexible.

",mateuszmandera,b'area: export/import bug priority: high size: S',2020-06-21T11:34:03Z,2020-06-21T16:39:59Z
15502,compose: Use rendered_markdown.update_elements for previews.,"As we add more features where rendered_markdown.update_elements does
something useful, it'll become important to run this code everywhere
we render markdown in the DOM.

One can see in this case that we had actually copied one hunk of
rendered_markdown.update_elements years ago, before we extracted it as
an independent function; we get to delete that copy.

Fixes #15500.

This PR fails node tests; we need to make `rendered_markdown.update_elements` a noop here.  I don't actually know how to do that for our new-style modules; @andersk can you help?

(I'd like your attention on this in any case; I think we might want to harden this interface a bit, or perhaps better, should we just be doing this in the same way as `clean_user_content_links`?)",timabbott,b'area: markdown bug size: S',2020-06-21T07:15:58Z,2020-07-07T21:37:44Z
15501,Mobile web: Long topics overlap the date stamp area in floating recipient bar,"I noticed this thanks to the development environment having long generated topics and messages across a range of dates.  If you're looking at messages from a past day in the mobile web UI, with a log topic, the topic ends up overlapping the date marker:

![image](https://user-images.githubusercontent.com/2746074/85216464-97d44480-b339-11ea-8f9b-67245c3ad4d7.png)

We should instead be cutting off the topic with ellipses to prevent this overlap.",timabbott,b'area: mobile web bug help wanted',2020-06-21T05:26:59Z,2020-07-09T20:13:39Z
15500,Draft/Preview view of Spoilers does not display client-side rendered content,"@opheliasdaisies @timabbott 

Looks like the change to make the dropdown button and default header client-side means that previews don't work quite right anymore. They don't show the dropdown arrow at all (meaning you can't preview the content inside a spoiler) and don't show the ""Spoiler"" default header if the header is left blank.

I'm not sure if other features that use the client-side rendered_markdown have a workaround for this. I'm happy to take this on as we finish up our other outstanding spoiler issues, it seems decently important to me.",dylnuge,b'area: markdown bug in progress',2020-06-21T04:40:30Z,2020-07-07T21:40:12Z
15497,"Erroneous ""Your message is outside your current narrow"" notices","I ran into another instance where we displayed the ""Sent! Your message is outside your current narrow."" error message erroneously.  

After some debugging, I figured out the recipe for what happend:
* Send a message to a new topic, but have the server be slow to response (E.g. because you added a `time.sleep(5)` in the send_message_backend function to help reproduce this).
* See the message locally echoed with a floating-point ID like `1234.01`
* The compose box should reopen
* Hit `Ctrl+.` to trigger a renarrow to the current compose location
* We'll enter that view, with the locally echoed message displayed via the `load_local_messages` code path
* We send a request to the server to fetch more messages; this request is done with an `anchor` of the selected message -- which in this case is of course the only message in this view, with ID `1234.01`. 
* This API request gets a 400 error, because floating points aren't allowed in the `GET /messages` API.
* This error leaves us stuck with `fetch_status.has_found_newest = false` and a loading spinner.  

Tagging as a blocker because recent changes make this failure mode much worse than it should be.  I think our fix should have two parts:
* We should ensure the `Your message is outside your current narrow` notice only occurs if the new message actually doesn't match.  Might involve adding a check of this form in the `notifications.js` logic for deciding to trigger this notice
.
```
                if (current_filter && current_filter.can_apply_locally() &&                                     
                    !current_filter.predicate()(msg)) {                                                         
```
* Second, we should fix actual bug here.  I think this is likely as simple as just having the `message_fetch` code round the anchor to an integer with a brief comment about floating point local echo IDs.

@ryanreh99 do you want to take at least the first part of this issue?",timabbott,b'area: message view bug help wanted priority: blocker',2020-06-21T02:23:35Z,2020-06-23T22:46:05Z
15489,message_controls: Prevent clicks via visibility & not pointer-events.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Partially fixes: #13642 (see ""Second bug"" heading).

The commit message here is really long... Should I just delete the `Trivia` and `History` stuff?

**Testing Plan:** <!-- How have you tested? -->
Manually tested this on my mobile device.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Before:
![message-controls-before](https://user-images.githubusercontent.com/33805964/85208065-171e4400-b34b-11ea-8644-a7d5d5bf1452.gif)
After:
![message-controls-after](https://user-images.githubusercontent.com/33805964/85208018-c4448c80-b34a-11ea-983e-6b1bf2a63a29.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: message view area: mobile web bug size: XS',2020-06-20T17:41:18Z,2020-06-21T17:14:12Z
15487,No hover effect in emoji picker while filtering,"If you search for some emoji in the picker and then hover over the results, there is no hover effect at all and the description of the hovered emoji is not shown at the bottom (like it is when not filtering).

This is a regression bug caused by #15451.

![Peek-2020-06-20-21-44](https://user-images.githubusercontent.com/47354597/85206500-db6f8400-b322-11ea-93fe-2187f53bbb5b.gif)

[CZO discussion](https://chat.zulip.org/#narrow/stream/9-issues/topic/Hover.20on.20filtered.20emojis/near/910105).
",Gittenburg,b'area: emoji bug priority: blocker',2020-06-20T16:22:36Z,2020-06-22T11:03:08Z
15480,Search pills are misaligned on Firefox,"With the latest Firefox 77.0.1.

![zulip_broken_pills](https://user-images.githubusercontent.com/47354597/85195826-f7990400-b2d5-11ea-8eca-545327eacf26.gif)
",Gittenburg,b'bug',2020-06-20T07:13:05Z,2020-07-06T18:54:33Z
15479,message view: Fix link generation logic of the end of results notice.,"Fixes #15405
![ci](https://user-images.githubusercontent.com/40122794/85191662-4bf3b200-b2dd-11ea-85bf-a71c91a9c224.png)
",ryanreh99,b'area: message view bug priority: blocker size: M',2020-06-20T04:34:02Z,2020-06-21T02:32:29Z
15469,stream: Fix message on clicking add button with empty subscribers form.,"This PR corrects the message shown when we click the add button
for subscribing users to stream with empty input.
We show 'No user to subscribe.' as the message when trying to add
subscribers with empty input.
Let me know if we want to change the message, I have added the one that
felt appropriate to me.

Fixes #15450.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![Screenshot (132)](https://user-images.githubusercontent.com/35494118/85165598-b24be680-b283-11ea-8307-c4ac40352622.png)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'area: stream settings bug size: S',2020-06-19T16:58:37Z,2020-06-21T13:45:03Z
15468,Fixes corrupted Reactions data model state when using multiple aliases for an emoji code. #15347,"@timabbott  Can you check this?
CI is passing.
Fixes #15347 ",arpit551,b'area: emoji area: production bug priority: high size: L',2020-06-19T16:42:58Z,2020-06-19T17:09:01Z
15457,bugdown: Use standard library datetime.timezone.utc,,andersk,b'size: XS',2020-06-18T21:30:43Z,2020-07-02T21:19:54Z
15451,emoji picker fixes,,showell,b'area: emoji bug size: M',2020-06-18T19:04:28Z,2020-06-20T19:47:10Z
15450,Wrong message generated when clicking add button on an empty stream membership form,"- Goto http://localhost:9991/#streams/7/announce

- Click on Add button.

- It generates wrong message.

  > user11@zulipdev.com are already subscribed.

![Screenshot from 2020-06-18 23-42-47](https://user-images.githubusercontent.com/7190633/85056869-941bb300-b1bd-11ea-8b5e-39966cc767ec.png)


The message should be ""No user selected"" or something similar.

",hackerkid,b'area: stream settings bug help wanted',2020-06-18T18:15:00Z,2020-06-21T00:55:24Z
15448,popovers: Improve keyboard navigation,"When you open a popover (even with the mouse) from the left or right sidebar, we should keyboard-enable the popover by selecting the first field, which should allow for keyboard navigation.

See also #15439.",showell,b'accessibility area: keyboard UI bug design in progress priority: high',2020-06-18T16:14:54Z,2020-09-01T06:01:17Z
15421,logging: Fix the broken logging configuration for webhooks.,"The webhooks code relies on two special loggers one for errors in general and one for unexpected events.

These loggers were previously configured in a few lines of global scope code at the top of zerver/decorator.py using `log_to_file` and then stored in global variables.

This, for reasons I'm not entirely certain of, lead to issues where sometimes the loggers would not be configured with the extra handlers added via. `log_to_file` but rather only the loggers specified in the configuration dictionary in computed_settings.py. So by specifying all of the handlers for these loggers in computed_settings.py itself we can both fix this issue and keep our logging configuration cleaner (in just one easy to read dictionary).

Fixes #15391.

Part of the series of issues that need to be fixed for the Zulip 2.2 release. @timabbott FYI.",Hypro999,b'area: production bug priority: blocker size: M',2020-06-17T11:46:42Z,2020-06-20T00:13:56Z
15420,Wrong email address visible for new signed up users.,"For users who just signed up, we show `user_profile.delivery_email` instead of `user_profile.email`. We need to show `user_profile.email` in every case.

Note: You need to be an admin to view email of other users.",amanagr,b'area: general UI bug help wanted in progress',2020-06-17T10:24:38Z,2020-06-18T04:54:19Z
15413,"auth: Change the ""continue in browser"" link in desktop flow end page.","As suggested by @andersk in https://github.com/zulip/zulip/issues/14828#issuecomment-623627319

Fixes #14828.
Giving the /subdomain/<token>/ url there could feel buggy if the user
ended up using the token in the desktop app, and then tried clicking the
""continue in browser"" link - which had the same token that would now be
expired. It's sufficient to simply link to /login/ instead.
",mateuszmandera,b'area: authentication bug priority: blocker size: S',2020-06-16T19:35:39Z,2020-06-16T23:27:59Z
15411,"""WARN [] Invalid property messages_read::hour"" from update_analytics_counts cron job","Since upgrading past aa70baba718a5723e12bce68075118ea4a168a9c I am getting an email from cron once every hour reading something like

> ```
> Subject: Cron <zulip@[MYSITE]> /home/zulip/deployments/current/manage.py update_analytics_counts
> 2020-06-16 17:05:07.220 WARN [] Invalid property messages_read::hour
> ```

Nothing committed since then looks like it would resolve this.",zackw,b'area: analytics bug priority: blocker',2020-06-16T17:55:38Z,2020-06-17T07:26:19Z
15405,message view: Fix link generation logic of the end of results notice.,"The end of results notice is displayed after the oldest message has been fetched and only if we have fetched the data for the current message list.

However while fetching, if any overlay is open (i.e. the hash fragment of the URL changes) the message list remains unchanged but since the href logic depends on the current URL instead of the message list, we get an incorrect link.",ryanreh99,b'area: message view bug priority: blocker',2020-06-16T08:00:48Z,2020-06-20T23:26:40Z
15402,Fix webapp stream name parsing to allow integers in stream name component,"Apparently we don't support using links of this form to access to a topic:

https://chat.zulip.org/#narrow/stream/3/topic/send_message.20API

requiring the stream name (or anything) to be encoded after a dash, like here:

https://chat.zulip.org/#narrow/stream/3-backend/topic/send_message.20API

@showell do you agree?

I think I've traced the problem to this function needing to support a pure ID in the stream name part.

```
exports.slug_to_name = function (slug) {                                                   
    const m = /^([\d]+)-/.exec(slug);                                                      
    if (m) {                                                                               
        const stream_id = parseInt(m[1], 10);                                              
        const sub = subs_by_stream_id.get(stream_id);                                      
        if (sub) {                                                                         
            return sub.name;                                                               
        }                                                                                  
        // if nothing was found above, we try to match on the stream                       
        // name in the somewhat unlikely event they had a historical                       
        // link to a stream like 4-horsemen                                                
    }                                                                                      
                                                                                           
    return slug;                                                                           
};                                                                                         
```

@gnprice FYI, can you open a zulip-mobile issue if its parser doesn't handle this properly as well?",timabbott,b'area: misc bug in progress priority: high',2020-06-16T00:24:04Z,2020-07-03T23:53:22Z
15399,Replace stream_params with sub,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This is done on top of #15393 and is still WIP.

**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: general UI bug size: L',2020-06-15T23:00:06Z,2020-06-18T11:08:11Z
15393,Fix regression on unknown streams in navbar,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This doubles down on ""undefined"" being an expected value for `_stream_params` (which will become the `sub` object in the future.)

**Testing Plan:** <!-- How have you tested? -->
Adds node tests to maintain coverage on `filter.js`

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![navbar-unknown-sub](https://user-images.githubusercontent.com/33805964/84704407-63e2d300-af77-11ea-8bc3-81e68b0b6b54.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: general UI bug size: L',2020-06-15T20:48:00Z,2020-06-16T14:44:11Z
15391,/var/log/zulip/webhooks_errors.log is not working in development (was production too),"This seems to be a regression dated roughly June 5 at 3PM; errors that used to be written to `/var/log/zulip/webhooks_errors.log` are now only appearing in `errors.log` in production environments.  The same is true for `/var/log/zulip/webhooks_unexpected_events.log`.  My guess is we broken the logger configuration.

@Hypro999 @eeshangarg FYI.",timabbott,b'area: production area: tooling bug',2020-06-15T20:07:26Z,2020-10-09T19:22:57Z
15387,Error when guest users clicks on an unsubscribed stream link,"When a guest user clicks on stream url to which the guest user is unsubscribed to, this creates a traceback
```
Uncaught TypeError: Cannot read property '_stream_name' of undefined
    at Filter.get_title (filter.js:578)
    at make_tab_data (tab_bar.js:26)
    at build_tab_bar (tab_bar.js:116)
    at Object../static/js/tab_bar.js.exports.render_title_area (tab_bar.js:162)
    at Object../static/js/tab_bar.js.exports.initialize (tab_bar.js:148)
    at Object../static/js/narrow.js.exports.activate (narrow.js:337)
    at do_hashchange_normal (hashchange.js:103)
    at hashchanged (hashchange.js:253)
    at hashchange.js:299
    at dispatch (jquery.js:5429)
    at elemData.handle (jquery.js:5233)
```

@**Yash RE ✨** FYI

Do we need a Puppeteer test for this too? I think it is easy to get in a state where this happens again.",amanagr,b'area: general UI bug help wanted in progress',2020-06-15T17:42:35Z,2020-06-15T23:51:30Z
15385,message view: Fix loading indicators.,"Fixes #15374 

**Testing Plan:** <!-- How have you tested? -->
Tested it by displaying which message lists's indicator is displayed, below it.
And also by continuously fetching the `home_msg_list`.

Added the testing commit at the end where changes have been commented to pass tests.
",ryanreh99,b'area: message view bug priority: high size: XL',2020-06-15T13:48:00Z,2020-06-16T05:31:41Z
15380,Selecting a category in the emoji picker scrolls to middle of category instead of top,Something appears to be off with the offset calculation in `static/js/emoji_picker.js`. Interestingly the scrolling works correctly when using Page Up / Down.,Gittenburg,b'bug',2020-06-15T05:41:55Z,2020-07-06T18:53:48Z
15374,Scope problems with loading_newer indicator,"The new loading_newer loading indicators turn out to be buggy, because of the somewhat subtle interaction caused by there being multiple message lists fetching data at a time.  Specifically, if you visit a narrowed view when the ""Home"" view isn't fully caught up, we'll end up showing loading indicators at the bottom of the page, even if the view we're actually looking at is caught up.

The structural problem is that we don't appear to properly scope the loading indicator logic accessed by `load_more` in `message_fetch.js` to only if `current_msg_list` is `home_msg_list`.  

I merged a1259c2521331dc817205eadcdb2dc20e5ecfe30, which helps a bit here, but the main issue remains.

And merged 67053ff479f01a4c7ee3423e8d99ecb98ccf0de1 to revert the highly visible buggy behavior to buy us a bit of time to fix this properly.  The commit message there has some thoughts on the right path forward.

@ryanreh99 FYI.
",timabbott,b'area: message view bug priority: high',2020-06-14T17:06:47Z,2020-06-16T05:30:36Z
15372,"After upgrade from 2.1.4 to development, certbot was uninstalled","I'm running zulip on Debian 10.  I initially installed 2.1.4 but then upgraded to a development branch -- specifically, I was asked to test https://github.com/zulip/zulip/pull/14925 .  Since the upgrade, the daily cron job that renews the server certificate has been reporting

```
/home/zulip/deployments/current/scripts/lib/certbot-maybe-renew: line 20: certbot: command not found
```

Installing the Debian package `certbot` fixes the issue.  I'm pretty sure this package *was* installed prior to the upgrade.",zackw,b'area: production bug',2020-06-14T14:19:24Z,2020-06-16T01:04:12Z
15368,emoji_picker: add Flags category,"Fixes #15303

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![image](https://user-images.githubusercontent.com/47354597/84576258-98a62d00-adb3-11ea-97e7-8b6ce837fbed.png)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Gittenburg,b'area: emoji bug priority: high size: XS',2020-06-14T07:05:55Z,2020-06-14T17:42:05Z
15351,Exception in local echo retry logic,"We've seen this exception in production:

```
Message:
Trying to get local_id from row that has reified message id: {message_id}

Stacktrace:
Error
    at Object.e.error (https://zulipchat.com/static/webpack-bundles/ea3954ab8bbc630b7437.js:1:7554)
       = ./static/js/blueslip.js line 245 column 17

    at Object.n.local_echo_id (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:305192)
       = ./static/js/rows.js line 108 column 18

    at HTMLElement.<anonymous> (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:500914)
       = ./static/js/echo.js line 362 column 35
```

The bug here is clearly that we are somehow allowing someone to click on the UI elements in this part of the message.  There's two possibilities: This is a message we ourselves sent and we didn't hide this UI properly after the message was processed by the server, or this UI was shown in the first place for a message sent by someone else.  The former is suggested by the fact that the message ID in question was sent by the user who got this error in the cases I've seen.

```
    <div class=""message_failed {{#unless msg.failed_request}}notvisible{{/unless}}"">
        <i class=""fa fa-refresh refresh-failed-message"" data-toggle=""tooltip"" title=""{{t 'Retry' }}"" aria-label=""{{t 'Retry' }}"" role=""button"" tabindex=""0""></i>
        <i class=""fa fa-times-circle remove-failed-message"" aria-hidden=""true"" data-toggle=""tooltip"" title=""{{t 'Cancel' }}""></i>
    </div>
```

This is with the Opera 68 browser, which may very well be relevant.

I certainly find it hard to understand the state machine for how those widgets are cleared, after reading the code, which makes me think it may just be a bit buggy (e.g. the buttons don't hide as soon as they should, or something).  In any case, an attempt to reproduce should start with making the send-message server-side code path return an error.

I should also mention that there's probably an opportunity to improve the code to avoid rendering to the DOM those widgets in messages that the user didn't themself send; we are likely wasting some browser resources in the vast majority of messages from the current model.",timabbott,b'area: compose area: message-editing bug help wanted',2020-06-13T00:37:03Z,2020-07-13T19:29:34Z
15348,Exception finding scroll element for emoji picker,"We get this frontend exception in production:

```
Message:
Expected one element in jQuery set, 2 found

Stacktrace:
Error
   at e.error (https://zulipchat.com/static/webpack-bundles/ea3954ab8bbc630b7437.js:1:7539)
       = ./static/js/blueslip.js line 243 column 57
   at $.fn.expectOne (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:287714)
       = ./static/js/setup.js line 48 column 13
   at n.get_scroll_element (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:695969)
       = ./static/js/ui.js line 24 column 5
   at S (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:1719129)
       = ./static/js/emoji_picker.js line 311 column 13
   at Anonymous function (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:1725017)
       = ./static/js/emoji_picker.js line 720 column 9
```

The code that's failing is this:
```
            const $emoji_map = $("".emoji-popover-emoji-map"");                                        
            const start = ui.get_scroll_element($emoji_map).scrollTop();                             
            next_emoji.focus();                                                                      
=>>>          if (ui.get_scroll_element($emoji_map).scrollTop() !== start) {                           
```

So the bug is most likely that somehow we have two copies of `.emoji-popover-emoji-map` in the DOM.  I'm not sure what might cause that, but one possibility is a bug that lets us open two emoji popovers at once (maybe a reactions one and a message editing or compose one)?",timabbott,b'area: emoji bug help wanted in progress',2020-06-13T00:21:33Z,2020-06-18T20:21:54Z
15347,Corrupted Reactions data model state when using multiple aliases for an emoji code,"We have this exception in our frontend exception logs:

`ERROR: server sent duplicate reactions for user {user_id} (key=unicode_emoji,1f44d)`

Looking at the data in question, we indeed have two near-identical Reaction objects in the database for a given message_id/user_profile_id/emoji_code pair; the only difference is that one is `+1` as `emoji_name` and the other is `thumbs_up`.  

The database currently have this unique constraint on the Reaction model:
`unique_together = (""user_profile"", ""message"", ""emoji_name"")`

I think perhaps the bug is that we should also have this unique constraint:

`unique_together = (""user_profile"", ""message"", ""reaction_type"", ""emoji_code"")`

Tagging as a priority since it's important to having bugs where the database doesn't match the intended data model.

This is clearly the result of a race, since we have this check in the view code:
```
    if Reaction.objects.filter(user_profile=user_profile,                                            
                               message=message,                                                      
                               emoji_code=emoji_code,                                                
                               reaction_type=reaction_type).exists():                                
        raise JsonableError(_(""Reaction already exists.""))                                           
```

The preparatory migration for fixing any past corruption can just delete any duplicates on this front.",timabbott,b'area: emoji area: production bug help wanted priority: high',2020-06-13T00:11:56Z,2020-06-19T17:07:57Z
15346,Exception rerendering messages following local echo,"This is a common exception in production:

```
Selected message id not in MessageList

Stacktrace:
Error
    at Object.e.error (https://zulipchat.com/static/webpack-bundles/ea3954ab8bbc630b7437.js:1:7554)
       = ./static/js/blueslip.js line 245 column 17

    at n.MessageList.select_id (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:452498)
       = ./static/js/message_list.js line 179 column 22

    at d._rerender_message (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:430119)
       = ./static/js/message_list_view.js line 1092 column 23

    at d.rerender_messages (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:430403)
       = ./static/js/message_list_view.js line 1117 column 18

    at Object.n.process_from_server (https://zulipchat.com/static/webpack-bundles/app.effe5e9f19d9637ed737.js:2:500466)
       = ./static/js/echo.js line 329 column 28
```

The issue seems to be that in the `echo.process_from_server` code path for that runs after a locally echoed message is received via `server_events`, we try to rerender the message in `home_msg_list`.  Somehow, we're finding that we find the currently selected message needs to be rerendered while doing so (i.e. we'd selected the locally echoed message), but then we're failing to actually select it after doing so.  My guess is this just throws an exception every time.

To try to reproduce this, I'd try adding a 5s delay before calling `send_event` in the `do_send_messages` code path, and then select the locally echoed message, to see if that triggers an exception when the `server_events` code runs.

Many of the production exceptions logged this a couple seconds before, so it may be relevant to the bug:
""Changed message ID from server caused out-of-order list, reordering""

See https://zulip.readthedocs.io/en/latest/subsystems/sending-messages.html for surrounding documentation.

",timabbott,b'area: compose bug help wanted',2020-06-13T00:03:20Z,2020-07-06T22:36:57Z
15329,Support bulk message deletion.,"CI https://app.circleci.com/pipelines/github/amanagr/zulip?branch=bulk_message_deletion
STATUS: 
![image](https://user-images.githubusercontent.com/25124304/84489882-fbb69780-acbf-11ea-975f-948eb0ddd98f.png)
",amanagr,b'area: api bug difficult priority: high size: XL',2020-06-12T08:54:28Z,2020-06-15T17:59:25Z
15318,Fix navbar search state,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes #14771.

**Testing Plan:** <!-- How have you tested? -->
Adds node tests.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

![search_bar_works_with_nav](https://user-images.githubusercontent.com/33805964/84427171-164a2b80-ac42-11ea-92d1-270bbfe232d6.gif)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: general UI bug size: M',2020-06-11T18:51:30Z,2020-06-11T22:49:19Z
15311,button in mobile web view out of scope ,"no more words to tell

<img width=""376"" alt=""grafik"" src=""https://user-images.githubusercontent.com/3506105/84365853-570a5c00-abd2-11ea-9777-c011fcf2dd70.png"">
",devZer0,b'area: mobile web bug',2020-06-11T08:57:32Z,2020-07-02T20:47:27Z
15303,:checkered_flag: 🏁 emoji is missing from reactions popover,"The emoji 🏁 U+1F3C1 CHEQUERED FLAG, which we call `checkered_flag` as its canonical name, works fine in the autocomplete in the compose box:
![image](https://user-images.githubusercontent.com/28173/84319006-29ff7000-ab24-11ea-91e1-5efd7bda60c5.png)

But it doesn't appear in the popover search when you try to add an emoji reaction:
![image](https://user-images.githubusercontent.com/28173/84318962-15bb7300-ab24-11ea-8043-3a771b796f0d.png)

Originally reported [in chat](https://chat.zulip.org/#narrow/stream/9-issues/topic/hidden.20emoji/near/900743).
",gnprice,b'area: emoji bug priority: high',2020-06-10T21:12:14Z,2020-06-14T17:41:18Z
15285,Add support for bulk delete_message events,"Now that we're doing things that from a user perspective are bulk-deletions of messages, we need to update the interface for how Zulip's real-time events API notifies clients of message deletions to support bulk updates.  We'll use this in a few places:
* The existing `do_delete_messages`, even in cases where all messages are in the same stream/topic, ends up doing individual events for each message in a giant loop.
* This is a blocker for https://github.com/zulip/zulip/pull/15277.

What's super tricky about this is that the `delete_message` event format wasn't designed with bulk messages in mind.  So we need to detect which clients support the newer format, using our handy `client_capabilities` feature.  Here's the plan:
* Add a new supported `bulk_message_deletion` client capability to `events_register_backend` and the API documentation, in a first commit.
* pass that property through `do_events_register`.  We may want to do a preparatory refactoring commit to pass the whole `client_capabilities` structure through to `do_events_register` as future-proofing, (replacing the `notification_settings_null` parameter).  We'll ultimate need that to end up in `request_event_queue` and finally being stored on the `ClientDescriptor` object generated created in our events system.
* Then, we migrate the format for `delete_message` events to use a `message_ids` list rather than a `message_id` singleton integer.  For backwards-compatibility, clients without the feature would have a list of events generated for them.

```
    elif event['type'] == ""delete_message"" and len(users) > 0 and isinstance(users[0], dict):        
        # do_delete_messages used to send events with users in dict format {""id"": <int>}             
        # This block is here for compatibility with events in that format still in the queue         
        # at the time of upgrade.                                                                    
        # TODO: Remove this block in release >= 2.3.                                                 
        user_ids = [user['id'] for user in cast(Iterable[Mapping[str, int]], users)]                 
-        process_event(event, user_ids)                                                               
+        process_deletion_event(event, user_ids)                                                               


def process_deletion_event(event: Mapping[str, Any], users: Iterable[int]) -> None:                           
    for user_profile_id in users:                                                                    
        for client in get_client_descriptors_for_user(user_profile_id):                              
            if not client.accepts_event(event):
                continue
            if client.has_capability(""bulk_message_deletion""):
                client.add_event(event)                                                              
                continue
            for message_id in event['message_ids']:
                compatibility_event = event.copy()
                compatibility_event['message_id'] = message_id
                del compatibility_event['message_ids']
                client.add_event(event)
```

We'll want to push hard on releasing updated apps that support the new `client_capability`, to minimize how often the backwards-compatibility code ever runs.

(And we might want to default all non-ZulipMobile app clients to assume the new capability to avoid accidental use of the old format in the future).",timabbott,b'area: api bug difficult in progress priority: high',2020-06-09T22:44:11Z,2020-06-15T17:55:43Z
15264,"upgrade-zulip, build-release-tarball: Add umask override","We already override the umask in `upgrade-zulip-stage-2`, but that’s too late since we’ve already written a bunch of files in stage 1. I would have removed the stage 2 override, but the OS upgrade documentation references running stage 2 directly.

Fixes #15164. Note that an affected installation will need to upgrade twice, because the first upgrade uses the old stage 1.",andersk,b'area: production bug size: S',2020-06-08T19:54:27Z,2020-07-02T21:20:05Z
15249,edit_history: Fix a few UI issues in the modal.,"This fixes a few UI issues with the edit history modal, along with some refactoring and cleanup:

- Fix topic-only edits never showing a date row.
- Don't repeat date rows.
- Respect time format setting (12h/24h). (Fixes #15171)
- Highlight topic edit diffs by using correct CSS selector.

**Testing Plan:**

I applied each commit to the dev server and checked that the edit history modal was working as expected.

**Screenshots:**

Both screenshots were taken with the time format set to 24-hour.

In the first, note: the 12-hour time; lack of date rows on the topic-only edits; ""repeated"" date row on the bottom visible edit (it would be repeated if topic-only edits showed date rows); and lack of diff highlighting for the topic edits.
![edit_history_modal_02c670f5a344086767481862b7093bdff33e6c11](https://user-images.githubusercontent.com/977850/83972853-69655c80-a897-11ea-8d8b-e5c14a600977.png)

In the second, note: the 24-hour time; the date row on the topic-only, first edit of June 3; no repeating date rows; and the diff highlighting for the topic edits.
![edit_history_modal_bf85b82822358d6f8acab02cea40a2d39113ce06](https://user-images.githubusercontent.com/977850/83972855-6e2a1080-a897-11ea-9616-ac306ebd1449.png)

**Future Plans:**

The UI does not currently take stream edits into account; I'm planning to fix that. I also have some ideas for UI/UX improvements.",cyphase,b'area: message-editing bug size: XL',2020-06-07T15:53:54Z,2020-06-07T20:57:33Z
15248,Fix moving topic for guest users,"@timabbott see https://github.com/zulip/zulip/pull/15234 before this.

I will complete the TODO of bulk deleting messages if this approach looks fine to you, which is same as https://github.com/zulip/zulip/issues/14498#issuecomment-610648610",amanagr,b'area: message-editing bug difficult priority: blocker size: L',2020-06-07T12:07:44Z,2020-06-08T14:59:53Z
15222,Improve top-right gear icon interaction and visual design,"* [ ] The click/hover area for the gear icon that opens the top-right menu is super weird (with no space to the left of the icon at all clickable, but a bit present to the right); ideally, it'd be in a rectangular area around the widget, like we have for the ""search"" icon a bit to its left.  My guess is that fixing this will involve deleting some legacy code that's causing the behavior.
* [ ] In the mobile web UI, there's a few problems.  The gear icon gets probably a bit too much horizontal space, and more importantly, there's a weird unnecessary right margin to the ""Users"" dropdown icon as well:

![image](https://user-images.githubusercontent.com/2746074/83908625-4b272180-a71c-11ea-8397-76979e73462d.png)


",timabbott,b'area: search bug design in progress priority: blocker',2020-06-05T18:05:47Z,2020-06-30T23:52:13Z
15214,realm logo: Fix realm logo unsupported file upload bug.,"Unable to upload a realm logo once we encounter file input error bug
was fixed by clearing `get_file_input()` after file input error
with `get_file_input().val('')`.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
fixes #15198

**Testing Plan:** <!-- How have you tested? -->
Tested in browser

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Jagansivam28,b'area: settings (admin/org) area: settings UI bug size: XS',2020-06-04T21:06:31Z,2020-06-04T22:08:35Z
15202,bugdown: Avoid deprecated ElementTree.getchildren method,"Fixes warnings like these with python -Wd:

```
/home/circleci/zulip/zerver/lib/bugdown/__init__.py:327: DeprecationWarning: This method will be removed in future versions.  Use 'list(elem)' or iteration over elem instead.
  for child in currElementPair.value.getchildren():
/home/circleci/zulip/zerver/lib/bugdown/__init__.py:328: DeprecationWarning: This method will be removed in future versions.  Use 'list(elem)' or iteration over elem instead.
  if child.getchildren():
/home/circleci/zulip/zerver/lib/bugdown/__init__.py:282: DeprecationWarning: This method will be removed in future versions.  Use 'list(elem)' or iteration over elem instead.
  for child in currElement.getchildren():
/home/circleci/zulip/zerver/lib/bugdown/__init__.py:283: DeprecationWarning: This method will be removed in future versions.  Use 'list(elem)' or iteration over elem instead.
  if child.getchildren():
```

https://docs.python.org/3.8/library/xml.etree.elementtree.html#xml.etree.ElementTree.Element.getchildren",andersk,b'size: S',2020-06-04T00:39:06Z,2020-06-07T03:59:07Z
15198,Unable to upload a realm logo once I upload an unsupported file,"steps to reproduce :
-  Upload the unsupported file as realm logo(eg pdf)
- Try to upload a supported file (jpg or png)
![screencast_00017](https://user-images.githubusercontent.com/45326319/83687672-bc29e480-a609-11ea-822e-6422a34921b6.gif)",Jagansivam28,b'area: settings (admin/org) area: settings UI bug in progress',2020-06-03T20:50:26Z,2020-06-04T21:21:50Z
15197,Stream color update for time reader,"If we change the stream color, the stream color does not register the changes in front of time reader
![Screenshot from 2020-06-04 01-41-34](https://user-images.githubusercontent.com/32801674/83687414-59384d80-a609-11ea-98f9-cd1b91c74f48.png)
Ideally it should automatically update the color for that part also but currently it requires a reload to register that change properly.",SiddharthVarshney,b'area: message view bug design help wanted in progress',2020-06-03T20:47:36Z,2020-07-07T01:41:18Z
15171,No 24h setting working in edit history,The edit history timestamp is not respecting the 24h setting. Still showing 12h.,mkagit,b'area: message-editing bug good first issue help wanted in progress',2020-06-02T00:20:19Z,2020-06-07T21:00:31Z
15166,Circleci setup document,"Fixes [#15095](https://github.com/zulip/zulip/issues/15095)
@timabbott ",arpit551,b'area: documentation (api and integrations) bug priority: high size: XS',2020-06-01T18:16:30Z,2020-06-01T21:12:12Z
15165,"org setings: Users: ""Last active"" sort doesn't work","In Chrome 83 on Mac OS X, under Settings> Organization > Users, trying to sort the list by ""Last active"" seems to actually sort by Name, rather than by last active:

<img width=""755"" alt=""Screenshot 2020-06-01 10 56 34"" src=""https://user-images.githubusercontent.com/109246/83438623-95e02b00-a3f6-11ea-8df5-ca9e4d7d0978.png"">

<img width=""649"" alt=""Screenshot 2020-06-01 10 57 17"" src=""https://user-images.githubusercontent.com/109246/83438673-ab555500-a3f6-11ea-9863-8bc7766aa218.png"">
",wdaher,b'area: settings UI bug in progress',2020-06-01T17:57:41Z,2020-06-02T19:10:12Z
15164,zproject/wsgi.py has incorrect permissions,"In the 2.1.4 release, zproject/wsgi.py did not have proper permissions for the SSO remote auth provider to access the script when running under apache. after changing the permissions to be 0755 the auth began to work again.",timapril,b'area: production bug',2020-06-01T13:59:19Z,2020-06-09T04:57:06Z
15156,outgoing_webhook: Send a PM to bot owner for invalid JSON responses.,"When the server responds with invalid JSON, instead of publishing an error message to the same stream we will notify the bot owner.

Closes #15145.

@timabbott pinging for review.",Hypro999,b'area: api bug size: S',2020-05-31T10:09:20Z,2020-06-11T10:43:45Z
15146,Data export failures in production,"I've seen this exception before with organizations imported from Slack (where there might have been empty streams in the Slack data export), and it appears deactivated streams in zulip might also be able to cause it?  Not sure, could just be a data import symptom here as well:

```
2020-05-29 23:15:22.457 INFO [] Exporting via export_from_config:  zerver_stream
Error: Some streams present in the realm were not exported:
     {'!DEACTIVATED:Name1', '!DEACTIVATED:Name2'}
Usually, this is caused by a stream having been created that never had subscribers.
(Due to a bug elsewhere in Zulip, not in the export tool)
```

In any case, our data import/export tooling throws this exception for empty streams, and probably we should just remove that check after confirming that we feel it's safe to do so.

(We might need to take a little care here to make sure we do export these deactivated streams).

@showell do you remember the context around these checks?

Tagging as a priority because this accounts for 100% of failures using our data export tools in production right now :)",timabbott,b'area: export/import bug help wanted priority: high',2020-05-29T23:22:31Z,2020-07-09T18:34:10Z
15145,Improve error handling for outgoing webhook responses with empty content,"If the response from an outgoing webhook (which can be used to trigger a message in Zulip) returns empty or no content, we currently raise an exception as follows: 

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2020-05-27-05-59-05/zerver/worker/queue_processors.py"", line 171, in do_consume
    consume_func(events)
  File ""/home/zulip/deployments/2020-05-27-05-59-05/zerver/worker/queue_processors.py"", line 200, in <lambda>
    consume_func = lambda events: self.consume(events[0])
  File ""/home/zulip/deployments/2020-05-27-05-59-05/zerver/worker/queue_processors.py"", line 589, in consume
    service_handler)
  File ""/home/zulip/deployments/2020-05-27-05-59-05/zerver/lib/outgoing_webhook.py"", line 289, in do_rest_call
    process_success_response(event, service_handler, response)
  File ""/home/zulip/deployments/2020-05-27-05-59-05/zerver/lib/outgoing_webhook.py"", line 277, in process_success_response
    send_response_message(bot_id=bot_id, message_info=message_info, response_data=response_data)
  File ""/home/zulip/deployments/2020-05-27-05-59-05/zerver/lib/outgoing_webhook.py"", line 166, in send_response_message
    raise JsonableError(_(""Missing content""))
zerver.lib.exceptions.JsonableError: Missing content
```

We should change the error handling to either silently succeed, or perhaps better, send a PM to the bot owner letting them know the bot is buggy (I think we have a general mechanism for this).

@Hypro999 this could be a good intro issue for you, if you're interested in getting involved in outgoing webhooks too :)",timabbott,b'area: api bug help wanted',2020-05-29T23:19:51Z,2020-06-10T21:47:13Z
15132,bugdown: Revert NamedTuple declarations to old style,"This reverts part of commit 8bcdf4ca970dd5cdf532992a489a21565303fd10 (#15093), to work around a mypy caching bug: https://github.com/python/mypy/issues/7281.
",andersk,b'size: S',2020-05-28T23:15:43Z,2020-06-07T03:59:09Z
15125,auth: Make sure that we enforce max_length during password reset.,"Discussion at:
- https://github.com/zulip/zulip/issues/15087
- https://chat.zulip.org/#narrow/stream/9-issues/topic/password.20length.20limitation

@timabbott requesting review.",Hypro999,b'area: authentication bug size: S',2020-05-28T09:28:44Z,2020-06-04T07:50:20Z
15117,portico: Use green btn for `call-to-action-button`.,"This button will now look similar in design as we have on
our /app page.

Fixes: #15077

![Screenshot from 2020-05-28 02-43-16](https://user-images.githubusercontent.com/32801674/83072797-06044f00-a08d-11ea-858b-d58b8b9ac3d6.png)
",SiddharthVarshney,b'area: portico bug size: S',2020-05-27T21:13:58Z,2020-05-27T23:30:09Z
15103,Traceback in handling desktop notifications,"We've been seeing this exception in production when trying to trigger a desktop notification:

```
Message:
Failed to insert new messages
t.addEventListener is not a function

Stacktrace:
TypeError: t.addEventListener is not a function
    at C (https://zulipchat.com/static/webpack-bundles/app.f4f8daaf2223439c6315.js:2:887121)
       = ./static/js/notifications.js line 413 column 29

    at Object.n.received_messages (https://zulipchat.com/static/webpack-bundles/app.f4f8daaf2223439c6315.js:2:891409)
       = ./static/js/notifications.js line 580 column 13

    at Object.n.insert_new_messages (https://zulipchat.com/static/webpack-bundles/app.f4f8daaf2223439c6315.js:2:938035)
       = ./static/js/message_events.js line 99 column 19

    at d (https://zulipchat.com/static/webpack-bundles/app.f4f8daaf2223439c6315.js:2:948728)
       = ./static/js/server_events.js line 118 column 32

    at success (https://zulipchat.com/static/webpack-bundles/app.f4f8daaf2223439c6315.js:2:949993)
       = ./static/js/server_events.js line 212 column 17

    at Object.e.success (https://zulipchat.com/static/webpack-bundles/app.f4f8daaf2223439c6315.js:2:40658)
       = ./static/js/channel.js line 86 column 16

    at s (https://zulipchat.com/static/webpack-bundles/c32daec18de0849c818e.js:2:109544)
       = /srv/zulip-npm-cache/8f198ae170cce57c2f98184b45f5ebb22546b031/node_modules/jquery/dist/jquery.js line 3496 column 31

    at Object.fireWith [as resolveWith] (https://zulipchat.com/static/webpack-bundles/c32daec18de0849c818e.js:2:110292)
       = /srv/zulip-npm-cache/8f198ae170cce57c2f98184b45f5ebb22546b031/node_modules/jquery/dist/jquery.js line 3626 column 7

    at N (https://zulipchat.com/static/webpack-bundles/c32daec18de0849c818e.js:2:161194)
       = /srv/zulip-npm-cache/8f198ae170cce57c2f98184b45f5ebb22546b031/node_modules/jquery/dist/jquery.js line 9786 column 14

    at XMLHttpRequest.<anonymous> (https://zulipchat.com/static/webpack-bundles/c32daec18de0849c818e.js:2:163662)
       = /srv/zulip-npm-cache/8f198ae170cce57c2f98184b45f5ebb22546b031/node_modules/jquery/dist/jquery.js line 10047 column 9
```

The User-Agent is the type of non-specific value that looks like the result of an Electron app trying to pretend to be a generic browser, though it's not super clear.  I'd start by seeing if we can reproduce this with Ferdi and Rambox as the browser, since those are the most likely culprits.

I'm not sure what we can do here; it feels like we should have validated `NotificationAPI` more, or maybe there's some kind of race where we need to wait for the notification element to be rendered first?",timabbott,b'area: notifications (messages) bug help wanted',2020-05-27T00:14:28Z,2020-06-18T19:49:01Z
15098,message view: Show indicator while fetching new messages.,"#15060 

Should the svg be extracted ?
I copy pasted it because I noticed elsewhere that the same svg block is used twice only in the same file  ( [billing.html](https://github.com/zulip/zulip/blob/master/templates/corporate/billing.html#L68-L73) ), exactly the same as this case.",ryanreh99,b'area: message view bug priority: high size: L',2020-05-26T17:33:23Z,2020-05-27T06:29:04Z
15095,Need to modify the document about setup CircleCI,"https://zulip.readthedocs.io/en/latest/git/cloning.html#step-3-configure-continuous-integration-for-your-fork

The Setup CircleCl part of this article is outdated. CircleCI has a new UI. 

We need to tell new developer to choose 'Add Manually'. Otherwise, it will be failed to build the branch.

![image](https://user-images.githubusercontent.com/55386662/82911898-01616d00-9f9f-11ea-9f1d-802d854ebabb.png)
",lancaogougou,b'area: documentation (api and integrations) bug priority: high',2020-05-26T14:20:51Z,2020-06-01T21:12:12Z
15087,Limitation on password length?,"I tried to use a 128 characters password on my Zulip profile. The password was accepted when I set it up, but then I was constantly getting rejected logins. I reset it three times via the 'forgot password' functionality.

When shortening it to 49 characters, it was accepted (like the 128 chards one) but then also functional (I could log in).

This would suggest a limit on the password length, which is a red light form a security perspective (there should be no limit because there is not reason for having one when the password is stored correctly). Is that the case?",wsw70,b'area: authentication bug in progress',2020-05-25T16:13:20Z,2020-05-28T22:06:27Z
15079,Avoid accidental message controls click on mobile web,"On touchscreens, if the message control buttons are not visible, a single click on a message box shouldn't trigger their click listeners. This commit checks whether the buttons are visible to users once a messagebox `touchstart` event is fired. If the buttons are not visible and a user clicks that area, the click events are just ignored.

Fixes #13642.
",hashirsarwar,b'area: message view area: mobile web bug size: S',2020-05-25T09:49:46Z,2020-07-04T18:44:32Z
15077,`Sign up now` buttom on landing page,"The `Sigh up now` button on the bottom section of the landing page seems very muted
Its feels like its disabled until you hover over it
![Screenshot from 2020-05-25 03-11-23](https://user-images.githubusercontent.com/32801674/82765599-d7406b80-9e35-11ea-8041-5f59f704ba4c.png)


(we can use green button template for the same if that looks good)",SiddharthVarshney,b'area: portico bug in progress',2020-05-24T21:44:42Z,2020-05-27T23:33:06Z
15075,settings-ui: Fix tab-switcher misalignment for iPad size devices.,"Fixes: #14913.

Testing: manually

I avoided the change the name of `Subscription | All streams` to `Mine | All` as mentioned in the issue

![Peek 2020-05-25 01-20](https://user-images.githubusercontent.com/32801674/82763763-8de91f80-9e27-11ea-8b7f-69b6c93e5367.gif)
",SiddharthVarshney,b'area: stream settings bug design priority: high size: S',2020-05-24T20:02:56Z,2020-05-26T22:39:16Z
15065,"message list: Render new messages only after ""newest"" is found.","Fixes #14017

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Tested manually as follows:-

1. set 5 secs delay for [get messages](https://github.com/zulip/zulip/blob/master/zerver/views/messages.py#L804).
2. Also set 10 seconds delay if `query_info['found_newest']` = True in [same view function](https://github.com/zulip/zulip/blob/master/zerver/views/messages.py#L969)
3.  set timeout duration to 500000 in [sent messages](https://github.com/zulip/zulip/blob/master/static/js/sent_messages.js#L113). (not sure if necessary, was getting blueslip warnings about event loop restarting)
4. `./manage.py populate_db -n10000`
5. `./manage.py mark_all_messages_unread`
6. Go to private message narrow
7. send a message to that narrow when all the messages haven't been fetched.
Previously the new message would get temporarily displayed.
Now the new message isn't rendered but is processed. (such as unread count increases)
8. send another message when last batch is being fetched.
This message gets stored in `_newest_items` and after the fetch is complete and the new if condition in `message_list.js` is satisfied, the new message(`_newest_items`) is rendered after the fetched messages(`bottom_messages`).

I also tested the last point by discarding the new message event if ""newest"" has not been found by the current message list.
Then if a new message is sent while fetching the last batch for that narrow then the message is missing. (as mentioned in the issue)
",ryanreh99,b'area: message view bug difficult priority: high size: XL',2020-05-22T16:11:30Z,2020-06-16T18:25:01Z
15060,Showing a loading indicator when fetching messages from the bottom of the feed,"If one had a lot of message history and does a `streams:public near:1` search and then scrolls to the bottom of the set of very old messages that were fetched, we don't show a loading indicator.

Looking at `exports.maybe_load_older_messages`, and comparing with `exports.maybe_load_newer_messages` in `message_fetch.js`, the problem is that this is just not implemented.  I think structurally we want this to be implemented as a hidden element inside the top of `bottom_whitespace` that can be shown/hidden as needed.

Easy to see on chat.zulip.org; in development, one likely wants `manage.py populate_db -n10000` or similar to be able to reproduce this.",timabbott,b'area: message view bug in progress priority: high',2020-05-21T21:48:34Z,2020-05-26T22:24:48Z
15055,message_edit: Always empty edit form before appending to it.,"Prior to commit 8b7e70ac2711372a0315b01179697ec644b33347 this system
would simply just .hide() forms when they were closed and
.empty().append() them when a new edit form was made. This was not a
very clean way of handling the action of canceling an edit, so
8b7e70ac2711372a0315b01179697ec644b33347 introduced a change that had
the ""show_edit"" function append the form and the hide function delete
the form. However, we overlooked the fact that the user could use
history to navigate away and back to the form and use ""e"" or ""left
arrow key"" to successfully append another form to element and get to
an ugly broken state.

This commit does not revert 8b7e70ac2711372a0315b01179697ec644b33347
as it is still accurate to .empty() when hiding the form, but we also
.empty().append() when showing the form, to avoid bugs like the above.
Fixes: #15045.


<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![always remove form before appending](https://user-images.githubusercontent.com/33805964/82553555-e5fef800-9b81-11ea-85e8-001f98cc1aaa.gif)

AS THE GIF SHOWS AT THE END: the current commit might not be an ideal fix, because if you're editing the form and click outside the form and use ""e"" or ""left arrow"" you're likely to delete whatever text you'd placed in the form... Should we change that?
Would it be an improvement if (instead of what this commit currently is) we modify the ""show edit message"" to check and early exit if there's already an edit form present?

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->",YashRE42,b'area: message-editing bug priority: high size: XS',2020-05-21T11:17:28Z,2020-06-06T03:12:54Z
15045,Duplicate message edit forms created using forward/back,"One can get into this broken state:

![image](https://user-images.githubusercontent.com/2746074/82474897-8ec52e80-9a80-11ea-894b-4a66c440e870.png)

The reproducer is simple:
* Hit `<-` to open message editing
* Hit back + forward to navigate to another view and back
* Hit `<-` again -- it'll open this second message-edit box.

@amanagr @YashRE42 @aero31aero as folks who've recently touched this state machine.",timabbott,b'area: message-editing bug help wanted in progress priority: high',2020-05-20T17:00:30Z,2020-06-06T03:15:50Z
15009,navbar: Use direct child selector to target spans.,"The navbar uses rendered markdown and rendered html within the narrow
description, this inserts eg katex--html and allows rendering of
inline math formulae. Unfortunately, in the previous SCSS file, this
fact was overlooked and a generic ""span"" selector was used with would
target all spans within the parent element, direct descendants or
otherwise, which caused the side effect of applying padding and margin
to inner katex elements which broke appearance.

This commit replaces the ""span"" selector with ""& > span"" so that only
spans which are the direct children to the parent element are selected
and katex--html is rendered correctly.

Fixes: #14947.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
AFTER:
![image](https://user-images.githubusercontent.com/33805964/82173006-8981ab80-98e9-11ea-823e-6a9a47fde185.png)
![image](https://user-images.githubusercontent.com/33805964/82173324-6acfe480-98ea-11ea-9be0-d1d4c1bcf751.png)


TODO: we'll probably want to write some javascript to handle cases like the following image... css solution seems difficult, since it's font-size related.
![image](https://user-images.githubusercontent.com/33805964/82173371-a10d6400-98ea-11ea-9c11-10d7aa33b07e.png)

bellow is one terrible way of doing it: (possibly we can get rid of the loop via em units...)
```javascript
    let katex = $("".narrow_description > .katex"");
    let katex_height = katex.css(""height"").slice(0,-2);
    while (katex_height > 20) {
        let font_size = katex.css(""font-size"").slice(0,-2);
        katex.css(""font-size"", font_size - 0.05 + ""px"");
        katex_height = katex.css(""height"").slice(0,-2);
    }
```
<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: search bug design priority: high size: XS',2020-05-18T04:31:57Z,2020-05-18T04:45:49Z
14982,Add `process_fts_updates --audit` option to fix search index corruption due to dictionary upgrades,"As was reported here: https://chat.zulip.org/#narrow/stream/9-issues/topic/Holes.20in.20search.20index.3F/near/877545, Zulip's full-text indexes can be partially corrupted when the database server's OS is upgraded. 

We should fix this by adding a `process_fts_updates --audit` option that checks for and fixes this condition (it seems appropriate to put in that existing tool rather than somewhere else since it already has the settings setup, but a separate tool would also be a fine option).

The query we want to do is this:
`UPDATE zerver_message SET search_tsvector = to_tsvector('zulip.english_us_search', subject || rendered_content) where to_tsvector(subject || rendered_content) != search_tsvector`

Running this on chat.zulip.org finished in a couple minutes without any user-facing disruption, so I think we can probably recommend that command to everyone who isn't zulipchat.com.

* [ ] Write the audit option for `process-fts-updates`.  We probably should have it audit pgroonga records as well if that's enabled.
* [ ] Document it in the `do-release-upgrade` documentation as thing one needs to run.
* [ ] Backport that commit to the 2.1.x branch so we can ship it in a point release.
* [ ] Add the release notes for  2.1.x a recommendation to run the audit tool for anyone who's previously done a do-release-upgrade.

Tagging as difficult because this is something we'll want to test on a production server (though I think it can be mostly developed and tested in a development environment; you just need to manually corrupt your search indexes by, say, running the above command without the `subject ||` part).",timabbott,b'area: production bug difficult help wanted priority: high',2020-05-14T18:51:31Z,2020-07-13T19:44:17Z
14977,"The link for ""Web App"" on the hello.html page leads to desktop app pages","Speaking of this:
![image](https://user-images.githubusercontent.com/45007152/81944451-12a09600-95fd-11ea-974c-c3a29269d3fc.png)

Clicking on ""Web"" will take you to `/apps/` which will simply redirect you to the desktop app page for your platform. That doesn't feel right. I'm not sure what it should point to though, considering we don't know the user's organization we can't just redirect to it.",mateuszmandera,b'area: portico bug help wanted in progress',2020-05-14T14:10:14Z,2020-05-27T04:54:25Z
14972,bugfix: Fix codecov broken backend coverage upload.,"Looks like @mateuszmandera 's #13946 introduces this issue. The commits before this have backend coverage. Also, there appears to be some problem with suffix of the file, which should be blank.

Also, removes the find error we see:
```
find: unknown predicate `-not -path './bower_components/**' -not -path './node_modules/**' -not -path './vendor/**''
 
    Error running `['find', '/home/circleci/zulip', ""-not -path './bower_components/**' -not -path './node_modules/**' -not -path './vendor/**'"", '-type', 'f', '-name', '*.gcno', '', '-exec', 'gcov', '-pb', '', '{}', '+']`: Command '['find', '/home/circleci/zulip', ""-not -path './bower_components/**' -not -path './node_modules/**' -not -path './vendor/**'"", '-type', 'f', '-name', '*.gcno', '', '-exec', 'gcov', '-pb', '', '{}', '+']' returned non-zero exit status 1.
 
```",amanagr,b'area: tooling bug priority: high size: M',2020-05-14T07:15:39Z,2020-05-28T05:19:13Z
14970,compose.js: Fix compose box didn't collapse.,"Fix a bug where the compose box didn't collapse when sending a message
from the preview area by hitting the send button. The bug ocurred because
the preview area wasn't being properly cleared when this flow was executed.
This was fixed by moving the clear_preview_area function call for a place
that will be reached by both the enter and button flow.

Fixes: #14889

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![giphy](https://user-images.githubusercontent.com/16260725/81871286-dfeb9480-954d-11ea-859b-8dd8b5d3177d.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",joaomcarvalho,b'area: compose bug size: XS',2020-05-13T21:49:01Z,2020-05-13T22:33:29Z
14962,Figure out why codecov.io stopped showing backend results,"It appears codecov.io stopped receiving `test-backend` coverage data, and now just shows frontend data.  Based on this page of codecov.io data:

https://codecov.io/gh/zulip/zulip/branch/master/commits?from=2020-02-14%2000%3A00%3A00&to=2020-02-16%2000%3A00%3A00

The first commit with the issue seems to be efb306515844619bdd3ca6cc152d12797a60b4fe; which doesn't make any sense, so I double we'll do well by bisecting.  My guess is that the frontend coverage data generated later in the job is somehow overwriting the backend data?  Not sure.

Tagging as a priority since it makes the coverage badges on our homepage look broken.

@arpit551 @amanagr @mateuszmandera  FYI.",timabbott,b'area: tooling bug priority: high',2020-05-12T23:48:04Z,2020-05-28T00:54:57Z
14960,Fix data-import parallelism defaults,"When running `manage.py import` and `manage.py convert_slack_data` (etc.), we currently default to a parallelism of 6 for tasks like

We should recognize things so that default is controlled by either a setting or half the number of CPUs on the system (if we can detect that efficiently), as a proxy for size.  Though that latter value might be bad in some memory-constrained containers on systems with a lot of CPUs, so might be a bad idea.

I think an acceptable solution would be:
* To create a `settings.DEFAULT_DATA_IMPORT_PARALLELISM`, set to 2 in `default_settings.py`, so that we use the parallel code path in development and production by default.
* Use that, rather than 6, as the default for `threads` and `processes` in all data import/export code paths.

This issue is an actionable fix replacement for https://github.com/zulip/zulip/issues/14830, which I'm closing now.

(Note, we also added https://github.com/zulip/zulip/commit/779daa5374e96cc2e48ab313adf118077e14a333 to help with this overall problem as a quick fix).",timabbott,b'area: export/import bug priority: high',2020-05-12T20:33:15Z,2020-06-21T16:39:32Z
14947,LaTeX in stream descriptions renders as invisible,"Apparently, if you put LaTeX in a stream description, like `$$x=1$$`, it appears in ""Manage streams"" but not in the top-center navbar.

Note #14791 is present, so you may need to reload after editing for your changes to take effect.",timabbott,b'area: search bug design help wanted priority: high',2020-05-11T23:49:29Z,2020-05-18T04:45:29Z
14913,tab-switcher misalignment in stream management modal.,"We seem to misalign our sorting tabs between the widths of [826, 976]px.

<img width=""331"" alt=""Screen Shot 2020-05-08 at 8 41 01 AM"" src=""https://user-images.githubusercontent.com/39782863/81452207-fcd53180-9121-11ea-802c-0e7201215892.png"">

From Tim,
> Might just need to reduce padding on some things, or perhaps change button labels ""Mine | All"" to be smaller.

As shown below changing the button labels fixes this, but it might be worth keeping the original text and fixing the spacing.

<img width=""331"" alt=""Screen Shot 2020-05-08 at 11 50 42 AM"" src=""https://user-images.githubusercontent.com/39782863/81452349-50477f80-9122-11ea-83eb-6f82a02b439c.png"">

",whoodes,b'area: stream settings bug design in progress priority: high',2020-05-08T21:53:18Z,2020-05-26T22:28:16Z
14889,"Compose box doesn't collapse when sending from ""Preview"".","If you send a very tall message while `Preview`ing the message (clicking the ""eye"" icon below the box), the compose box won't collapse down as it typically should.

To reproduce simply 
1. Draft a long message that increases the compose box height
2. Click preview.
3. Send the message.

The compose box sticks there and feels a little broken.

From Tim,
> I'm guessing it's just a missing resize function call in that code path.",whoodes,b'area: compose bug help wanted in progress',2020-05-07T03:05:31Z,2020-05-13T22:36:10Z
14888,bug in moving topics between streams,"On the JuliaLange Zulip, I tried to move a topic between two streams, i.e. [this topic](https://julialang.zulipchat.com/#narrow/stream/225583-appreciation/topic/gripe-tangent.3A.20Slack's.20threading) to [this one](https://julialang.zulipchat.com/#narrow/stream/225540-gripes/topic/gripe-tangent.3A.20Slack's.20threading), but it seems to only move one message at a time instead of the whole stream.

Or maybe I'm misunderstanding what is meant by ""move topic"" here?",MasonProtter,None,2020-05-07T01:37:33Z,2020-05-08T18:11:33Z
14873,Can't create Usergroups,"I am using only ldap for authorisation. i would like to use groups, but as you can see in the screenshot, i have nothing to work with, and yes i am an administrator

![grafik](https://user-images.githubusercontent.com/12413618/81160078-f318c600-8f89-11ea-8648-63a51871bb3d.png)
",ChrisPea,b'area: settings (admin/org) area: settings UI bug help wanted priority: high',2020-05-06T09:10:15Z,2020-06-16T03:29:53Z
14829,bugdown: Support hanging_lists preprocessor for indented lists.,"Previously, hanging_lists preprocessor didn't consider anything
indented at 4 or above spaces to be a list. This meant that when
we had a list like:

1. 1
  2. 2
    3. 3
  2. 2a
1. 1a

We would insert a newline between 3. 3 and 2. 2a. This resulted
in the block processor breaeking down 1 list into 2 blocks, which
messed up the nesting and indentation for the second block.

Discussion at:
https://chat.zulip.org/#narrow/stream/9-issues/topic/List.20rendering.20(ul.2Fol)
**Testing Plan:** <!-- How have you tested? -->
Manual + automated tests

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",aero31aero,None,2020-04-30T23:51:45Z,2020-05-01T00:54:41Z
14828,Fix error handling for expired tokens in desktop app login flow,"Following https://github.com/zulip/zulip/pull/14747, if you complete the desktop app login flow to login the desktop app, and on the landing page (see https://github.com/zulip/zulip/issues/14827) and click ""Continue in browser""), we'll try reusing the login token, which is forbidden.  This results in the following broken page:

![image](https://user-images.githubusercontent.com/2746074/80769532-5c1fba00-8b02-11ea-9cea-57e92464becd.png)

(This can happen both in the desktop app and the server).

We could clean up the page, but @mateuszmandera is there a reason we don't just want to redirect back to /login in this expired case case?  (@andersk FYI).

A few other questions to think a bit about:
* How long do we want to give users to use the token?  
* Does it make sense to allow the token to be used more than once?  (Or the token to be used once and the link to be used once?)  Then a user who wants to login to both the desktop app and browser could do that in one login transaction.

",timabbott,b'area: authentication bug priority: blocker',2020-04-30T23:51:31Z,2020-06-16T23:27:54Z
14826,[Bug] Visual bug mentor box size,"Expected box to fit text

Actually box is about half the size of a character until you type

Steps - Open web app, click on gear top right, under Your account,scroll down to mentor.

Development environment - Git commit id: 5a58b7c549e0eeb8959ddf1703d8af8819d81c12

Using - web app

![Mentor box size bug](https://user-images.githubusercontent.com/57152547/80768568-5cbf4d00-8b10-11ea-908d-436ab8b96520.JPG)
",smartst3r,b'area: settings UI bug',2020-04-30T23:28:41Z,2020-05-01T18:00:59Z
14772,Sentry webhook integration should use 'title' instead of 'message',"Raven, the deprecated sentry client, would add a `message` field to the webhook payload for events captured using `capture_message` and `capture_exception`, and that is used by the sentry integration to create the zulip message.  https://github.com/zulip/zulip/blob/master/zerver/webhooks/sentry/view.py

In the new sentry_sdk client (at least the python one), `message` is only added for `capture_message`.  Looking at the sentry docs, it looks like the `title` field should be used instead (or possibly either the `title` or `message` field depending on which is present).  https://docs.sentry.io/workflow/integrations/integration-platform/webhooks/?platform=python#payload",elhawk,b'area: integrations bug help wanted in progress priority: high',2020-04-27T19:18:47Z,2020-05-05T23:43:01Z
14771,Navbar Redesign: Browser Navigation Bug,"There is a bug in the new searchbar state's implementation.

1. Narrow to a stream, I'll use #**general**.
2. Open search bar. Text should read `stream: general`.
3. Replace the text and enter a search term for a global search.
4. Press browser back to get back to stream narrow.
5. Press browser next to get to search results. The searchbar reads `stream:general` instead of the search query.
",aero31aero,b'area: general UI bug',2020-04-27T19:14:33Z,2020-06-11T22:49:13Z
14758,process_fts_updates: Use correct dbname and owner to access schema.,"Fixes #14756
The schema containing fts_updates
is owned by `zulip_test` and is in `zulip_test` db,
We were not using the correct db and user to connect when testing
hence, we were not able to find the Table.
",amanagr,b'area: search bug priority: high size: XS',2020-04-26T06:43:14Z,2020-04-28T11:44:35Z
14756,process_fts_updates is crashing in CircleCI,"From our `bionic-backend-frontend-python3.6` job in CI, it appears one of our supervisord jobs isn't working:

```
Apr 25 15:28:49 Starting Zulip services on ports: web proxy: 9981, Django: 9982, Tornado: 9983, Thumbor: 9985
Apr 25 15:28:49 Note: only port 9981 is exposed to the host in a Vagrant environment.
Apr 25 15:28:49 2020-04-25 15:28:49,263 INFO: process_fts_updates starting
Apr 25 15:28:49 2020-04-25 15:28:49,384 INFO: Not in recovery; listening for FTS updates
Apr 25 15:28:49 Traceback (most recent call last):
Apr 25 15:28:49   File ""./puppet/zulip/files/postgresql/process_fts_updates"", line 135, in <module>
Apr 25 15:28:49     rows_updated = update_fts_columns(cursor)
Apr 25 15:28:49   File ""./puppet/zulip/files/postgresql/process_fts_updates"", line 38, in update_fts_columns
Apr 25 15:28:49     BATCH_SIZE,))
Apr 25 15:28:49 psycopg2.errors.UndefinedTable: relation ""fts_update_log"" does not exist
Apr 25 15:28:49 LINE 1: SELECT id, message_id FROM fts_update_log LIMIT 1000;
```

My guess is this is a permissions-type issue; `process_fts_updates` (the thing that updates our full-text search indexes) is probably not connecting to the right database or ""schema"" within the postgres database and thus not seeing the `fts_update_log` table that's there.

Might be a case where the ""local interactive debugging"" feature of CircleCI is really useful.

@amanagr @arpit551 FYI",timabbott,b'area: search bug in progress priority: high',2020-04-25T23:17:43Z,2020-04-28T11:53:58Z
14745,Remove DefaultStream objects associated with a stream on deactivation,"Apparently, we have a bug where if you deactivate a stream that's marked as a default stream, we don't call `do_remove_default_stream` on it, resulting in these being leaked, which can be confusing.

We should fix this for the upcoming DefaultStreamGroup feature at the same time we fix this.  

`do_deactivate_stream` is the code path that needs to handle this.

",timabbott,b'area: stream settings bug help wanted in progress priority: high',2020-04-24T23:45:30Z,2020-04-26T17:06:28Z
14742,Clean update-prod-static to have reasonable output,"This is an alternative solution to #14644, which I think is much nicer as an approach than what I'd originally suggested and @amanagr implemented in #14701, since it lets us remove complexity from a tool I've never been happy with and make it into a tool that could be actually reasonable.

",timabbott,b'area: production area: production installer bug priority: high size: L',2020-04-24T20:32:13Z,2020-04-25T22:39:22Z
14739,i18n: Add translation tag to email templates.,"Some of the email templates were missing translation tags. Added them.

Fixes: #14398

Tested by temporarily adding the german translations in the `django.po` files. Most of the strings to which the tags have been added here require additional translations.

**The list of strings requiring translation is:**
(left the HTML tags in some so it would be easier to just copy-paste the entire thing)
* Reactivate your Zulip organization
* New streams
* Click here to log in to Zulip and catch up.
* Manage email preferences
* Unsubscribe from digest emails
* Zulip digest for
* Group PMs with
* PMs with
* New missed messages
* This email does not include message content because your organization has disabled
* This email does not include message content because you have disabled
* You are receiving this because you were mentioned in
* You are receiving this because you have email notifications enabled for this stream.
* Do not reply to this email. This Zulip server is not configured to accept incoming emails 

* `More message{{ convo.count|pluralize }} by`

* `Reply to this email directly, <a href=""{{ narrow_url }}"">view it in Zulip</a>, or <a href=""{{ realm_uri }}/#settings/notifications"">manage email preferences</a>.`

* `<a href=""{{ narrow_url }}"">View or reply in Zulip</a>, or <a href=""{{ realm_uri }}/#settings/notifications"">manage email preferences</a>.<br>`

* `<a href=""{{ narrow_url }}"">Reply in Zulip{</a>, or <a href=""{{ realm_uri }}/#settings/notifications"">manage email preferences</a>.<br>`",vaibhavrajsingh2001,b'area: i18n bug priority: high size: L',2020-04-24T18:06:31Z,2020-04-30T23:14:28Z
14728,top navbar: Add proper live-update for redesigned top-navbar,"Our redesigned top-navbar doesn't has proper live-update.

There's a few functions in `tab_bar.js`, e.g. `update_stream_name`, that may be called in some of the right places and are meant to do live-update here, but we didn't hook them up when merging #11894 because the original implementations had security bugs (inserting `rendered_description` HTML without using the appropriate template rendering).  

The right fix here is to just fully rerender the `tab_bar` component when we know the data going into it (stream name, description, privacy status, etc.) changes; this means we just need to tweak the existing rendering logic to support being called to rerender, and we can use that in all the relevant `stream_events.js` code paths.

@YashRE42 is pretty busy right now so I think it makes sense for someone else to take the lead on this.  ",timabbott,b'area: search bug priority: blocker',2020-04-23T23:12:16Z,2020-06-10T21:25:20Z
14725,"styles: Size full-viewport fixed elements as 100%, not 100vw × 100vh","Mobile Chrome includes the height of the address bar in its calculation of 100vh, which was causing a corresponding part of our content to be pushed off the bottom of the screen.

Fixes #11324.

**Testing Plan:** Dev server in mobile Chrome.",andersk,b'area: mobile web area: stream settings bug size: S',2020-04-23T21:52:51Z,2020-05-04T01:50:29Z
14701,upgrade-zulip-from-git: Provide useful error messages when `update-prod-static` fails ,This just prints the path to the prod static log file. ,amanagr,b'area: production area: production installer bug priority: high size: L',2020-04-22T14:03:27Z,2020-04-26T03:59:56Z
14691,Check for untracked files after running test-backend in CI.,"Following 703fae8980bedc7c38f6077c54a10c34fbe2d6bb, I think we should have a check in CI that after running all of our checks, there are no untracked files.

One can list untracked files using `git ls-files --exclude-standard --others`; we'll want to e.g. write that to a file, check if it's empty, and if not print it out and exit with failure (It doesn't seem to have an option to directly set a nonzero exit code).  ",timabbott,b'area: testing-infrastructure bug priority: high',2020-04-21T23:57:01Z,2020-04-24T19:36:47Z
14685,nginx: Tweak nginx settings to customize 5xx page.,"Tweaked the `nginx.conf` to map error status with their error message and
enabled ssi (server side include) to pass variables to the resulting page.
Included the imports into the `5xx.html` to print error code and it's
message. Tweaked the webpack config to preserve comment in the error page
to preserve the ssi.

Fixes #14611.

**Testing Plan:** <!-- How have you tested? -->
Manually add a location in `puppet/zulip/files/nginx/zulip-include-frontend/app`
to return either 502/503/504 error.
Eg:- 
```
location /test-path.html {
    return 502;
}
```

Or visit my test instance [here](https://majordwarf.zulipdev.org/502/).

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![image](https://user-images.githubusercontent.com/23737560/79893396-a37eba00-8421-11ea-870c-2e11f97d6d91.png)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",majordwarf,b'area: production bug priority: high size: S',2020-04-21T17:17:30Z,2020-05-07T23:47:01Z
14678,logging_util: Handle record.status_code missing in skip_200_and_304.,"Fixes #14595.
Invalid HTTP requests could end up in an unhandled exception in
skip_200_and_304 due the record not having the status_code attribute
set. With this change we'll avoid the exception

Example:
`curl  -X POST -H 'Transfer-Encoding : chunked' --data-binary 'a' 'http://zulipdev.com:9991/json/messages/57'`

```
2020-04-21 10:56:22.007 WARN [django.server] ""POST /json/messages/57 HTTP/1.1"" 405 95
2020-04-21 10:56:22.007 INFO [django.server] code 400, message Bad request syntax ('a')
2020-04-21 10:56:22.008 WARN [django.server] ""a"" 400 -
```
",mateuszmandera,b'area: production bug priority: high size: XS',2020-04-21T11:04:25Z,2020-04-22T18:26:35Z
14644,upgrade-zulip-from-git: Provide useful error messages when `update-prod-static` fails,"In https://github.com/zulip/zulip/issues/14615, we have `upgrade-zulip-from-git` failing inside `update-prod-static`, and the error message is terrible:

```
2020-04-17 21:23:41,590 upgrade-zulip-stage-2: Building static assets...
Cached version not found! Installing node modules.
+ /srv/zulip-yarn/bin/yarn install --non-interactive --frozen-lockfile --prod

Error running a subcommand of ./tools/update-prod-static: /srv/zulip-yarn/bin/yarn install --non-interactive --frozen-lockfile --prod
Actual error output for the subcommand is just above this.

Traceback (most recent call last):
  File ""./tools/update-prod-static"", line 37, in <module>
    setup_node_modules(production=True, stdout=fp, stderr=fp)
  File ""./tools/../scripts/lib/node_cache.py"", line 66, in setup_node_modules
    stderr=stderr)
  File ""./tools/../scripts/lib/node_cache.py"", line 91, in do_yarn_install
    cwd=target_path, stdout=stdout, stderr=stderr)
  File ""./tools/../scripts/lib/zulip_tools.py"", line 200, in run
    subprocess.check_call(args, **kwargs)
  File ""/usr/lib/python3.5/subprocess.py"", line 581, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/srv/zulip-yarn/bin/yarn', 'install', '--non-interactive', '--frozen-lockfile', '--prod']' returned non-zero exit status 1
Traceback (most recent call last):
  File ""/home/zulip/deployments/2020-04-18-01-53-13/scripts/lib/upgrade-zulip-stage-2"", line 122, in <module>
    preexec_fn=su_to_zulip)
  File ""/usr/lib/python3.5/subprocess.py"", line 581, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['./tools/update-prod-static', '--authors-not-required', '--prev-deploy', '/home/zulip/deployments/current']' returned non-zero exit status 1
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/lib/upgrade-zulip-from-git"", line 69, in <module>
    deploy_path, ""--from-git""] + deploy_options)
  File ""/usr/lib/python3.5/subprocess.py"", line 581, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2020-04-18-01-53-13/scripts/lib/upgrade-zulip-stage-2', '/home/zulip/deployments/2020-04-18-01-53-13', '--from-git']' returned non-zero exit status 1
```

Because `update-prod-static` is failing, the actual error messages is in `/home/zulip/deployments/next/var/log/upgrade-prod-static.log`.

`update-prod-static` itself has very verbose output, so I think there's two paths forward:
* Simplest is to copy `build-release-tarball` in at least printing the path to `upgrade-prod-static.log`, and perhaps catching and not emitting much of that unhelpful traceback.
* Better would be to make `update-prod-static` have more sane output.",timabbott,b'area: production area: production installer bug priority: high',2020-04-19T04:31:34Z,2020-04-25T22:39:06Z
14640,"'Copy and close' closes the source, and does not copy","---
<!-- Please Include: -->
- **Operating System**:
  - [ ] Windows
  - [ ] Linux/Ubuntu
  - [x] macOS
- **Version**:
  - 5.0.0
- **Clear steps to reproduce the issue**:
  1. **View source / Edit topic** of an existing message
  2. Click the **Copy and close** icon
  3. Attempt to paste what you just copied
- **Relevant error messages and/or screenshots**:
  1. Source closes with 'Copied!' message
  2. Content is not copied to clipboard though

https://www.loom.com/share/308f035364d14bc3b84cbdf8ec731997",peterdalydickson,b'area: message-editing bug help wanted priority: high',2020-04-16T05:24:58Z,2020-04-22T00:53:33Z
14596,stream settings: Fix UI feedback on clicking checkbox to subscribe.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
https://github.com/zulip/zulip/issues/14481

Before this change, on clicking a checkbox to toggle subscription to a
stream no UI feedback was shown and users could toggle the checkbox
multiple times to send multiple requests causing bugs. This commit
initializes a spinner on clicking the checkbox, to provide a UI feedback
to the user. This commit also disables the checkbox once a request for
subscription has been sent and re-enables the checkbox only after a
response.

**Testing Plan:** <!-- How have you tested? -->
The testing for this has been done by adding a wait of 2 secs in
actions.py for the response. This gives sufficient time to test the
working manually. Also, for error cases an error has been sent from
action.py and the behaviour has been manually observed.


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![streamtoggle](https://user-images.githubusercontent.com/20909078/79463687-c91d5500-8016-11ea-8460-942f95ec55a9.gif)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Pranav2612000,b'area: stream settings bug priority: high size: L',2020-04-16T13:46:59Z,2020-04-19T05:07:19Z
14595,AttributeError: 'LogRecord' object has no attribute 'status_code',"I have a development environment with the latest Git version. After performing many requests, I get blocked because of rate limiting. Then, the following error is logged in the console:

```
----------------------------------------
Exception happened during processing of request from ('127.0.0.1', 56444)
2020-04-16 11:35:49.159 INFO [zr] 127.0.0.1       POST    429  65ms (mem: 57ms/4) (+start: 24ms) /json/messages (10@zulip via website)
2020-04-16 11:35:49.160 INFO [zr] status=429, data=b'{""result"":""error"",""msg"":""API usage exceeded rate limit"",""retry-after"":2.6131470203}\n', uid=10@zulip
2020-04-16 11:35:49.162 INFO [zr] 127.0.0.1       POST    429  11ms (mem: 7ms/2) /json/messages (10@zulip via website)
2020-04-16 11:35:49.162 WARN [django.server] ""POST /json/messages HTTP/1.1"" 429 84
2020-04-16 11:35:49.173 INFO [zr] status=429, data=b'{""result"":""error"",""msg"":""API usage exceeded rate limit"",""retry-after"":2.6109778881}\n', uid=10@zulip
2020-04-16 11:35:49.179 INFO [zr] 127.0.0.1       POST    429  20ms (+start: 51ms) /json/messages (10@zulip via website)
2020-04-16 11:35:49.182 WARN [django.server] ""POST /json/messages HTTP/1.1"" 429 84
2020-04-16 11:35:49.195 INFO [zr] status=429, data=b'{""result"":""error"",""msg"":""API usage exceeded rate limit"",""retry-after"":2.5940015316}\n', uid=10@zulip
Traceback (most recent call last):
  File ""/usr/lib/python3.7/socketserver.py"", line 650, in process_request_thread
    self.finish_request(request, client_address)
  File ""/usr/lib/python3.7/socketserver.py"", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File ""/usr/lib/python3.7/socketserver.py"", line 720, in __init__
    self.handle()
  File ""/srv/zulip-py3-venv/lib/python3.7/site-packages/django/core/servers/basehttp.py"", line 171, in handle
    self.handle_one_request()
  File ""/srv/zulip-py3-venv/lib/python3.7/site-packages/django/core/servers/basehttp.py"", line 187, in handle_one_request
    if not self.parse_request():  # An error code has been sent, just exit
  File ""/usr/lib/python3.7/http/server.py"", line 322, in parse_request
    ""Bad request syntax (%r)"" % requestline)
  File ""/usr/lib/python3.7/http/server.py"", line 456, in send_error
    self.log_error(""code %d, message %s"", code, message)
  File ""/usr/lib/python3.7/http/server.py"", line 558, in log_error
    self.log_message(format, *args)
  File ""/srv/zulip-py3-venv/lib/python3.7/site-packages/django/core/servers/basehttp.py"", line 154, in log_message
    level(format, *args, extra=extra)
  File ""/usr/lib/python3.7/logging/__init__.py"", line 1383, in info
    self._log(INFO, msg, args, **kwargs)
  File ""/usr/lib/python3.7/logging/__init__.py"", line 1519, in _log
    self.handle(record)
  File ""/usr/lib/python3.7/logging/__init__.py"", line 1528, in handle
    if (not self.disabled) and self.filter(record):
  File ""/usr/lib/python3.7/logging/__init__.py"", line 762, in filter
    result = f.filter(record)
  File ""/srv/zulip-py3-venv/lib/python3.7/site-packages/django/utils/log.py"", line 147, in filter
    if self.callback(record):
  File ""/home/sjoerd/zulip/zerver/lib/logging_util.py"", line 122, in skip_200_and_304
    if getattr(record, 'status_code') in [200, 304]:
AttributeError: 'LogRecord' object has no attribute 'status_code'
----------------------------------------
```

Normally, [http.server logs request, status code, size](https://github.com/python/cpython/blob/master/Lib/http/server.py#L544-L545), and [Django extracts the status code from that](https://github.com/django/django/blob/master/django/core/servers/basehttp.py#L144-L157). However, [on errors http.server logs code and message](https://github.com/python/cpython/blob/master/Lib/http/server.py#L457) and Django doesn't extract the status code.

Parsing arguments to log messages seems pretty fragile to me, so maybe it's better to accept that there isn't always a status code on a log record. Making `getattr` default to `None` in [`skip_200_and_304`](https://github.com/zulip/zulip/blob/master/zerver/lib/logging_util.py#L122) is probably the best option.

",Sjord,b'area: production bug priority: high',2020-04-16T12:09:46Z,2020-04-22T18:26:14Z
14581,Rare exception in removing mobile push notifications,"We get this exception occasionally:
```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2020-04-12-23-25-13/zerver/worker/queue_processors.py"", line 170, in do_consume
    consume_func(events)
  File ""/home/zulip/deployments/2020-04-12-23-25-13/zerver/worker/queue_processors.py"", line 199, in <lambda>
    consume_func = lambda events: self.consume(events[0])
  File ""/home/zulip/deployments/2020-04-12-23-25-13/zerver/worker/queue_processors.py"", line 481, in consume
    handle_remove_push_notification(event['user_profile_id'], message_ids)
  File ""/home/zulip/deployments/2020-04-12-23-25-13/zerver/lib/push_notifications.py"", line 670, in handle_remove_push_notification
    gcm_payload, gcm_options = get_remove_payload_gcm(user_profile, message_ids)
  File ""/home/zulip/deployments/2020-04-12-23-25-13/zerver/lib/push_notifications.py"", line 656, in get_remove_payload_gcm
    'zulip_message_id': message_ids[0],
  File ""/home/zulip/deployments/2020-04-12-23-25-13/zulip-py3-venv/lib/python3.6/site-packages/django/db/models/query.py"", line 291, in __getitem__
    return self._result_cache[k]
IndexError: list index out of range
```

I believe it's what happens where there's a race where a message is deleted after the user has read it but before the mobile push notification to remove it is sent.

There are probably 2 bugs here:
* When we delete a message, we probably don't send an appropriate ""remove push notification"" notice. (So if the user hadn't read the message yet, we might never tell the app)
* In `handle_remove_push_notification`, we do `bulk_access_messages_expect_usermessage`, which is wrong in the case the messages have been deleted.  I'm not sure we need that check at all -- there should be no possible security issues involving a remove push notification for a message you never originally received, and I think it was meant as a bit of an assertion that turns out to not always be true.

(We might want to do something with `ArchivedMessage` like we do in the push notifications send path for the similar deletion race there (which we have a test for!) to check that what happened is deletion, and not something else?  Not sure)

@mateuszmandera this might be an issue for you given the deletion angle here.

@gnprice FYI.",timabbott,b'area: mobile area: notifications (messages) bug priority: high',2020-04-14T22:30:08Z,2020-04-14T22:30:59Z
14568,Put LaTeX equations in align environment,"I had hoped that I could work around [this issue](https://github.com/zulip/zulip/issues/14567) by using the align features of LaTeX, but it seems that using `&` to mark where two lines should align does not work, i.e. 
```
\```math
f(x) &= (x + 1)^2 \\
 &=  x^2 + 2x + 1
\ ```
```
doesn't want to render properly. I don't know how this works in Zulip under the hood, but in regular LaTeX if you replace `\begin{equation} ... \end{equation}` with `\begin{align} ... \end{align}` this sort of thing will work. ",MasonProtter,b'area: markdown bug help wanted in progress',2020-04-13T17:27:54Z,2020-04-13T23:01:26Z
14567,Wide LaTeX equations get cut off on narrow screens ,"It seems that if I post a sufficiently wide LaTeX equation in Zulip, the only way to see the full thing is to have a wide enough screen. I can't find a way to scroll sideways and see the full thing. Here's a couple screenshots showing what I mean
![Screenshot_20200413_111103](https://user-images.githubusercontent.com/29157027/79141877-df59b580-7d77-11ea-828d-d2846d7acd91.png)
![Screenshot_20200413_111044](https://user-images.githubusercontent.com/29157027/79141887-e254a600-7d77-11ea-8491-a684d7fd9e6c.png)
",MasonProtter,b'area: LaTeX bug help wanted priority: high',2020-04-13T17:14:08Z,2020-04-14T15:14:03Z
14563,"settings: Fix hovering bug in ""Uploaded files"" settings.","While Hovering over the ""Mentioned in"",""size"" column in
""Uploaded files"" settings the column width is increasing
since we are using `pesudo element ::after` the bug is fixed by
adding `fixed width` for `mentioned_in=20%` , `size=10%`.
fixes #14559

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Jagansivam28,b'area: settings UI area: uploads bug size: XS',2020-04-13T11:49:25Z,2020-04-24T00:46:10Z
14560,upgrade-zulip: Remove tsearch-extras on upgrade.,"We stopped using tsearch-extras in Zulip 2.1.0 after Anders figured
out how to achieve its goals with native postgres.  However, we never
did a `DROP EXTENSION` on systems thta had upgraded, which meant that
backups created on systems originally installed with Zulip 2.0.x and
older, and later upgraded to Zulip 2.1.x, could not be restored on
Zulip servers created with a fresh install of Zulip 2.1.x.

We can't do this with a normal database migration, because DROP
EXTENSION has to be done as the postgres user, so we add some custom
migration code in the upgrade-zulip-stage-2 tool.

It's safe to run this whenever tsearch_extras.control is installed because:
* Zulip is AFAIK the only software that ever used tsearch_extras.
* The package was only installed via puppet on production servers configured to
  run a local Zulip database.
* We'll only run this code once per system, because it removes the
  package and thus the control files.

Fixes #13612.
",timabbott,b'area: production bug priority: high size: S',2020-04-12T23:21:56Z,2020-04-15T22:19:14Z
14559,"Hovering over the ""Mentioned in"" column in ""Uploaded files"" setting shifts the UI","I'm not sure why this happens (it clearly has something to do with the sorting feature), but we have a UI bug where hovering the mouse over the ""mentioned in"" column in the /#settings/uploaded-files shifts the UI.  

We should figure out the cause and fix it.  (And then audit all the other settings pages with a table for the same bug).  It's possible the fact that the table's empty in a development environment is relevant here.",timabbott,b'area: settings UI area: uploads bug help wanted',2020-04-12T21:58:40Z,2020-04-17T18:35:33Z
14550,messages: Fix 500 on queries with empty string as search operand.,"The error is PGroonga specific since `pgroonga_query_extract_keywords` does
not handle empty string inputs correctly. This commit adds filtering on the
narrow to ignore searches with empty operands, to fix the bug. If search
with the empty string was the only search term, the search behaves similar
to no narrow being specified.

Closes #14405

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",punchagan,b'area: search bug priority: high size: S',2020-04-11T15:49:14Z,2020-04-12T18:08:52Z
14498,Fix live update for moving messages to a stream the user isn't able to see,"Following 7990676583b5094e1a12572a782ece7ed57b401e (Part of #6427 / #13912), we have nicely working real-time sync for moving a group of messages in a topic to a new stream.  (The UI hasn't quite merged yet, but I don't intend to block merging it on finishing this).

There's a bug where if a client receives an event notifying it to move messages to a stream ID it doesn't recognize, it'll throw an exception, because the client doesn't know anything about the new stream ID.

The right fix properly involves somewhat tricky changes in the `stream_changed` code paths inside `message_events.js` to basically just discard the messages if the target stream ID is unknown (rather than moving them to a stream_id the client knows nothing about and/or trying to renarrow).  Hopefully we can find a clean way to do this.

Fortunately, it's pretty easy to test this by just using the feature with a second browser logged in as Polonius and narrowed to the messages about to be moved; the one thing to be careful about when reproducing it is to make sure the public stream is one the guest user has never been subscribed to in the past (I'd just make a new stream).

Once we've fixed this issue, which sounds like it's only for guest users, we can look at relaxing the rules that currently limit moving messages to another stream to just:
(1) Organization administrators can do it.
(2) Where both streams are public.

Which are almost certainly too strict, but are necessary because of this implementation limitations (and changing them also requires some thought on policy).

Tagging as a release-blocker since it's a known exception for installations using guest users.",timabbott,b'area: message-editing bug difficult help wanted in progress priority: blocker',2020-04-07T21:36:53Z,2020-06-18T08:03:10Z
14484,boto3: Fix support for using non-S3 providers,"In #14378, we made the migration from boto to boto3, which generally makes life easier, but it breaks the pattern we'd been using of using `self.connection.DefaultHost` to get the ""S3"" URL for the bucket in use based on the boto configuration.  See 7e0ea61b004ed12e653ed085d75c2508882862e2 for context; we'll want to re-apply that with the right boto protocol for doing so.

Relatedly, we'll want to figure out what (if anything) should replace `/etc/zulip/boto.cfg`.  

Tagging as a release blocker since it's a regression, but it's not so important to block moving #14378 to master as we can fix forward.

We'll also want to look at:
* Updating the discussion in f1f60bc9bb916276ca5643f21971b40cba6a0b0d; I bet with boto3 the signature part is different / can be deleted?
* See if we can remove the block in `zproject/settings.py` related to `/etc/zulip/boto.cfg` that exists as a GCE workaround.
",timabbott,b'area: uploads bug priority: blocker',2020-04-07T00:41:43Z,2020-06-19T00:55:17Z
14481,stream settings: Fix UI feedback for clicking checkbox widgets to toggle subscription,"In Zulip's stream management UI, it's possible to send several duplicate requests to subscribe yourself to a stream by clicking repeatedly.  This is confusing at best and buggy at worst.

This is reproducible as follows:
* Add `time.sleep(2)` at the start of `bulk_add_subscriptions` to create a delay.
* Open ""Manage streams""
* Open the browser inspector's network tab.
* Click the checkmark next to a stream you're not subscribed to repeatedly, and notice that each click triggers an additional network request.

We should change the mechanism to (1) show a loading indicator (perhaps in place of the checkmark?  I'm not sure what will look good visually) while the request is in flight and relatedly (2) prevent sending a duplicate request until the first one has received a response.

This bug is important because a bug in the transaction behavior of `bulk_add_subscriptions` can cause it to 500 on the additional duplicate requests, which happens routinely on zulipchat.com due to its scale.
",timabbott,b'area: stream settings bug help wanted priority: high',2020-04-06T22:01:03Z,2020-04-19T05:06:07Z
14445,tests: use test_realm_integer for integer fields in dispatch.js and some minor changes in settings_org tests.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This PR adds the test_realm_integer helper which is used by integer valued fields now which were incorrectly using test_realm_boolean till now.

Also some changes in settings_org tests to use correct integer values in page_params object instead of string values and also using option values in settings_config.js instead of direct integers.

Fixes #12284.

<!-- How have you tested? -->

 <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'area: settings UI area: testing-coverage bug size: M',2020-04-02T21:22:08Z,2020-04-30T20:06:15Z
14408,portico: Fix the position and size of overflow for small size devices.,"Fixes: #8424

**Previously for Small devices**
![Screenshot from 2020-03-31 04-14-05](https://user-images.githubusercontent.com/32801674/77968922-1e165700-7306-11ea-82c4-ae1bdcca0cb3.png)


**Now:**
![Screenshot from 2020-03-31 04-14-54](https://user-images.githubusercontent.com/32801674/77968970-3be3bc00-7306-11ea-833d-2664f2374e5c.png)
",SiddharthVarshney,b'area: portico bug size: M',2020-03-30T22:46:02Z,2020-05-12T11:37:30Z
14405,Empty search query in /json/messages endpoint causes 500 internal server error.,"Sending an empty search query (not possible directly from the web app UI) causes a 500 internal server error. The endpoint is json/messages and the query string is:
```
anchor=newest
num_before=50
num_after=50
narrow=[{""negated"":false,""operator"":""search"",""operand"":""""}]
client_gravatar=true
```
and the error stacktrace is 
```
2020-03-30 18:36:06.228 INFO [zr] 172.17.0.1      GET     500  49ms (db: 34ms/3q) /json/messages [streams,search] (iago@zulip.com via website)
2020-03-30 18:36:06.228 ERR  [django.request] Internal Server Error: /json/messages
2020-03-30 18:36:06.229 ERR  [django.server] ""GET /json/messages?anchor=newest&num_before=50&num_after=50&narrow=[{%22negated%22:true,%22operator%22:%22streams%22,%22operand%22:%22public%22},{%22negated%22:false,%22operator%22:%22search%22,%22operand%22:%22%22}]&client_gravatar=true HTTP/1.1"" 500 49
2020-03-30 18:36:07.830 ERR  [] Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/base.py"", line 1246, in _execute_context
    cursor, statement, parameters, context
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/default.py"", line 588, in do_execute
    cursor.execute(statement, parameters)
  File ""/srv/zulip/zerver/lib/db.py"", line 31, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""/srv/zulip/zerver/lib/db.py"", line 18, in wrapper_execute
    return action(sql, params)
psycopg2.errors.SystemError: pgroonga: query_extract_keywords: failed to parse expression: Syntax error: <||>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/django/core/handlers/base.py"", line 113, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip/zerver/lib/rest.py"", line 27, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/django/views/decorators/csrf.py"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File ""/srv/zulip/zerver/lib/rest.py"", line 166, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 142, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 677, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 656, in authenticate_log_and_execute_json
    return limited_view_func(request, user_profile, *args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 796, in wrapped_func
    return func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/lib/request.py"", line 368, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/views/messages.py"", line 903, in get_messages_backend
    rows = list(sa_conn.execute(query).fetchall())
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/base.py"", line 982, in execute
    return meth(self, multiparams, params)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/sql/elements.py"", line 293, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/base.py"", line 1101, in _execute_clauseelement
    distilled_params,
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/base.py"", line 1250, in _execute_context
    e, statement, parameters, cursor, context
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/base.py"", line 1476, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/util/compat.py"", line 398, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/util/compat.py"", line 152, in reraise
    raise value.with_traceback(tb)
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/base.py"", line 1246, in _execute_context
    cursor, statement, parameters, context
  File ""/srv/zulip-py3-venv/lib/python3.6/site-packages/sqlalchemy/engine/default.py"", line 588, in do_execute
    cursor.execute(statement, parameters)
  File ""/srv/zulip/zerver/lib/db.py"", line 31, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""/srv/zulip/zerver/lib/db.py"", line 18, in wrapper_execute
    return action(sql, params)
sqlalchemy.exc.OperationalError: (psycopg2.errors.SystemError) pgroonga: query_extract_keywords: failed to parse expression: Syntax error: <||>

[SQL: SELECT /* get_messages */ anon_1.message_id, anon_1.flags, anon_1.subject, anon_1.rendered_content, anon_1.content_matches, anon_1.topic_matches
FROM (SELECT message_id, flags, subject, rendered_content, pgroonga_match_positions_character(rendered_content, pgroonga_query_extract_keywords(escape_html(%(escape_html_1)s))) AS content_matches, pgroonga_match_positions_character(escape_html(subject), pgroonga_query_extract_keywords(escape_html(%(escape_html_1)s))) AS topic_matches
FROM zerver_usermessage JOIN zerver_message ON zerver_usermessage.message_id = zerver_message.id
WHERE user_profile_id = %(param_1)s AND recipient_id NOT IN (%(recipient_id_1)s, %(recipient_id_2)s, %(recipient_id_3)s, %(recipient_id_4)s, %(recipient_id_5)s, %(recipient_id_6)s, %(recipient_id_7)s, %(recipient_id_8)s, %(recipient_id_9)s, %(recipient_id_10)s, %(recipient_id_11)s, %(recipient_id_12)s, %(recipient_id_13)s, %(recipient_id_14)s) AND (search_pgroonga &@~ escape_html(%(escape_html_1)s)) ORDER BY message_id DESC
 LIMIT %(param_2)s) AS anon_1 ORDER BY message_id ASC]
[parameters: {'escape_html_1': '', 'param_1': 10, 'recipient_id_1': 18, 'recipient_id_2': 19, 'recipient_id_3': 20, 'recipient_id_4': 21, 'recipient_id_5': 22, 'recipient_id_6': 26, 'recipient_id_7': 27, 'recipient_id_8': 28, 'recipient_id_9': 29, 'recipient_id_10': 30, 'recipient_id_11': 31, 'recipient_id_12': 32, 'recipient_id_13': 33, 'recipient_id_14': 34, 'param_2': 50}]
(Background on this error at: http://sqlalche.me/e/e3q8)
```
on the current master (35b444d59cb00ba2ca2973a5f7fef42f844ab445).",agrawal-d,b'area: search bug priority: high',2020-03-30T19:19:17Z,2020-04-12T18:04:10Z
14398,i18n missing for digest and missed message email templates,"During tests with our evaluation system, I got an email with a missed message reminder. The system texts were English phrases, while system and user preferences were set to German. Looking around I found 7 files under /home/zulip/deployments/current/templates/zerver/emails that, as far as I understand, lack internationalization support:

digest.source.html
digest.subject.txt
digest.txt
missed_message.source.html
missed_message.subject.txt
missed_message.txt
realm_reactivation.subject.txt
",idandr,b'area: i18n bug in progress priority: high',2020-03-30T10:57:15Z,2020-04-30T23:15:24Z
14351,Fix how the /team page generates contributor data,"We've been having periodic issues with the /team page on zulipchat.com losing the ""contributors"" data that lives at the bottom.  I think a proper fix for this will require some restructuring in how this is run.

Currently, the /team page is generated by `tools/update-authors-json`, which is a somewhat unreliable tool, as part of the `update-prod-static` pipeline.

This is bad for several reasons:
* We don't want failures in this tool to be able to break deploying a new release, so we potentially ignore failures in production environments.
* It is slow and makes deploying new production changes slower.
* It means there's no consistency in how often we update.

The right solution for this problem is to run it in a cron job, that can be much more patient (waiting minutes if need be) for GitHub to generate the results, and can complain more loudly if it encounters errors.

As part of this, we should make links to `/team/` on non-zulipchat.com servers just go to zulipchat.com (since we won't be including these data in release tarballs, etc.), like we do with /plans.  

@hackerkid would you be up for taking point on this fix?  

",timabbott,b'area: portico bug help wanted in progress priority: high',2020-03-26T20:36:54Z,2020-04-08T19:56:17Z
14275,setup_path: Fixed KeyError in setup_path for virtualenv>16.7.10.,"In virtualenv>16.7.10 site_packages variable is removed from activate_this.py [virtualenv commit](https://github.com/pypa/virtualenv/commit/9569493453a39d63064ed7c20653987ba15c99e5)
The condition we used to check that the virtualenv is compatible [in commit](https://github.com/zulip/zulip/pull/11243/commits/b49fbc86b27cf2e8658bc43578d25d20d8480790)
should be changed for virtualenv>16.7.10


Fixes #14025

Tested on virtualenv 20.0.1",arpit551,b'area: production installer bug priority: high size: XS',2020-03-20T22:50:56Z,2020-03-24T23:29:59Z
14244,Refactor lightbox code to fix buggy implementation of the image-list.,"Previously, `lightbox.open()` was responsible for retrieving the image data from the DOM, saving it in `asset_map` and finally displaying the image using that data. This implementation wasn't correct for image list at bottom of the lightbox because the `image` parameter passed to lightbox.open() could contain more than one instances of the image that had to be opened.

This commit refactors the lightbox implementation to fix it's behaviour for the bottom image-list. The changes are as follows:

- Seperated the image data parsing logic from the `lightbox.open()` and moved it into parse_image_data().

- Metadata of all the images is stored in the `asset_map` when an image is opened and the image-list is rendered at the bottom.

- Whenever an image-list element is clicked, the image is directly accessed from `asset_map` rather than relying on the original image element still being findable in the DOM.

Fixes #14152.",hashirsarwar,b'area: message view bug difficult priority: high size: L',2020-03-19T03:36:00Z,2020-07-04T18:46:22Z
14231,bug fix: Fix unread counts for certain API messages.,"If I send a message from a normal Zulip client, it is
considered to be ""read"" by me.  But if I send it via
an API program (using my human account), the message
is not immediately ""read"" by me.

Now we handle this correctly in `get_raw_unread_data`.

The symptom of this was that these messages would get
""stuck"" in ""Private Messages"" narrows until the next
time you reloaded your app.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",showell,b'size: XL',2020-03-17T23:13:19Z,2020-04-14T23:09:51Z
14184,ui-fix: Re-sorting of list_render when data gets updated or the same list_render object created again.,"Previously, when list_render.create was called, if a list_render with the
given name existed, it returned the list_render object with the previous
properties, without the property to sort the lists added. I changed the
code to add the 'click' event to the table columns to sort the data
even if the list_render is being reloaded from a previously created
list_render.

Does not cause any breaking change.

Fixes #14175 
<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? --> - 


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  --> -


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Pranav2612000,b'area: settings UI bug size: S',2020-03-12T19:13:17Z,2020-03-18T03:53:31Z
14175,list_render: Not possible to re-sort when data gets updated.,"When the data gets updated and a column has already been sorted, it is not possible to again sort the list_render tables by a column.

Steps to reproduce:

1. Go to https://chat.zulip.org/#settings/uploaded-files
2. Toggle the File thead element.
3. Upload a new file.
4. Now thead sorting buttons does not seems to be clickable. (it gets resolved after reloading)",ryanreh99,b'area: settings UI bug',2020-03-11T22:04:13Z,2020-03-17T19:11:55Z
14152,"lightbox: Fix buggy implementation of ""image-list"" at bottom of lightbox","So, I haven't been able to reproduce this in a development environment, but we've seen tracebacks in production where the `exports.open()` call below is throwing ""Caller should pass in a single row."" inside `rows.js`:

```
    $(""#lightbox_overlay"").on(""click"", "".image-list .image"", function () {                           
        const $image_list = $(this).parent();                                                        
=>>>>    const original_image = $("".message_row img[src='"" + $(this).attr('data-src') + ""']"");        
                                                                                                     
=>>>>        exports.open(original_image);                                                                
                                                                                                     
        $("".image-list .image.selected"").removeClass(""selected"");                                    
        $(this).addClass(""selected"");                                                                
                                                                                                     
        const parentOffset = this.parentNode.clientWidth + this.parentNode.scrollLeft;               
        // this is the left and right of the image compared to its parent.                           
        const coords = {                                                                             
            left: this.offsetLeft,                                                                   
            right: this.offsetLeft + this.clientWidth,                                               
        };                                                                                           
```

Looking at the code here, our logic doesn't make much sense.  The setup that we have here is that:
* We've rendered this `image-list` object containing tiny thumbnails of other images in the narrow one can click on, with some data on the image in `data-src`.
* When you click on that image, we read that data from the `data-src` attribute.
* We then do something crazy, which is to now try to find in the DOM the unique (?) message row containing a something with that `data-src` value.
* So that we can call `lightbox.open()` on it.

That approach is crazy both because it's super weird and because we don't know for sure that there's only one place that there's a preview of the target image.  What we should be doing is:

(1) Splitting the data-parsing part of `lightbox.open` from the rest of it.
(2) When we render the `image-list`, computing the data that `lightbox.open` needs from the DOM and putting it into `asset_map`.
(3) Having the click handler for `image-list` look things up in the `asset_map` directly, rather than relying on the original image element still being findable in the DOM.

One possible reproducer approach for the exception we're seeing is the message containing the image the user clicked being edited to no longer have an image prefix in it in the DOM while the user has the lightbox open but before they clicked it.  The approach described above would prevent this failure mode (by briefly caching the details of the image for the duration of the lightbox session).
",timabbott,b'area: message view bug difficult help wanted in progress priority: high',2020-03-09T04:02:41Z,2020-04-05T20:19:17Z
14151,Fix tracebacks hitting `escape` after repeated message editing,"@showell this may be a good issue for you to investigate and at least get to a proposed path forward, since the current state seems quite weird.  I found this via production exception reporting, and can reproduce this in a development environment.  The traceback is this:

```
 at Object.blueslip_error [as error] /static/js/blueslip.js:245
 at Object../static/js/rows.js.exports.id /static/js/rows.js:53
 at Object../static/js/message_edit.js.exports.end /static/js/message_edit.js:427
 at Object../static/js/hotkey.js.exports.process_escape_key /static/js/hotkey.js:214
 at Object../static/js/hotkey.js.exports.process_hotkey /static/js/hotkey.js:451
 at Object../static/js/hotkey.js.exports.process_keydown /static/js/hotkey.js:795
 at HTMLDocument.<anonymous> /static/js/hotkey.js:799
 at HTMLDocument.dispatch jquery/dist/jquery.js:5237
 at HTMLDocument.elemData.handle jquery/dist/jquery.js:5044
```

The reproducer is to find a private message sent long enough ago you can't edit it anymore, and do ""View source"" on it, and then hit `escape` while it's still selected.  The obviously buggy code is around line 214 in hotkey.js -- the `message_edit_content` widget for a PM you cannot edit will never be focused, I think, so we should be falling back to some way of selecting the row that includes unfocused elements.

The reason the fix isn't simple is that I notice several things here that seem wrong:
* It appears that `message_edit.end()` does not remove previous message-edit forms from the DOM, so if you open and close message editing on 5 messages,  `const message_edit_inputs` ends up having 5 entries, even though only 1 form might be open.  I think `message_edit.end` should be changed to remove the `message_edit` forms from the DOM (potentially included disabling the upload widget or something first), but I'm not totally sure.  
* There's kinda 2 duplicate implementations in hotkey.js; the first one for the selected message, and the later ones for whatever message has the focus if focus is on text.  I am not sure what the history is here but it seems weird to have both of these without at least a comment explaining why.

Combined with the fact that one can have multiple message_edit forms open, I'm not sure what the right fix is.  (I'd be fine with `escape` closing all open message_edit forms).",timabbott,b'area: message-editing bug help wanted',2020-03-09T03:38:39Z,2020-04-22T23:42:02Z
14114,bugdown:: Use Atomic String.,"This is a followup to #14082.
",aero31aero,b'size: L',2020-03-06T12:05:21Z,2020-03-06T19:36:04Z
14107,Cant view profile of bot owner in organization settings,"Nothiing happens on clicking the owner's name.
![nogo](https://user-images.githubusercontent.com/7714968/76004372-66bd3900-5f2f-11ea-8629-09666a5081b2.gif)
",agrawal-d,b'bug good first issue in progress',2020-03-05T16:50:16Z,2020-03-05T19:05:56Z
14101,Add zerver/lib/events / test_events support for moving messages between streams,"This is a planned follow-up to #13912; I'm opening it now so we don't lose track of it.  We should add a case to `test_stream_send_message_events` (or similar to the message editing piece of it) that moving a message between streams using the `propagate` feature, and verifies that our `zerver/lib/events.py` code does the right thing.

I'm pretty sure it doesn't today and might be fairly tricky to fix, and it's a very small race, so I'm OK with merging #13912 without a proper fix for it.  ",timabbott,b'area: api area: message-editing bug difficult in progress',2020-03-05T01:30:35Z,2020-07-06T22:51:58Z
14097,message_header: Topic edit pencil sometimes missing from recipient bar controls.,"A recent bug was introduced that disables the topic edit capability of certain topics.  It's hard to pinpoint a pattern, but going farther back in a stream's history seems to be positively correlated to the number of topics that are affected.  

Currently as of writing this, eg, the `checkins` stream on [chat.zulip.org](chat.zulip.org) has topic edit options on the first few.  Scrolling up reveals sparsity among editable topics.  With the same topic, at one point, exhibiting both editable and non-editable states at different points of the interleaving (!). This is shown below in the screenshots.

Easily reproducible in the development environment; iago (realm admin) doesn't face this issue, but all other members do.

> `tabbott` topic shown with both an edit pencil, and without an edit pencil.

<img width=""699"" alt=""Screen Shot 2020-03-03 at 9 20 09 PM"" src=""https://user-images.githubusercontent.com/39782863/75854803-08f4e980-5d95-11ea-883a-7ef71583f80f.png"">

> Here we see three topics marked from `today` as editable, with `yesterday`'s non-editable.

<img width=""699"" alt=""Screen Shot 2020-03-03 at 9 26 47 PM"" src=""https://user-images.githubusercontent.com/39782863/75855195-cc75bd80-5d95-11ea-93e4-922b2f90b5ce.png"">
",whoodes,b'area: message view bug',2020-03-04T07:34:29Z,2020-03-20T21:38:07Z
14096,Fix GitHub webhook support for requesting a team as a reviewer,"This is an issue with Zulip's GitHub webhook; we currently only support the `requested_reviewers`  part of a `review_requested` event, and not the `requested_teams` part.

Following https://zulipchat.com/api/incoming-webhooks-overview, we should capture a test fixture for this issue and then add support for displaying teams as well with test coverage from the new fixture.

Here's our implementation of the `review_requested` event, for reference.  Doing this cleanly might require some refactoring of the structure here to first generate a list of rendered reviewers and then join with `,`/`and`, rather than doing everything in one pass as we have below:

```
def get_pull_request_review_requested_body(payload: Dict[str, Any],                                  
                                           include_title: Optional[bool]=False) -> str:              
    requested_reviewers = (payload['pull_request']['requested_reviewers'] or                         
                           [payload['requested_reviewer']])                                          
    sender = get_sender_name(payload)                                                                
    pr_number = payload['pull_request']['number']                                                    
    pr_url = payload['pull_request']['html_url']                                                     
    message = ""**{sender}** requested {reviewers} for a review on [PR #{pr_number}]({pr_url}).""      
    message_with_title = (""**{sender}** requested {reviewers} for a review on ""                      
                          ""[PR #{pr_number} {title}]({pr_url})."")                                    
    body = message_with_title if include_title else message                                          
                                                                                                     
    reviewers = """"                                                                                   
    if len(requested_reviewers) == 1:                                                                
        reviewers = ""[{login}]({html_url})"".format(**requested_reviewers[0])                         
    else:                                                                                            
        for reviewer in requested_reviewers[:-1]:                                                    
            reviewers += ""[{login}]({html_url}), "".format(**reviewer)                                
        reviewers += ""and [{login}]({html_url})"".format(**requested_reviewers[-1])                   
```",timabbott,b'area: integrations bug good first issue help wanted in progress',2020-03-04T00:11:51Z,2020-03-10T23:33:07Z
14090,stats: Fix Other calculation,"In commit 2248d4d9a4e41a94d245612f69a407ff25000f31 (#13883) I incorrectly migrated a loop.  Fixes #14052.

**Testing Plan:** Tested by hacking up `get_chart_data` on the backend.",andersk,b'area: analytics bug priority: blocker size: XS',2020-03-02T23:27:24Z,2020-05-04T01:50:26Z
14087,bugdown: Avoid hanging list paragraphs being processed as codeblocks.,"Previously, the input:

~~~
====================
- One
  - Two

    Two continued
====================
~~~

Would produce the same output as:

~~~
====================
- One
  - Two

```
Two continued
```
====================
~~~

This was because our CodeBlockProcessor had a higher priority than
the ListIndentProcessor. This issue was discussed here:
https://chat.zulip.org/#narrow/stream/9-issues/topic/continuation.20paragraphs.20in.20list.20items.


**Testing Plan:** <!-- How have you tested? -->

Manual testing + 1 new testcase in markdown testcases.
",aero31aero,b'size: S',2020-03-02T21:52:25Z,2020-03-03T20:08:25Z
14052,Nan values in stats page,"In the [URL](https://recurse.zulipchat.com/stats), the `Messages sent by client` section displays Nan while displaying the chart. The section beneath the `Messages sent by client` displays numerical values. Please find the screenshot below

<img width=""932"" alt=""zulip_Messages_sent_by_client"" src=""https://user-images.githubusercontent.com/311929/75454107-e6c92900-599a-11ea-9b90-fb8d04a585ad.png"">

Browser: 0.0.3987.116 (Official Build) (64-bit)
OS: macOS Version 10.15.3 (Build 19D76)

Let me know if you need more details.",kracekumar,b'area: analytics bug priority: blocker',2020-02-27T14:28:11Z,2020-03-03T01:45:45Z
14028,narrow: Show starred messages from muted topics in starred message view.,"Starred messages from muted topics were not shown in the starred
messages view. Condition for muting_enabled is modified accordingly
such that the starred messages from muted topics are shown in the
starred messages narrowed view.

Fixes #13548

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Node tests are updated accordingly and the change is manually tested.



**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sahil839,b'area: left-sidebar bug difficult size: M',2020-02-25T20:01:53Z,2020-06-16T20:17:13Z
14025,virtualenv 20.0.1 breaks zulip installer,"When virtualenv 20.0.1 is installed on a system, the zulip installer fails to complete due to an error in `scripts/lib/setup_path_on_import.py`:

```
Successfully installed Yarn 1.19.1!
+ mkdir -p /etc/zulip
+ cat
+ '[' -n '' ']'
+ dpkg-query --showformat '${Status}\n' -W rabbitmq-server
+ grep -vq ' not-installed$'
+ cat
+ '[' -n '' ']'
+ case "",$PUPPET_CLASSES,"" in
+ '[' -z '' ']'
+ cp -a /tmp/tmp.yliyQLjARE/zulip-server-2.1.2/zproject/prod_settings_template.py /etc/zulip/settings.py
+ '[' -n zulip ']'
+ sed -i 's/^EXTERNAL_HOST =.*/EXTERNAL_HOST = '\''zulip'\''/' /etc/zulip/settings.py
+ '[' -n root@localhost.localdomain ']'
+ sed -i 's/^ZULIP_ADMINISTRATOR =.*/ZULIP_ADMINISTRATOR = '\''root@localhost.localdomain'\''/' /etc/zulip/settings.py
+ ln -nsf /etc/zulip/settings.py /tmp/tmp.yliyQLjARE/zulip-server-2.1.2/zproject/prod_settings.py
+ /tmp/tmp.yliyQLjARE/zulip-server-2.1.2/scripts/setup/generate_secrets.py --production
Traceback (most recent call last):
  File ""/tmp/tmp.yliyQLjARE/zulip-server-2.1.2/scripts/setup/generate_secrets.py"", line 11, in <module>
    import scripts.lib.setup_path_on_import
  File ""/tmp/tmp.yliyQLjARE/zulip-server-2.1.2/scripts/lib/setup_path_on_import.py"", line 14, in <module>
    if not os.path.exists(activate_locals[""site_packages""]):
KeyError: 'site_packages'

Zulip installation failed (exit code 1)!

The install process is designed to be idempotent, so you can retry after resolving whatever issue caused the failure (there should be a traceback above). A log of this installation is available in /var/log/zulip/install.log
root@zulip-2001:/tmp/tmp.yliyQLjARE/zulip-server-2.1.2#
```

Something about how the virtualenv at `/srv/zulip-venv-cache/$hash` is being created is causing issues (note that I was able to recreate this with Zulip 2.0.7 as well).

## Steps to recreate

I provisioned an Ubuntu 18.04 container with LXD and performed the following:

1. `pip3 install virtualenv==20.0.1`, then followed the [installation guide](https://zulip.readthedocs.io/en/stable/production/install.html#installer-details):

2. `cd $(mktemp -d); wget https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz; tar -xf zulip-server-latest.tar.gz`

3. `zulip-server-*/scripts/setup/install --self-signed-cert --email=root@localhost.localdomain --hostname=zulip`

When version 20.0.1 is substituted with 15.1.0 or 16.7.10 on an identical container, the install process finishes without any errors. If virtualenv 20.0.1 isn't supported, I would think a check in the installer to ensure the correct version (or a note on the installation page) would be useful, since I imagine it would be common for people to want the latest version of virtualenv installed on systems.

I can provide more logs if needed. Thanks!",n-cc,b'area: production installer bug priority: high',2020-02-25T16:14:50Z,2020-03-23T11:06:20Z
14024,actions: Make do_change_plan_type support changing plan to SELF_HOSTED,"Thanks to @xpac1985 reporting, debugging and proposing fix to the issue. The proposed fix was modified slightly by me to set the correct value for max_invites and upload_quota_gb. 

Fixes #13974",hackerkid,b'area: export/import bug size: M',2020-02-25T08:23:42Z,2020-02-26T00:15:56Z
14017,Fix message list handling of new messages arriving when we're not caught up with the end of the feed,"This is a follow-up to #8989, which addressed an issue with local echo producing out-of-order messages when the current user sends messages to a narrow.  

There's a related bug and race issue when another user sends a message to a narrow while our browser is in the process of fetching the latest batch of messages in that topic.  The bug is that I believe currently we'll display the new message potentially temporarily out-of-order (appearing to be just after the messages we have already received from the server, when in fact there may be hundreds of messages still being fetched from the server in between).  That issue should be possible to fix using `fetch_status` to discard `server_events` events using the same techniques described in #13996.  But that would potentially leave a race would have the user's browser receives the `server_events` response containing the new message from the server, just before receiving the last batch of messages (with `found_newest=True`) that had been queried from the database moments before the new message was sent (with the end result being a missing message).

I think this is likely fixable through storing on the current message list any messages that we would have added to it but for `found_newest=False` (rather than discarding them) and then processing those as new messages once we reach `found_newest=True` if they were not already present in the message list.
",timabbott,b'area: message view bug difficult in progress priority: high',2020-02-24T19:47:54Z,2020-06-16T18:17:38Z
14000,"settings_account: Fix real-time sync of text on the ""Full name"" button.","The issue was the wrong selector.

Fixes: #13820.

GIF:
![Peek 2020-02-23 01-21](https://user-images.githubusercontent.com/40331304/75098344-ec112700-55da-11ea-8b41-5df87ef9185f.gif)
",pragatiagrawal31,b'area: settings (user) bug size: XS',2020-02-22T19:52:55Z,2020-02-25T01:30:11Z
13990,settings user groups: Fix organization admin can not create user groups. ,"The bug was in complex `if` condition, which should mean that users should
be allowed to create a User group only when they are either admin or user
group creation policy is set to everyone.

Fixes: #13909.
",pragatiagrawal31,b'area: settings (admin/org) bug priority: high size: S',2020-02-21T19:36:12Z,2020-02-24T20:16:26Z
13974,"""Some older messages are unavailable"" on self-hosted instance","We've recently migrated our Zulip cloud instance to a self-hosted server.
Some streams show the `Some older messages are unavailable` warning.

![2020-02-20_13-41-01_Zulip](https://user-images.githubusercontent.com/6882771/74934506-a986f900-53e6-11ea-960a-6dc98c0a2d5d.png)

Is this maybe related to the fact that our cloud instance had 10k+ messages already, and showed that warning too, and it has somehow been migrated?
Or is this simply an issue that doesn't take self-hosted instances into account?",xpac1985,b'area: export/import bug',2020-02-20T12:42:24Z,2020-02-26T00:14:55Z
13959,emoji appearance is jumbled,"Hello everyone,

When using the Zulip Windows App v4.0.0, the appearance of emojis is very strange and jumbled. See this screenshot from the emoji picker:

![image](https://user-images.githubusercontent.com/155238/74828391-06968800-52dd-11ea-96d5-9bfe9a0cece8.png)

This started about a week ago. It continues despite a factory reset as well as installing and uninstalling the Zulip app. Everything appears fine when I use a web browser.",nikomatsakis,b'area: emoji bug priority: blocker',2020-02-19T10:59:34Z,2020-02-28T12:54:41Z
13953,hotspots: Animate more tastefully,"Bounce five times, once every 5 seconds, rather than forever every 0.75 seconds. This reduces annoying user distraction and idle CPU/GPU consumption.

Fixes #13760.

**Testing Plan:** `run-dev` with `ALWAYS_SEND_ALL_HOTSPOTS = True`.",andersk,b'bug design difficult size: S',2020-02-19T02:14:45Z,2020-05-04T01:50:15Z
13946,tests: Ensure coverage data files get cleaned up at the end.,"From commit message:

> Without calling cov.erase() the data file seems to persist and even
pollute future test runs if not removed. Registering an atexit handler
seems like a good, and reasonably clean way to ensure the cleanup
happens.
Fixes #13933.

I think this is cleaner than a more hacky cleanup inserted at the beginning of ``test-backend``? And should be reliable enough, as according to atexit doc:
```
Note: The functions registered via this module are not called when the program is killed by a signal not handled by Python, when a Python fatal internal error is detected, or when os._exit() is called.
```

Which should be sufficiently unlikely to happen between the moment these files come into existence (at the first ``cov.save()`` call) and exit.

I'm wondering about whether we should add these ``.coverage.*`` files to ``.gitignore``, since they normally only exist for short periods of time, and I wouldn't have spotted this bug so easily if I hadn't had these files listed at the top in my VSCode source control bar - so it seems actually useful to have them annoyingly listed :sweat_smile: 
",mateuszmandera,b'area: testing-infrastructure bug priority: high size: XS',2020-02-18T14:44:54Z,2020-02-19T22:36:22Z
13943,export: Canonicalize the email of cross realm bot to default value,"Fixes #13496

",hackerkid,b'area: export/import bug size: M',2020-02-18T11:31:54Z,2020-02-19T22:44:56Z
13933,.coverage.xxxxx file not getting cleaned up,https://chat.zulip.org/#narrow/stream/43-automated-testing/topic/.2Ecoverage.2Exxxxx.20file.20not.20getting.20cleaned.20up/near/817599,showell,b'area: testing-infrastructure bug in progress priority: high',2020-02-17T17:43:49Z,2020-02-19T22:39:20Z
13909,Organization admin can't create user groups,"Hi,

i have two admin user. Both can't create a user group with the setting:

""Who can create and manage user groups""
Selected: Admins

If i change the setting to ""Admins and members"", then the admin users can create user groups.",big-r81,b'area: settings (admin/org) bug in progress priority: high',2020-02-14T12:15:12Z,2020-02-24T20:17:22Z
13844,auth: Include user-input email in some error messages in the login form.,Fixes #13126.,mateuszmandera,b'area: authentication bug size: S',2020-02-07T18:42:11Z,2020-02-11T17:00:07Z
13820,"""Full Name"" doesn't change immediately after editing in settings","The ""full name"" of the user doesn't change immediately after editing the name, the changes are reflected only after refreshing the page. 

Screenshots of the issue:
1. Initially the name was ""Name"", I was changing it to ""New Name""
![Screenshot 2020-02-05 at 1 09 15 AM](https://user-images.githubusercontent.com/39935516/73780604-c8fe0f00-47b4-11ea-8079-5109c3bf6266.png)

2. After clicking ""Change"" the ""full name"" doesn't change only a ""saved"" message comes up. The changes are reflected after refreshing the page.
![Screenshot 2020-02-05 at 1 09 30 AM](https://user-images.githubusercontent.com/39935516/73780573-b84d9900-47b4-11ea-8833-17baf96339fa.png)
",AyushHazard,b'area: settings (user) bug help wanted in progress',2020-02-04T19:46:49Z,2020-02-25T01:33:08Z
13789,webhooks/ansibletower: Update for AWX 9.1.1.,"Add a simple compatibility function for AWX 9.x.x. Before AWX 9.x.x
a ""friendly_name"" key was sent by default. Afterwards it was removed
from being a default key but we can still more or less determine if
the triggering event was a job from the REST-style URL.

Note: It is also technically possible to add the key back by defining
a custom notification template in AWX/Tower.

Resolves #13295.",Hypro999,b'area: integrations bug priority: high size: L',2020-02-01T09:20:58Z,2020-03-25T07:09:43Z
13787,events: Investigate likely buggy stream creation event generation code,"We have this block of code in `zerver/lib/events.py` for processing stream creation events:

```
            for stream in event['streams']:
                if not stream['invite_only']:
                    stream_data = copy.deepcopy(stream)
                    if include_subscribers:
￼                        stream_data['subscribers'] = []
￼                    stream_data['stream_weekly_traffic'] = None
￼                    stream_data['is_old_stream'] = False
￼                    stream_data['is_announcement_only'] = False
￼                    # Add stream to never_subscribed (if not invite_only)
￼                    state['never_subscribed'].append(stream_data)
```

I'm suspicious that this code is wrong.  Why should settings details like `is_announcement_only` be correctly guessable here, and why shouldn't we just be getting those values from the `stream_data` object?  

For debugging this, we'll want to add a print statement in that block and run `test-backend test_events` to find what (if any) test is covering the code path, and then look at making that test verify the cases it should, and then from there, fix this block of code.",timabbott,b'area: stream settings bug priority: high',2020-01-31T23:41:51Z,2020-06-16T17:43:22Z
13760,Welcome tour animation CPU usage high on Ubuntu 19.10,"Super cool project, started playing around with it after hearing it mention on Linux Action News. However, I almost rejected the project out of hand because leaving the web page open pins one of my CPU cores at 100%. Looking into it I found that the **welcome tour click-here animation** caused the CPU spike (power user: I read man pages, I don't click bouncy animations).

Steps to reproduce:

1. Log in as a new user.
2. Idle at the web page (with one of the round animations showing)
3. Check top (brave wcpu 35%)

I see the issue on my laptop (Haswell laptop, Ubuntu 19.10, Brave **and** Firefox), but _not_ on my desktop (Haswell desktop, Windows 8.1, Nvidia graphics, Chrome and Firefox).
Moving to another tab makes the CPU usage drop to normal.
Finishing the tour makes the CPU drop to normal.

Is this worth looking further into? I will test on some other systems and see how they respond, and report back here.

",oskar-fagerfjall,b'bug design difficult',2020-01-29T01:16:24Z,2020-07-17T15:46:00Z
13756,Fix reloading browser window in stream-edit UI,"If you reload a browser window that's visiting http://localhost:9991/#streams/8/design, we end up incorrectly showing the ""Create stream"" UI.  I'm not sure when this regressed, but it should be loading that stream's settings page.

![image](https://user-images.githubusercontent.com/2746074/73309962-294ee880-41d8-11ea-8d07-bfedb4ef97cc.png)

@pragatiagrawal31 @YJDave any idea what's going on here?",timabbott,b'area: stream settings bug in progress priority: high',2020-01-28T22:12:57Z,2020-01-28T22:30:51Z
13741,social_auth: Clear session fields leftover from previous auth attempts.,"Fixes #13560.

Tested manually and the commit also has an automated test.

Everything about this is hacky, but I can't see any proper way of doing this - we need upstream to merge https://github.com/python-social-auth/social-core/pull/426. The commit has comments to make things less confusing and to document that all of this should ideally be deleted in the future.",mateuszmandera,b'area: authentication area: mobile bug size: L',2020-01-27T11:11:43Z,2020-01-30T22:45:17Z
13703,Avoid adding invited users to notifications stream unconditionally.,"**What this PR does?**

- In invite users screen, added `#` with the stream names to match how we display them elsewhere.
- Sort the stream names in invite users screen.
- Listed notifications stream along with other streams with a message ""recieves notifications for new streams"" instead of adding the invited user unconditionally.
- Left-justified the elements in the invite users screen.
- Fixes #13645 

**Testing Plan:**
Unit tests.

**Screenshot:**

![Screenshot from 2020-01-28 00-07-18](https://user-images.githubusercontent.com/45683359/73205292-8f008d80-4162-11ea-83be-55614b944ae7.jpg)
",hashirsarwar,b'area: onboarding area: stream settings bug priority: high size: L',2020-01-18T18:13:31Z,2020-07-04T18:49:54Z
13700,topic list: Simplify some code,"Tim, I stacked this on top of the three commits you had me review yesterday.

The goal here is to eventually kill off some of the crazy redraw logic (similar to what I'm doing with the PM list code), but these simplifications should be helpful regardless.",showell,b'area: left-sidebar bug size: XL',2020-01-17T21:58:16Z,2020-01-22T22:32:05Z
13693,"Fix emails when disabling ""Include message content in missed message notifications""","I got a report from a user in the Recurse Center who was confused as to why they were getting missed-message emails that didn't contain any content.  The emails also incorrectly claimed one couldn't reply because missed-message emails weren't configured on the server.  There are 2 things we should do to fix (mostly centered on this block of code:
```
    if not message_content_allowed_in_missedmessage_emails(user_profile):                            
        context.update({                                                                             
            'reply_to_zulip': False,                                                                 
            'messages': [],                                                                          
            'sender_str': """",                                                                        
            'realm_str': user_profile.realm.name,                                                    
            'huddle_display_name': """",                                                               
```

* [x] In this case, rather than the email displaying `Reply in Zulip\nDo not reply to this message. This Zulip server is not configured to accept incoming emails`, we should say "".""Reply in Zulip\nThis email does not include message content because you have disabled [message content appearing in email notifications](https://zulipchat.com/help/pm-mention-alert-notifications).""
* [x] We should potentially move that text from the footer to the message body, rather than having no body?
* [x] We also should change s/Do not reply to this message/Do not reply to this email/ for better clarity.

@hackerkid can you take charge of fixing this?",timabbott,b'area: emails bug in progress priority: high',2020-01-16T20:16:35Z,2020-01-31T20:33:02Z
13681,Fix bugs with topic_list and muting,"Fixes #13676 and #13677.  

I tested this manually pretty extensively using `manage.py mark_all_messages_unread`; the unit tests for this component aren't good and I didn't have time to rework them to test this logic well.",timabbott,b'area: left-sidebar bug size: L',2020-01-15T21:40:11Z,2020-01-26T07:59:03Z
13677,Topic ordering on short-list of streams with a lot of active topics ,"(reproducing sections of the e-mail here, per @timabbott's request) 

We have a large OS community that’s currently running on (free) slack.
A bot mirrors selected slack channels as topics on a slack-archive stream.
Here’s what we’re frequently presented with: 

<img width=""234"" alt=""Screen Shot 2020-01-14 at 08 50 28"" src=""https://user-images.githubusercontent.com/431708/72431125-d2c2c280-3772-11ea-91cb-9eedcd50d0f0.png"">

One minor issue there is that the short-list is almost fully comprised of empty/read or muted channels. Other useful topics are hidden behind “more topics” .

I’m not sure how those channels are currently being sorted. Would it be possible to put unmuted, unread channels first, at least on the short-list?

Thanks a lot for this great product! 🎉 ",aisamu,b'area: left-sidebar bug',2020-01-15T11:50:58Z,2020-01-22T22:31:51Z
13676,"""More topics"" count includes muted topics","(reproducing sections of the e-mail here, per @timabbott's request) 

We have a large OS community that’s currently running on (free) slack.
A bot mirrors selected slack channels as topics on a slack-archive stream.
Here’s what we’re frequently presented with: 

<img width=""234"" alt=""Screen Shot 2020-01-14 at 08 50 28"" src=""https://user-images.githubusercontent.com/431708/72431125-d2c2c280-3772-11ea-91cb-9eedcd50d0f0.png"">

One minor issue there is that, although the stream read-count obeys muting rules, “more topics” do not. After reading all the unmuted topics on that stream, ""more topics” was still showing 148 unread messages.

Would it be possible for “more topics” read count to behave as the stream count, ignoring muted topics?

Thanks a lot for this great product! 😃",aisamu,b'area: left-sidebar bug in progress',2020-01-15T11:48:08Z,2020-01-22T22:34:53Z
13672,register: Fix whitespace.,"This correct change fails the template linter with this error:

```
(zulip-py3-venv) tabbott@coset:~/zulip$ ./tools/lint templates/zerver/register.html 
templates | Traceback (most recent call last):
templates |   File ""tools/check-templates"", line 180, in <module>
templates |     check_our_files(args.modified, args.all_dups, args.fix, args.targets)
templates |   File ""tools/check-templates"", line 35, in check_our_files
templates |     check_html_templates(by_lang['html'], all_dups, fix)
templates |   File ""tools/check-templates"", line 129, in check_html_templates
templates |     validate(fn=fn, check_indent=(fn not in bad_files))
templates |   File ""/home/tabbott/zulip/tools/lib/template_parser.py"", line 291, in validate
templates |     state.matcher(token)
templates |   File ""/home/tabbott/zulip/tools/lib/template_parser.py"", line 279, in f
templates |     ''' % (fn, problem, start_token.s, start_line, start_col, end_tag, end_line, end_col))
templates | lib.template_parser.TemplateParserException:
templates |                     fn: templates/zerver/register.html
templates |                     Mismatched tag.
templates |                     start:
templates |                         {%- for stream in default_stream_group.streams.all() -%}
templates |                         line 194, col 25
templates |                     end tag:
templates |                         label
templates |                         line 198, col 21
templates | 
```

It appears to be some sort of subtle bug in the matching of silent Jinja2 tags, and is preventing merging a valuable fix to our default stream groups feature (#13670).

@adnrs96 do you have time to debug this?  It'd be much appreciated.  ",timabbott,b'area: tooling bug size: XS',2020-01-14T23:03:25Z,2020-01-16T23:29:33Z
13645,Guest invite grants permission to additional unselectable stream,"Hello,
The guest invite feature on both a self hosted install and chat.zulip.org will grant permissions to any selectable stream as well as a hidden stream. On a self-hosted install it would grant the `#general` stream and in chat.zulip.org it will grant the `#announce` stream. When configuring the guest invite, neither of these streams appear in the selectable stream list.

In both UI's the ""Default"" (general or announce) stream isn't available to select or deselect.
but in the self-hosted install, I can generate an invite link which doesn't give the ""Default""(general) stream.",Phfas,b'area: onboarding area: stream settings bug help wanted in progress priority: high',2020-01-11T05:33:02Z,2020-01-27T23:41:05Z
13644,Edit bot from does not closes after clicking save button,"To reproduce-
1. Open settings and go to `Your Bots`.
2. Click on the `edit` icon on one of the bot cards and edit some information in the form. 
3. Click the save button on the edit form.

The form does not close on clicking the save button.
The form should close once the save button is clicked and the server acknowledges that the save is successful.",sahil839,b'area: settings (admin/org) bug',2020-01-10T13:18:01Z,2020-04-29T06:11:16Z
13638,Prevent inconsistencies between get_cross_realm_dicts and get_raw_user_data,"We've had some issues with inconsistencies between in the dictionary format for `get_raw_user_data` and `get_cross_realm_dicts`, including in 630aadb7e077a857bb3940a404dacc8b1740f6a5.  

We should make that category of error impossible.  I see a few paths forward:
* Deduplicating the code by having `get_cross_realm_dicts` call a part of `get_raw_user_data` as a subroutine.  (Maybe via extracting its `user_data` helper method as a public method, `format_user_row`)
* Using a `TypedDict` to define the type for what they're returning
* Extending one of our `zerver/views/home.py` tests to check the formats.

I'd probably start with trying the first approach and see how it goes.

@Hypro999 FYI.",timabbott,b'area: api area: refactoring bug good first issue help wanted',2020-01-08T22:15:56Z,2020-01-31T22:29:18Z
13634,CSS issue with /me and code ,"<img width=""269"" alt=""color_mismatch_example"" src=""https://user-images.githubusercontent.com/11799692/71987610-8c161b00-31fc-11ea-9b30-edebee5fe281.png"">

When using `/me`, inline code blocks have the wrong CSS styling. Also lacking is dark-mode coloring.

Styling for the containing `<span>` element:
[without_me.txt](https://github.com/zulip/zulip/files/4035862/without_me.txt)
[with_me.txt](https://github.com/zulip/zulip/files/4035863/with_me.txt)
",ajkerzner,b'bug design good first issue help wanted in progress',2020-01-08T15:03:34Z,2020-01-08T21:52:57Z
13612,Restore fails: tsearch_extras.control missing,"Hi,
i want to migrate our Zulip-System to a new server (Debian 9->Debian 10). I've installed the server according to your docs (Step1, Step2) without problems. Bur the restore-process fails with the following message:

```
pg_restore: [archiver (db)] Error from TOC entry 2; 3079 16387 EXTENSION tsearch_extras
pg_restore: [archiver (db)] could not execute query: ERROR:  could not open extension control file ""/usr/share/postgresql/11/extension/tsearch_extras.control"": No such file or directory
    Command was: CREATE EXTENSION IF NOT EXISTS tsearch_extras WITH SCHEMA zulip;
```
[full_output.txt](https://github.com/zulip/zulip/files/4025133/full_output.txt)

The version is 2.1.1 for both systems (Backup und Restore).
",codebit-de,b'area: production bug in progress priority: high',2020-01-06T07:51:41Z,2020-04-15T22:21:47Z
13605,"Fix ""private messages"" widget frequently rerendering and losing scroll position","We got this report from a user:

> ""We have been using this app for a very long time now. I have a major problem with it and wondering if there is a fix. When I am trying to search old private messages-- it is constantly taking me back to the top-- I am not able to search past messages with other people. It is extremely frustrating! Is there a way to open just my private message or can I change the time before it takes me back to the top of the private messages? What can be done to correct this issue?""

I think what's going on is ""Private messages"" is rerendering periodically (specifically, I think every time we get new presence data from the server), and that's resetting the scrollbar.  I'm aware of the rerendering behavior because it is super annoying when using ""Inspect elements"".  

I'm not sure what the best fix is; we could potentially avoid doing a rerender at all for presence updates where nobody's visual state changed.  Also, it'd probably makes sense to preserve the scroll position whenever we do such a rerender.  And maybe we should switch that component to use `vue` or something where updates don't require a full HTML replacement?  

But in any case, this seems worth fixing, so tagging it as a priority.
",timabbott,b'area: left-sidebar bug in progress priority: high',2020-01-03T19:52:08Z,2020-01-30T21:15:41Z
13598,bugdown: Rewrite List Preprocessor logic to properly parse fences.,"Previously, we didn't track opening and closing fences separately,
with led to bugs like not parsing a list that was immediately after
a quoted fence; we treated each ``` as a new fence.

This commit rewrites the function to maintain a stack of currently
open fences. If any of the parent fences is a code fence, we do not
insert a new line before a list.

We also add some test cases specifically to test this behavior with
complexly nested lists.

Reported [here](https://chat.zulip.org/#narrow/stream/9-issues/topic/bulleted.20list.20.2B.20quote-block)


CC @gnprice.",aero31aero,b'area: markdown size: XL',2020-01-02T01:27:22Z,2020-01-28T11:36:00Z
13584,Dump `update-prod-static.log` after failures in `update-prod-static`,"It's common for networking or resource issues on a Zulip server during `upgrade-zulip-from-git` to result in `update-prod-static` failing.  We should make it a lot easier to see those errors and self-service debug.  See https://chat.zulip.org/#narrow/stream/31-production-help/topic/Upgrade.20from.202.2E1.2E0.20to.202.2E1.2E1.20failed/near/804160.  

I'm not sure what the best model is; maybe it's `tail -n50 /path/to/update-prod-static.log` plus printing its path for more details, but this could help a ton in having users self-diagnose issues.",timabbott,b'area: production area: production installer bug priority: high',2019-12-28T20:10:51Z,2020-06-16T04:32:00Z
13583,Fix historical New User Bot messages to be sent by Notification Bot,"In 656f882a44b2a29414aafe22d724a09c493f1468, we eliminated NEW_USER_BOT, which was basically a duplicate of NOTIFICATION_BOT with a different identity.  What we should have done at the time was added a database migration to move all messages sent by the NEW_USER_BOT cross-realm bot to have been sent by `NOTIFICATION_BOT` instead, and then delete `NEW_USER_BOT`.  

This will fix a bug that causes `NEW_USER_BOT` to go through the `report_late_add` code path on zulipchat.com and probably any other Zulip server older than 656f882a44b2a29414aafe22d724a09c493f1468.

Tagging this as a priority because it is part of an effort to clear all known production-side JavaScript exceptions.

@mateuszmandera FYI this could be a good issue given your extensive recent experience with testing migrations.

Once we do this, we can consider changing the `report_late_add` code path to be a stronger error (I think we still want to check for it as a way to catch bugs).",timabbott,b'area: production bug priority: high',2019-12-28T19:50:13Z,2020-04-26T18:08:58Z
13560,"After logging into mobile app with OAuth, same browser can’t log into webapp with OAuth","The browser-based OAuth flow for the mobile app stuffs `mobile_flow_otp` into a session variable somewhere in Python Social Auth. If you then try to use the same browser to log into the webapp, the previous value of `mobile_flow_otp` leaks into the new authentication flow and you end up getting dumped back into the mobile app instead of logged into the webapp.",andersk,b'area: authentication area: mobile bug',2019-12-23T00:29:18Z,2020-01-30T22:45:13Z
13554,user settings: cannot search users (too slow?),"This may be a duplicate of https://github.com/zulip/zulip/issues/13192, but in the rust-lang Zulip org I literally cannot search through the list of users. This is a problem since it prevents me from ""administering"" successfully! What happens when I go to the list of users is as follows:

* Searching simply has no effect at all
* Scrolling is very, very slow, but I can (it seems) in principle scroll through all the users, but I've never had the patience to test that theory
* Further, the size of the scroll bar seems to initially indicate a small number of users, and I cannot drag the scroll bar and pull it down to quickly jump to later letters of the alphabet -- pulling the bar all the way down the list only brings me later in the ""A"" names
* Once I scroll down, more names do seem to load, and the size of the bar shrinks

But to get to a name that starts with, say, ""P"", seems like it would take me quite some time if I scrolled manually.

~~This is rather an urgent problem! Thanks.~~ We did resolve our immediate need (scrolled for a long time)",nikomatsakis,b'area: settings (admin/org) bug',2019-12-19T10:49:34Z,2020-07-10T06:12:57Z
13551,provision: Fix Trello exception classes,"`zerver.webhooks.trello.view.exceptions.TrelloException` is maded a
subclass of `UnexpectedWebhookEventType` to stop error emails whenever
Trello adds a new event type.

WIP

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


 <!-- How have you tested? -->


 <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",shubhamgupta2956,b'area: integrations bug size: S',2019-12-18T00:20:41Z,2020-01-13T21:41:07Z
13549,Duplicated displaying of group PMs,"After clicking into some group PMs, I'm getting them displayed twice in the list of conversations. Example:
![image](https://user-images.githubusercontent.com/45007152/71000209-cc3d1e80-20d2-11ea-8b27-95a351eefff9.png)

That's one conversation, the link is identical, but it gets rendered twice for some reason.",mateuszmandera,b'area: left-sidebar bug',2019-12-17T13:41:02Z,2020-01-02T20:00:26Z
13548,"Starred messages from muted topic are counted, but don't show up in ""Starred messages"" view","To reproduce:
1. Enable Starred message count to show up next to ""Starred messages""
2. Star a message in a muted topic
3. The count increases, but the message doesn't show in the view if you go into it.",mateuszmandera,b'area: left-sidebar bug difficult',2019-12-17T13:19:23Z,2020-03-27T07:17:27Z
13547,Incorrect conversation link in private message with  multiple people,"Hi, 
Could you please fix the following issue: 
 
1. Start a private conversation with 3 or more people.
2. Write a message
3. Select the option 'Copy link to conversation' in this message (it needs to be your message)
4. Your ID is excluded from the link to the message
Should be:  /#narrow/pm-with/9,14,57-group/near/1231756
As is: /#narrow/pm-with/9,14-group/near/1231756

Thank you ",anlevshin,b'area: left-sidebar bug priority: high',2019-12-17T10:31:50Z,2020-01-31T20:47:21Z
13543,Validate cache keys before sending to memcached,"PR for https://github.com/zulip/zulip/issues/13504

The cache key validation change came out a lot bigger than intended. But I do think that the most sane approach is to validate in the base functions ``cache_*`` in order to have all the codepaths that could send an invalid cache key covered (such as ``bulk_fetch`` and so on). The upside is the resulting increased test coverage.",mateuszmandera,b'area: production bug size: XL',2019-12-16T07:18:20Z,2020-01-04T00:56:49Z
13541,Glitches around the hidden emails setting,"Besides https://github.com/zulip/zulip/issues/13539 there are some glitches I've bumped into:

- [x] With email visibility set to admins only, when I go to stream settings on an admin account, the email addresses for the ``Subcriptions`` section are in their hidden version userX@domain.

- [x] In ``Users`` tab in Org settings I'm having the Email column empty quite often. In those cases,
trying to use the search errors out:
![image](https://user-images.githubusercontent.com/45007152/70870885-dd7e1200-1f90-11ea-91cf-4fcfbc72255a.png)
Sometimes deactivating users works, sometimes errors out like this:
![image](https://user-images.githubusercontent.com/45007152/70870622-790d8380-1f8d-11ea-9f22-9b2241479dbd.png)
This must be the code:
```
        if ($(""#deactivation_user_modal .email"").html() !== email) {
            blueslip.error(""User deactivation canceled due to non-matching fields."");
            ui_report.message(i18n.t(""Deactivation encountered an error. Please reload and try again.""),
                              $(""#home-error""), 'alert-error');
        }
```
Note that ``""Deactivation encountered an error. Please reload and try again.""`` does't seem to be showing up?

Trying to refresh the page multiple times, the column stays empty. But flipping the email visibility settings to ``Admins only`` and refreshing somehow makes the column show up:
![image](https://user-images.githubusercontent.com/45007152/70870907-259d3480-1f91-11ea-8a94-455517f89474.png)

- [x] ~~Deactivated users also have a habit of disappearing from the list after refreshing?~~.  Tim thinks this isn't a bug -- they go to the ""Deactivated users"" tab after refreshing.  Potentially it'd make sense to 
",mateuszmandera,b'area: settings (admin/org) bug in progress priority: high',2019-12-15T23:18:42Z,2020-03-09T09:48:05Z
13522,bugdown: Parse urls correctly to set potential_attachment_urls.,"The initial implementation didn't handle relative urls properly.
We fix this by using urllib to extract the paths. We also add a
check on the hostname; either its empty (relative url) or the
server's current hostname.

Since we're operating only on the path, we remove the check for
leading '/' in attachment_url_to_path_id.
",aero31aero,None,2019-12-12T23:32:11Z,2019-12-13T04:30:27Z
13504,Improve error handling for invalid memcached requests,"We sometimes get exceptions from memcached about invalid keys being passed in that aren't super useful, e.g.:
```
Traceback (most recent call last):
  File ""/srv/zulip-venv-cache/08c7c1e4fad499cee6dd00398c62f9908faed46f/zulip-py3-venv/lib/python3.5/site-packages/django_pylibmc/memcached.py"", line 130, in get
    return super(PyLibMCCache, self).get(key, default, version)
  File ""/srv/zulip-venv-cache/08c7c1e4fad499cee6dd00398c62f9908faed46f/zulip-py3-venv/lib/python3.5/site-packages/django/core/cache/backends/memcached.py"", line 79, in get
    val = self._cache.get(key)
pylibmc.BadKeyProvided: error 33 from memcached_get(:1:c1fbd697a784127f4887e84e511e2): (0x40af260) A BAD KEY WAS PROVIDED/CHARACTERS OUT OF RANGE, Key provided had invalid character. -> libmemcached/key.cc:103
```

or this:

```
Traceback (most recent call last):
  File ""/srv/zulip-venv-cache/08c7c1e4fad499cee6dd00398c62f9908faed46f/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip-venv-cache/08c7c1e4fad499cee6dd00398c62f9908faed46f/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/request.py"", line 367, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 357, in _wrapped_func_arguments
    client_name=full_webhook_client_name(webhook_client_name))
  File ""./zerver/decorator.py"", line 238, in validate_api_key
    user_profile = access_user_by_api_key(request, api_key, email=role)
  File ""./zerver/decorator.py"", line 270, in access_user_by_api_key
    user_profile = get_user_profile_by_api_key(api_key)
  File ""./zerver/lib/cache.py"", line 149, in func_with_caching
    val = cache_get(key, cache_name=cache_name)
  File ""./zerver/lib/cache.py"", line 187, in cache_get
    ret = cache_backend.get(KEY_PREFIX + key)
  File ""/srv/zulip-venv-cache/08c7c1e4fad499cee6dd00398c62f9908faed46f/zulip-py3-venv/lib/python3.5/site-packages/django_pylibmc/memcached.py"", line 130, in get
    return super(PyLibMCCache, self).get(key, default, version)
  File ""/srv/zulip-venv-cache/08c7c1e4fad499cee6dd00398c62f9908faed46f/zulip-py3-venv/lib/python3.5/site-packages/django/core/cache/backends/memcached.py"", line 79, in get
    val = self._cache.get(key)
ValueError: key length 286 too long, max is 250
```

That last one appears to be a HackerOne user trying to send an invalid API key.  I think the error handling behavior that we want is probably:
(1) We modify `cache_with_key` to check if keys are longer than the maximum supported by memcached or have invalid characters in them.  If they do, we by default log a warning (maybe using the `traceback` module so we know where it is and can do tactical fixes like what's suggested on the next item as appropriate) and return `None` (since with an invalid key, there's nothing in the cache).
(2) Additionally for `access_user_by_api_key`, I think it makes sense to make the function itself check that the input in a hex format string of the right length for an API key, and if not, do an appropriate `raise JsonableError`, since that should give a nice user-facing error for an invalid format API key.  

We wrap all Zulip access to memcached via our functions in `zerver/lib/cache.py`, so this shouldn't be too complicated to implement.  

@mateuszmandera this is probably a good quick issue for you; I'd like it to be done by someone who can write careful tests for the error cases.  I don't think it's a priority for 2.1 release planning.",timabbott,b'area: production bug',2019-12-10T20:12:02Z,2020-01-04T00:56:45Z
13496,Fix data import when `EMAIL_GATEWAY_BOT` setting is in use,"If a user has changed the `EMAIL_GATEWAY_BOT` setting (and the bot's email address), our data import/export process into Zulip crashes with an exception (https://chat.zulip.org/#narrow/stream/31-production-help/topic/Realm.20import/near/800549).

I think it's possible that this could be fixed by just adding a bit of code  in `fetch_user_profile_cross_realm` to canonicalize the `EMAIL_GATEWAY_BOT` email address to Zulip's default value (so that all exports use the standard email address).  We should reproduce the issue and test that fix in a development environment.",timabbott,b'area: export/import bug in progress',2019-12-10T01:32:50Z,2020-02-19T22:47:53Z
13490,models: Add is_realm_admin and is_guest setters.,"Fixes #13452.
We add an option to control UserProfile.role through is_realm_admin,
is_guest properties. The issue with using these is that when changing
user's .role we want to create appropriate RealmAuditLog entries and
send events. This isn't possible when using these setters - the log
entries and events should be created if the role change in the
UserProfile is actually save()-ed to the database - and on the level of
the setter function, it's not known whether the change will indeed be
saved.
It would have to be somehow figured out on the level of post_save
signal handlers, but it doesn't seem like a good design to have such
complexity there, for the sake of setters that generally shouldn't be
used anyway - because we prefer the do_change_is_* functions.
The purpose of this change is mainly for handling use-cases like the
linked issue #13452, where some library function we don't control needs
to do setattr on these boolean properties.
For this reason, this change includes linter rules warning against
using the setters directly.",mateuszmandera,b'area: authentication bug priority: high size: M',2019-12-08T19:42:56Z,2019-12-09T20:21:32Z
13482,"bugdown: Reenable -,+ to begin a markdown list.","This commit has a side-effect that we also now allow mixed lists,
but they have different syntax from the commonmark implementation
and our marked output. For example, without the closing li tags:

```
  Input    Bugdown     Marked
-------------------------------------
         <ul>
- Hello    <li>Hello  <ul><li>Hello</ul>
+ World    <li>World  <ul><li>World
+ Again    <li>Again      <li>Again</ul>
* And      <li>And    <ul><li>And
* Again    <li>Again      <li>Again</ul>
         </ul>
```

The bugdown render is in line with what a user in #13447 requests.

Fixes #13477.

**Testing Plan:** <!-- How have you tested? -->
Manual + automated tests.

**GIFs or Screenshots:**

Note how the local echo (below) renders slightly differently from the bugdown output.
![image](https://user-images.githubusercontent.com/8033238/70304425-e8fe6a00-1827-11ea-83d9-30c47188c82b.png)

",aero31aero,b'area: markdown bug priority: high size: M',2019-12-06T07:25:51Z,2019-12-10T00:13:36Z
13479,generate_secrets: Remove unused local_database_password in production,"Fixes #13464.

Note: Using `RawConfigParser` to write the secrets file means that hand-inserted comments will [no longer be preserved](https://bugs.python.org/issue33481). I assume we don’t care. If we do, we could bring in something like [ConfigObj](https://configobj.readthedocs.io/en/latest/configobj.html) (but its [Python 3 fork](https://github.com/DiffSK/configobj) hasn’t been pushed to PyPI…).

**Testing Plan:** Ran `generate_secrets` with and without `--development`.",andersk,b'area: production installer bug priority: high size: S',2019-12-05T04:55:58Z,2020-02-10T23:04:39Z
13477,Bulleted lists with `-` are broken in the backend markdown processor,"The reproducer is simple:

```
You should be able to do this:
- list of things
- more things
```

@tommyip @aero31aero FYI.  This could have been caused by our recent work on numbered lists?",timabbott,b'area: markdown bug in progress priority: high',2019-12-04T18:23:03Z,2019-12-10T00:16:06Z
13474,Push bouncer error handling,"For issue https://github.com/zulip/zulip/issues/13294

I've spent some time looking into using python-zulip-api but didn't find a simple way (for example in ``send_to_push_bouncer`` we have the ``extra_headers`` parameter that's used  to set the content-type when sending the payload in json form, which python-zulip-api doesn't support right now) so I limited myself to just catching the various ``requests`` exceptions for now. Adding usage of session, or further exploring how to use python-zulip-api could be a follow-up to this PR.

This still involves a whole bunch of plumbing changes to handle bouncer errors on the various codepaths, and I'm not sure if this is the best approach, but at least it's the most reasonable way I've managed to come up with for now.",mateuszmandera,b'area: production bug has conflicts priority: high size: XL',2019-12-03T19:49:24Z,2019-12-04T18:17:54Z
13473,Markdown /me messages bug.,"The first commit addresses the original issue. I'm not sure if its worth merging the second commit but it appeared to be the next obvious step.

**Testing Plan:** <!-- How have you tested? -->
Manual + automated tests.

**GIFs or Screenshots:**

With the fix.
![image](https://user-images.githubusercontent.com/8033238/70060100-e8878880-1607-11ea-9c7a-43efbe8b1fa9.png)
Without the fix.
![image](https://user-images.githubusercontent.com/8033238/70060352-5fbd1c80-1608-11ea-89a5-5675435ec05d.png)


Fixes #13454.",aero31aero,b'area: markdown bug size: S',2019-12-03T14:33:40Z,2019-12-04T01:17:56Z
13467,Fix Trello exception classes,"We need to make `zerver.webhooks.trello.view.exceptions.TrelloException` into a subclass of `UnexpectedWebhookEventType` to avoid getting error emails whenever Trello adds a new event type.  See `zerver/webhooks/trello/view/exceptions.py` for where to make the change.

",timabbott,b'area: integrations bug good first issue help wanted in progress',2019-12-02T20:26:06Z,2020-01-08T02:05:33Z
13464,Don't generate useless local_database_password secret in production,"The `local_database_password` secret is only used in the Zulip development environment, and it's a bug that `generate_secrets.py` generates it in production.  We should ensure it doesn't get generated there for new installations, since it's confusing.  

It might also be helpful to make `generate_secrets.py` remove or comment it on upgrade, though I suppose that carries some risk if the user has written their own code to access that setting.  

@andersk @mateuszmandera FYI",timabbott,b'area: production installer bug priority: high',2019-12-02T06:42:08Z,2019-12-09T21:05:32Z
13463,stream settings: Fixing a bug where the stream-list in the stream set…,"…tings would list all streams but wold show the 'Subscribed' label enabled by resetting the control variable when setting up the page.

Fixes: #13297

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![giphy](https://user-images.githubusercontent.com/16260725/69920616-cb688380-1468-11ea-9840-6a918f2273a0.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",joaomcarvalho,b'area: stream settings bug size: XS',2019-12-01T21:20:07Z,2019-12-02T18:02:36Z
13462,revoke_invitations: Revoke remaining invitations after user register.,"If a user receives more than one invitation to join
an organization and accepts one of them, the others
will still be listed in the admin board.

Fixes: #12629

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",clarammdantas,b'area: invitations bug size: XL',2019-12-01T18:04:25Z,2020-05-27T22:37:26Z
13454,Occasional non-effectiveness of /me,"[Occasional non-effectiveness of /me - Zulip Community - Zulip](https://chat.zulip.org/#narrow/stream/137-feedback/topic/Occasional.20non-effectiveness.20of.20.2Fme) 

Some of the test results at https://chat.zulip.org/#narrow/stream/7-test-here/topic/.2Fme/near/799765 suggested (to me) that failure occurs if the `/me` line includes (or is followed by a line with) a pasted image. 

This, however, was contrary to those findings: 

![image](https://user-images.githubusercontent.com/192271/69878796-c915f600-12bd-11ea-9453-ba295f11fa32.png)",grahamperrin,b'area: markdown bug',2019-11-29T15:35:10Z,2019-12-04T17:51:05Z
13452,LDAP Group sync - No groups appearing in zulip,"Hi,

(I am using the 2.1.0 rc1 because debian10 buster is already releases and the older zulip versions don't want to install on buster.)

I have tried to setup ldap group syncing. Unfortunately no groups appear. In addition I am also unable to set realm admins based on ldap groups:

```
AUTH_LDAP_FIND_GROUP_PERMS = True

AUTH_LDAP_GROUP_SEARCH = LDAPSearch( ""ou=gruppen,dc=<my dc>"", ldap.SCOPE_SUBTREE, ""(objectClass=groupOfUniqueNames)"" )

AUTH_LDAP_USER_FLAGS_BY_GROUP = {
#    ""is_staff"": (
#         LDAPGroupQuery(""cn=bv-team-it,ou=gruppen,dc=<my dc>"")
#        | LDAPGroupQuery(""cn=admin-zulip,ou=rollen,dc=<my dc>"")
#     ),
#    ""is_realm_admin"" : ( LDAPGroupQuery(""cn=bv-team-it,ou=gruppen,dc=<my dc>"") )
}

AUTH_LDAP_GROUP_TYPE = GroupOfUniqueNamesType(name_attr=""cn"")
```

No groups appear in zulip. Also as soon as I uncomment the is_realm_admin line I receive the following error:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 46, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zerver/management/commands/sync_ldap_user_data.py"", line 43, in handle
    sync_ldap_user_data(user_profiles)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zerver/management/commands/sync_ldap_user_data.py"", line 25, in sync_ldap_user_data
    sync_user_from_ldap(u, logger)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zproject/backends.py"", line 764, in sync_user_from_ldap
    updated_user = ZulipLDAPUser(backend, ldap_username, realm=user_profile.realm).populate_user()
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django_auth_ldap/backend.py"", line 521, in populate_user
    self._get_or_create_user(force_populate=True)
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django_auth_ldap/backend.py"", line 721, in _get_or_create_user
    self._populate_user()
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django_auth_ldap/backend.py"", line 741, in _populate_user
    self._populate_user_from_group_memberships()
  File ""/home/zulip/deployments/2019-11-27-20-35-23/zulip-py3-venv/lib/python3.7/site-packages/django_auth_ldap/backend.py"", line 768, in _populate_user_from_group_memberships
    setattr(self._user, field, value)
AttributeError: can't set attribute
```",ClundXIII,b'area: authentication bug priority: high',2019-11-28T13:01:06Z,2019-12-09T19:59:58Z
13448,A few stats strings tagged for translation are not actually translated,"There are several strings on /stats page aren't use translation, but they are translated on transifex.
Messages sent over time
![зображення](https://user-images.githubusercontent.com/5281753/69663474-fcbf0900-108e-11ea-988a-a4ea4c061dad.png)
Me | https://www.transifex.com/zulip/zulip/translate/#uk/djangopo/116075406
Humans | https://www.transifex.com/zulip/zulip/translate/#uk/djangopo/116075425
Bots | https://www.transifex.com/zulip/zulip/translate/#uk/djangopo/109180928
Last 2 months | didn't find in transifex
Last 6 months | didn't find in transifex
All time | https://www.transifex.com/zulip/zulip/translate/#uk/djangopo/116075415",Mant1kor,b'area: i18n bug',2019-11-26T19:01:15Z,2020-06-16T03:43:14Z
13443,bots: Render bot owner name in bots settings as link to show owner profile,"If owner exists, show owner name as link in org. settings which on click
trigger owner profile popup.

Fixes: #13388.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
#13388 

**Testing Plan:** <!-- How have you tested? -->
Opened the settings page and clicked on owner name and checked if the owner profile popup open or not.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![issue13388](https://user-images.githubusercontent.com/52816811/69525725-bbdfcb00-0f8e-11ea-833f-1325dbd4f53a.gif)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",gauravthapar,b'area: settings (admin/org) bug size: S',2019-11-25T08:54:12Z,2019-12-06T20:04:06Z
13441,"Search ""you may want to use streams:all"" notice appears before we've loaded messages from server","If you do a search for something and it returns no results, we provide this helpful notice:

![image](https://user-images.githubusercontent.com/2746074/69431563-dd218c80-0cec-11ea-8ac0-f6c31a81f5c0.png)

(See the call to `filter.contains_only_private_messages` and 01b19291e73f5bfddd48999623d581d40fe12caf for the implementation)

The intent is that we also provide this notice at the very top of the search results, in case you get 5 results and scroll to the top and are like ""where are the rest?"".  However, what's buggy is that:
* The loading spinner circle that's supposed to go around the ""Z"" is misplaced downwards about the height of that widget.
* We don't want to show that widget if we don't have results yet, since it's confusing
* We also don't want to have that widget suddenly appear in a way that pushes down content suddenly by 2 lines in cases where the search query can be partially rendered by the browser (e.g. a `sender:` query).

The main issue should be easy to reproduce in the development environment by adding a `time.sleep(5)` inside `by_search` in `zerver/views/messages.py` (making every search take 5+s` on the backend).  

The obvious approach would be something like this:
* We move the logic to hide the notice at the start of `narrow.activate` and only show it after `message_fetch.load_messages_for_narrow` completes (via putting the code to show it in the `cont` continuation) (if the client needs to go the server) or in the `select_immediately` code path (where the browser has enough cached message history to show the messages immediately).  

But it's possible we actually want to move the logic for this to e.g. `message_list_view.js` or `message_fetch.js` or `fetch_status.js`.  @showell do you have an opinion on where this should go?

@thedeveloperr @vinitS101 FYI.
",timabbott,b'bug priority: high',2019-11-22T14:06:12Z,2019-12-11T02:38:32Z
13433,Emoji parsing is broken after an invalid emoji code in the same line,"When writing a line that contains two colons with text inbetween that does not correspond to a valid emoji code, it is not possible to use an actual emoji code afterwards.

It happened to me when I tried to post a timestamp in chat and it seems to break down as soon as `:06:` appears in the message. Please have a look at the following screenshot for clarification.

![image](https://user-images.githubusercontent.com/53255135/69359969-f2190400-0c89-11ea-97e4-4bec7dc27ad5.png)
",k-spa,b'area: emoji area: markdown bug',2019-11-21T17:10:55Z,2020-01-16T02:20:24Z
13428,sidebar: Move the buddy list tooltip content logic to JS.,"Moved the logic from static/templates/buddy_list_tooltip_content.hbs to
the get_title_data function to simplify the template.

Fixes #13426 ",vinitS101,b'area: i18n bug priority: high size: XL',2019-11-20T22:48:06Z,2019-11-21T05:20:06Z
13426,Fix i18n of sidebar user popovers,"In #11882, we added new tooltip hover behavior in the sidebars over users, replacing the old `title` elements that were slow to appear.

As part of that implementation, we added `static/templates/buddy_list_tooltip_content.hbs`, which has no internationalization.  We need to use https://zulip.readthedocs.io/en/latest/translating/internationalization.html#handlebars-templates to tag the various `Last active: {{last_seen}}` blocks for translation.  It might also make sense to, in order to avoid duplication, move some of the logic into the JavaScript code that calls this.  The tooltip template itself could be a `first_line` with an optional `second_line` attribute, with that data computed in the JavaScript caller.",timabbott,b'area: i18n bug in progress priority: high',2019-11-20T20:56:05Z,2019-11-21T01:07:35Z
13397,Fix longer strings not being translated.,"When strings are tagged for translation using `tr this` the
strings are passed as it is along with new line and tab
characters but the translation data has a single line string.
This commit removes all those characters before being translated
using `i18n.t`.
<!-- What's this PR for?  (Just a link to an issue is fine.) -->

Fixes [#13389](https://github.com/zulip/zulip/issues/13389)

**Testing Plan:** <!-- How have you tested? -->
Have tested this manually by checking if those strings that
were not translated earlier were translated.

",chdinesh1089,b'area: i18n area: settings (admin/org) bug priority: high size: XS',2019-11-13T14:03:00Z,2019-11-20T19:03:16Z
13389,A few longer administrative strings tagged for translation are not actually translated,"I got a report from one of our translators that two of our settings pages, `/#organization/filter-settings` and the bottom of `/#settings/your-account` have large sections that don't seem to be translated properly:

![image](https://user-images.githubusercontent.com/2746074/68517108-077a4100-023b-11ea-8b7a-79cf5349a3bd.png)

![image](https://user-images.githubusercontent.com/2746074/68517123-195be400-023b-11ea-9427-edc0f03856b2.png)

What's weird is that the blocks are tagged for translation with `tr this` and have translation data in the `locale/` directory, which would suggest that the bug is in the handlebars+i18next integration or how we're using it (we're extracting the strings correctly for translator, but not actually doing the substitution correctly at runtime).  Debugging is required.

If I had to guess, I suspect the problem is that these are the places where we're using `tr this` with a multi-line block of text, and we're stripping whitespace in only one of ""when we construct the strings for translation"" and ""when we try to substitute translated strings"".  If you look in the `translations.files, e.g., there's no leading whitespace on those lines:
```
locale/zh_Hans/translations.json:  ""An API key can be used to programmatically access a Zulip account. Anyone with access to your API key has the ability to read your messages, send messages on your behalf, and otherwise impersonate you on Zulip, so you should guard your API key as carefully as you guard your password. <br /> We recommend creating bots and using the bots' accounts and API keys to access the Zulip API, unless the task requires access to your account."": ""API Key用于编程开发访问你的Zulip账户，任何人使用你的Key都可以：读取你的信息，使用你的身份发送信息，所以请不要公开API Key，像保护你的银行卡密码一样保护好它<br />我们建议创建机器人账户权限的API Key来访问Zulip API，除非某些特定任务需要
```

which would suggest maybe it's that the runtime whitespace handling is **not** stripping whitespace whereas the string-extracting time code is?

@andersk do you have any ideas for where the whitespace stripping is happening incorrectly?  ",timabbott,b'area: i18n area: settings (admin/org) bug help wanted priority: high',2019-11-08T23:23:36Z,2019-11-20T19:01:45Z
13388,"Improve rendering of ""bot owner"" fields in ""bot settings""","As explained in a TODO comment I just wrote in 44f9ce92e91f23afb8e92b08f9d6c6e8184ba789, our webapp doesn't provide the ideal experience in the ""Bots admin"" page for investigating bot owners:

```
@@ -133,6 +133,18 @@ function populate_users(realm_people_data) {
         if (user.is_bot) {
             // Convert bot type id to string for viewing to the users.
             user.bot_type = settings_bots.type_id_to_string(user.bot_type);
+
+            // TODO: This is a messy way to handle bot owners.
+            // Ideally, we'd send the user ID to the template, render
+            // owner names as a link, and have that link take the
+            // browser to that user's profile.  But showing the user's
+            // full name is simpler and doesn't look broken, so we do
+            // that for now.
+            if (user.bot_owner_id !== null) {
+                user.bot_owner_full_name = people.get_person_from_user_id(user.bot_owner_id).full_name;
+            } else {
+                user.bot_owner_full_name = i18n.t(""No owner"");
+            }
             bots.push(user);
         } else if (user.is_active) {
             user.last_active = get_last_active(user);
```

It would be a nice improvement to the UI to do what's described there.  

The main thing that's going to be somewhat tricky about this code is writing the logic to trigger navigating to the user's profile popover.",timabbott,b'area: settings (admin/org) bug help wanted in progress',2019-11-08T23:10:29Z,2019-12-06T20:07:02Z
13385,ldap: Fix error while updating a user registered in multiple realms.,"Closes #11520.

Taken from https://github.com/zulip/zulip/pull/11775 - the same solution, just rebased, with some more comments and extra checks in the test.

Regarding the concern mentioned on that PR ( https://github.com/zulip/zulip/pull/11775/files#r262215228 ) - ``get_or_build_user`` doesn't get called in that codepath, so everything should be okay.
",mateuszmandera,b'area: authentication bug has conflicts size: L',2019-11-08T06:26:18Z,2019-11-21T19:15:14Z
13375,Website: The footer is not properly visible in mobile view of the website,"### Problem:
The footer of the website https://zulipchat.com/apps/ios is not visible properly in the mobile view of the website as the font-color is light and is not visible properly as the background-color of its background is also light in color.

### screenshot: 
![Screenshot from 2019-11-06 17-42-15](https://user-images.githubusercontent.com/42200276/68297718-a6792e80-00bd-11ea-9235-81891c3ea86c.png)

### Specifications of my system:
OS: Linux(ubuntu)
Browser: Google Chrome
Version: 77.0.3865.120

If you want, I can go ahead and work on this issue.",rajat2502,b'area: portico bug design',2019-11-06T12:22:46Z,2020-02-21T18:04:52Z
13369,Wrong email hash for Gravatar image in profile,"When I go to my profile it has the link which says ""Avatar from Gravatar"" but it is the wrong image.

If I go to https://en.gravatar.com/site/check/ and enter my email address then I see the correct image and also the email hash.

When I look in the network tab I see that it is downloading the image that is shown in my profile from https://secure.gravatar.com/avatar/cd16f71697e7bed9f447bcbf03c6f200?d=identicon&s=500&version=1 but that is the wrong email hash. How can that be?",steinybot,b'area: settings (user) bug in progress priority: high',2019-11-04T23:57:37Z,2019-11-05T20:39:55Z
13330,integration: Fix missing taiga test action.,"Previously testing webhook from taiga site would result in error.
This adds missing 'test' action to taiga webhooks.

Fixes #13317


**Testing Plan:** <!-- How have you tested? -->
Tested with ./tools/test-all",kostekIV,b'area: integrations bug priority: high size: M',2019-10-27T19:36:32Z,2019-10-29T12:41:06Z
13317,Taiga webhook integration issue,"Hi, I'm trying to create a webhook using the taiga integration.
I get the same issue as  #2318.

Content:
```
Content-Type: application/json
X-TAIGA-WEBHOOK-SIGNATURE: SIGNATURE
X-Hub-Signature: sha1=SIGNATURE
Content-Length: 427
```

Payload:
```
{""by"":{""id"":7,""photo"": ""photo.jpg"",""permalink"":""https://TAIGA_INSTANCE/profile/USER"",""username"":""USERNAME"",""full_name"":""FULLNAME"",""gravatar_id"":""GRAVATAR_ID""},""date"":""2019-10-24T12:59:58.341Z"",""action"":""test"",""data"":{""test"":""test""},""type"":""test""}
```

Response:
```
{""content"": ""{\""result\"":\""error\"",\""msg\"":\""Message must not be empty\"",\""code\"":\""BAD_REQUEST\""}\n""}
```

zulip_version on zulipchat.com : ""2.0.0-2712-g45d2154b4""
taiga_version: current stable: 4.2.14-stable",grandemk,b'area: integrations bug good first issue help wanted in progress priority: high',2019-10-24T13:19:32Z,2019-10-28T22:01:44Z
13309,BUG: Zulip crashes when creating Linkifier,"Hello,

we are currently using Zulip 2.0.6 on an ubuntu 18.04 LTS server. We experienced some weird behavior yesterday when creating a linkifier. After the linkifier was created, you couldn't access the UI. It only showed an internal error.  It didn't just show it to the person that created the Linkifier but also to the rest of the users on that server. Turns out the problem was the name of the regex group! 'name' is apparently not a good name for the group.

Steps to reproduce:
1. Create a linkifier:
    Pattern: `#WIKI-(?P<name>[a-zA-Z]+)`
    URL:      `https://whatever/%(name)s`
2. Load the web interface or try to use the Desktop app and you will get an internal error
3. Remove the linkifier via the API; Zulip works again
4. Create a linkifier where `name` is replaced with `wiki` and Zulip still works

The log hinted at a group, which was why I figured out it was the regex group that created the problem. The log read as follows:
Logger django.request, from module django.core.handlers.exception line 135:
Error generated by Anonymous user (not logged in) on zulip.clickware.de deployment

> Traceback (most recent call last):
>   File ""/home/zulip/deployments/2019-10-18-06-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/core/handlers/exception.py"", line 109, in get_exception_response
>     response = callback(request, **dict(param_dict, exception=exception))
>   File ""/home/zulip/deployments/2019-10-18-06-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
>     response = view_func(request, *args, **kwargs)
>   File ""/home/zulip/deployments/2019-10-18-06-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/views/defaults.py"", line 47, in page_not_found
>     body = template.render(context, request)
>   File ""/home/zulip/deployments/2019-10-18-06-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/template/backends/jinja2.py"", line 80, in render
>     context.update(context_processor(request))
>   File ""./zerver/context_processors.py"", line 66, in zulip_default_context
>     no_previews=True)
>   File ""./zerver/lib/bugdown/__init__.py"", line 2255, in convert
>     mention_data, email_gateway, no_previews=no_previews)
>   File ""./zerver/lib/bugdown/__init__.py"", line 2130, in do_convert
>     maybe_update_markdown_engines(realm_filters_key, email_gateway)
>   File ""./zerver/lib/bugdown/__init__.py"", line 1930, in maybe_update_markdown_engines
>     make_md_engine(realm_filters_key, email_gateway)
>   File ""./zerver/lib/bugdown/__init__.py"", line 1873, in make_md_engine
>     email_gateway=email_gateway,
>   File ""./zerver/lib/bugdown/__init__.py"", line 1888, in build_engine
>     guess_lang=False
>   File ""./zerver/lib/bugdown/__init__.py"", line 1700, in __init__
>     super().__init__(*args, **kwargs)
>   File ""/home/zulip/deployments/2019-10-18-06-39-10/zulip-py3-venv/lib/python3.6/site-packages/markdown/core.py"", line 95, in __init__
>     self.build_parser()
>   File ""./zerver/lib/bugdown/__init__.py"", line 1713, in build_parser
>     self.inlinePatterns = self.build_inlinepatterns()
>   File ""./zerver/lib/bugdown/__init__.py"", line 1802, in build_inlinepatterns
>     reg = self.register_realm_filters(reg)
>   File ""./zerver/lib/bugdown/__init__.py"", line 1816, in register_realm_filters
>     inlinePatterns.register(RealmFilterPattern(pattern, format_string, self),
>   File ""./zerver/lib/bugdown/__init__.py"", line 1506, in __init__
>     markdown.inlinepatterns.Pattern.__init__(self, self.pattern, markdown_instance)
>   File ""/home/zulip/deployments/2019-10-18-06-39-10/zulip-py3-venv/lib/python3.6/site-packages/markdown/inlinepatterns.py"", line 196, in __init__
>     re.DOTALL | re.UNICODE)
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/re.py"", line 233, in compile
>     return _compile(pattern, flags)
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/re.py"", line 301, in _compile
>     p = sre_compile.compile(pattern, flags)
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/sre_compile.py"", line 562, in compile
>     p = sre_parse.parse(p, flags)
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/sre_parse.py"", line 855, in parse
>     p = _parse_sub(source, pattern, flags & SRE_FLAG_VERBOSE, 0)
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/sre_parse.py"", line 416, in _parse_sub
>     not nested and not items))
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/sre_parse.py"", line 765, in _parse
>     p = _parse_sub(source, state, sub_verbose, nested + 1)
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/sre_parse.py"", line 416, in _parse_sub
>     not nested and not items))
>   File ""/srv/zulip-venv-cache/e1eb6592bce842070114364c4b6387c63e4c43d9/zulip-py3-venv/lib/python3.6/sre_parse.py"", line 759, in _parse
>     raise source.error(err.msg, len(name) + 1) from None
> sre_constants.error: redefinition of group name 'name' as group 3; was group 2 at position 44
> 
> 
> Deployed code:
> - ZULIP_VERSION: 2.0.6
> - version: 2.0.6

As the API still worked I suspect that Django had a problem with the Linkifier. Am I right with my assumption? Can you reproduce the problem?",clk-jkn,b'area: markdown question',2019-10-23T04:48:45Z,2019-10-30T20:25:28Z
13297,stream settings: subscribed-filter state is stickier than subscribed-filter UI state,"1\. Hover over any stream in the left-hand list. Click the dropdown arrow and select _Stream settings_.
2\. Change the stream filter (upper left iOS-style radiobutton-group) from ""Subscribed"" to ""All Streams"".
3\. Hit `Esc`.
4\. Repeat step 1.

The stream-list within the settings dialog will show all streams, but the segmented-control will be reset to ""Subscribed"".

This was _not_ reproduced on using the gear-dropdown in the upper right to enter the _Stream settings_ dialog.",rk-for-zulip,b'area: stream settings bug help wanted',2019-10-17T18:43:55Z,2019-12-02T18:01:48Z
13295,Error with AWX 7.0.0,"Hello.
I'm testing integration between **AWX 7.0.0** (Ansible Tower) by sending notifications in **Zulip 2.0.4**.
During testing, I encounter an error from Ansible :

![image](https://user-images.githubusercontent.com/2016950/66895321-c5baf980-eff2-11e9-8649-06e5f2433133.png)

And I immediatly receive an email warning from Zulip with the following content :

```Logger root, from module zerver.middleware line 291:
Error generated by Ansible (user42@zulip.******.**) on zulip.******.** deployment

Traceback (most recent call last):
  File ""/srv/zulip-venv-cache/ebe617662f96425113e5a75344bbe5a0593f634a/zulip-py3-venv/lib/python3.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip-venv-cache/ebe617662f96425113e5a75344bbe5a0593f634a/zulip-py3-venv/lib/python3.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/request.py"", line 289, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 375, in _wrapped_func_arguments
    raise err
  File ""./zerver/decorator.py"", line 361, in _wrapped_func_arguments
    return view_func(request, user_profile, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 289, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/webhooks/ansibletower/view.py"", line 27, in api_ansibletower_webhook
    body = get_body(payload)
  File ""./zerver/webhooks/ansibletower/view.py"", line 34, in get_body
    if (payload['friendly_name'] == 'Job'):
KeyError: 'friendly_name'


Deployed code:
- git: 2.0.0-2546-ga1fa0b011
- ZULIP_VERSION: 2.0.4+git


Request info:
- path: /api/v1/external/ansibletower
- POST: {}
- REMOTE_ADDR: ""['10.10.36.6']""
- QUERY_STRING: ""['api_key=******&topic=******&stream=******&topic=******""
- SERVER_NAME: ""['']""
```

I have already disable the ""Disable SSL checking"" but it seems also that the new version of AWX (the 7.0.0) contains new options for webhook like ""HTTP Headers"" and ""HTTP Method"".

![image](https://user-images.githubusercontent.com/2016950/66895546-5db8e300-eff3-11e9-9954-8e1df5485e17.png)

Note that I have already notifications from GitLab so the notification service works in my self-hosted Zulip configuration.",sulian,b'area: integrations bug priority: high',2019-10-16T07:04:20Z,2020-02-03T04:21:04Z
13294,Improve error handling in push notification bouncer service,"Apparently, our code for sending push notifications to the remote Zulip server doesn't properly handle network errors (i.e. before one gets to an HTTP error) when trying to connect to the bouncer server; those just result in an unhandled exception which gets emailed to the server administrator.  This is not ideal in cases where e.g. there's transient network downtime between the Zulip server and the push notifications service.

Based on the `do_api_query` code of `python-zulip-api`, which has been pretty well tested, we'll want to do something like this:

```
diff --git a/zerver/lib/remote_server.py b/zerver/lib/remote_server.py
index 6572a336a8..1f638ae0e3 100644
--- a/zerver/lib/remote_server.py
+++ b/zerver/lib/remote_server.py
@@ -45,13 +45,17 @@ def send_to_push_bouncer(method: str,
     if extra_headers is not None:
         headers.update(extra_headers)
 
-    res = requests.request(method,
-                           url,
-                           data=post_data,
-                           auth=api_auth,
-                           timeout=30,
-                           verify=True,
-                           headers=headers)
+    try:
+        res = requests.request(method,
+                               url,
+                               data=post_data,
+                               auth=api_auth,
+                               timeout=30,
+                               verify=True,
+                               headers=headers)
+    except (requests.exceptions.Timeout, requests.exceptions.SSLError,
+            requests.exceptions.ConnectionError) as e:
+        return {}, True
 
     if res.status_code >= 500:
         # 500s should be resolved by the people who run the push
```

Plus some plumbing to make the `zerver/lib/push_notifications.py` code (and queue worker code) respect the `failed` part of the `send_to_push_bouncer` return value; right now we achieve that goal through the unhandled exception preventing full acknowledgement of the event we tried to process.",timabbott,b'area: production bug in progress priority: high',2019-10-15T22:38:06Z,2019-12-04T18:14:14Z
13256,LDAP fixes based on search-by-email.,"This should fix the following issues:
https://github.com/zulip/zulip/issues/11878
https://github.com/zulip/zulip/issues/11715
https://github.com/zulip/zulip/issues/9277
possibly some other related ones :thinking: 

1. We swtich to our fork of django-auth-ldap, where I implemented searching in LDAP by email.
2. . A rather unpleasant migration of tests to slapdtest. This is where most of the large number of line changes of PR comes from. This is necessary, because as explained the main migration commit:
> the fakeldap setup we used, with mocking of django_auth_ldap.config.ldap.initialize, would permanently affect the internal state of the ldap modules for all other tests

so having any fakeldap-based tests broke slapdtest (the ldap modules would keep trying to connect to fakeldap instead of slapd.). Plus switching to slapdtest has various other benefits, so I think we're definitely better off relying on that everywhere.

3. We fix email_belongs_to_ldap, to search for emails in the directory rather than blindly returning True.

4. Use email search in django_to_ldap_username, which allows fixing the flows of things like getting api keys and sync_user_from_ldap, which use user_profile.email as the identifier, by allowing them to translate that email into the proper ldap username.
",mateuszmandera,b'area: authentication bug has conflicts priority: high size: XL',2019-10-05T23:02:41Z,2019-10-22T23:12:52Z
13233,"Organization settings ""Discard"" option is misaligned vertically","While testing #12958, I noticed this CSS bug:

![image](https://user-images.githubusercontent.com/2746074/65927053-06890080-e3ad-11e9-88cc-071ec26868b6.png)

It seems to not be a regression in the last 100 commits; didn't try bisecting further.  It might be simpler to just fix forward than to figure out where it was broken; not sure.
",timabbott,b'area: settings (admin/org) bug priority: blocker',2019-10-01T01:16:42Z,2019-10-07T18:58:25Z
13220,Fix sort order of emoji choices,"The ""plain text"" option should really be last here (this is a regression from other refactoring) in ""display settings"": 

![image](https://user-images.githubusercontent.com/2746074/65546938-50fe0f00-decd-11e9-84f6-ffd0522e400f.png)

I'm not sure what the right fix is.  The data is passed from the backend to the frontend in a dictionary (`page_params.emojiset_choices`, grep for `EMOJISET_CHOICES`) ; probably the best option is to add a sort key field to the dictionary generated in `zerver/lib/events.py` (which ends up in `page_params`) and use that for sorting in the handlebars templates.  ",timabbott,b'area: emoji bug good first issue help wanted in progress',2019-09-24T20:16:50Z,2019-11-06T22:56:47Z
13209,support: do_change_realm_subdomain should clear relevant cache.,"If you run `do_change_realm_subdomain` on a subdomain X in production, and then go to zulipchat.com/new to create a new realm with subdomain X, you'll get ""subdomain name unavailable"".

You can fix this by flushing memcached, which suggests there's some cache entry that do_change_realm_subdomain should be clearing.",rishig,b'area: support bug difficult help wanted',2019-09-21T20:34:15Z,2020-02-27T23:17:03Z
13199,styles: Add overflow: hidden on .message_content,"This has two purposes:

1. Prevent stupid stacks of diacritical marks from overflowing into other messages.  Fixes #7843.

2. Prevent Chrome from collapsing the inside bottom margin with the .messagebox outside (in a way that Firefox doesn’t).

**Testing Plan:** Dev server.",andersk,b'area: message view bug size: XS',2019-09-19T20:38:59Z,2019-10-12T00:34:50Z
13196,bugdown: correctly set has:link on messages,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Use rendered content for has_link and similar search keywords
https://github.com/zulip/zulip/issues/12912

Also fixes the issue where edits do not update this field

**Testing Plan:** <!-- How have you tested? -->
Removed old tests based on raw content and added tests of various messages sent in various possible raw link formats, verifying that the resulting messages did/did not have has:link as appropriate.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",dustinheestand,b'size: XL',2019-09-19T03:12:44Z,2019-12-11T01:07:32Z
13180,Improve load characteristics of the user_activity queue worker,"This is a priority issue because it is causing queuing both on zulipchat.com and in some other installations, and we don't have a good recommendation for how to work around it.

The basic issue is that we have this queue worker, which we need because Tornado isn't allowed to connect directly to the database:

```
@assign_queue('user_activity')                                                                                                            
class UserActivityWorker(QueueProcessingWorker):                                                                                          
    def consume(self, event: Mapping[str, Any]) -> None:                                                                                  
        user_profile = get_user_profile_by_id(event[""user_profile_id""])                                                                   
        client = get_client(event[""client""])                                                                                              
        log_time = timestamp_to_datetime(event[""time""])                                                                                   
        query = event[""query""]                                                                                                            
        do_update_user_activity(user_profile, client, query, log_time)                                                                    
                                 ```

which is configured to only support a single process.  The `do_update_user_activity` function is pretty simple -- does a single check with the database and then a single write.  But the throughput means that one round trip per update is likely too much.

Most requests to Zulip are presence requests or `/events` requests; from a production log file:

```
root@prod0:~# zgrep presence /var/log/zulip/server.log.7.gz  | wc -l
3725186
root@prod0:~# zgrep events /var/log/zulip/server.log.7.gz  | wc -l
4483721
root@prod0:~# zgrep -v presence /var/log/zulip/server.log.7.gz  | grep -v events | wc -l
1550199 # everything else
```

So cutting which endpoints are handled here won't make much difference, since `presence` is already not included and we need the `events` data.

The UserActivity data isn't used for a lot -- mostly manual analytics inspection.  But there are some production codebase use cases that require the data to be up to date within 5 minutes (the main one being a check in the zephyr mirroring code) and others that use it (inside /activity).

The actual update code is pretty simple:
```
def do_update_user_activity(user_profile: UserProfile,                                                                                    
                            client: Client,                                                                                               
                            query: str,                                                                                                   
                            log_time: datetime.datetime) -> None:                                                                         
    (activity, created) = UserActivity.objects.get_or_create(                                                                             
        user_profile = user_profile,                                                                                                      
        client = client,                                                                                                                  
        query = query,                                                                                                                    
        defaults={'last_visit': log_time, 'count': 0})                                                                                    
                                                                                                                                          
    activity.count += 1                                                                                                                   
    activity.last_visit = log_time                                                                                                        
    activity.save(update_fields=[""last_visit"", ""count""])                                                                                                                                                                         
```

There's a few ways we can fix this without just adding additional parallel workers (which would be fairly doable the same way we do it for the `message_sender` workers if need be).  I think the best is as follows:

We use a strategy similar to what we use for the `MissedMessageWorker`: the queue processor drains events from the queue and then batch-processes them, either every few minutes or just whenever it has no events to drain (deduplicating events in Python by just combining the counts and using the later of the timestamps).  I think the data structure used by the queue worker for this tracking can be just a dict mapping tuples `(user_profile_id, client_id, query_str)` to a tuple `(count_incr, last_visit)`.

Combining this with changing that 5 minute threshhold for Zephyr mirroring to e.g. 15 minutes to give a bit of breathing room, this would likely be pretty effective.  And it would nicely let us automatically recover from duplicate events.


",timabbott,b'area: production bug priority: high',2019-09-18T00:29:27Z,2019-09-21T18:49:56Z
13171,pm_list: Bot availability status in pm,"Changes the bot availability circle to bot icon on
left side bar, pm listing.

Fixes #13149

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
**Testing Plan:** <!-- How have you tested? -->
Manual testing

**GIFs or Screenshots:** 
![Captura de tela de 2019-09-16 18-13-47](https://user-images.githubusercontent.com/15564640/64996772-416f3c80-d8b5-11e9-9d37-f7bcf7c6aad6.png)

On the discussion of this issue, it was said that if the recipient of the message is a bot, it shouldn't have an availability circle at all. But for me personally, it was kinda odd seeing no icon at all besides the name of the bot, and also I think it would be less confusing if it had some indication that that user is a bot. So, I put a bot icon, but I'm not sure if it is nice or ok. What do you think @timabbott and @rishig ? 


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",clarammdantas,b'area: compose bug priority: high size: L',2019-09-16T22:16:05Z,2019-09-19T00:40:26Z
13149,Bot availablity status in pm,If you send PM to a bot it has always unavailable status. Even if it is online and replying,luckyraul,b'area: compose bug help wanted in progress priority: high',2019-09-09T09:04:05Z,2019-09-19T00:43:27Z
13137,LDAP sync error,"Zulip 2.0.4 in docker with LDAP authentication in AD
When I run 
**su zulip -c ""/home/zulip/deployments/current/manage.py sync_ldap_user_data -r '' -a""**
in docker container, Zulip client shows a white screen with a message like 
{""result"":""error"",""msg"":""API usage exceeded rate limit"",""retry-after"":8.3048295975}",santherics,b'area: authentication bug priority: high',2019-09-05T12:55:29Z,2019-10-25T20:26:27Z
13122,right sidebar: Keyboard shortcuts icon should disappear in medium widths.,"To reproduce:
* Turn the ""User list on left sidebar in narrow windows"" display setting on
* Narrow the window till there are 2 panes 

You'll get stuff like
![image](https://user-images.githubusercontent.com/890911/64135978-0512eb00-cda3-11e9-8d55-7a1718076c0f.png)

You need the display setting turned on to hit the bug. ",rishig,b'area: right-sidebar bug help wanted in progress',2019-09-03T00:00:15Z,2019-10-07T03:46:50Z
13111,settings: Add FAKE_EMAIL_DOMAIN setting.,"Continued from https://github.com/zulip/zulip/pull/13107 (since I can't reopen it).

Fixes #9401.

This adds a FAKE_EMAIL_DOMAIN setting, which should be used if
EXTERNAL_HOST is not a valid domain, and something else is needed to
form bot and dummy user emails (if email visibility is turned off).
It defaults to EXTERNAL_HOST.

get_fake_email_domain() should be used to get this value. It validates
that it's correctly set - that it can be used to form valid emails.

If it's not set correctly, an exception is raised. This is the right
approach, because it's undesirable to have the server seemingly
peacefully operating with that setting misconfigured, as that could
mask some hidden sneaky bugs due to UserProfiles with invalid emails,
which would blow up the moment some code that does validate the emails
is called.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",mateuszmandera,b'area: bots bug priority: high size: L',2019-08-30T00:39:10Z,2019-08-30T22:00:33Z
13110,typeahead: Prioritize language names subset of another for sorting.,"This ensures that typing '```java' and pressing enter would result in
getting dropped into a java codeblock instead of javascript codeblock.

We implement this by modifying the popularity score of languages that we
have deemed popular in lang.json. All other languages still have score of 0
so we still have cases for languages like `j` => `java, javascript, j`.

Fixes #13109.

**Testing Plan:** <!-- How have you tested? -->
Manual testing.",aero31aero,b'area: compose bug size: M',2019-08-30T00:17:29Z,2019-09-26T20:07:07Z
13109,Auto-Complete for Java->Javascript is annoying,"If i want to post some Java code i type in
<pre>
```Java
</pre>
and then press Enter for new line to post my code. This will cause `Java` to get auto-completed to `Javascript` which is quite annoying.

OS: Windows 10",Katharsas,b'area: compose bug',2019-08-28T21:46:01Z,2019-09-26T20:01:48Z
13107,settings: Add FAKE_EMAIL_DOMAIN setting.,"Fixes #9401.

This add a FAKE_EMAIL_DOMAIN setting, which should be used if
EXTERNAL_HOST is not a valid domain, and something else is needed to
form bot email and dummy user email (if email visibility is turned off).
It default to EXTERNAL_HOST.

get_fake_email_domain() should be used to get this value. It validates
that it's correctly set - that it can be used to form valid emails.

If it's not set correctly, an exception is raised. This is the right
approach, because it's undesirable to have the server seemingly
peacefully operating with that setting misconfigured, as that could
mask some hidden sneaky bugs due to UserProfiles with invalid emails,
which would blow up the moment some code that does validate the emails
is called.
",mateuszmandera,b'area: bots bug priority: high size: L',2019-08-29T22:46:39Z,2019-08-30T01:45:05Z
13073,Fix desktop notifications for wildcard mentions in muted streams/topics,"The correct behavior, as described in #6040, is that we should not do desktop notifications for wildcard mentions (e.g. `@all`) in muted streams or topics.  I just merged 5e19546c148bd46544cc5b120df6fdc5655c4f7a which covers one of the more complicated pieces of it.

This replaces #6040 which is pretty cluttered at this point; the `unread_msgs` data work has been completed, as has been the work to make email and mobile push notifications for wildcard mentions do the right thing of not notifying in muted streams.   I've extracted the following outstanding items from #6040: 

> When new messages reach the frontend (including when the 1000 recent history messages are loaded), `exports.process_loaded_messages` in `unread.js` currently looks at whether messages were mentioned (in any capacity) and adds them to the `unread_mentions_counter` data.  We'll need to change this block:
 ```
        if (message.mentioned) {                                                                     
            exports.unread_mentions_counter.add(message.id);                                         
        }                                                                                            
```
Note that I think `message.mentioned` already takes wildcard mentions into account, so we may need to do some refactoring to have the data we need available here.

> The narrow including these messages.  For this, the best thing to do structurally is pretty challenging.  We need to change this section of `by_is`:
```
        elif operand == 'mentioned':                                                                                  
            cond1 = column(""flags"").op(""&"")(UserMessage.flags.mentioned.mask) != 0                                    
            cond2 = column(""flags"").op(""&"")(UserMessage.flags.wildcard_mentioned.mask) != 0                           
            cond = or_(cond1, cond2)                                                                                  
            return query.where(maybe_negate(cond))                                                                    
```

to add an additional filter clause that removes messages that (1) don't have the mentioned flag and (2) have a recipient that's a muted stream.

And then we probably also need to modify `can_apply_locally` in a corresponding way.  

@aero31aero @thedeveloperr this could be a good issue for you.",timabbott,b'area: notifications (messages) bug priority: high',2019-08-26T03:33:33Z,2019-12-10T21:12:46Z
13069,data export: Fix sort regression and perma-success banner bug.,"### 1st commit
Looks like a regression was caused in 02cfb47315322c88b7b3730ba7a784fd67094121 as a result of removing the following tags (related #13049):
```html
<input type=""text"" class=""search"" placeholder=""{{t 'Filter exports' }}""
  aria-label=""{{t 'Filter exports' }}""/>
<div class=""progressive-table-wrapper"" data-simplebar data-list-render=""admin_exports_list"">
```
Also updated to use `Object.values(exports)` to return an array of each exports enumerable values.  As well as adding `.init()` which looks standard for implementations of this kind, but were missing here.

### 2nd commit
This Fixes #13045. I tried using `ui_report` in this situation, but nothing really seems to work for what we want.  So with this approach it fades and hides the `div`.

![hide_banner](https://user-images.githubusercontent.com/39782863/63646728-255fed00-c6b3-11e9-9b95-da0d80a5f93f.gif)
",whoodes,b'area: settings UI bug size: S',2019-08-25T07:11:29Z,2019-08-28T22:27:22Z
13045,"org settings: Arrival of data export doesn't clear ""Export started"" banner.","To reproduce, go to http://localhost:9991/#organization/data-exports-admin and click ""Start public export"".

A green banner like 
![image](https://user-images.githubusercontent.com/890911/63454149-13562400-c3ff-11e9-9abc-1ec9387a97c3.png) 
appears. 

A few seconds later, the export appears in the table below, but the banner doesn't clear. 
",rishig,b'area: settings UI bug help wanted in progress',2019-08-21T17:33:49Z,2019-08-28T22:30:20Z
13030, settings_org: Make save widgets fadeout quick if setting toggled back.,"In ""discarded"" state, ""Save/discard"" widgets start disappearing without the
lag of 800ms as in ""saved"" state. Furthermore, when all settings are restored to
the original state (i.e. there is no net change in the state of input elements),
""discard"" state is more intuitive.

While doing this I have fixed a very minor bug that we haven't sent
fadeout_delay argument as 0, but having its value as undefined still
defaults to 0 so there will no impact of this change.

Fixes: #12258.",pragatiagrawal31,b'area: settings (admin/org) area: settings UI bug priority: high size: XS',2019-08-18T14:38:22Z,2019-08-21T23:49:18Z
13011,Fix integrations sidebar,"Fixes: #12929 
![Screen Shot 2019-08-15 at 23 09 49](https://user-images.githubusercontent.com/18381652/63127341-c7e4e580-bfba-11e9-8924-c0a66abf23af.png)

The PR also includes:
* CSS refactoring of `integrations.scss` to use SCSS nesting
* Adding a background to the categories in integration details page. I think the sidebar looks better with the background on the categories.
<img width=""475"" alt=""Screen Shot 2019-08-16 at 00 16 37"" src=""https://user-images.githubusercontent.com/18381652/63127506-30cc5d80-bfbb-11e9-822f-db1f0b5db2ee.png"">

**Testing Plan:**
I tested the changes on Chrome and Firefox, on all the screen sizes used in media queries on this page.
",alexandraciobica,b'area: portico bug size: XL',2019-08-15T21:24:13Z,2019-08-16T20:49:40Z
13006,Gap handled between streams for continuous hover effect,"Fixes #12508.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes #12508 
Gap no more changes hover effect of pointer cursor

**Testing Plan:** <!-- How have you tested? -->
Chrome dev tools

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![gap](https://user-images.githubusercontent.com/49382298/63090281-70be2100-bf78-11e9-9f6a-e187448d26db.png)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",sonamkshenoy,b'area: left-sidebar bug size: XS',2019-08-15T10:49:37Z,2019-08-20T15:28:44Z
12989,settings: Move API key form into its own modal.,"The modal is rendered dynamically to avoid password managers inserting password into the input field too aggressively.

Fixes #12523.

![image](https://user-images.githubusercontent.com/18504232/62876523-b5b73d00-bd57-11e9-9c6b-ec9ea62de3b9.png)
(The green key icon is my password manager)
![image](https://user-images.githubusercontent.com/18504232/62876538-bd76e180-bd57-11e9-85ae-3ea0cf5e94e5.png)
",tommyip,b'area: settings (user) bug priority: high size: XL',2019-08-12T15:22:35Z,2019-08-13T16:50:58Z
12958,fix user avatar source text,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
#12524 

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![image](https://user-images.githubusercontent.com/33805964/62710784-8af67d00-ba15-11e9-994a-5aeb06f8ffbe.png)
![image](https://user-images.githubusercontent.com/33805964/62710821-9d70b680-ba15-11e9-9a07-a966d57f04f4.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: onboarding area: settings (user) bug priority: high size: S',2019-08-08T14:20:06Z,2019-10-01T01:17:00Z
12942,"echo: Consistently send local_id as string, convert it back to number.","Fixes: #2734.

`local_id` was being transmitted to the server as a string by the AJAX transmission path, and as a number by by the WebSocket transmission path.  Then, one of the two racing success callback paths would use the original number, while the other would use the type returned by the server.  Depending on which transmission path was used and which callback path won the race, `reify_message_id` would sometimes be passed a string that would fail to compare equal to the numerical selection id.  If the locally echoed message was selected, this would cause the selection to disappear.

**Testing Plan:** Inserted `time.sleep(3)` in `do_send_messages`.",andersk,b'area: message view bug size: XS',2019-08-06T02:43:04Z,2019-10-12T00:34:53Z
12929,integrations: Left sidebar of integrations page is misordered.,"E.g. the left half of https://chat.zulip.org/integrations/doc/appfollow looks like

![image](https://user-images.githubusercontent.com/890911/62415398-fd162e80-b5dd-11e9-8f9a-d5d9c2d5a68d.png)

The ""Back to list"" should appear after ""Customer support""
",rishig,b'area: portico bug help wanted in progress',2019-08-03T18:01:57Z,2019-08-15T23:15:18Z
12910,Wrong setting of a caret when one returns after tabs switching,"Gif that shows problem:

![csw](https://user-images.githubusercontent.com/16510738/62074377-4f0c2c80-b24b-11e9-916d-3500c8ab8600.gif)

Gray background is a blank page.

Browser: Chrome 75.
OS: Win10.",FoggyFinder,b'area: compose bug',2019-07-29T18:56:40Z,2019-08-08T12:46:24Z
12868,Improve virtualenv-clone hashing logic,"Our `virtualenv` management logic is designed to have a few properties:
* After running `provision` or the equivalent production operation, you always have a correct virtualenv as though you'd built it fresh
* We avoid the performance pain of redownloading and/or rebuilding all of our packages fresh for the common operations of ""adding a new package"" or ""upgrading a minor version of a package"", both in the development environment and in production.
* https://zulip.readthedocs.io/en/latest/subsystems/dependencies.html is a useful reference.

There are a few issues we need to fix with the current implementation:
* We don't currently compare the `Python` version when deciding whether we need to build a new virtualenv from scratch.  
* Our index of packages included in the virtualenv doesn't have package versions; we should include those and only allow package upgrades to use the `virtualenv-clone` plus cache approach (downgrades are often not tested upstream).

We should be able to test whether the implementation is working manually through inspection of `/srv/zulip-venv-cache/` before and after adding a new python dependency (see the docs for how to do this using `update-locked-requirements`), downgrading in `dev.txt`, and upgrading/downgrading the Python version itself.  We don't currently have unit tests of any this logic, though it wouldn't be a bad idea to write some simple tests of the logic functions from `scripts/lib/setup_venv.py` in `tools/tests/` somewhere (`tools/test-tools` is the runner for those).

@andersk FYI; we might want to fix this before we merge https://github.com/zulip/zulip/pull/12837.",timabbott,b'area: production area: tooling bug in progress priority: high',2019-07-23T23:13:44Z,2020-07-13T20:06:16Z
12859,linkifiers pattern URL should not be required to end in substitution,"From this conversation: https://chat.zulip.org/#narrow/stream/9-issues/topic/linkification.20invalid.20URL.20format.20string

Currently, linkifiers must end in a substitution. Attempting to save a linkifier that has a pattern that ends in a string (e.g. `https://server.example.com/%(id)s/detail/`) results in an error message `Failed: Invalid URL format string`.

Note that you can insert strings into other parts of the URL -- [see ""Generic GitHub"" example](https://zulip.xes-mad.com/help/add-a-custom-linkification-filter)

Linkifiers should be allowed to end in a string.",ghost,b'area: markdown area: settings (admin/org) bug',2019-07-22T15:32:13Z,2019-07-23T14:14:13Z
12821,bugdown: Force absolute urls in topic links.,"If a url doesn't have a scheme, browsers would treat it as a relative
url and open something like: https://chat.zulip.org/google.com instead.

This PR fixes the issue on the backend; the frontend implementation
remains out of sync and the user sending the message wouldn't see
any linkification for urls without a scheme.

Fixes #12791.

---

Also, I believe some part of this would be relevant to the discussion with Mateusz on topic links. I'll be doing my tests on that assuming this PR is merged.

",aero31aero,b'bug priority: blocker size: S',2019-07-19T05:55:10Z,2019-07-19T19:18:52Z
12818,Denormalize the display_recipient cache from the message bodies,"As described in detail in https://chat.zulip.org/#narrow/stream/3-backend/topic/hidden.20emails/near/768801, the current structure of the way we cache the `display_recipient` field in `message_dict` structures is 

The work here is primarily going to be in the `messages_for_ids` code path, in particular not fetching `display_recipients` in the `generic_bulk_cached_fetch` code path, and instead converting the existing `hydrate_recipient_info` to work more like `bulk_hydrate_sender_info`.  

While we are thinking about this, we may want to consider also adding support for an option in `get_messages_backend` to only include IDs in the `display_recipient` structure (or maybe just not include ` display_recipient`, and instead send just the IDs in some other structure?  Unclear.).  But that piece is lower priority.",timabbott,b'area: api bug in progress priority: high',2019-07-18T19:36:26Z,2019-08-20T19:28:15Z
12798,Suppress Handlebars automatic partial indentation,"Fixes #12795.

**Testing Plan:** `run-dev`.",andersk,b'area: message view bug priority: blocker size: S',2019-07-16T21:26:34Z,2019-07-18T03:30:50Z
12795,Over indentation in markdown code blocks.,"We are seeing rendered blocks of code over indented only in the message view, when previewing everything appears normal.  This happens with or without language specification.

Here's the sent message:
<img width=""907"" alt=""Screen Shot 2019-07-15 at 8 44 12 PM"" src=""https://user-images.githubusercontent.com/39782863/61273730-e8b0e580-a745-11e9-9143-e7b49092d110.png"">

Preview of the message:
<img width=""740"" alt=""Screen Shot 2019-07-15 at 8 44 49 PM"" src=""https://user-images.githubusercontent.com/39782863/61273769-fb2b1f00-a745-11e9-90b1-cb36578cad85.png"">

And the raw:
<img width=""740"" alt=""Screen Shot 2019-07-15 at 8 44 38 PM"" src=""https://user-images.githubusercontent.com/39782863/61273792-09793b00-a746-11e9-9b28-26aa97a2d407.png"">


After a quick bisect, it appears that this issue was introduced by 0c565f50bef24dd03c539d47954215a707ee438f in some strange way.",whoodes,b'area: message view bug priority: blocker',2019-07-16T07:21:30Z,2019-07-17T23:09:23Z
12791,auto-linkification of topics links incorrectly generate relative links,"If you're on, say, `mysite.zulipchat.com` and create a stream called `#general>cooldomain.com`, a little blue ↗️ appears next to it which you can click on.  Cool!  Unfortunately this takes me to `https://mysite.zulipchat.com/cooldomain.com` which was probably not the intent; it should probably go to `https://cooldomain.com/`.

----

Library plug: if these are being generated server-side, [hyperlink](https://github.com/python-hyper/hyperlink) will let you perform this transformation in a structured way by doing something like this:

```python3
>>> from hyperlink import parse
>>> parse(""example.com"")
DecodedURL(url=URL.from_text('example.com'))
>>> url = parse(""example.com"")
>>> if not url.scheme:
...     url = url.replace(scheme='https', host=url.path[0], path=())
...
...
>>> url
DecodedURL(url=URL.from_text('https://example.com'))
```",glyph,b'bug priority: blocker',2019-07-16T00:14:18Z,2019-08-05T00:25:32Z
12748,custom profile fields: Show red error indications closer to the fields with validation errors,"With our development environment data, when editing custom profile fields following #12442, the feedback for if you enter invalid input when editing custom profile fields data is not working in that the error may appears off the top of the scrollable region.  I see two issues:
* For `/#organization/profile-field-settings`, we should have a ""Saved"" widget on the ""Add a new profile field"" widget, in addition to the one for the table that's at the top of ""Custom profile fields"", so that the error message is in the part of the screen you're looking at.
* For the ""Your account"" profile, we could either (1) scroll the part of the screen where the error message is into view, (2) add some sort of red marker around values that got an error, or (3) have a ""save"" feedback widget on each individual field (probably the cleanest given that our auto-save logic is basically never going to save changes to multiple fields at once).

@YJDave this is probably a good issue for you.",timabbott,b'area: settings (admin/org) area: settings (user) area: settings UI bug priority: high',2019-07-10T00:42:59Z,2020-04-24T21:50:03Z
12706,templates: Fix wrong path to edit-embedded-bot-service template.,"This bug is introduced in #12667 (use handlebars-loader). Discovered via https://circleci.com/gh/tommyip/zulip/115?utm_campaign=vcs-integration-link&utm_medium=referral&utm_source=github-build-link
",tommyip,b'bug size: XS',2019-07-03T14:50:11Z,2019-07-04T03:33:17Z
12636,group-pms: Update list when new group pm is made.,"Fixes: #12503.
<!-- What's this PR for?  (Just a link to an issue is fine.) -->
It was a little tricky tracking this down, but I think I've got it.

I think we should also make it so deleting all the messages of a group-pm live removes that group-pm from the list instead of having to reload. I haven't looked into it that much though, I'll have to track down how to do that.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Window might look weird because I had to use responsive view to record with both user lists open.
![group-pms](https://user-images.githubusercontent.com/33805964/59980324-e8736d80-9611-11e9-8b84-996c13d11a02.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: right-sidebar bug size: S',2019-06-23T18:23:30Z,2019-07-03T23:40:20Z
12629,invite: Accepting an invite should revoke any other live invitations.,"To repro:
* Send two invitations to an email address
* Accept one of them

The second one still shows up in the admin invitation panel. ",rishig,b'area: invitations bug help wanted',2019-06-22T15:19:32Z,2020-05-27T22:37:17Z
12627,Name email setting ui bug fixes,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
https://github.com/zulip/zulip/issues/12524

**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: onboarding area: settings (user) bug has conflicts priority: high size: S',2019-06-21T20:39:36Z,2019-07-25T04:35:25Z
12621,Typeahead Cursor Position Bug,"This issue has been discussed in https://chat.zulip.org/#narrow/stream/9-issues/topic/user.20typeahead.20regression.3F.

When you press enter on a typeahead and start typing, your cursor is placed at the end of the textbox, whereas we want it to be placed at the end of the typeahead immediately. This causes some characters to appear at the end of the message before you again get to typing where you left off.

This is a timing bug, possibly caused by bootstrap-typeahead triggering `.change()` on `#compose` which moves the cursor to the end and our code which then moves the cursor back. It should only be noticeable on typeaheads with a large number of items.

Potential fixes:

1. Patch bootstrap-typeahead to not trigger `.change()` after setting the value of the textbox.
2. Use the `$('#compose').change()` event in our typeahead code instead of the currently used `setTimeout` to place the cursor.

Related PR #11687.",aero31aero,b'area: compose bug',2019-06-21T07:20:30Z,2019-07-25T22:03:06Z
12612,fixed #11662 : Message collapse/condense bugs,"Fixed #11662

Tested on short, moderate and long messages.

Short messages now cycle from collapsed-normal (normal also meaning uncondensed).
Long messages now cycle as collapsed-condensed-normal.

![smolexp](https://user-images.githubusercontent.com/41019632/59787012-24db5c80-92e6-11e9-92e0-f0275954c599.png)

short message cycle and long message cycle (1)
![smolminandlargeexp](https://user-images.githubusercontent.com/41019632/59787022-2a38a700-92e6-11e9-92e6-e0eccf75296c.png)

long message cycle (2)
![largealarge](https://user-images.githubusercontent.com/41019632/59787027-2efd5b00-92e6-11e9-88f0-37fc19079437.png)
edit: Last PR got messed up so I made a new one
Here are GIFs demonstrating the changes.
Before:
![zulipbefore](https://user-images.githubusercontent.com/41019632/60029717-4ca03b00-96bf-11e9-9d54-aceae251ff84.gif)
After:
![zulip#11662demo](https://user-images.githubusercontent.com/41019632/60029393-b10eca80-96be-11e9-878f-08ffab3788c3.gif)
",ab1nash,b'area: message view bug size: XS',2019-06-19T17:32:37Z,2019-07-14T04:31:24Z
12598,Fix nondeterministic Casper failure with custom profile fields,"I was able to produce the following casper failure locally on master (no reliably):
```
PASS Fail to find element matching selector: tr#emoji_new_mouse_face
2019-06-17 23:06:00.455 INFO [zr] 127.0.0.1       POST    200   1ms (+start: 8ms) /json/report/error (iago@zulip.com via website)
2019-06-17 23:06:02.232 INFO [zr] 127.0.0.1       GET     200   1ms (lp: 2.0s) (+start: 7ms) /json/events [1560812695:14/1] (iago@zulip.com via website)
2019-06-17 23:06:02.234 INFO [] Disconnected handler for queue 1560812695:14 (iago@zulip.com/website)
2019-06-17 23:06:04.210 INFO [zr] 127.0.0.1       GET     200   5ms (lp: 2.0s) (+start: 21ms) /json/events [1560812695:14/1] (iago@zulip.com via website)
2019-06-17 23:06:04.210 INFO [] Disconnected handler for queue 1560812695:14 (iago@zulip.com/website)
FAIL ""#admin-profile-field-status img"" never appeared in 5000ms
#    type: uncaughtError
#    file: /home/tabbott/zulip/frontend_tests/casper_tests/10-admin.js
#    error: ""#admin-profile-field-status img"" never appeared in 5000ms

#    stack: not provided
PASS Untitled suite in /home/tabbott/zulip/frontend_tests/casper_tests/10-admin.js
```

![casper-failure1](https://user-images.githubusercontent.com/2746074/59642478-fa3ca880-9119-11e9-9249-fa519b9c7eca.png)


@YJDave can you investigate if there's a possible initialization race that could cause this exception?",timabbott,b'area: testing-coverage bug',2019-06-17T23:10:51Z,2019-06-17T23:39:02Z
12593,Allow access to DMs with deactivated users,"While some information contained in direct messages that include a deactivated user is available in search previews, clicking through to the conversation results in an error message of ""One or more of these users do not exist!""

I'm using Zulip in production via the web app.",richardhoyt,b'area: search bug priority: high',2019-06-17T16:02:34Z,2019-07-23T14:14:12Z
12583,Encode brackets in URI to avoid conflict with markdown links.,"This works for brackets in both stream and topic names.

Fixes #12579.
",tommyip,b'area: markdown area: message view bug size: L',2019-06-15T04:36:48Z,2019-06-16T22:19:20Z
12579,"Parentheses () in topic name not encoded when using ""Copy link to conversation""","When a topic name includes a `(` character, ""Copy link to conversation"" results in a literal `(` in the URL, which Zulip then doesn't recognize and hyperlink.

I created a topic to demonstrate:

Broken link: https://chat.zulip.org/#narrow/stream/7-test-here/topic/topic.20with.20(.20in.20the.20name/near/753950

Fixed link: https://chat.zulip.org/#narrow/stream/7-test-here/topic/topic.20with.20%28.20in.20the.20name/near/753950

![image](https://user-images.githubusercontent.com/12665708/59538786-d0804900-8eaf-11e9-9273-a6b29932d5d9.png)",ihenckel,b'area: markdown area: message view bug help wanted',2019-06-14T21:21:11Z,2019-07-23T14:14:12Z
12558,draft: Fix draft list not being able to scoll to bottom.,"Fixes #12552.

This also removes the margin between the header and the draft list

Master | PR
<img src=""https://user-images.githubusercontent.com/18504232/59326061-dcd19e00-8d17-11e9-81c9-5886c46036cb.png"" width=""320""> <img src=""https://user-images.githubusercontent.com/18504232/59326063-de02cb00-8d17-11e9-9306-f7bc1460ebe5.png"" width=""320"">",tommyip,b'bug size: S',2019-06-12T05:48:45Z,2019-06-19T02:45:07Z
12552,draft UI regression (can't scroll to oldest drafts),"I saw this on CZO and managed to reproduce on upstream master. I can see it if I open drafts and have enough of them that I need to scroll down. The bug is that I'm not able to see the bottom-most draft.

![image](https://user-images.githubusercontent.com/33805964/59221181-4f416180-8be4-11e9-918e-79ea19bc3cf6.png)

I'll update here if I can bisect this.

update: I see this on master~1000, so I don't think a bisect is possible.",YashRE42,b'bug',2019-06-10T19:39:53Z,2019-06-13T18:35:16Z
12535,Keyboard shortcut,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fix for issue #11766.
Redo of PR https://github.com/zulip/zulip/pull/11769

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

Before:
![keyboard-icon-before](https://user-images.githubusercontent.com/33805964/59145928-34b29100-8a08-11e9-98e6-b68b2f3c54fa.gif)

After:
![keyboard-icon-after](https://user-images.githubusercontent.com/33805964/59145929-354b2780-8a08-11e9-8582-5a502e2b85f5.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: general UI bug size: XS',2019-06-08T10:42:46Z,2019-06-24T19:59:37Z
12527,css: Add nightmode variant for fetching more messages loading indicator,"Fixes: #12522

Added white color to the loading spinner that is displayed when more messages are fetched.

The first GIF I just changed the code so that the spinner is displayed all the time so the change can be seen easier. 
![spinner2](https://user-images.githubusercontent.com/18381652/59115238-2cdfe780-8949-11e9-8be1-e3738d020f82.gif)
For the second one, I am not sure why the spinner is not displayed all the times.
![spinner](https://user-images.githubusercontent.com/18381652/59115247-2fdad800-8949-11e9-8703-581ccd5e3a56.gif)
",alexandraciobica,b'area: message view bug design priority: high size: XS',2019-06-07T15:31:33Z,2019-06-10T09:30:20Z
12524,settings: Name change restriction help icon appears regardless of org setting.,"- [x] On https://chat.zulip.org/#settings/your-account, the question-in-a-circle should not appear unless https://zulipchat.com/help/restrict-name-and-email-changes is set.

![image](https://user-images.githubusercontent.com/890911/59080383-4c213b00-889d-11e9-8ba0-16a541304961.png)

Labeling as priority since this is something users may see pretty early in their use of Zulip.

- [x] One other thing that could be done while this is being fixed is that these question marks should have 
```
position: relative;
top: 2px;
left: 1px;
```
or equivalent when following a block input, like in this name and email case

- [x] A possibly related problem is that when avatar changes are restricted, the ""Avatar from gravitar"" text that appears on-hover over the profile picture is vertically off.

- [ ] There is an inconsistency between behavior and docs for email changes. The docs say that no email addresses can be changed when email changes are restricted, but in master admins can still change their own email address. Which is correct?",rishig,b'area: onboarding area: settings (user) bug help wanted priority: high',2019-06-07T03:56:19Z,2019-10-01T01:10:09Z
12523,Fix LastPass inserting the user's password into the DOM in our API key form,"LastPass will aggressively insert the user's password into any HTML field with the ""password"" format.  This potentially means that our `#settings/your-account` features which have the user enter a password might have the password automatically entered by LastPass even when those parts of our forms are hidden (but still in the HTML).  What I'd like to do is move the form containing `#get_api_key_button` into a modal (like our ""Change password"" UI) that is rendered dynamically only when the user clicks the button to fetch their API key.

It should be a relatively simple migration and would mean LastPass only fills the password into the form when a user has actually clicked into UI where their password might be relevant.

This is also a useful preliminary step for https://github.com/zulip/zulip/issues/6341 in addition to fixing the described issue.  ",timabbott,b'area: settings (user) bug in progress priority: high',2019-06-07T00:15:09Z,2019-08-14T17:55:42Z
12522,Loading indicator for fetching more messages does not have a night theme variant,"Zulip's night theme (""display settings"") apparently doesn't override the styling for the loading spinner for more messages (Which spins around the ""Z"" at the top of the message feed), making it basically invisible.  It's easy to reproduce on chat.zulip.org; in a development environment, I'd recommend using `./manage.py populate_db -n5000` to make it easy to trigger repeatedly (by rebuilding the test database with a bunch more messages so the `home` key always fetches more from the server).  

Reported in https://chat.zulip.org/#narrow/stream/9-issues/topic/no.20loading.20indicator/near/750749

@alexandraciobica this could be a good quick issue for you.",timabbott,b'area: message view bug design priority: high',2019-06-06T20:54:38Z,2019-06-07T17:45:31Z
12508,left sidebar: Increase thickness of hover.,"This is a regression from the left-sidebar refactorings we did a few months ago, but I didn't get a chance to write it up.

I've overlaid the hover from hovering over two adjacent streams:

![image](https://user-images.githubusercontent.com/890911/59004359-385ad380-87ce-11e9-84e4-e3b8dc819117.png)

There should be no gap -- the click targets and hover highlight should extend to cover the gap. I think the gap is coming from a 1px margin on the `<li>` that's not being included in the click target, but I haven't done a deep dive.
",rishig,b'area: left-sidebar bug help wanted',2019-06-06T03:16:27Z,2019-10-07T20:53:02Z
12504,notifications: Disable default permission pop up.,"The issue here was that if the user has not allowed desktop
notifications, the browser would give its own pop up requesting for
permission, this would happen concurrently with zulip's custom green bar
that requests for permission, we would prefer that users interact with
our green bar and so this commit disables the pop up.
<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This fixes #11504 by removing the cause of the problem.

**Testing Plan:** <!-- How have you tested? -->
Open firefox, navigate to local env, log in as user 1.
Open chrome, navigate to local env, log in as user 2.
click ""i"" icon and reset notification permissions to default (ask), allow a reload, confirm that green bar is present. [on chrome]
send message to user 2 from user 1. [from firefox to chrome]
* prior to this, you would see a browser pop up
* after this, that pop up no longer triggers.

repeat in opposite order and confirm everything to be same.

The gifs bellow show manual testing:
chrome-notification-working
![chrome-notification-working](https://user-images.githubusercontent.com/33805964/59106855-00ca6380-8955-11e9-85c9-7997667bc2eb.gif)
chrome-notification-blocked
![chrome-notification-blocked](https://user-images.githubusercontent.com/33805964/59106861-06c04480-8955-11e9-8679-798f917c25f8.gif)

firefox-notifcations-working
![firefox-notifcations-working](https://user-images.githubusercontent.com/33805964/59106879-1049ac80-8955-11e9-8c05-6d98e94e885f.gif)
firefox-notification-blocked
![firefox-notification-blocked](https://user-images.githubusercontent.com/33805964/59106888-150e6080-8955-11e9-9744-9b5d42c02196.gif)

some extra testing:
chrome-notification-ask-later
![chrome-notification-ask-later](https://user-images.githubusercontent.com/33805964/59106917-29525d80-8955-11e9-8110-08aff6fee49c.gif)
chrome-notification-never-ask-later
![chrome-notification-never-ask-later](https://user-images.githubusercontent.com/33805964/59106921-2bb4b780-8955-11e9-95b4-5147aa73dbd4.gif)

firefox-notifcations-ask-later
![firefox-notifcations-ask-later](https://user-images.githubusercontent.com/33805964/59106930-32432f00-8955-11e9-93be-08008a1a7366.gif)
firefox-notification-never-ask-later
![firefox-notification-never-ask-later](https://user-images.githubusercontent.com/33805964/59106933-34a58900-8955-11e9-9c69-c98a1df366cf.gif)

**node tests:**
I've just restored our previous test cases, but we could possibly increase coverage here by writing more tests, but maybe that would be a good follow up?


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YashRE42,b'area: notifications (messages) bug size: M',2019-06-05T21:20:38Z,2019-06-12T23:18:12Z
12503,right sidebar: Creating a new Group PM doesn't update the Group PM section.,"To repro: Send a Group PM to (say) Aaron and Cordelia

Expected behavior is that the bottom right will look something like 
![image](https://user-images.githubusercontent.com/890911/58984456-fa3dbf80-878d-11e9-98af-950cf68633aa.png)

Current behavior is that the `aaron, Cordelia Lear` line doesn't show up until you refresh.
",rishig,b'area: right-sidebar bug help wanted',2019-06-05T19:33:12Z,2019-07-23T14:14:11Z
12498,private conversation randomly scrolls up,"Couple of times a day it happens that in a private conversation the content suddenly scrolls randomly up.

This unfortunately is hard (or even impossible) to reproduce but is there anybody who is experiencing the same problem? We are at least two. 
AFAIK it happens when
1) receiving a new message at the time the given conversation is showing
2) switching to zulip with alt+tab
3) sending a message

Can't tell if the scroll is always the same distance but mostly it's going back to between 1/3 and 1/2 of the current conversation on that day.

Logs don't say anything related.

Thanks for any feedback

---
- **Operating System**:
  - [x] Windows
- **Zulip version**:
  - [x] v2.3.82",crazee881,b'area: message view bug',2019-06-05T17:30:08Z,2019-09-18T18:45:37Z
12486,Fix leaking test templates in test_runner.py,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->

N = self.parallel templates are created, and these templates were
previously named 'zulip_test_template_<1, N>'.  However, to support
running multiple instances of `test-backend`, a unique
`random_id_range_start` was created for each template database.

There was no problem prior because the templates would simply be
used again and thus did not require any clean up. Now that there are
unique database names being created, every time `test-backend` is run
these templates can accumulate on disk.  Instead, we clean up our
templates at the end of every complete run of the test suite, or upon a
SIGINT.

Fixes: #12426

**Testing Plan:** 
```
>>> tools/test-backend
>>> df -h
>>> manage.py dbshell
zulip_test=> \l
```",whoodes,b'area: testing-infrastructure bug has conflicts priority: high size: M',2019-06-04T15:02:37Z,2019-06-07T02:03:34Z
12472,Sqrt does not render properly on web client,"I am not sure whether I should report problems with web client issues here, but I did not find a specific repository for it.

When typesetting sqrt (e.g. `$$\sqrt{2} > 1$$`) in the web client on the `chat.zulip.org`, the square root does not get rendered properly (it appears for a quick duration and then is not shown). Other signs such as integrate work. I am using Firefox 67.0 on Linux 64 bits.",stephanemagnenat,b'area: LaTeX area: dependencies bug',2019-06-03T07:52:00Z,2020-04-01T22:06:33Z
12465,left_sidebar: Click target includes whole row for all links.,"Extended the click targets for the top four links (All messages, Private messages, Mentions and Starred messages).
The click target now covers the whole row and the mouse pointer also changes as expected.

Fixes #12449.

**GIFs:**

![left sidebar links](https://user-images.githubusercontent.com/25329595/58753835-ed497380-84e2-11e9-8b99-0e84138538c5.gif)
",vinitS101,b'area: left-sidebar bug size: S',2019-06-01T21:33:37Z,2019-07-09T20:36:20Z
12449,left sidebar: Click target should include whole row.,"For streams, the click target includes the whole shaded area. For the four links in the upper left, this seems to not be the case.",rishig,b'area: left-sidebar bug help wanted',2019-05-30T20:47:22Z,2019-07-23T14:14:10Z
12446,Quote-and-reply doesn't handle code blocks properly,"If you use quote-and-reply on a message containing a code block without a language specified, like this one, it doesn't work, because we treat the start-block marker as an end-block marker for the quote:

https://chat.zulip.org/#narrow/stream/49-development-help/topic/Vagrant.20Docker/near/747567

I think there's a few reasonable ways we could handle this:
* Have quote-and-reply generate a ""``` endquote"" marker, and look for those?  Seems messy because manually created quote blocks (e.g. for pasting an email, or whatever) might not have these (though I suppose we could have typeahead add it).  Maybe the best version of this would be something like ""``` quote 12345"" (message ID, which we were talking about for another feature anyway for showing more rich information) with a ""```endquote 12345"" later in the message (and we'd know we need to find an endquote with that ID because of the ID on the quote?)
* Try to add a special `nonquote` language marker (which has no effect other than not being a possible end for a quote block) when doing quote-and-reply on a message that has a code block in it.  The annoying part of this is that we'd need to parse the message pretty thoroughly to do that.

",timabbott,b'area: markdown bug',2019-05-30T17:58:45Z,2020-02-05T01:41:55Z
12444,import: Handle hidden_by_limit case for files in slack import,Fixes #12011,hackerkid,b'area: export/import bug size: XS',2019-05-30T10:54:10Z,2019-05-30T19:01:48Z
12426,test-backend: Fix leaking of test databases on ctrl+C,"Currently, if you hit Ctrl+C while running out backend unit tests, we'll end up leaking copies of the test template databases:

```
zulip=> \l
                                            List of databases
             Name             |   Owner    | Encoding |   Collate   |    Ctype    |   Access privileges   
------------------------------+------------+----------+-------------+-------------+-----------------------
 postgres                     | postgres   | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 template0                    | postgres   | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
                              |            |          |             |             | postgres=CTc/postgres
 template1                    | postgres   | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
                              |            |          |             |             | postgres=CTc/postgres
 zulip                        | zulip      | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_base                   | zulip      | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test                   | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_base              | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template          | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_1        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_10       | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_11       | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_12       | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_13       | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_14       | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_15       | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_2        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_3        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808201 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808202 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808203 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808204 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808205 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808206 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808207 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808208 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808209 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808210 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808211 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_33808212 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_4        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_5        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_6        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_7        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550101 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550102 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550103 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550104 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550105 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550106 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550107 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550108 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550109 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550110 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550111 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_70550112 | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_8        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 zulip_test_template_9        | zulip_test | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
(47 rows)
```

Actually, I think we leak them unconditionally right now; possibly because the code in `teardown_test_environment` is confused.... I tried the below patch, but it did not seem to fix the problem (I don't know why).

```
diff --git a/zerver/lib/test_runner.py b/zerver/lib/test_runner.py
index dcbb33ef32..ee740e45f1 100644
--- a/zerver/lib/test_runner.py
+++ b/zerver/lib/test_runner.py
@@ -406,13 +406,7 @@ class Runner(DiscoverRunner):
         return super().setup_test_environment(*args, **kwargs)
 
     def teardown_test_environment(self, *args: Any, **kwargs: Any) -> Any:
-        # No need to pass the database id now. It will be picked up
-        # automatically through settings.
-        if self.parallel == 1:
-            # In parallel mode (parallel > 1), destroy_test_databases will
-            # destroy settings.BACKEND_DATABASE_TEMPLATE; we don't want that.
-            # So run this only in serial mode.
-            destroy_test_databases()
+        destroy_test_databases(_worker_id)
         return super().teardown_test_environment(*args, **kwargs)
 
     def test_imports(self, test_labels: List[str], suite: unittest.TestSuite) -> None:

```

We should figure out some solution for preventing this, and possibly also a solution for cleaning them up regularly (e.g. whenever we rebuild the test database, run a query to drop any leaked via `ctrl+C`).  ",timabbott,b'area: testing-infrastructure bug priority: high',2019-05-28T22:55:24Z,2019-07-23T14:14:09Z
12415,setup-apt-repo: Try to download pre-setup deps before skipping update,"Simulate isn’t enough in some cases.  The error message when this fails looks sufficiently non-alarming.

LXC:

    default: + apt-get -dy install lsb-release apt-transport-https gnupg
    default: Reading package lists...
    default: Building dependency tree...
    default:
    default: Reading state information...
    default: lsb-release is already the newest version.
    default: gnupg is already the newest version.
    default: The following NEW packages will be installed:
    default:   apt-transport-https
    default: 0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
    default: Need to get 25.1 kB of archives.
    default: After this operation, 238 kB of additional disk space will be used.
    default: Err http://archive.ubuntu.com/ubuntu/ trusty-updates/main apt-transport-https amd64 1.0.1ubuntu2.3
    default:   404  Not Found [IP: 91.189.88.161 80]
    default: Err http://security.ubuntu.com/ubuntu/ trusty-security/main apt-transport-https amd64 1.0.1ubuntu2.3
    default:   404  Not Found [IP: 91.189.88.161 80]
    default: E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/a/apt/apt-transport-https_1.0.1ubuntu2.3_amd64.deb  404  Not Found [IP: 91.189.88.161 80]
    default:
    default: E: Some files failed to download
    default: + apt-get update
    […]
    default: Fetched 4,504 kB in 7s (611 kB/s)
    default: Reading package lists...
    default: + apt-get -y install lsb-release apt-transport-https gnupg
    default: Reading package lists...

Docker:

    default: + apt-get -dy install lsb-release apt-transport-https gnupg
    default: Reading package lists...
    default: Building dependency tree...
    default:
    default: Reading state information...
    default: Package gnupg is not available, but is referred to by another package.
    default: This may mean that the package is missing, has been obsoleted, or
    default: is only available from another source
    default: E: Package 'gnupg' has no installation candidate
    default: + apt-get update
    […]
    default: Fetched 16.2 MB in 5s (3,326 kB/s)
    default: Reading package lists...
    default: + apt-get -y install lsb-release apt-transport-https gnupg
    default: Reading package lists...

(All in green.)

**Testing Plan:** Tested `vagrant up` with LXC and Docker providers.",andersk,b'area: provision bug size: XS',2019-05-27T22:15:17Z,2019-07-18T03:30:51Z
12411,backtrace when attempting to synchronise thumbnailPhoto onto S3 backend,"```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/views/auth.py"", line 647, in login_page
    extra_context=extra_context, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/contrib/auth/views.py"", line 54, in inner
    return func(*args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/contrib/auth/views.py"", line 150, in login
    )(request)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/views/generic/base.py"", line 68, in view
    return self.dispatch(request, *args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/views/decorators/debug.py"", line 76, in sensitive_post_parameters_wrapper
    return view(request, *args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/views/decorators/cache.py"", line 57, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/utils/decorators.py"", line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/contrib/auth/views.py"", line 90, in dispatch
    return super(LoginView, self).dispatch(request, *args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/views/generic/base.py"", line 88, in dispatch
    return handler(request, *args, **kwargs)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/views/generic/edit.py"", line 182, in post
    if form.is_valid():
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/forms/forms.py"", line 183, in is_valid
    return self.is_bound and not self.errors
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/forms/forms.py"", line 175, in errors
    self.full_clean()
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/forms/forms.py"", line 385, in full_clean
    self._clean_form()
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/forms/forms.py"", line 412, in _clean_form
    cleaned_data = self.clean()
  File ""./zerver/forms.py"", line 283, in clean
    realm=realm, return_data=return_data)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/contrib/auth/__init__.py"", line 70, in authenticate
    user = _authenticate_with_backend(backend, backend_path, request, credentials)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django/contrib/auth/__init__.py"", line 116, in _authenticate_with_backend
    return backend.authenticate(*args, **credentials)
  File ""./zproject/backends.py"", line 431, in authenticate
    password=password)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django_auth_ldap/backend.py"", line 150, in authenticate
    user = self.authenticate_ldap_user(ldap_user, password)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django_auth_ldap/backend.py"", line 210, in authenticate_ldap_user
    return ldap_user.authenticate(password)
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django_auth_ldap/backend.py"", line 350, in authenticate
    self._get_or_create_user()
  File ""/home/zulip/deployments/2019-05-20-11-38-33/zulip-py3-venv/lib/python3.6/site-packages/django_auth_ldap/backend.py"", line 591, in _get_or_create_user
    self._user, built = self.backend.get_or_build_user(username, self)
  File ""./zproject/backends.py"", line 500, in get_or_build_user
    self.sync_avatar_from_ldap(user_profile, ldap_user)
  File ""./zproject/backends.py"", line 307, in sync_avatar_from_ldap
    upload_avatar_image(BytesIO(ldap_user.attrs[avatar_attr_name][0]), user, user)
  File ""./zerver/lib/upload.py"", line 769, in upload_avatar_image
    upload_backend.upload_avatar_image(user_file, acting_user_profile, target_user_profile)
  File ""./zerver/lib/upload.py"", line 402, in upload_avatar_image
    content_type = guess_type(user_file.name)[0]
AttributeError: '_io.BytesIO' object has no attribute 'name'
```",akumria,b'area: authentication area: uploads bug priority: high',2019-05-27T07:34:07Z,2019-07-23T14:14:09Z
12385,stream settings: Disable Mobile notifications if push bouncer not set up.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->

Fixes #12208 
Continue work of PR #12217 

",YJDave,b'area: stream settings bug size: L',2019-05-23T06:36:54Z,2019-06-24T11:47:28Z
12383,bots: Bots can post to announcement-only streams if their owner can.,"Bot owned by a non-admin gets blocked, and one owned by an admin
can post to announcement-only stream.

Fixes: #12310.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
#12310

**Testing Plan:** <!-- How have you tested? -->
Wrote automated unit tests

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
Note: While writing tests for this issue I discovered few buggy tests (see: https://chat.zulip.org/#narrow/stream/49-development-help/topic/.2Fapi.2Fv1.2Fmessages.20vs.20.2Fjson.2Fmessages.20endpoint for context). I will be fixing them in another PR. ",thedeveloperr,b'area: bots bug priority: high size: L',2019-05-23T01:05:53Z,2019-05-28T01:46:48Z
12381,Fix LDAP avatar synchronization not checking if the avatar has changed,"The comments starting here https://github.com/zulip/zulip-desktop/issues/695#issuecomment-493252147 have more details, but basically, when we run `manage.py sync_ldap_user_data` with a thumbnailPhoto field configured, we end up re-uploading (and re-notifying about) every user's avatar regardless of whether or not they've actually changed, which is really expensive in a bunch of ways.  

Ideally, we'd be able to prevent that by just comparing the image content, but if that proves difficult (because of e.g. thumbnailing), we could store a hash of the original avatar image somewhere (maybe `RealmAuditLog` for lack of a better idea?) and use that to check whether there's a new value.

@HarshitOnGitHub @shubham-padia this is a high priority LDAP auth backend issue.

",timabbott,b'area: authentication bug priority: high',2019-05-22T21:42:23Z,2019-07-23T14:14:08Z
12377,Move wrong password warning to next to the password field when fetching an API key through setting modal,"Original chat: https://chat.zulip.org/#narrow/stream/6-frontend/topic/show.20a.20warning.20when.20password.20is.20wrong.20(fetch.20api.20key)/near/744694

When we want to fetch an API key from the setting modal, we have to input our password, but if the submitted password is wrong, the warning is shown at the top of the setting modal instead of being shown next to the password field. This is pretty confusing since most of the users won't notice the warning because they have to scroll to the top of the modal first.

How to reproduce:
1. Log in to Zulip.
2. Open settings.
3. In ""Your account"" tab, scroll down and find the API key section.
4. Click on ""Show/change your API key""
5. Fill a wrong password in the current password field.
6. Click on ""Get API key"" button

Then the warning will be shown at the top of the setting modal.

Expected result:

The warning should be shown next to the password field.",refeed,b'area: settings (user) bug',2019-05-22T17:44:56Z,2019-08-15T23:59:12Z
12369,stream settings: Clicking outside stream permissions modal doesn't close it.,"Edit: the issue below is resolved, but see the messages from me and Yash starting at https://github.com/zulip/zulip/issues/12369#issuecomment-499759044

To reproduce:
* As Iago, go to stream settings, and click on a stream
* Click `[Change]` on the line that describes the stream permissions
* Click anywhere outside the modal that pops up.

It should close the modal; instead, the click goes through. ",rishig,b'area: stream settings bug help wanted',2019-05-21T07:11:54Z,2020-07-23T20:09:38Z
12366,dependencies: Upgrade simplebar to 4.0.0,"Fixes #12347.

**Testing Plan:** Dragged the settings scrollbar, releasing the mouse outside the modal; observed that the modal doesn’t spuriously close.",andersk,b'area: general UI bug size: S',2019-05-21T02:55:43Z,2019-07-18T03:30:53Z
12363,user_profile_modal: Move SimpleBar back to the correct div,"Fixes a regression in commit 01613e71fbf17468eb1759bb7bffb124ee23acdf (#12348).

**Testing Plan:** Opened a user profile.",andersk,b'area: general UI bug size: XS',2019-05-21T01:10:46Z,2019-07-18T03:30:56Z
12360,dependencies: Update yarn.lock for simplebar@4.0.0-alpha.9 upgrade,"This somehow got dropped from commit 491589579ad737a3a5a7959b275ee473a5971fd1. We were ~~installing the right package anyway~~ (not anymore, now that simplebar@4.0.0 is released) but `yarn` wasn’t happy.",andersk,b'area: provision bug size: S',2019-05-20T22:38:06Z,2019-05-21T02:32:23Z
12359,restore-backup: Run zulip-puppet-apply before pg_restore.,"This should ensure that we apply any special configuration for the
database system (e.g. installing `pgroonga`) before we try to restore
the database contents from the archive.

For pgroonga in particular, this is important so that we can preserve
the configuration of the extension in the `pg_restore` process.

Fixes #12345.",timabbott,b'area: search bug has conflicts size: S',2019-05-20T22:03:56Z,2019-06-06T23:38:39Z
12347,Scrollbar drag can result in unintended click actions,"Split off from #11792:

> * on the settings pages, if you click on the scrollbar, drag it down, and then release your click when the mouse is outside the settings modal (e.g. below it or to the right), it closes the settings modal. I don't know if this is an existing thing or a regression, but I ran into it a bunch of times when testing even after knowing the behavior.

This was not a regression from perfect-scrollbar, but I fixed it in Grsmto/simplebar#312 and Grsmto/simplebar#317. Just waiting for the fixes to be included in a new upstream release.",andersk,b'area: general UI bug',2019-05-17T20:34:14Z,2019-05-24T00:31:09Z
12345,Migration fails for installation using pgroonga,"Migrating to an Ubuntu 18.04 server from an older Ubuntu 18.04 server with pgroonga fails with pgroonga error.

Steps:

1. Make backup:

```
# As the zulip user
/home/zulip/deployments/current/manage.py backup
```

2. Copy file to new server.

3. Restore backup: https://zulip.readthedocs.io/en/latest/production/maintain-secure-upgrade.html#restoring-backups

4. See this error:

```
/home/zulip/deployments/current/scripts/setup/restore-backup zulip-backup-2019-05-17-07-05-08-7ocx478_.tar.gz 
+ tar -C /tmp/zulip-restore-backup-i3a6cqrd '--transform=s|^zulip-backup/settings(/.*)?$|/etc/zulip\1|x' '--transform=s|^zulip-backup/zproject(/.*)?$|/home/zulip/deployments/2019-05-17-06-56-58/zproject/../zproject\1|x' '--transform=s|^zulip-backup/uploads(/.*)?$|/home/zulip/uploads\1|x' -xPz
+ chown -R postgres -- /tmp/zulip-restore-backup-i3a6cqrd
+ /home/zulip/deployments/2019-05-17-06-56-58/zproject/../scripts/setup/terminate-psql-sessions zulip zulip zulip_base
 pg_terminate_backend 
----------------------
 t
 t
 t
 t
(4 rows)

+ su -s /usr/bin/env - -- postgres dropdb --if-exists -- zulip
+ su -s /usr/bin/env - -- postgres createdb -O zulip -T template0 -- zulip
+ su -s /usr/bin/env - -- postgres pg_restore -d zulip -- /tmp/zulip-restore-backup-i3a6cqrd/zulip-backup/database
pg_restore: [archiver (db)] Error while PROCESSING TOC:
pg_restore: [archiver (db)] Error from TOC entry 3; 3079 28338 EXTENSION pgroonga 
pg_restore: [archiver (db)] could not execute query: ERROR:  could not open extension control file ""/usr/share/postgresql/10/extension/pgroonga.control"": No such file or directory
    Command was: CREATE EXTENSION IF NOT EXISTS pgroonga WITH SCHEMA public;



pg_restore: [archiver (db)] Error from TOC entry 4525; 0 0 COMMENT EXTENSION pgroonga 
pg_restore: [archiver (db)] could not execute query: ERROR:  extension ""pgroonga"" does not exist
    Command was: COMMENT ON EXTENSION pgroonga IS 'Super fast and all languages supported full text search index based on Groonga';



pg_restore: [archiver (db)] Error from TOC entry 3932; 1259 38414 INDEX zerver_message_search_pgroonga zulip
pg_restore: [archiver (db)] could not execute query: ERROR:  access method ""pgroonga"" does not exist
    Command was: CREATE INDEX zerver_message_search_pgroonga ON zulip.zerver_message USING pgroonga (search_pgroonga);



pg_restore: [archiver (db)] Error from TOC entry 4526; 0 0 ACL SCHEMA pgroonga postgres
pg_restore: [archiver (db)] could not execute query: ERROR:  schema ""pgroonga"" does not exist
    Command was: GRANT USAGE ON SCHEMA pgroonga TO zulip;



WARNING: errors ignored on restore: 4

Error running a subcommand of /home/zulip/deployments/current/scripts/setup/restore-backup: su -s /usr/bin/env - -- postgres pg_restore -d zulip -- /tmp/zulip-restore-backup-i3a6cqrd/zulip-backup/database
Actual error output for the subcommand is just above this.

Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/setup/restore-backup"", line 122, in <module>
    restore_backup(tarball_file)
  File ""/home/zulip/deployments/current/scripts/setup/restore-backup"", line 97, in restore_backup
    run(as_postgres + [""pg_restore"", ""-d"", db_name, ""--"", db_dir])
  File ""/home/zulip/deployments/current/scripts/lib/zulip_tools.py"", line 203, in run
    subprocess.check_call(args, **kwargs)
  File ""/usr/lib/python3.6/subprocess.py"", line 291, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['su', '-s', '/usr/bin/env', '-', '--', 'postgres', 'pg_restore', '-d', 'zulip', '--', '/tmp/zulip-restore-backup-i3a6cqrd/zulip-backup/database']' returned non-zero exit status 1.
```

I think I probably have to install pgroonga on the new server.  But 

a. where are these directions?  should I just use https://zulip.readthedocs.io/en/latest/subsystems/full-text-search.html ?

b. shouldn't this be part of the backup/restore directions since it can prevent restore?

c. Did @kou say this documentation specific to pgroonga during restore exists somewhere?  

@kou This continues a conversation you started in #12206.",stone212,b'area: search bug',2019-05-17T08:06:44Z,2019-07-03T08:32:07Z
12329,Pasted images don't obey embedded color profile,"Images which are pasted in (thanks for doing #7130 !) don't have their color profile retained/respected, but images which are uploaded do.

Using a test image from [this stack overflow](https://superuser.com/questions/313397/should-i-embed-the-srgb-color-profile-in-jpeg-files) which github also fails at.

This is how it will look if color profiles in the image aren't being pasted in/respected:
![image](https://user-images.githubusercontent.com/32879218/57794901-9594c500-76f9-11e9-8d2a-62291bbb05bc.png)

This is how it looks when they're kept attached to the image:
![image](https://user-images.githubusercontent.com/32879218/57794990-c2e17300-76f9-11e9-8449-5b1b39d5db92.png)

Here's how Zulip displays a pasted in image:
![image](https://user-images.githubusercontent.com/32879218/57795033-dbea2400-76f9-11e9-94de-690a2b756b32.png)

 Here's how Zulip displays an uploaded image:
![image](https://user-images.githubusercontent.com/32879218/57795061-ea384000-76f9-11e9-9873-0e3fed28d987.png)

And for comparison, here's it working in hangouts:
![image](https://user-images.githubusercontent.com/32879218/57795119-089e3b80-76fa-11e9-8ae9-be1f0f6472b6.png)

This leads me to believe that the color profile information is available in the buffer, but getting thrown out when pasted in.

Tested on CentOS 7 with AppImage (2.5.0 beta) and the web app in Chrome. Will test pasting on OSX.",swallitsch,b'area: compose area: uploads bug help wanted',2019-05-15T17:14:01Z,2019-05-17T00:08:29Z
12310,Bots should be able to post to announcement-only streams if their owner can,"Our general model for bots is that they can post to places their owner can, to help simplify setup for bots that need to post to private streams.  The same reasoning applies to posting to announcement_only streams, which we hadn't thought about.  

I think the change we want is something like this, but it needs unit tests, both that a bot owner by a non-admin still gets blocked, and one owned by an admin can:

```
diff --git a/zerver/lib/actions.py b/zerver/lib/actions.py
index 5012b694ee..4cb81200b1 100644
--- a/zerver/lib/actions.py
+++ b/zerver/lib/actions.py
@@ -2162,7 +2162,12 @@ def validate_sender_can_write_to_stream(sender: UserProfile,
     # matches the realm of the sender.
 
     if stream.is_announcement_only:
-        if not (sender.is_realm_admin or is_cross_realm_bot_email(sender.email)):
+        if sender.is_realm_admin or is_cross_realm_bot_email(sender.email):
+            pass
+        elif sender.is_bot and (sender.bot_owner is not None and
+                                sender.bot_owner.is_realm_admin):
+            pass
+        else:
             raise JsonableError(_(""Only organization administrators can send to this stream.""))
 
     if not (stream.invite_only or sender.is_guest):
```

Tagging it as a priority mainly because this is a correctness issue and likely quick to fix.",timabbott,b'area: bots bug help wanted priority: high',2019-05-09T21:20:03Z,2019-07-23T14:14:07Z
12303,Creating and using API keys with sAMAccountname email mapping ,"_Probably_ relates to a similar issue #11878 which results in improper mapping of email and sAMAccountname. When attempting to create my user API key via User settings, it repeatedly prompts `Error getting API key: Your username or password is incorrect.`",alfonsrv,b'area: authentication bug priority: high',2019-05-08T19:26:24Z,2019-10-25T20:29:54Z
12301,streams: Update description for stream-privacy-type.,"Fixes #10524
@rishig @timabbott 
Let me know if there are any changes required with wording or settings checkbox.",YJDave,b'area: stream settings bug priority: high size: S',2019-05-08T09:06:28Z,2019-06-12T18:19:44Z
12300,"Disable ""All streams"" for guest user","Fixes #10980
Closes PR #11482 

Thank you @matkaczmarek for your work! 

![image](https://user-images.githubusercontent.com/25907420/57355833-9030fb00-718c-11e9-9edf-5a6a9821cad4.png)

![image](https://user-images.githubusercontent.com/25907420/57360989-118e8a80-7199-11e9-82ab-3f8c050123f9.png)


",YJDave,b'area: stream settings bug size: L',2019-05-08T08:31:46Z,2019-05-20T07:36:32Z
12289,ldap: Do not modify self._LDAPUser.attrs in test_query_email_attr.,"Fixes #12273.
When running the test_query_email_attr test in reverse, the test failed
because self._LDAPUser.attrs was being modified and it was being shared
with other tests.

Testing:
`./tools/test-backend --parallel=1 --reverse zerver.tests.test_auth_backends.TestQueryLDAP`",shubham-padia,b'area: authentication area: testing-coverage bug priority: high size: XS',2019-05-07T07:55:45Z,2019-05-08T16:56:13Z
12284,settings node tests: Clean up use of `test_realm_boolean` for non-boolean fields,"In `frontend_tests/node_tests/settings_org.js`, our tests for `create_stream_policy` and related features feel like they're somewhat brittle/not fully thought through.  In particular:
* There's sorta a weird mixture of string values like `'1'` and integer values like `0` for integer-format fields in the expected_value structure
* We use `test_realm_boolean` in `frontend_tests/node_tests/dispatch.js` for some fields that are integers, not boolean; we should either change its model to match some of other property types tests on the backend that can support multiple data types (and rename it to `test_realm_property` or something), or add a similar function for integers.  I think I prefer the former model if we can make it work.

@pragatiagrawal31 @shubhamdhama FYI.",timabbott,b'area: settings UI area: testing-coverage bug help wanted in progress',2019-05-06T23:36:36Z,2020-04-03T00:37:56Z
12283,Add test data for soft deactivation with multiple streams,"To fix CI, I merged 3ecdabdc77202839ba9abf20bbf29b53c3d47fb6, but we should have an actual test covering that code path (where messages were sent to multiple streams during the window where the user was soft-deactivated).

@punchagan @adnrs96 FYI",timabbott,b'area: production bug help wanted priority: high',2019-05-06T23:16:21Z,2019-05-08T21:44:55Z
12281,Invitations are removed from the list too soon,"Invitations are removed from the list of invitations when the registration page is opened, not when the user registers.

I invited someone to a self-hosted Zulip organization. I know they received the invite because I saw the email on their phone when they were asking me about it, and they clicked on it and loaded the sign-up page. But now, they're still not registered, and yet I don't see them in the list of outstanding invitations. I can't positively affirm that they *were* listed, but I'm assuming they were.

I reproduced this by inviting myself at another email address, confirming that the invite was visible in the invitations list, clicking on the invite link in the email, then confirming that I was no longer visible in the invitations list.

The invitations list data is generated in [the `do_get_user_invites()` function in zerver/lib/actions.py](https://github.com/zulip/zulip/blob/d4715f23d77b2337168bf1fb2b5a870ef0c1b49d/zerver/lib/actions.py#L4928), though fixing this may require touching more code than just that.",cyphase,b'area: settings (admin/org) bug good first issue help wanted',2019-05-06T22:11:42Z,2020-05-27T04:45:45Z
12274,Navigating to more topics closes sidebar,"Navigating to 'more topics' of any stream closes the sidebar (for devices with smaller displays like phones) and the user is taken to the previous stream he/she was on. 

We want to change this behaviour to not close the sidebar and show 'more topics' keeping the sidebar open.

Discussion [here](https://chat.zulip.org/#narrow/stream/9-issues/topic/Click.20on.20'More.20Topics'.20closes.20sidebar/near/739250).",vsvipul,b'area: left-sidebar bug good first issue help wanted',2019-05-06T02:39:57Z,2019-07-23T14:14:06Z
12273,Fix broken LDAP test when running tests in reverse order,"We had to disabled one of our LDAP tests in https://github.com/zulip/zulip/commit/26ef199a703e7506db0107c97f07417d45da1150, because it was broken; we should fix it so we can re-enable the test.",timabbott,b'area: authentication area: testing-coverage bug priority: high',2019-05-06T00:24:28Z,2019-07-23T14:14:06Z
12258,Fade save/discard buttons more quickly if you toggle back the last setting,"If you just double-toggle a checkbox in ""organization settings"", the ""save/discard"" widget for that settings section stays around for a few hundred milliseconds before starting to disappear; I think it should start disappearing immediately.

While we're at it, I think it'd be valuable to have a (short) minimum time for the ""saving"" animation of like 100ms so that you see that state in the development environment; right now it feels a bit jarring that the thing just flashes and then says ""saved"" immediately.

@pragatiagrawal31 FYI since you did the last round of changes here.",timabbott,b'area: settings (admin/org) area: settings UI bug in progress priority: high',2019-05-03T19:44:47Z,2019-08-21T23:48:11Z
12244,webhooks/jira: Ignore comment_created message.,"comment_created payloads may not contain the required issue data
to format a useful notification, therefore, it is better to handle
issue comments through issue_updated events (which we already do).

Fixes: #11995

@timabbott: FYI :)",eeshangarg,b'area: integrations bug size: XL',2019-05-01T23:10:07Z,2019-05-01T23:33:50Z
12242,bugdown: Fix double processed emoji tags inside inline tags.,"When an emoji is nested inside another inline tag, like em or strong
it was getting double processed because of the way the inlinePattern
TreeProcessor runs (it runs recursively). With this fix, we set the
inner text of the emoji span as an AtomicString, preventing us from
double processing the emoji's text.

Fixes #11621

Test Plan: Added test case for **:smile:**, verify it passes. Go into
local dev server and send ""**:smile:**"" to self and verify the DOM
does not have double <span> tags for the emoji.",okayzed,b'area: emoji area: markdown bug priority: high size: S',2019-05-01T19:06:20Z,2019-05-02T00:03:49Z
12239,Linkifier URL validation regex is broken,"The linkifier validation regex doesn't allow things like ampersands (for query parameters) or forward slashes following the last placeholder.

Ampersand example: https://example.com/?foo=bar&id=%(id)s
Forward slash example: https://example.com/product/%(id)s/details

Either of those results in a validation error saying ""Invalid URL format string"".

[Here's the relevant function as of the latest commit](https://github.com/zulip/zulip/blob/272ed9068590e575e09c5abaeffca48040164873/zerver/models.py#L635):

```python
def filter_format_validator(value: str) -> None:
    regex = re.compile(r'^([\.\/:a-zA-Z0-9#_?=-]+%\(([a-zA-Z0-9_-]+)\)s)+[a-zA-Z0-9_-]*$')

    if not regex.match(value):
        raise ValidationError(_('Invalid URL format string.'))
```

Note that in the first character set, which is for what comes before a placeholder, there's no ampersand (or semi-colon), and in the third character set, which is for what comes after the last placeholder, there's less; not even a forward slash, which is what blocks the second example above.

The second character set is for the placeholder names. This is also broken in practice, because it allows hyphens. While placeholders are allowed to have hyphens in Python, named groups in regular expressions are not, since they have to be valid Python identifiers. This could come up if someone tries to use a name with a hyphen, only gets a validation error for the regex, and mistakenly changes it only there, not in both places.

Which segues into something that should probably be its own issue, since it goes beyond the regex itself, but I'll mention it here. It's possible to have non-paired named groups and placeholders. If there are named groups that don't have a matching placeholder, they're just silently dropped, which isn't breakage but may not be ideal. However, if there are placeholders that don't have a matching named group, the message isn't sent, although it still appears in the sending client instance, with the target string linkified with the unfilled placeholder still visible in the URL. In the web and desktop clients, there are red Retry and Cancel buttons on the right when hovering over the message; Retry has no obvious effect, and Cancel removes the message. In the mobile client (on Android, but I assume it's the same on iOS), there's a spinner that isn't moving to the right of the message. Long pressing bring up the menu with an option to Delete, but since I'm an admin on this instance I can do that anyway, so I don't know if that's equivalent to Cancel from the web/desktop clients.

---

Here's the CZO thread that led to opening this issue: https://chat.zulip.org/#narrow/stream/9-issues/topic/linkifier.20URL.20issues

@timabbott mentioned a workaround that can be used in the interim to bypass the restrictive aspect of the validation regex:

> You can bypass that validator locally by using the Django command line (`manage.py shell`), e.g.:
> `realm_filter = RealmFilter.objects.create(realm_id=2, pattern='pattern', url_format_string='format string')`",cyphase,b'area: markdown bug',2019-05-01T02:30:40Z,2019-10-20T01:40:42Z
12234,settings: Don't check mobile notifications if they are disabled.,"Fixes #12198.
AFAIK there are no unit tests for settings_notifications, please let me know if that's not the case.

![Peek 2019-04-30 12-04](https://user-images.githubusercontent.com/13910561/56940310-1a031780-6b40-11e9-89a9-48aa0de1057b.gif)
",shubham-padia,b'area: settings (user) bug priority: high size: XS',2019-04-30T04:05:17Z,2019-04-30T23:36:17Z
12231,open graph: Use the complete URL for open graph URLs.,"Closes #12199

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

The og:url parameter is a [required parameter](http://ogp.me/) and should be the canonical URL for the page.  This PR changes the value of og:url from just the realm URL to the full URL of the page. 

**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",punchagan,b'area: portico bug size: S',2019-04-29T13:55:55Z,2019-05-06T00:53:49Z
12224,Return caret back to its original position after clicking link,"Fixes #6581

I did something similar to [@dgarvit PR](https://github.com/zulip/zulip/pull/6971). In this fix only elements in message compose box will be refocused, all other input elements will not (for example: `Search people` input).",Aasfga,b'area: message view bug has conflicts size: S',2019-04-28T13:14:39Z,2020-07-06T10:35:51Z
12220,settings: Fix broken headers in night mode.,"This bug turned out to pop up wherever a table existed in both
'settings' and 'organization settings', notably *excluding* both
'Custom Emoji' and 'Authentication Methods'.

The first thought to the solution was to simply add `thead` to the css
rule that applies the appropiate color for headers and the like.  This
was successful, however it brought attention to a sub-problem:

`emoji-settings-admin` and `auth-mehtod-settings-admin` were both
creating table headers in the body of the table. This was causing the
rows in these two tables to be colored inversely from all the others.
This is also the reason why these tables are the only ones correctly
styled. These handlebars were updated with the headers moved out of the
body.

The even and odd rows of the tables were then colored appropriately.

Fixes: #12209

All tables are now styled similarly to the following:
<img width=""811"" alt=""Screen Shot 2019-04-26 at 9 25 54 PM"" src=""https://user-images.githubusercontent.com/39782863/56846528-1172be80-686c-11e9-957e-69e860a7b21e.png"">


",whoodes,b'bug priority: high size: S',2019-04-27T07:43:42Z,2019-04-29T21:55:48Z
12218,Organization/Bots/Edit: Save Button is not clickable,"An admin with full privs looking at the organization bots page can click the edit button, and is free to modify the values presented, but the save button itself can not be clicked.

A slightly different description of this report is what caused me to open and close #12201 , but I've verified this issue this time across 2 different installs- one on ubuntu14, one of ubuntu18- both 2.0.2",swallitsch,b'area: settings (admin/org) bug',2019-04-26T23:11:49Z,2019-04-30T21:51:39Z
12209,Fix headings in organization settings for night mode,"I just noticed this on chat.zulip.org:

![image](https://user-images.githubusercontent.com/2746074/56766549-8788ff80-675e-11e9-8d70-1d90fc5ce912.png)
",timabbott,b'bug help wanted priority: high',2019-04-25T20:32:32Z,2019-07-23T14:14:05Z
12208,"stream settings: User should not be able to click on ""Mobile notifications"" if push bouncer is not set up.","In stream settings:
![image](https://user-images.githubusercontent.com/890911/56760333-d3807800-674f-11e9-92ea-3abd659103a2.png)

In Settings -> Notifications:
![image](https://user-images.githubusercontent.com/890911/56760391-ec892900-674f-11e9-9a77-9c50d458d6e1.png)

We should disable the ""Mobile notifications"" line in stream settings and add the question mark help (similar to how we do it Settinsg -> Notifications) when the push bouncer is not set up. There's already a field in `page_params` that indicates whether the push bouncer is set up or not, so should be pretty fast. 
",rishig,b'area: stream settings bug good first issue',2019-04-25T18:49:10Z,2019-06-25T00:26:56Z
12199,Open Graph og:url tags over-canonicalize all URLs back to the home page,"Split from #12187:

> By the way, it turns out all our OpenGraph tags are [busted anyway](https://developers.facebook.com/tools/debug/sharing/?q=https%3A%2F%2Fchat.zulip.org%2Fapi%2Fincoming-webhooks-walkthrough) because we always set `og:url` to point to the home page (which redirects to /login, whose `og:url` points back to the home page).",andersk,b'area: portico bug help wanted',2019-04-23T23:19:45Z,2019-07-23T14:14:44Z
12198,"notification settings bug: Visual toggling of ""Mobile"" in private messages UI","This issue is related to the messy `if_and` business in the settings_checkbox template.  Basically, the template has correct behavior, but whenever you toggle any setting, `settings_notifications.update_settings()` gets called, and that ends up always checking the checkbox for ""mobile"" in the private messages bundle, even though that checkbox was disabled.  

I believe the issue here is that `update_settings` should be taking into account the realm-level `page_params` value for whether push notifications are enabled in the organization.

Tagging as a priority since real-time sync issues like this can be really confusing for years.

@pragatiagrawal31 @shubhamdhama FYI",timabbott,b'area: settings (user) bug priority: high',2019-04-23T22:45:59Z,2019-07-23T14:14:44Z
12169,/etc/zulip/settings.py NOREPLY_EMAIL_ADDRESS vs TOKENIZED_NOREPLY_EMAIL_ADDRESS,"Hi, using latest Zulip server installed on my machine, I experience this behavior, which I think is confusing.

*/etc/zulip/settings.py*:
`EXTERNAL_HOST = 'discuss.internal.mysite.com'`

If I have settings like this:
```
# ADD_TOKENS_TO_NOREPLY_ADDRESS = True
TOKENIZED_NOREPLY_EMAIL_ADDRESS = ""noreply-{token}@mysite.com""
# Used for noreply emails only if ADD_TOKENS_TO_NOREPLY_ADDRESS=False
# NOREPLY_EMAIL_ADDRESS = """"
```

Invitations and test e-mails have correct `from` - tokenized noreply email address, as expected.
However private message reminders go from `noreply@discuss.internal.mysite.com`.

If I change setting to:
```
# ADD_TOKENS_TO_NOREPLY_ADDRESS = True
TOKENIZED_NOREPLY_EMAIL_ADDRESS = ""noreply-{token}@mysite.com""
# Used for noreply emails only if ADD_TOKENS_TO_NOREPLY_ADDRESS=False
NOREPLY_EMAIL_ADDRESS = ""noreply@mysite.com""
```
private messages have correct `from`: `noreply@mysite.com`

From the comment it looks like `NOREPLY_EMAIL_ADDRESS` is not used at all when `ADD_TOKENS_TO_NOREPLY_ADDRESS = True`, which is not true.
",vrozkovec,b'area: production bug priority: high',2019-04-19T18:51:30Z,2019-04-23T21:47:56Z
12134,"restore-backup: Reset cwd when switching to postgres, and open backup tarball as root","Fixes permission errors when running `restore-backup` from a cwd inaccessible to the `postgres` user, or on a tarball inaccessible to the `zulip` user.

Fixes: #12125.

**Testing Plan:** In a development install, ran `restore-backup` as root from `/root` on a tarball in `/root`.",andersk,b'bug priority: high size: M',2019-04-15T20:09:41Z,2019-07-18T03:30:52Z
12126,message editing: Pasting images then hitting ctrl+enter sends broken image link.,"When composing a message, if you try to send while an image is uploading, nothing happens.
When message editing, doing the same results in 

![image](https://user-images.githubusercontent.com/890911/56098874-63096980-5eba-11e9-825e-e7d1b4762632.png)

This was on a connection with ~0.5 mbps upload and download, but I suspect that only matters in that there is sufficient time to hit ""Ctrl+enter"" while the image is uploading.",rishig,b'area: message-editing bug help wanted',2019-04-14T20:43:26Z,2019-07-23T14:14:42Z
12125,restore-backup Fails,"Following the instructions from https://zulip.readthedocs.io/en/latest/production/maintain-secure-upgrade.html#backups:

1. Back up the database on current server and rsync to new server.

2. Follow step 1 and 2 from here https://zulip.readthedocs.io/en/latest/production/install.html

3. Back to page https://zulip.readthedocs.io/en/latest/production/maintain-secure-upgrade.html#backups run `/home/zulip/deployments/current/scripts/setup/restore-backup /path/to/backup` *as root* and see it fail:

```
root@zu2:~# /home/zulip/deployments/current/scripts/setup/restore-backup ./zulip-backup-2019-04-14-16-29-35-vdtkih7f.tar.gz 
tar (child): ./zulip-backup-2019-04-14-16-29-35-vdtkih7f.tar.gz: Cannot open: Permission denied
tar (child): Error is not recoverable: exiting now

gzip: stdin: unexpected end of file
tar: Child returned status 2
tar: Error is not recoverable: exiting now
+ tar -C /tmp/zulip-restore-backup-ba5ih62r --keep-directory-symlink -xzf ./zulip-backup-2019-04-14-16-29-35-vdtkih7f.tar.gz
tar (child): ./zulip-backup-2019-04-14-16-29-35-vdtkih7f.tar.gz: Cannot open: Permission denied
tar (child): Error is not recoverable: exiting now

gzip: stdin: unexpected end of file
tar: Child returned status 2
tar: Error is not recoverable: exiting now

Error running a subcommand of /home/zulip/deployments/current/scripts/setup/restore-backup: tar -C /tmp/zulip-restore-backup-ba5ih62r --keep-directory-symlink -xzf ./zulip-backup-2019-04-14-16-29-35-vdtkih7f.tar.gz
Actual error output for the subcommand is just above this.

Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/setup/restore-backup"", line 65, in <module>
    run([""tar"", ""-C"", tmp, ""--keep-directory-symlink"", ""-xzf"", args.tarball])
  File ""/home/zulip/deployments/current/scripts/lib/zulip_tools.py"", line 203, in run
    subprocess.check_call(args, **kwargs)
  File ""/usr/lib/python3.6/subprocess.py"", line 291, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['tar', '-C', '/tmp/zulip-restore-backup-ba5ih62r', '--keep-directory-symlink', '-xzf', './zulip-backup-2019-04-14-16-29-35-vdtkih7f.tar.gz']' returned non-zero exit status 2.
```",stone212,b'bug priority: high',2019-04-14T19:38:00Z,2019-04-16T01:04:14Z
12108,stream-edit: Empty edit stream-name makes the span styling ineffective ,"
![zulip](https://user-images.githubusercontent.com/26672113/56047041-dd17e200-5d44-11e9-951f-0d098518c1ab.gif)

Added vertical-align in subscriptions.scss to fix broken span styling in stream-name edit.

Fixes: #11923 ",matkaczmarek,b'area: stream settings bug size: XS',2019-04-12T15:14:45Z,2019-04-14T03:35:40Z
12086,message view: Fix Rerender left sidebar after changing hello topic.,"So if we edit hello topic the message_id of hello topic goes
to -Infinity. If we ignore the topic with message_id equals to
-Infinity then this fixes issue.

Fix #11901


![Peek 2019-04-10 01-36](https://user-images.githubusercontent.com/32260593/55831719-6d7dd900-5b31-11e9-874e-b572e74aff78.gif)

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",ss62171,b'area: message view area: onboarding bug size: S',2019-04-09T20:09:58Z,2019-09-18T18:25:19Z
12080,markdown: Fix list indicators rendering for bullet list.,"Previously, the frontend javascript processor didn't treat
`+ -` as bullet list indicators, thus rendering different
ouptut from that of backend.

This was due to the change in list definiton when we make
when rendering tables which results into removal of `+ -`
and only `*` is treated as bullet list indicator, added
conditions to change back to original bullet list regex
when table is not encountered.

Fixes #11860

![fix-list-indicators](https://user-images.githubusercontent.com/41135524/55695774-c3d70480-59d7-11e9-8dd6-ff086ebfd81d.gif)
",gaharavara,b'area: markdown bug has conflicts size: S',2019-04-08T02:55:08Z,2019-12-11T01:17:48Z
12073,message view: Reduce extra white space above quotes and unordered lists.,"Blockquotes and unordered lists had a large amount of space above them when preceded by a `p` tag.
This change reduces this white space with negative margins.

Fixes #11631.

**Screenshots :** [UPDATED]

**Before** : (czo)

![Screenshot_1](https://user-images.githubusercontent.com/25329595/55759290-95f4cd00-5a76-11e9-84f0-4cea20e1e2fb.png)

**After** :

![vertical spacing](https://user-images.githubusercontent.com/25329595/55759165-5cbc5d00-5a76-11e9-8ff1-6e054cb2e824.png)

",vinitS101,b'area: message view bug size: S',2019-04-06T16:51:50Z,2019-04-11T07:05:52Z
12067,Narrowing to re-subscribed stream scrolls to last subscribed message,"I recently rejoined a stream that I had left a few years ago, and now every time I narrow to the stream it scrolls me back to the last message sent before I unsubscribed.

I've tried scrolling to the most recent message (by pressing the `End` key and by going through all the messages with the `j` key), and I've tried using the stream drop-down option `Mark all messages in <stream> as read`, but the behavior persists.

I'm not sure what else to try, or how better to describe this problem. I'll also contact @timabbott on that Zulip instance to offer more debugging / troubleshooting / information gathering.",jasonaowen,b'area: message view bug priority: high',2019-04-05T14:55:45Z,2019-09-18T20:35:22Z
12038,user docs: Clicking on article in multiple sections breaks scrollbar.,"To repro:
* Make your window not too tall
* Go to localhost:9991/help
* Click **Stream Management** in the left sidebar
* Click **Add or remove users from a stream**

And then try to scroll around the left sidebar. 
Note that directly going to http://localhost:9991/help/add-or-remove-users-from-a-stream doesn't cause this broken behavior. ",rishig,b'area: documentation (user) bug help wanted',2019-04-02T23:40:11Z,2019-07-23T14:14:39Z
12023,markdown: Fix unordered list not rendering in blockquote.,"This fixes an issue where the hanging unordered list was not
rendering in blockquote; the problem was that we were not
adding an empty line(to satisfy the markdown) for hanging
unordered list if it is in blockquote. Both blockquote
and code block is fenced but we want to avoid rendering
the list if it's in the code block but not in blockquote.

Fixes: #11916.

**Testing Plan:** 
Tested manually and updated automated test
",overide,b'area: markdown bug size: S',2019-03-31T17:42:20Z,2019-04-14T02:24:00Z
12011,Slack import fails with KeyError: 'url_private' due to 'hidden_by_limit',"This bug is similar to #11619  except than the mode being 'tombstone' it's 'hidden_by_limit'. 

My hypothesis is that we were using a community slack version which caps displayed messages at 10k, but they keep all the messages available so you can unlock them w/ a paid plan later. 


",mikegcoleman,b'area: export/import bug',2019-03-30T02:50:00Z,2019-05-30T19:06:05Z
11995,Jira to Zulip stream integration,"We just integrated the webhook into a stream.  The idea is that any critical ticket that is created and commented on shows up in a ""critical issues"" Stream in Zulip.  Though we didn't specify topics, each ticket that is created shows up in the ""critical issues"" stream with a topic of the ticket number.  For now, this is fine.  But when people comment on the critical ticket, it shows up in a "":"" topic.  So if there are multiple comments from multiple tickets, they all appear in the "":"" topic. 

![image](https://user-images.githubusercontent.com/48458920/55033827-99e61100-4fd9-11e9-82ce-ed31766c7913.png)

Is there a way to have the comments to the tickets show up under the correct topics?",Mentalone,b'area: integrations bug',2019-03-26T21:13:48Z,2019-05-01T23:34:36Z
11990,"Disable ""w"" hotkey when settings dropdown menu is open.","Ideally the settings dropdown should close when we use ""w"" shortcut to search users.
![ezgif com-video-to-gif(4)](https://user-images.githubusercontent.com/30211121/55011147-7d62cc80-500b-11e9-8910-9ea6044b52e7.gif)
",2208Abhinav,b'area: keyboard UI bug',2019-03-26T15:39:04Z,2020-02-03T21:45:26Z
11963,Add responsive styling for individual /integrations/doc/ pages.,"@timabbott @rishig 

This is ready for review.
![Screenshot from 2019-03-21 14-47-18](https://user-images.githubusercontent.com/25278879/54742791-590c8780-4be8-11e9-827e-f3088e20e909.png)

I went through all of this - https://chat.zulip.org/#narrow/stream/137-feedback/topic/Zulip.20Integration.20Docs.20on.20Mobile/near/708632 

The reason why I didn't use a logo because there was a particular a `div` that contained the logo along with the box and all and it was appearing on the web version of the page and by default, it was hidden for mobile pages(`display:none`). Making any changes to that div was altering the whole design. So, I instead copied the `img` tag and tried using the place, I wanted the logo to appear. But, it was not working. So, I opted to use this.

I think the current design is simple and does the work. Let me know.
This PR closes the https://github.com/zulip/zulip/issues/11701",sameerchoubey,b'area: documentation (api and integrations) bug priority: high size: S',2019-03-21T09:19:39Z,2019-05-21T06:41:33Z
11938,Errors when changing password do not display,"I attempted to change my password to the string `""Q|~>(I%$9r*IctB1yRBWJL""|`. This does not change my password, but this is unclear from the UI. I think what might be happening is an error appears for a moment, but the page is immediately reloads, dismissing the error.",WesleyAC,b'area: settings (user) bug priority: blocker',2019-03-19T02:06:18Z,2019-03-19T05:16:59Z
11937,Fix social auth backend handling of attempts to login by deactivated users,"We just got a report that while trying to login with our Google auth backend with an email address that has a deactivated account did something reasonable (took them back to /login with a clear error message), our GitHub backend took them back to /login and then redirected again to /accounts/go.  So it seems likely we have buggy error handling in SocialAuthBackend for this error situation.  We should investigate and fix.  Tagging as a priority because investigating this is probably a blocker for #11450.

@HarshitOnGitHub FYI.",timabbott,b'area: authentication bug priority: high',2019-03-18T21:34:31Z,2019-07-23T14:14:37Z
11925,Email mirror: change stream name encoding in mirror addresses,"PR for issue https://github.com/zulip/zulip/issues/9840

This implements Tim's suggested approach at https://github.com/zulip/zulip/issues/9840#issuecomment-434876717

1. We make email_token a unique column.
2. We make stream_name in the receiving address completely ignored, the code only looks at the token to decide to which stream it should send the message.
3. We change how the stream name gets encoded - I decided to go for django's slugify function, since in my mind it seems to be perfect for this: https://docs.djangoproject.com/en/2.1/ref/utils/#django.utils.text.slugify
Things like Cyrillic characters just get dropped by slugify, which means the stream name can get ""slugified"" to an empty stream. We cover this case by skipping the stream_name part in that case. decode_email_address is prepared for this scenario too.",mateuszmandera,b'area: notifications (other) bug priority: high size: XL',2019-03-17T12:46:14Z,2019-03-18T18:16:48Z
11923,stream-edit: Empty edit stream-name makes the span styling ineffective,"![stream_edit_bug](https://user-images.githubusercontent.com/41135524/54484225-ff265d80-4887-11e9-9f30-f64de0c81a74.gif)
In the stream settings when editing a stream name if we erase all the characters the styling of the span becomes ineffective resulting in  the above output.",gaharavara,b'area: stream settings bug help wanted',2019-03-17T02:13:58Z,2019-07-23T14:14:36Z
11916,Bullet list does not work correctly in block quote,"When quoting text with bullet lists, the formatting breaks if there is a non-empty line preceding the list, or if there is a number list before the bullet list. (This may not cover all cases, but are the two we identified).

Example text:
``````
ORIGINAL:

word
*  Sed ut perspiciatis unde omnis iste 
*  natus error sit voluptatem accusantium 
*  doloremque laudantium, totam rem aperiam,

 eaque ipsa quae ab illo inventore veritatis et quasi 

1.  architecto beatae vitae dicta sunt explicabo. Nemo
1.  enim ipsam voluptatem quia voluptas sit aspernat
1.  ur aut odit aut fugit, sed quia consequuntur magni 

*  dolores eos qui ratione voluptatem sequi nesciunt. 
*  Neque porro quisquam est, qui dolorem ipsum quia
 *  dolor sit amet, consectetur, adipisci velit, sed quia n

on numquam eius modi tempora incidunt ut labore e

BROKEN WHEN QUOTED:
```quote
word
*  Sed ut perspiciatis unde omnis iste 
*  natus error sit voluptatem accusantium 
*  doloremque laudantium, totam rem aperiam,

 eaque ipsa quae ab illo inventore veritatis et quasi 

1.  architecto beatae vitae dicta sunt explicabo. Nemo
1.  enim ipsam voluptatem quia voluptas sit aspernat
1.  ur aut odit aut fugit, sed quia consequuntur magni 

*  dolores eos qui ratione voluptatem sequi nesciunt. 
*  Neque porro quisquam est, qui dolorem ipsum quia
 *  dolor sit amet, consectetur, adipisci velit, sed quia n

on numquam eius modi tempora incidunt ut labore e
```

WORKAROUND:
```quote
word

*  Sed ut perspiciatis unde omnis iste 
*  natus error sit voluptatem accusantium 
*  doloremque laudantium, totam rem aperiam,

 eaque ipsa quae ab illo inventore veritatis et quasi 

1.  architecto beatae vitae dicta sunt explicabo. Nemo
1.  enim ipsam voluptatem quia voluptas sit aspernat
1.  ur aut odit aut fugit, sed quia consequuntur magni 

word 

*  dolores eos qui ratione voluptatem sequi nesciunt. 
*  Neque porro quisquam est, qui dolorem ipsum quia
 *  dolor sit amet, consectetur, adipisci velit, sed quia n

on numquam eius modi tempora incidunt ut labore e
```
``````

How it renders (I've circled where it is broken):
![image](https://user-images.githubusercontent.com/38052592/54463262-b3f93700-472f-11e9-8dc2-5c6f116429ce.png)

Note the workarounds were either adding a word or adding an empty line before the quoted bullet list.
",amahoneyLIT,b'area: markdown bug help wanted',2019-03-15T21:38:31Z,2019-07-23T14:14:36Z
11906,context_processors: Do not render inline previews for realm description.,"Fix issue #11889.

_Note: I have placed the test in test_signup.py because this issue occurs during login/signup. There probably might be a more apt place to put the test though..._",Hypro999,b'area: settings (admin/org) bug priority: high size: S',2019-03-15T09:21:26Z,2019-03-18T03:26:13Z
11897,Streams: Scrollbar in 'All Streams' and 'STREAMS' doesn't end when we scroll to the end.,"When we try to scroll to the bottom of STREAMS in the main page or of All Streams in stream settings the scrolling doesn't end.

![](https://chat.zulip.org/user_uploads/2/94/FBB2VGe8wInBCy18vpFSd2Bz/streams.gif)

I was able to observe this in both localhost and https://chat.zulip.org in Ubuntu Firefox and Chrome.
Just try to scroll down in Streams as far as possible to observe this behavior.",Raghavareddy21,b'area: stream settings bug',2019-03-14T12:57:38Z,2019-05-21T03:10:36Z
11889,Link Previews cause error for some links in Organization description,"With the ""show previews of linked websites"" feature enabled, some links such as https://zulipchat.com in the Organization description result in an error on the login page.

Here is the traceback:

Logger root, from module zerver.lib.bugdown line 2235:
Error generated by Anonymous user (not logged in) on ip-10-239-30-102 deployment

Traceback (most recent call last):
  File ""./zerver/lib/bugdown/__init__.py"", line 1013, in run
    extracted_data = link_preview.link_embed_data_from_cache(url)
  File ""./zerver/lib/cache.py"", line 126, in func_with_caching
    raise NotFoundInCache()
zerver.lib.cache.NotFoundInCache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""./zerver/lib/bugdown/__init__.py"", line 2219, in do_convert
    rendered_content = timeout(5, _md_engine.convert, content)
  File ""./zerver/lib/timeout.py"", line 88, in timeout
    six.reraise(thread.exc_info[0], thread.exc_info[1], thread.exc_info[2])
  File ""/home/zulip/deployments/2019-03-12-17-59-49/zulip-py3-venv/lib/python3.6/site-packages/six.py"", line 693, in reraise
    raise value
  File ""./zerver/lib/timeout.py"", line 48, in run
    self.result = func(*args, **kwargs)
  File ""/home/zulip/deployments/2019-03-12-17-59-49/zulip-py3-venv/lib/python3.6/site-packages/markdown/core.py"", line 272, in convert
    newRoot = treeprocessor.run(root)
  File ""./zerver/lib/bugdown/__init__.py"", line 1015, in run
    self.markdown.zulip_message.links_for_preview.add(url)
AttributeError: 'NoneType' object has no attribute 'links_for_preview'


Deployed code:
- ZULIP_VERSION: 2.0.0
- version: 2.0.0


Request info: none",ostermang,b'area: settings (admin/org) bug priority: high',2019-03-13T17:32:07Z,2019-03-17T20:56:41Z
11883,emoji: Allow users to add emoji or react in mobile browsers.,@timabbott I have pushed this pr for issue #11448. It works perfectly fine (I guess it was something else that I observed while debugging that I mentioned in issue #9692 ) This pr solves the issue of adding emoji to the message and also reacting on other's message.,2208Abhinav,b'area: mobile web bug size: S',2019-03-12T18:10:10Z,2019-03-14T21:50:56Z
11878,"sync_ldap_user_data deactivates all users, despite query_ldap delivering proper results","Attempting to synchronize user fields via `manage.py sync_ldap_user_data` results in all LDAP authenticated users being deactivated. `manage.py <username>` delivers the proper results though. I'm quite confused if this is a bug or an error with our setup.  

```
root@Zulip# su zulip -c '/home/zulip/deployments/current/manage.py sync_ldap_user_data'
2019-03-12 10:58:17.201 INFO [zulip.sync_ldap_user_data] Starting update.
2019-03-12 10:58:17.270 WARN [zulip.sync_ldap_user_data] Did not find support@<company>.biz in LDAP.
2019-03-12 10:58:17.270 INFO [zulip.sync_ldap_user_data] Deactivated non-matching user: support@<company>.biz
2019-03-12 10:58:17.699 WARN [zulip.sync_ldap_user_data] Did not find some.user@<company>.biz in LDAP.
2019-03-12 10:58:17.699 INFO [zulip.sync_ldap_user_data] Deactivated non-matching user: some.user@<company>.biz
...
...
...
2019-03-12 10:58:17.887 INFO [zulip.sync_ldap_user_data] Finished update.#

root@Zulip# su zulip -c '/home/zulip/deployments/current/manage.py query_ldap suser'
full_name: ['Some User CN']
custom_profile_field__durchwahl: ['+4987654321']
custom_profile_field__mobil: ['+4912345678']
userAccountControl: ['512']
email: ['some.user@<company>.biz']
```

```
#/etc/zulip/settings.py
from django_auth_ldap.config import LDAPSearch, GroupOfNamesType

AUTH_LDAP_SERVER_URI = ""ldaps://ldapproxy.biz:636""

AUTH_LDAP_BIND_DN = ""cn=adquery,ou=serviceaccounts,dc=company,dc=loc""

AUTH_LDAP_USER_SEARCH = LDAPSearch(""OU=wikiusers,DC=company,DC=loc"",
                                    ldap.SCOPE_SUBTREE, ""(&(objectClass=*)(sAMAccountName=%(user)s))"")

LDAP_APPEND_DOMAIN = """"  # type: Optional[str]

LDAP_EMAIL_ATTR = ""mail""  # type: Optional[str]

AUTH_LDAP_USER_ATTR_MAP = {
    ""full_name"": ""cn"",
    ""userAccountControl"": ""userAccountControl"",
    ""custom_profile_field__mobil"": ""mobile"",
    ""custom_profile_field__durchwahl"":""telephoneNumber""
}
```  


Our LDAP logic is as follows: \<firstname_initial\>\<surname\> for the username and for the mail \<firstname\>.\<secondname\>@\<company\>.biz. We've been using Zulip for 5ish months with this setup now (we love it btw!), being able to log in with the username only, in order to streamline login experiences over all platforms. 

Side note: I had to manually reactivated all users in PostgreSQL, as LDAP is our only authentication backend and manage.py doesn't seem to provide an option to activate users. ",DestructiveInfluence,b'area: authentication bug priority: high',2019-03-12T12:13:50Z,2019-10-22T23:05:39Z
11873,left sidebar: Blue highlight of active PM doesn't go to edge of sidebar.,"To repro, just go to any PM conversation, and hover over the Private messages section. You'll see that the bule box is too narrow. Topic narrows have the correct behavior, for comparison.",rishig,b'area: left-sidebar bug help wanted',2019-03-12T02:32:49Z,2019-03-15T19:09:54Z
11867,Youtube thumbnail has unexpected behavior on mouse hover.,"This looks like a Firefox specific bug.  Basically, the play icon appears to the right of the thumbnail when you hover the mouse over the video.

<img width=""611"" alt=""Screen Shot 2019-03-08 at 9 17 33 PM"" src=""https://user-images.githubusercontent.com/39782863/54159084-3613f380-43f0-11e9-8d66-d969224d356e.png"">
",whoodes,b'area: message view bug design good first issue',2019-03-11T21:25:21Z,2019-07-23T14:14:35Z
11860,Frontend markdown doesn't treats + or - as list item indicators,"It seems like the frontend markdown parser treats only * as a list indicator while - or + are not treated as a list indicators, thus raising different outputs.

Steps to reproduce:
type the below in message and click on eye button
```
- zero
 - one
  - two
   - three
    - four
     - five
      - six
       - seven
        - eight
```

we get the backend rendered content which is the expected output

![backend](https://user-images.githubusercontent.com/41135524/54098187-73b95200-43d9-11e9-81f0-9448c64fac28.PNG)

now click on drafts to see the frontend rendered content

![bug2](https://user-images.githubusercontent.com/41135524/54098217-9c414c00-43d9-11e9-999b-405430adfc56.PNG)

which is different from the backend(i.e. expected output), identical issue is raised when we use + too. The related file would be marked.js .
",gaharavara,b'area: markdown bug',2019-03-11T03:15:19Z,2019-12-11T01:18:12Z
11819,copy_and_paste: Fix copy/paste behaviour on Firefox.,"When selecting multiple messages, Firefox makes multiple ranges for the
selected messages whereas Chrome makes just one. Changes have been made such
that `startContainer` of the first range and `endContainer` of the last
range is taken to copy the contents.

Fixes #11805 
",vrongmeal,b'area: browser-support bug priority: high size: L',2019-03-07T17:51:03Z,2019-03-14T00:38:54Z
11817,settings_org: Fix visibility time of `Saved` state and `Discard` buttons.,"This fixes the bug where the `Saved` state fades out almost instantly(that
is actually 300 ms, by default). Now, we fixed the bug and defined the
`fadeout_duration` for `Saved` state to be 500 ms.

Fixes: #11737.

Let me know if it still gets fade out quickly, then I'm thinking to change the time limit from 500 ms to 800 ms, or if to any other intermediate value.
Here are the two GIF's for the same
- **GIF1** : with fadeout_duration `500 ms`.
![mar-07-2019 22-51-02](https://user-images.githubusercontent.com/40331304/53976548-45174f00-412d-11e9-9786-d2125a1e20b5.gif)
- **GIF2** : with fadeout_duration `800 ms`
![mar-07-2019 23-18-51](https://user-images.githubusercontent.com/40331304/53977840-ea332700-412f-11e9-9fb5-8e30b92baa9b.gif)

",pragatiagrawal31,b'area: settings (admin/org) area: settings UI bug priority: high size: XL',2019-03-07T17:34:35Z,2019-03-10T20:10:49Z
11809,Improve performance of `set_pm_conversation_count` in `static/js/pm_list.js`,"I was doing some frontend profiling earlier today on chat.zulip.org, and ran into a case where `update_dom_with_unread_counts()` took 163ms, which is definitely high for that sort of update.  100ms of that was 20 calls to `set_pm_conversation_count` in `static/js/pm_list.js`, each of which was consuming 5ms.  This is a bit odd because I definitely didn't have 20 conversations with unread messages in the PM list.

I suspect this is partially some sort of UI scalability issue, where this only happens because there's a large number of users in the organization, but also in part a bug that `exports.get_li_for_user_ids_string` is such an expensive operation and we're calling it not just for the PM list entries whose unread counts might have changed.

Tagging as difficult because I think this sort of profiling issue can be difficult to track down and optimize.",timabbott,b'area: left-sidebar bug difficult',2019-03-07T00:41:19Z,2020-01-31T20:50:17Z
11805,copy-paste with ctrl+C is broken on Firefox with Windows+Linux (sender names are missing),"Here's what happens when you copy-paste with ctrl+C on Windows:

```
So, just to explain what's going on there are 2 copy-paste implementations.
  12:27 PM

One is the ctrl+C / ctrl+V implementation, which is in static/js/copy_and_paste.js and has pretty extensive tests.
  12:28 PM

The second is what happens if, (at least on Linux), you select text and then just paste it with e.g. the middle mouse button, which does not trigger our copy-paste handler and instead is determined by the ordering of elements and the no-select tags.
  12:28 PM

For me, at least, in Chrome the ctrl+C one works great, and the other one is somewhat messy.
12:30 PM

On chrome everything seems to work fine, the problem exists on Firefox...
1:07 PM

one way to handle this would be to have a popover menu when you select more than 1 message of text, that allows you to select one of a few copy options (e.g. copy selection, copy selected messages, copy message content with full info like sender and timestamps)
  1:08 PM

(or V1 can just be the middle one: copy messages, which is the one I want 90% of the time)
```

The code for this copy-paste implementation is in `static/js/copy_and_paste.js` -- we'll likely need to print-debug or something to figure out what's going on.",timabbott,b'area: browser-support bug priority: high',2019-03-06T21:41:57Z,2019-03-14T00:39:17Z
11802,Electron check condition outdated in reset.html,"In the [reset.html](https://github.com/zulip/zulip/blob/master/templates/zerver/reset.html), there exists a codeblock-

```
<div class=""actions if-zulip-electron""><!-- only show if on `ZulipElectron` -->
                <a class=""back-to-login"" href=""{{login_url}}""><i class=""fa fa-arrow-left""></i> Back to the login page</a>
</div>
```

But this 'back to login' link is not shown on the electron app currently, as visible in the attached screenshot-

![screenshot from 2019-03-05 20-37-00](https://user-images.githubusercontent.com/21038781/53906613-6a468780-4071-11e9-93d4-08c05c90c502.png)


",vsvipul,b'area: portico bug priority: high',2019-03-06T19:09:25Z,2019-03-12T18:27:51Z
11800,bugfix: Hide tooltips when switching a narrow.,"Fixes #4639.

This closes all open tooltips when activating a new narrow, as otherwise they are stuck on the screen (see the bugfix description).",Tim-W,b'area: settings UI bug size: XS',2019-03-06T16:21:00Z,2019-03-19T19:29:57Z
11799,Hide tooltips when switching a narrow.,"Fixes #4639.

Hides all tooltips when activating a narrow, as the previous open tooltips usually are not relevant anymore.
",Tim-W,b'area: settings UI bug size: XS',2019-03-06T13:59:03Z,2019-03-06T16:19:29Z
11798,bugfix: Hide tooltips when switching a narrow.,"Fixes #4639.

Closes all open tooltips when activating a narrow.",Tim-W,b'size: XS',2019-03-06T13:51:16Z,2019-03-09T00:16:19Z
11793,markdown: Ensure topic linkification and message conversion is same for realm patterns.,"We recently added some additional checks for converting realm
filters in RealmFilterPattern that included having a more liberal
regex for matching the realm filters. As a result, we started
linkifying in topics when we shouldn't.

This commit makes both the message conversion and topic linkification
take the same codepath inside RealmFilterPattern to keep the behavior
consistent.

Fixes #11791.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Adds automated tests

 <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",aero31aero,b'area: markdown bug has conflicts priority: high size: M',2019-03-06T05:30:24Z,2019-03-11T18:49:12Z
11791,Linkifiers with overlapping patterns are linked twice in topics,"Given two linkifiers, `#(?P<id>[0-9]+)` and `some-other-repository#(?P<id>[0-9]+)`, that overlap then, in my testing, the more specific pattern is matched in messages (where possible), but in topics, both patterns are matched and two link buttons are shown where this may not be desirable.

As a more concrete example, in Rust's Zulip instance, we have a linkifier with the first pattern above, that links to issues and pull requests in the main `rust-lang/rust` repository, and we have multiple linkifiers matching the second pattern with other repositories. Within a topic where the name matches the second pattern, the linkifier should only link to that repository, and the `#xxx` at the end shouldn't also match the first pattern, as it wouldn't link to a meaningful or relevant `rust-lang/rust` issue.

One potential improvement that could resolve this would be to let linkifiers be sorted in the organization settings and then check the patterns in order, stopping after the first match. Optionally, patterns could also have an option that would say ""keep checking other patterns even after matching this pattern"" for users who wish to maintain the old behaviour.",davidtwco,b'area: markdown bug priority: high rust community request',2019-03-05T23:58:46Z,2019-03-11T18:50:06Z
11789,ldap: Continue syncing other fields even if a field is missing.,"Earlier the behavior was to raise an exception thereby stopping the
whole sync. Now we log an error message and skip the field. Also
fixes the `query_ldap` command to report missing fields without
error.

Fixes: #11780.",HarshitOnGitHub,b'area: authentication bug size: M',2019-03-05T18:24:50Z,2019-03-09T12:49:12Z
11786,Upgrade from 2.0.0 to 2.0.1 failed,"When I try to upgrade from 2.0.0 to 2.0.1 i got:
```
...
Node version 8.11.1 and yarn version 1.7.0 are already installed.
Generated Camo config file /etc/default/camo
generate_secrets: No new secrets to generate.
2019-03-05 04:59:19,927 upgrade-zulip-stage-2: Installing static assets...
2019-03-05 04:59:20,762 upgrade-zulip-stage-2: Checking for needed migrations
process-fts-updates: ERROR (not running)
2019-03-05 04:59:22,974 upgrade-zulip-stage-2: Stopping Zulip...
zulip-django: ERROR (not running)
zulip-tornado: ERROR (not running)
zulip-thumbor: ERROR (not running)
2019-03-05 04:59:23,103 upgrade-zulip-stage-2: Applying puppet changes...
Warning: The string '4038176' was automatically coerced to the numerical value 4038176 (file: /home/zulip/deployments/2019-03-05-04-59-14/puppet/zulip/manifests/base.pp, line: 93, column: 19)
Error: Evaluation Error: Cannot reassign variable '$uploads_route' (file: /home/zulip/deployments/2019-03-05-04-59-14/puppet/zulip/manifests/nginx.pp, line: 47, column: 20) on node zulip.flashgrid.io
Traceback (most recent call last):
  File ""/home/zulip/deployments/2019-03-05-04-59-14/scripts/lib/upgrade-zulip-stage-2"", line 170, in <module>
    subprocess.check_call([""./scripts/zulip-puppet-apply"", ""--force""])
  File ""/usr/lib/python3.6/subprocess.py"", line 291, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['./scripts/zulip-puppet-apply', '--force']' returned non-zero exit status 1.
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/lib/upgrade-zulip"", line 58, in <module>
    + deploy_options)
  File ""/usr/lib/python3.6/subprocess.py"", line 291, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2019-03-05-04-59-14/scripts/lib/upgrade-zulip-stage-2', '/home/zulip/deployments/2019-03-05-04-59-14']' returned non-zero exit status 1.
```

nginx.pp line 47 is:
```
if $no_serve_uploads != '' {
    # If we're not serving uploads locally, set the appropriate API headers for it.
    $uploads_route = 'puppet:///modules/zulip/nginx/zulip-include-maybe/uploads-route.noserve'
  }
```",svpcom,b'area: production bug priority: high',2019-03-05T09:31:01Z,2019-03-06T21:19:46Z
11780,ldap_query and sync_ldap_user_data break if custom LDAP field missing,"Both ldap_query and sync_ldap_user_data break if a custom field specified in `settings.AUTH_LDAP_USER_ATTR_MAP` is missing from the LDAP user.

Desired behavior: Continue syncing other, present fields

This can be fixed by changing `zproject.backends.sync_custom_profile_fields_from_ldap()` line 350 to a try/except which `continue` when it encounters a `KeyError` (No need to log the missing field here, `django_auth_ldap` will log it), and then `zerver.management.commands.query_ldap.query_ldap()` line 20 should change to a `get()` with a default value of something like ""LDAP field {} not present"" so that the user testing with query_ldap can see the value is missing when the status returns.",swallitsch,b'area: authentication bug',2019-03-05T02:03:52Z,2019-07-23T14:14:32Z
11777,Regression 1.9 -> 2.0: linkifiers with dashes no longer work,"After the upgrade to 2.0, we've noticed that all of our linkifiers with dashes in the regex pattern have stopped working. The `-` might be a red herring, but that's what we've noticed between working linkifiers and non-working linkifiers.

Not working:
```
(?P<issue>[A-Z][A-Z_0-9]*-\d+)  # HELP-4568
http://jira.example.com/browse/%(issue)s

(?P<id>[0-9a-f-]{1,64}@[a-zA-Z]{1,32}) # c9f4fb80-a9df-4e36-a202-5a2aa0853681@Thing
http://github.example.com/pages/swallitsch/resourceidentifier?id=%(id)s
```

Working:
```
(?P<subreddit>\/r\/[a-zA-Z]+)  # /r/programming
http://www.reddit.com/%(subreddit)s

(?P<word>[tT]hanks|[tT]hank[- ]you|:thx:|thx)  # Thanks
https://thx.youearnedit.com/?%(word)s
```

We've tried escaping the dashes in the regex and deleting and re-adding the regexes.
",swallitsch,b'area: markdown bug priority: high',2019-03-04T18:29:57Z,2019-07-23T14:14:32Z
11776,portico: Refresh deactivated realm notice page every 60 seconds.,Fixes: #11757.,HarshitOnGitHub,b'area: portico bug priority: high size: S',2019-03-04T17:45:31Z,2019-03-04T19:39:15Z
11774,auth: Remove `invalid_subdomain` restriction from LDAP backend.,Fixes: #11692.,HarshitOnGitHub,b'area: authentication bug has conflicts priority: high size: L',2019-03-04T13:30:47Z,2019-03-10T08:00:00Z
11766,JavaScript on-hover explanation on the Keyboard Shortcut icon shows doubling effect.,"The keyboard shortcut icon on-hover explanation shows doubling effect on and off hover.

![keyboard s](https://user-images.githubusercontent.com/35079024/53696040-fb56fd80-3de8-11e9-81f5-379b12ed84e8.gif)

",RishabhGoyal992,b'area: general UI bug',2019-03-03T13:47:48Z,2019-06-24T20:00:46Z
11758,user_uploads not serving after 2.0 upgrade,"Upgraded to 2.0 from 1.9.1 this morning, on Ubuntu Trusty. Everything working as expected before upload.

Copying my troubleshooting from the [zulip topic](https://chat.zulip.org/#narrow/stream/31-production-help/topic/user_uploads).

* Upgraded via git, to the 2.0.0 tag
* Impacts both new uploads and old uploads.
* New uploads don't trigger any errors, and show up where they're expected to on the zulip filesystem
* restart-server script does not resolve issue, neither does rebooting the server itself..
* Our conf.py is boring:
```
[machine]
puppet_classes = zulip::voyager, zulip::static_asset_compiler
deploy_type = voyager
```
* nginx.conf identical to [Zulip's nginx.conf in repo](https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf)
* We're using a self signed cert, but trying to access images from machines which have a matching cert authority installed
* When I try to go to the URL of the image directly, it makes me authenticate- which I thought wasn't going to be supported on Trusty (instead images would be served without regard to authentication)
* I remember [this commit](https://github.com/zulip/zulip/commit/efe85453039e9ef9e1a7a503e33d8b21e91e5fa9#diff-7f650084f892af5ba032222273d372e7) is were Zulip first started authenticating local uploads, but it has support for the older versions of nginx
* Content-Security-Policy was added in [this commit](https://github.com/zulip/zulip/commit/d608a9d315a3dae90033d36cdf591eb3227ce30e#diff-9b57523c22e695172bd9a625be44ddfc) to uploads-route.direct, then further modified in [this commit](https://github.com/zulip/zulip/commit/4898fe7ebc4e249e487a84b81cf2730cb24ced33#diff-9b57523c22e695172bd9a625be44ddfc) but removing that line doesn't result in being able to view uploads (even after full reboot)

Anyone have any ideas?

",swallitsch,b'area: uploads bug priority: blocker',2019-03-02T18:58:41Z,2019-03-02T20:21:37Z
11757,Realm Deactivated Page does not refresh,"As part of doing a backup before upgrading to 2.0, I followed the 1.9 backup instructions which recommend deactivating the realm.

Every logged in user now has a giant ""Realm Deactivated"" screen, telling them to email me, even though the realm has been back up for an hour. 

This is extremely unideal, as some of those users will just assume the realm is dead forever. For every other non-technical user, I have to email them that the realm is actually back up and to ignore the page and refresh. 

Technical users will likely just refresh the page, and aren't an issue.

At the very least, I recommend the wording of this page be modified to recommend refreshing. Ideally, this would attempt refreshes automatically. Users know what to do when prompted with a sign in page, but they don't even know what a realm is.",swallitsch,b'area: portico bug help wanted priority: high',2019-03-02T18:47:34Z,2019-07-23T14:15:47Z
11755,user docs: Export and Import: Calls 'manage' instead of 'manage.py',"[Export and import - Export your Zulip Data](https://zulip.readthedocs.io/en/latest/production/export-and-import.html#export-your-zulip-data) has the following code instructions:

```
cd /home/zulip/deployments/current
./manage deactivate_realm -r ''  # Deactivates the organization
./manage.py export -r ''  # Exports the data
```

The 2nd line should be `manage.py`",swallitsch,b'area: documentation (production) bug',2019-03-02T17:11:00Z,2019-03-02T21:09:32Z
11748,stream settings: Add unsubscribe button for guests,"Fixes: #11743

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Added visibility of Unsubscribe button for guests in stream settings.
In below screen shot, I've logged in as a guest user

**GIFs or Screenshots:** 
![screenshot 2019-03-02 at 6 10 43 pm](https://user-images.githubusercontent.com/39343253/53682280-10b12680-3d1a-11e9-9f25-652d4a35173b.png)
",ruchit2801,b'area: stream settings bug size: XS',2019-03-02T13:06:41Z,2019-03-09T08:46:59Z
11743,stream settings: Add unsubscribe button for guests.,"Currently (I believe) guests can unsubscribe from a stream on the backend, but we don't show the button for it in stream settings.",rishig,b'area: stream settings bug good first issue',2019-03-02T08:03:14Z,2019-07-23T14:15:46Z
11742,/for/open-source heading area has messed up spacing on mobile,"The ""Zulip"" and menu end up somewhat overlapping the title:

![image](https://user-images.githubusercontent.com/2746074/53677474-27497600-3c65-11e9-8e51-e79759e5c30d.png)
",timabbott,b'area: portico bug help wanted',2019-03-02T05:02:18Z,2019-03-04T03:54:02Z
11737,"organization settings: ""Saved"" state does not persist properly","Our code in `exports.save_organization_settings` seems to configure the desired behavior, which is that the ""[check] Saved"" state after saving an organization settings change sticks around for ~500ms before starting to fade away (in the `succeeded` code path).  However, if you actually try using it, the ""Saved"" state disappears almost immediately.  The bug is probably somewhere between there and `exports.change_save_button_state`

Tagging as a priority since this is a pretty visible bug.

@shubhamdhama @pragatiagrawal31 FYI",timabbott,b'area: settings (admin/org) area: settings UI bug priority: high',2019-03-01T19:51:21Z,2019-07-23T14:15:45Z
11736,markdown: Fix numbered list handling of blank lines between blocks.,"This fixes an issue where blank lines between blocks were causing
auto-numbering of the list to stop before the blank line resulting
in two separate numbered list instead of one.

Fixes: #11651.",overide,b'area: markdown bug priority: high size: M',2019-03-01T19:06:50Z,2019-03-02T22:52:32Z
11716,popovers: Fix toggling of user popover.,"Fix the logic for closing user popover on clicking
the chevron again in the buddy list.

Fixes: #11690.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
",Varunvaruns9,b'area: right-sidebar bug size: XS',2019-02-28T13:22:52Z,2019-02-28T22:45:17Z
11702,compose: Quote and reply adds an extra space.,"If you quote and reply a message, it adds an extra space at the end of the second triple-backtick.
I tested this using the `>` shortcut.",rishig,b'area: compose bug good first issue',2019-02-27T18:46:02Z,2019-07-23T14:15:44Z
11701,Add responsive styling for individual /integrations/doc/ pages,"While the root /integrations page has reasonable responsive mobile styling, the /integrations/doc/github type pages do not at all.  We should fix this.

Some screenshots are in https://chat.zulip.org/#narrow/stream/137-feedback/topic/Zulip.20Integration.20Docs.20on.20Mobile/near/708632",timabbott,b'area: documentation (api and integrations) bug help wanted priority: high',2019-02-27T18:25:48Z,2019-05-21T01:56:45Z
11697,compose: Add shortcut hint to New topic and New stream message button.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes: #11678.


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
<img width=""890"" alt=""image"" src=""https://user-images.githubusercontent.com/23462580/53496989-31367200-3ac9-11e9-9541-32d92b7a272e.png"">

<img width=""583"" alt=""image"" src=""https://user-images.githubusercontent.com/23462580/53497012-3eebf780-3ac9-11e9-84e8-fd6eeb0ad2a1.png"">



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",thedeveloperr,b'area: compose bug size: S',2019-02-27T14:23:13Z,2019-02-27T18:08:33Z
11692,ldap: Remove invalid_subdomain restrictions on LDAP backend,"We got a report from a user that they were trying to use our LDAP backend with organizations on several subdomains, with the idea being that users could auto-create accounts in any of the subdomain organizations.  This didn't work at all -- once you had an account in one, you couldn't make another with the LDAP auto creation logic.

We've confirmed try editing `get_or_build_user` in `zproject/backends.py` to remove this block fixes the issue:

```
        if return_data.get(""invalid_subdomain""):                                                                                  
            # TODO: Implement something in the caller for this to                                                                 
            # provide a nice user-facing error message for this                                                                   
            # situation (right now it just acts like any other auth                                                               
            # failure).                                                                                                           
            raise ZulipLDAPException(""Wrong subdomain"")                                                                           
```

I think there's no good reason for us to have this restriction, and there's a valid use case, so I think we just want to remove that code and add a test for auto-creating an account for `ldapuser1` in a second organization.

@HarshitOnGitHub @shubham-padia FYI, this is probably an issue for one of you :)",timabbott,b'area: authentication bug priority: high',2019-02-26T19:37:25Z,2019-07-23T14:15:43Z
11690,User Popover doesn't closes on clicking again on chevron.,"**Current behavior-**
Once we open the user popover, clicking again on chevron doesn't closes it.


![ezgif com-crop](https://user-images.githubusercontent.com/35494118/53440658-17dee880-3a2b-11e9-90c0-e947cdde57dc.gif)


**Expected behavior-**
Popover should close after opening the popover by clicking again on chevron. ",sahil839,b'area: right-sidebar bug help wanted',2019-02-26T19:19:59Z,2019-07-23T14:15:42Z
11679,"compose: We don't correctly switch to ""New conversation"" button.","In most narrows, the three buttons at the bottom are
`New topic`, `New private message`, `Reply`.
![image](https://user-images.githubusercontent.com/890911/53373645-ec64dc80-390a-11e9-837e-9971078c64ac.png)

In any PM narrow (either ""Private messages"" or a particular PM narrow), the buttons should be 
`New stream message`, `New conversation`, `Reply`. Instead, it is 
![image](https://user-images.githubusercontent.com/890911/53373668-00a8d980-390b-11e9-9e51-672f6b53a991.png)

I can see the code attempting to do the right thing; in `mobile_message_buttons_popover_content.handlebars`:
```
        <a class=""compose_mobile_private_button"">
            <i class=""fa fa-envelope"" aria-hidden=""true""></i>
            {{#if is_in_private_narrow }}
            {{t ""New conversation"" }}
            {{else}}
            {{t ""New private message"" }}
            {{/if}}
        </a>
```
but for whatever reason it's not succeeding. 

(Also worth noting that it's not just the button name that should change, the current behavior is not correct either; clicking the second button there should give you a blank ""To"" line in the compose box, whereas currently it's doing the same thing as ""Reply"".)",rishig,b'area: compose bug good first issue',2019-02-25T22:40:05Z,2019-07-23T14:15:41Z
11678,compose: New topic buttons don't have keyboard shortcut hints.,"Both `New topic` and `New stream message` are missing the `(c)` in their title atttribute. Hover over one of them, and compare to hovering over `Reply`. 

There's also a `New conversation` button in the code, though I'm not sure when we show it. That should have the keyboard shortcut of `(x)`.",rishig,b'area: compose bug help wanted',2019-02-25T22:35:57Z,2019-07-23T14:15:40Z
11672,zoom videochat allows only one meeting at the same time,"I create two Zoom meetings in Zulip. My colleagues login to the first one and stay there. I try to login to the second one and see ""The host has another meeting in progress"". The colleagues close the first meeting then I am able to login to the second one.",santherics,b'area: integrations bug priority: high',2019-02-25T05:57:54Z,2020-06-03T23:41:14Z
11666,message view: Compose icons appear even if message is not editable.,"To repro: 
Go to ""View Source"" of a message you can't edit. The compose icons along the bottom shouldn't be there. 

![image](https://user-images.githubusercontent.com/890911/53302232-38335b00-3811-11e9-9529-17cd5831890e.png)
",rishig,b'area: message view bug good first issue',2019-02-24T16:50:57Z,2019-07-23T14:15:39Z
11663,Topic edit: edit icon doesn't remove edit icon and checkbox label doesn't fade ,"Changing settings of allowing message editing to never should lead to-

-  disappearing of edit topic icon in recipient bar

- fading of checkbox of allowing to edit topic of any message

But it does so only after reloading the page after saving the settings.

This can be reproduced by-

- Login as admin in dev environment.

- Change the setting of allowing message editing to never and save the changes.

- Reload the page to see the required changes.

GIF for current behaviour is attached-

![peek 2019-02-21 20-31](https://user-images.githubusercontent.com/35494118/53290994-064ed400-37d2-11e9-9c68-0698a75b41a2.gif)
",sahil839,b'area: general UI bug question',2019-02-23T19:48:22Z,2020-05-12T19:30:14Z
11662,Message feed: Collapse message hotkey has a few bugs.,"Some things that I was able to repro:
* Hitting `-` twice doesn't clear the `[More...]` link
* Once you get into that state, clicking the `[More..]` link changes to ""Condense this message"" rather than going away.

I tested this on messages 3-4 lines long. ",rishig,b'area: message view bug good first issue',2019-02-23T18:49:42Z,2019-07-13T22:46:49Z
11659,left sidebar: Fix closing stream search.,"Fixed issue where closing stream search was not working if
the user does not enter any search term and try to close the
search box by clicking on the close icon.

Fixes: #11636.",overide,b'area: left-sidebar bug priority: blocker size: S',2019-02-23T14:21:27Z,2019-02-25T19:54:53Z
11656,Fix focus issues when someone sends a message while you're editing the latest message,"I've occasionally noticed a problem where I send a message, am editing it, and then someone sends a reply while I'm typing my edits, and the text area loses focus (resulting in my next characters triggering hotkeys, not entering text into the message I was editing)

The reproducer for this is very precise:
* Send a message as Iago in one tab from a topic narrow.
* Start editing the message, leaving focus in that window
* In an incognito window, login as Cordelia 
* Tab back to Iago's window -- Note message edit still has focus.
* Now from Cordelia's window, send a reply to the message Iago sent.
* Tab back to Iago's window -- the message being edited will have lost focus.  Characters you type will be treated as hotkeys.

This is a priority issue because it comes up in a common flow and produces pretty unexpected results.  It may be a bit tricky to trace, though, because the bug may involve some subtle details involving `message_list_view` doing a rerender of the message being edited -- I think that's the most likely explanation for this issue happening only when you're editing what was previously the last message in your narrow.

In particular, the `merge_message_groups` logic for Cordelia's incoming message results in a `message_actions` object that will rerender Iago's message and then also add Cordelia's message.

So the bug here is either that the rerendering of Iago's message is unnecessary (possible; I'm not 100% sure why we need to do that) or that we should avoid losing focus in that process (sounds difficult given that the HTML is being replaced).",timabbott,b'area: message-editing bug difficult priority: high',2019-02-23T01:20:22Z,2019-07-23T14:15:38Z
11651,Fix markdown numbered list handling of blank lines between blocks,"If you write

```
1. first
1. second
```

Zulip's auto-numbering thing works and turns it into 1/2.  However,

```
1. first

1. second
```

apparently that just results in two 1.s in their own paragraphs. 
",timabbott,b'area: markdown bug priority: high',2019-02-22T21:41:40Z,2019-07-23T14:15:38Z
11636,left sidebar: Closing stream search doesn't work.,"To repro, open stream search and try to click the `X`.

![peek 2019-02-21 11-14](https://user-images.githubusercontent.com/890911/53195148-e4830080-35c9-11e9-92de-68208cc35870.gif)


(Closing with `Esc` does work)",rishig,b'area: left-sidebar bug good first issue priority: blocker',2019-02-21T19:15:09Z,2019-07-23T14:15:36Z
11631,message view: Vertical spacing is off above quotes and lists.,"The following markdown
```
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam ac finibus lacus. In ornare tincidunt suscipit. 
> Nulla tellus nulla, dictum ultricies justo in, vulputate cursus lectus. Suspendisse at ullamcorper odio, iaculis euismod nibh. 

Nullam in purus erat.
* Mauris sit amet nunc magna.
* Praesent non ante in quam varius semper.
* Aliquam dictum pulvinar lorem, vulputate 

elementum lorem egestas vitae. Praesent sit amet est nec velit tincidunt dapibus id in mi.
```

produces
![image](https://user-images.githubusercontent.com/890911/53133301-71c14900-3527-11e9-9c60-a7b5c3b653f4.png)

The vertical space above the quote and especially above the bullets is too much, relative to e.g. paragraph breaks. I think it's at the point where it affects readibility, and makes it look like the bullets are not tied to the sentence that precedes it. 
",rishig,b'area: message view bug help wanted',2019-02-20T23:55:00Z,2019-07-23T14:15:35Z
11625,streams-creation-form: Prevent newline characters in the description.,"This commit achieves two things:
  1. Changes the UI of the ""Create stream"" form to make the
     textarea previously used to get the stream description
     a simple input field of type text (to suggest a single
     line description).

  2. Adds an extra check on the frontend side to make sure that
     when users create a new stream via. the ""Create stream""
     option in the settings panel, they can't enter any newline
     characters (i.e. we disallow the enter key from being
     registered when typing out the stream description).
     We must also make sure that they cannot copy-and-paste over
     descriptions containing newline characters.

NOTE: Because of the 1st change (UI change) for the most part, users are already prohibited from entering newline characters making the 2nd change partially redundant. However, since these extra checks are not particularly expensive, they would be a good idea to keep. 

resolves issue #11617.",Hypro999,b'area: stream settings bug size: S',2019-02-20T18:48:55Z,2019-04-03T08:00:54Z
11621,markdown: Emoji in bold format produces wrong duplicated (nested) span for emoji.,"Example 

If some one composes reactions in bold like ** :tada:  ** then it's markup is:

```
<span aria-label=""tada"" class=""emoji emoji-1f389"" role=""img"" title=""tada"">
    <span aria-label=""tada"" class=""emoji emoji-1f389"" role=""img"" title=""tada"">
        🎉
    </span>
</span>
```

So is this a issue or intensional?

https://chat.zulip.org/#narrow/stream/3-backend/topic/reactions.20in.20bold/near/703183

Relevant: https://zulip.readthedocs.io/en/latest/subsystems/markdown.html

@zulipbot label emoji
@zulipbot label markdown",jainkuniya,b'area: emoji area: markdown bug priority: high',2019-02-20T15:05:25Z,2019-05-02T00:04:50Z
11619,Slack import fails with KeyError: 'url_private',"Full stack trace during the import of a recently imported Slack Dump:

```
2019-02-20 13:56:31.207 INFO [] Writing Messages to /home/zulip/deployments/2019-02-11-23-41-46/[…]/messages-000109.json                                            

Traceback (most recent call last):
  File ""./manage.py"", line 50, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line        
    utility.execute()
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py"", line 356, in execute                          
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py"", line 283, in run_from_argv                        
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py"", line 330, in execute                              
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zerver/management/commands/convert_slack_data.py"", line 58, in handle                                                         
    do_convert_data(path, output_dir, token, threads=num_threads)
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zerver/data_import/slack.py"", line 888, in do_convert_data                                                                    
    realm, realm['zerver_userprofile'], realm['zerver_realmemoji'], domain_name, output_dir)                                                                                      
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zerver/data_import/slack.py"", line 542, in convert_slack_workspace_messages                                                   
    domain_name, long_term_idle)
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zerver/data_import/slack.py"", line 683, in channel_message_to_zerver_message                                                  
    uploads_list=uploads_list,
  File ""/home/zulip/deployments/2019-02-11-23-41-46/zerver/data_import/slack.py"", line 742, in process_message_files                                                              
    url = fileinfo['url_private']
KeyError: 'url_private'
```

Let me know if I can supply more info!",bascht,b'area: export/import bug help wanted',2019-02-20T13:58:46Z,2019-07-23T14:15:34Z
11617,"stream settings: Ban newlines in the stream description field of ""Create a stream""","Discussion at https://chat.zulip.org/#narrow/stream/137-feedback/topic/Stream.20description.

We just need to prevent users from adding newlines in the stream description field of this form: https://zulipchat.com/help/create-a-stream

For now, it's ok if it's not enforced on the backend.

(Marking as bug, since it's the cause of downstream bugs that we can ignore after making this change).",rishig,b'area: stream settings bug good first issue',2019-02-19T22:45:47Z,2019-02-20T20:29:16Z
11604,Fix overlap between gradients and integrations footer.,"Before:
![screenshot at feb 17 12-28-30](https://user-images.githubusercontent.com/15116870/52918757-8b585b80-32af-11e9-8307-835e3e3aefac.png)
Note that the end of the white gradient (`hsl(0, 0%, 100%)`) isn't the same color as the background of the footer (`hsl(0, 0%, 98%)`, hence the changes in the 1st commit.

After:
![screenshot at feb 17 12-27-30](https://user-images.githubusercontent.com/15116870/52918751-711e7d80-32af-11e9-9bec-49126e15998e.png)

Fixes #11591.",synicalsyntax,b'area: portico bug size: S',2019-02-17T20:29:23Z,2019-02-18T23:51:22Z
11601,message editing: Changing topic of message doesn't properly update view.,"I was able to repro the following on czo:
* As admin, 
* Go to narrow with old messages
* Change the topic of a previous message (select ""Only this message"")

It adds the new topic to the left sidebar, but the topic of the message doesn't change. If you reload, or click to a different topic and back, it updates to the correct thing.

Did not try many other permutations (non-admin, not an old message, etc.), but this does not repro if you select ""Change later messages to this topic"".",rishig,b'area: message-editing area: onboarding bug help wanted priority: high',2019-02-17T17:10:09Z,2019-07-23T14:15:33Z
11591,integrations: Footer broken on category pages.,"Go to https://zulipchat.com/integrations/bots (or the equivalent in dev). The bottom of the page looks like:

![image](https://user-images.githubusercontent.com/890911/52905040-fa1eb180-31e8-11e9-9bfa-71ddc541293e.png)

It's fine on the `All` category.

",rishig,b'area: portico bug good first issue',2019-02-16T20:49:19Z,2019-02-18T23:43:42Z
11569,emoji: Fix traceback on opening emoji popover in quick succession.,"Since the bootstrap popovers are destroyed asynchronously so opening
a emoji popover in quick succession like by clicking the reaction
button on another message was causing a race condition which was
causing some operations to be applied on a destroyed emoji popover.
This commit fixes it by making sure to apply any operations on the
currently active popover.

Fixes: #9851.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",HarshitOnGitHub,b'area: emoji bug has conflicts size: S',2019-02-14T18:30:02Z,2019-02-14T19:35:55Z
11547,subs: Update Default streams data while renaming streams.,"If a stream is a default stream, this updates its name at `Default Streams`
section of `Organization settings` page.

Fixes: #11466


**GIFs or Screenshots:** 
![feb-13-2019 18-33-54](https://user-images.githubusercontent.com/40331304/52713723-11c62200-2fbe-11e9-85ce-5bb550b0fd05.gif)
",pragatiagrawal31,b'area: settings (admin/org) bug priority: high size: S',2019-02-13T13:06:14Z,2019-02-14T01:11:02Z
11531,responsiveness: Keyboard shortcuts icon doesn't disappear in narrow window.,"To repro: narrow the window till you see only two panes.

![image](https://user-images.githubusercontent.com/890911/52602341-1ac8bf00-2e17-11e9-86a8-d9eda80d76ed.png)
",rishig,b'area: general UI bug help wanted',2019-02-12T00:08:00Z,2019-02-12T00:08:53Z
11523,"bugdown: #3220 Add ShortcutExpansion class, it enables message shortcuts","<!-- What's this PR for?  (Just a link to an issue is fine.) --> [WIP] #3220 

**Testing Plan:** <!-- How have you tested? -->
* Manual testing: send messages like ""::afk"", ""fasgdfg:afk"", ... 
* Automated testing: run ""test-backend test_bugdown "" with some new test cases added to markdown_test_cases.json (Note that frontend tests will fail because frontend work has not been started yet)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",dmagrinya,b'size: M',2019-02-11T19:47:00Z,2019-02-17T20:46:36Z
11520,Multiple organizations with LDAP backend,"Currently, Zulip allows multiple organizations with LDAP backend. In the case of the existence of the same user in several organizations, the synchronization with the LDAP fails with error.",santherics,b'area: authentication bug',2019-02-11T11:06:27Z,2019-11-21T19:15:08Z
11512,topic: Change topic update limit from 2 to 7 days.,"Changed topic update limit from 2 days to 7 days when the propagate mode
is 'change_all'. Relevant option label in the frontend is changed as well
to avoid confusion.

**Testing Plan:**
Manually tested it by generating messages for past 3 months and changing
topic of 3 months old message with propagate mode 'change_all'. Topic got
changed only for the selected message and messages sent in recent 7 days.

Fixes: #11475.",overide,b'area: message-editing bug size: S',2019-02-10T10:20:28Z,2019-03-10T20:37:24Z
11509,Bankruptcy modal background incorrectly rendered on webkit mobile,"Our modal component background is being rendered after the ```.app``` div which contains the contents of the application. This was causing a problem in webkit browsers on mobile where the z-index of the backdrop was being read as being higher than that of the modal contents.

![img_2196](https://user-images.githubusercontent.com/322991/52532083-31064a80-2d45-11e9-94a5-8c5d53f038ab.PNG)

See https://chat.zulip.org/#narrow/stream/6-frontend/topic/Problem.20with.20catch.20up.20overlay.20on.20mobile.20site",armaanahluwalia,b'area: general UI area: mobile web bug',2019-02-10T09:35:01Z,2020-04-26T09:56:12Z
11508,decorator.py: Add `max_int_size` param to `to_non_negative_int()`.,"Add `max_int_size` parameter to `to_non_negative_int()` in
decorator.py so it will be able to validate that the integer doesn't
exceed the integer maximum limit.

Fixes #11451

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",refeed,b'area: settings (admin/org) bug size: M',2019-02-09T23:26:13Z,2019-03-01T19:17:13Z
11504,frontend: Green bar is even visible after clicking Allow in permission browser prompt.,"The green bar encouraging the user to enable desktop notifications doesn't dismiss even after selecting `Allow` option in the browser-initiated prompt.

Steps to reproduce:
* Open realm in new Incognito tab.
* Send a message to the account  which is open in Incognito (or wait for sometime until  a message arrives and notif permission prompts automatically)
* Clicks `Allow`
* Green bar is even visible.

> Tim Abbott: Hmm, I think the bug here is we shouldn't be triggering the browser prompt not through clicking the green bar.

https://chat.zulip.org/#narrow/stream/6-frontend/topic/green.20bar.20at.20top.20to.20enable.20notification",jainkuniya,b'area: notifications (messages) bug help wanted',2019-02-09T12:12:13Z,2019-06-12T23:14:35Z
11488,"""Sent to wrong narrow"" notifications do not appear for messages that can't be locally echoed","Read https://zulip.readthedocs.io/en/latest/subsystems/markdown.html and https://zulip.readthedocs.io/en/latest/subsystems/sending-messages.html before working on this issue so you know what's going on.

Our ""you sent a message to a different narrow"" banner (and other notifications about sending to unusual places) is triggered by `notifications.notify_local_mixes`.  We only call this here, in the case where the message was locally echoed:

```
    if (locally_echoed) {                                                                                                              
        var need_user_to_scroll = render_info && render_info.need_user_to_scroll;                                                      
        notifications.notify_local_mixes(messages, need_user_to_scroll);                                                               
    }                                                                                                                                  
```

Messages are not locally echoed when `markdown.contains_backend_only_syntax()` returns true; the simplest example is the URL of an image (which would be rendered to include an inline preview of the image by the backend).

We should be calling `notifications.notify_local_mixes` for messages you sent from the current client but that could not be locally echoed.  This is complicated by the fact that we don't have a natural way to detect which messages which were not locally echoed were sent by the current client, as is.  So the fix for this issue involves:
(1) Changing our message-sending logic to still compute some sort of `local_id` and send it through the API to the server, even if we did not locally echo the message, and adding whatever state tracking we need to trying to replace a locally echoed message if we didn't actually locally echo it.
(2) Changing that variable `locally_echoed` to `sent_by_this_client`.

This is a somewhat complex issue that will require some careful code-reading, but likely only a handful of lines of changes that aren't renaming variables for clarity.  
",timabbott,b'area: message view area: notifications (messages) bug help wanted',2019-02-07T23:11:44Z,2019-07-23T14:16:32Z
11482,"guest users: Fix buggy rendering of ""subscriber count""","'All stream' tab disabled for guest user and added test to keep coverage.

![obraz](https://user-images.githubusercontent.com/26672113/52440942-a7c1fe80-2b1f-11e9-8c14-6db4b8e58199.png)

Disabled tab switching with mouse, arrows.
'/#streams/all' redirects now to '/#streams/subscribed'

This button:
![obraz](https://user-images.githubusercontent.com/26672113/52441054-fff90080-2b1f-11e9-8580-3ef7c1f91fdb.png)
redirects also to subscribed tab.

Fixes: #10980",matkaczmarek,b'area: stream settings bug size: M',2019-02-07T20:37:06Z,2019-05-14T00:28:53Z
11466,renaiming a default stream,"I have a similar problem as here  #3893 
I renamed one of the default streams. The new name was not passed to the default stream settings. I also couldn't delete the old stream name from the defaults and add the new name. I had to rename the stream again (back), then delete it from the default, then rename it, then add the renamed stream again.

my zulipserver version is git:master ",ftribrunn,b'area: settings (admin/org) bug priority: high',2019-02-06T13:04:49Z,2019-07-23T14:16:32Z
11451,Make to_non_negative_int support a maximum argument,"Our `to_non_negative_int` REQ converter (read our ""developer tutorials"" if you don't know what this is) should validate the maximum for the integer, and return a user error in the case that it's too large.  

Probably should change it to a nested decorator `to_non_negative_int(max: int=None)`.  See `api_key_only_webhook_view` for an example similar decorator.  The error message can be e.g. ""'%s' is too large (max %s)"".

I think it makes sense to have a default maximum of 2^32-1 (for the use cases that are e.g. a message ID), but probably some call points will want something more like 10000.  

As a reproducer, here's the exception if you e.g. put a bunch of 9s as your message edit time limit.

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 143, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 707, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 686, in authenticate_log_and_execute_json
    return limited_view_func(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 853, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 136, in wrapper
    return func(request, user_profile, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 220, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/realm.py"", line 150, in update_realm
    allow_community_topic_editing)
  File ""./zerver/lib/actions.py"", line 592, in do_set_realm_message_editing
    'message_content_edit_limit_seconds',
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 808, in save
    force_update=force_update, update_fields=update_fields)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 838, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 905, in _save_table
    forced_update)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 955, in _do_update
    return filtered._update(values) > 0
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 667, in _update
    return query.get_compiler(self.db).execute_sql(CURSOR)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 1204, in execute_sql
    cursor = super(SQLUpdateCompiler, self).execute_sql(result_type)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 899, in execute_sql
    raise original_exception
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 889, in execute_sql
    cursor.execute(sql, params)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 64, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/utils.py"", line 94, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/utils/six.py"", line 685, in reraise
    raise value.with_traceback(tb)
  File ""/home/zulip/deployments/2019-02-03-06-56-36/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 64, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 32, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 19, in wrapper_execute
    return action(sql, params)
django.db.utils.DataError: integer out of range
```",timabbott,b'area: settings (admin/org) bug good first issue help wanted',2019-02-04T22:30:58Z,2019-07-23T14:16:31Z
11448,Emoji Popup abruptly closes on android mobile website,"This is a bug.
This issue occurs when we add emoji reaction to sent messages.

Steps to follow try to reproduce:
1) open zulip website on an android mobile browser (I tried chrome only)
2) try to add emoji to a message
3) The emoji popup and android keyboard appears. Then both disappear abruptly before user can select an emoji

Note: This issue was tested on iphone but was not happening there.
It would be nice if android users can verify this issue in other browsers in android.

",thedeveloperr,b'area: mobile web bug',2019-02-04T20:05:17Z,2019-07-23T14:16:31Z
11447,markdown: Disable definition/reference links in marked.,"We had disabled reference style links in bugdown, however,
we hadn't disabled them in marked. This commit rectifies
that and adds test cases for the same.

Fixes #11350.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",aero31aero,b'area: markdown bug size: S',2019-02-04T10:31:21Z,2019-02-05T04:44:44Z
11388,bugdown: Improve logging of message numbers.,,showell,b'size: M',2019-01-29T20:36:18Z,2019-01-29T20:49:57Z
11374,manage.py streams_stats broken ?,"i installed latest zulip from master and we successfully imported hipchat archive. looks good so far.

i tried to get a list of all streams with stream_stats.

apparently, something seems broken.

there should be >100 rooms/streams (i can see in webgui), but streams_stats does not list
private streams at all and prints out ""70 private streams"" for the public ones

looks like a bug to me.

btw, how do i list all streams with manage.py ?

```
/manage.py stream_stats
zulip
------------
                   stream     subscribers   messages
0 private streams


------------
                   stream     subscribers   messages
--- list of public streams here ---
70 private streams
```",devZer0,b'area: analytics bug good first issue help wanted',2019-01-28T14:53:45Z,2019-01-31T23:06:07Z
11351,Fixes Issue 11219,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes https://github.com/zulip/zulip/issues/11219 I created a new PR and closed an old one due to linting error in commit.

**Testing Plan:** <!-- How have you tested? -->
I have manually tested it and wrote automated tests for it.
I tested the backend changes that catches 500 error manually by adding latency as described here:
https://github.com/zulip/zulip/issues/11219#issuecomment-454388029
After backend change commits I made frontend commits.
Frontend changes were tested in chrome and safari. I used chrome's network throttle feature in developer tools to test delete spinner.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![11219 pull req jan-25-2019 01-42-59](https://user-images.githubusercontent.com/23462580/51708798-d2558700-204a-11e9-986c-c48b24ed25a9.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->",thedeveloperr,b'area: api bug priority: high size: L',2019-01-24T21:14:00Z,2019-01-25T19:09:32Z
11350,frontend vs backend markdown: Comments are rendered as text in the former but hidden in the latter.,"Typing `[//]: <> (comment)` into the message box will result in the message being empty then after a moment, shows `[//]: <> (comment)`.",rht,b'area: markdown bug help wanted',2019-01-24T21:00:02Z,2019-02-04T19:16:39Z
11349,Fixes #11219,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fix for: https://github.com/zulip/zulip/issues/11219

**Testing Plan:** <!-- How have you tested? -->
I have manually tested it and wrote automated tests for it.
I tested the backend changes that catches 500 error manually by adding latency as described here 
https://github.com/zulip/zulip/issues/11219#issuecomment-454388029
After backend change commits I made frontend commits.
Frontend changes were tested in chrome and safari. I used chrome's network throttle feature in developer tools to test delete spinner.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![11219 pull req jan-25-2019 01-42-59](https://user-images.githubusercontent.com/23462580/51705951-0af16280-2043-11e9-8e59-ddb6a9640660.gif)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->",thedeveloperr,b'area: api bug priority: high size: L',2019-01-24T20:19:12Z,2019-01-24T21:06:30Z
11347,Added 'Errored' and 'Canceled' to bad statuses in Travis webhooks,"Fixes #11259

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
https://github.com/zulip/zulip/issues/11259

**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",akshaygupta533,b'area: integrations bug size: XS',2019-01-24T19:51:11Z,2019-01-26T23:54:41Z
11344,Fixes #11183,"

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixed #11183 

**Testing Plan:** <!-- How have you tested? -->
An user named gaël was registered then in compose box I try to mention that user and i was able to mention it.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
!
[ezgif com-video-to-gif](https://user-images.githubusercontent.com/32260593/51694818-9e1c9f00-2027-11e9-8b8a-cbcd4c3a2d4b.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",ss62171,b'area: compose area: i18n bug priority: high size: M',2019-01-24T17:00:59Z,2019-01-31T18:46:31Z
11333,Fixed #11183,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
https://github.com/zulip/zulip/issues/11183


**Testing Plan:** <!-- How have you tested? -->
An user named **gaël** was registered then in compose box I try to mention that user and i was able to mention it.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
!-->
[ezgif com-video-to-gif](https://user-images.githubusercontent.com/32260593/51565745-ce91fb00-1eb8-11e9-8f3e-f5c2a365b3eb.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
Fix #11183 
",ss62171,b'area: compose area: i18n bug priority: high size: S',2019-01-22T21:14:55Z,2019-01-24T18:31:21Z
11330,Fix,"Fix #11183 
**Testing Plan**
A user **Gaël** was registered, then i tried to mention this user in compose box.


![ezgif com-video-to-gif](https://user-images.githubusercontent.com/32260593/51558155-c760f200-1ea4-11e9-83e6-fd0bd75bb299.gif)
",ss62171,b'area: compose area: i18n bug priority: high size: XS',2019-01-22T16:58:25Z,2019-01-22T18:55:38Z
11324,Button to create a new stream is not visible in mobile browser,"When I tried to create a new test stream in my test organisation, in my mobile browser, I added stream name and description. Now create stream button is at bottom in this form. I scroll down to most possible bottom side in browser, but button is still not visible. Only a 5-10% of its portion is visible(Only top line of button). 
![whatsapp image 2019-01-20 at 6 30 28 pm](https://user-images.githubusercontent.com/39343253/51439513-91274500-1ce1-11e9-807a-cc75bcbcfaf4.jpeg)
",ruchit2801,b'area: mobile web area: stream settings bug',2019-01-20T13:02:15Z,2020-09-15T05:48:13Z
11321,bugdown: Restructure Bugdown to extend Markdown from being an extension.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->

This is currently the minimum amount of code changes to pass the tests, with iteratively completing the migration to the new api, and some cleanup.

**Testing Plan:** <!-- How have you tested? -->

Testing using existing tests and dev server.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",aero31aero,b'size: XL',2019-01-20T08:32:05Z,2019-01-28T21:12:59Z
11301,Fix handling of ctrl+C when cloning a virtualenv,"Our Python dependency management system (https://zulip.readthedocs.io/en/latest/subsystems/dependencies.html) generally does a good job of ensuring that you're always running the correct version of everything if you just run provision.  

But there is a reproducible issue that I've seen:
* Start with a provision virtualenv
* Add a new Python package to requirements/dev.txt
* Run provision
* Hit ctrl-C to interrupt the process while it's installing the packages in the virtualenv via `pip install` (I do this sometimes when I realize I don't actually want to provision in that shell and want to use a different one for it)
* Now run provision again.
* Try to start Zulip using the virtualenv -- this will crash.

What we should do is ""fix"" the broken virtualenv by reinstalling it, but we don't.  We already have a stamp file / manifest system to do a write once virtualenv construction is complete, and `setup_venv.py` checks that the resulting stamp file is in place before proceeding.  From some testing, it appears the problem is that `virtualenv-clone` ends up copying the `success-stamp`.

```
(zulip-py3-venv) tabbott@zaset:~/zulip$ virtualenv-clone /srv/zulip-py3-venv/ /tmp/newve
ls -ltr /tmp/newve(zulip-py3-venv) tabbott@zaset:~/zulip$ ls -ltr /tmp/newve
total 32
drwxr-xr-x 3 tabbott tabbott 4096 Jan  7 10:33 lib
drwxr-xr-x 2 tabbott tabbott 4096 Jan  7 10:33 include
-rw-r--r-- 1 tabbott tabbott   59 Jan  7 10:33 pip-selfcheck.json
drwxr-xr-x 5 tabbott tabbott 4096 Jan  7 10:34 share
-rw-rw-r-- 1 tabbott tabbott 4983 Jan 11 11:22 setup-venv.log
-rw-rw-r-- 1 tabbott tabbott 1986 Jan 11 11:22 package_index
drwxr-xr-x 3 tabbott tabbott 4096 Jan 11 11:22 bin
-rw-rw-r-- 1 tabbott tabbott    0 Jan 11 11:22 success-stamp
```

So probably we just need to remove that file after doing virtualenv-clone, but this needs some careful manual testing that I don't have time for right now, hence the issue.",timabbott,b'area: dependencies area: tooling bug help wanted',2019-01-17T00:38:32Z,2019-02-16T19:26:34Z
11299,Fix #10867,"A line is commented in file static/js/portico/signup.js which fixes the issue

https://github.com/zulip/zulip/issues/10867
<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
An organisation with url **shubh** was already created then i tested with new email and same url , after submitting form it shows **subdomain not available** and ""Full Name"" field was not cleared then i replace url with new one and after submitting form **sign up** process completed.


![ezgif com-video-to-gif](https://user-images.githubusercontent.com/32260593/51278460-a742b600-1a00-11e9-82b5-76a7cf9f8bb4.gif)



**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",ss62171,b'area: onboarding bug size: XS',2019-01-16T21:07:57Z,2019-01-18T20:59:40Z
11297,ldap: Changes to invitation registration flow and some bug fixes.,"This commit fixes the issues mentioned in #11212 along with some warts I found while working on this.

Fixes: #11212.",HarshitOnGitHub,b'area: authentication bug priority: high size: XL',2019-01-16T09:00:11Z,2019-01-17T18:20:27Z
11292,stream settings: Remove ability for members to create admin-only streams.,"This commit takes away the ability for non-admin members to create streams
where only admins can post messages by hiding the option from them.

Fixes #11290

**Admin**
![screenshot 2019-01-16 at 2 59 28 am](https://user-images.githubusercontent.com/33068691/51211198-d4c52c00-193a-11e9-8d65-aaf752d36ca3.png)

**Member**
![screenshot 2019-01-16 at 2 59 47 am](https://user-images.githubusercontent.com/33068691/51211207-dee72a80-193a-11e9-92bf-9e40cc63fde4.png)
",vrongmeal,b'area: stream settings bug size: M',2019-01-15T21:30:51Z,2019-03-09T16:12:28Z
11291,message_edit: Fix message edit history breakdown on large messages.,"This removes max_height from .message_edit_content in
static/styles/zulip.scss.

Fixes: #5629.",Amadeo234,b'area: message-editing bug size: S',2019-01-15T19:52:50Z,2019-02-08T23:49:05Z
11290,Don't offer members the ability to create a stream only administrators can post to,"Currently, in the ""create stream"" UI, we offer the ""restrict posting to organization administrators"" option regardless of whether the user creating the stream is an organization administrator, which can result in them creating a stream that they can neither post to not change the settings for to allow them to post.

We should fix this by just hiding that option for non-admin users.

Original report here: https://chat.zulip.org/#narrow/stream/6-frontend/topic/restrict.20to.20admins/near/682476",timabbott,b'area: stream settings bug help wanted',2019-01-15T19:34:19Z,2019-07-23T14:16:25Z
11287,zulip-puppet-apply tries to install pgroonga from PPA under Debian,"puppet/zulip/manifests/postgres_appdb_base.pp tries to install pgroonga from PPA:
```
  if $pgroonga == 'enabled' {
    apt::ppa {'ppa:groonga/ppa':
      before => Package[""postgresql-${zulip::base::postgres_version}-pgroonga""],
    }
```
Under Debian we need to setup pgroonga repo in another manner:
```
wget -O /usr/share/keyrings/groonga-archive-keyring.gpg https://packages.groonga.org/debian/groonga-archive-keyring.gpg
echo 'deb [signed-by=/usr/share/keyrings/groonga-archive-keyring.gpg] https://packages.groonga.org/debian/ stretch main' > /etc/apt/sources.list.d/groonga.list
apt update
```",ilyaevseev,b'area: production installer bug',2019-01-15T07:36:45Z,2019-01-15T23:25:14Z
11286,zulip-puppet-apply fails on Debian Stretch because python-software-properties unavailable.,"zulip-puppet-apply tries to install python-software-properties package that's presented in Debian Jessie (oldstable) but excluded from Debian Stretch (current stable) and replaced by software-properties-common.

It seems that lsbdistrelease 9.6 is recognized in puppet/apt/manifests/ppa.pp and puppet/apt/spec/defines/ppa_spec.rb as old Ubuntu version instead of modern Debian.",ilyaevseev,b'area: production installer bug',2019-01-15T07:23:03Z,2019-01-16T19:01:14Z
11283,#Web Invite new users,"When i am trying to invite new users, the following fault appears.
![web invite users](https://user-images.githubusercontent.com/45594372/51139990-057b6780-184e-11e9-9c97-ad284a49bfcf.JPG)
",gregzil,b'area: onboarding bug priority: high',2019-01-14T20:45:12Z,2019-07-23T14:16:25Z
11279,"OS specific docs not showing User's default OS tab as active when opened form left help sidebar.""","when opened with complete url shows correct tab as active. 
![screenshot 4](https://user-images.githubusercontent.com/36725774/51135994-6b251f00-1861-11e9-8171-603c150dcb74.png)
when opened by clicking from left help sidebar showing first tab as active.
![screenshot 5](https://user-images.githubusercontent.com/36725774/51136086-a4f62580-1861-11e9-9fdf-453ce29dcdfa.png)",adarshPatel509,b'area: documentation (user) bug',2019-01-14T19:37:56Z,2019-01-14T22:38:25Z
11271,Add proper validation for stream color inputs,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
***Purpose of this PR:***
This should solve issue #11268 
",Hypro999,b'area: api area: stream settings bug priority: high size: M',2019-01-14T07:04:38Z,2019-01-15T02:04:04Z
11268,Add proper validation for stream color inputs,"We should add proper validation that ""stream color"" inputs are valid HTML colors in the format of `#abcd12` where the 6 colors after the hash are valid hex characters.  I think doing this basically involves just changing `update_subscription_properties_backend` to replace `check_string` with a a new validation function `check_color`, and adding some tests.",timabbott,b'area: api area: stream settings bug priority: high',2019-01-14T04:12:09Z,2019-01-14T18:19:04Z
11265,uploads: Return HTTP 400 for decompression bombs and some UI fixes.,Fixes: #11215.,HarshitOnGitHub,b'area: uploads bug size: M',2019-01-13T08:14:29Z,2019-01-14T22:35:32Z
11259,"In Travis webhooks, include an emoji for status 'Errored'","The Travis CI integration does not recognize the status 'Errored' and does not display an emoji for it:

<img width=""910"" alt=""Travis CI Bot: Author: Chelsea Voss
Build status: Errored (No emoji specified for status 'Errored'.)
Details: changes, build log"" src=""https://user-images.githubusercontent.com/3229696/51060119-6fbcaf80-15a3-11e9-96ac-ac83e3003e3c.png"">


The fix should be a small change to [zerver/webhooks/travis/view.py](https://github.com/zulip/zulip/blob/master/zerver/webhooks/travis/view.py), adding `'Errored'` to `BAD_STATUSES`.",csvoss,b'area: integrations bug good first issue help wanted',2019-01-11T21:21:34Z,2020-03-18T00:49:50Z
11255,Invite users results in error,"Inviting multiple users results in error 'Argument ""invite_as"" is not valid JSON.'

I have a screenshot but it contains PII. I can reproduce this error with only one user.",sakebomb,b'area: onboarding bug priority: high',2019-01-11T16:51:08Z,2019-01-15T12:29:26Z
11241,Add support for passing language into send_future_email.,Fixes #11240 ,akornor,b'area: emails area: i18n bug size: S',2019-01-09T23:38:38Z,2019-01-10T01:50:05Z
11240,Add support for passing language into send_future_email,"The invitation_reminder email, and possibly other emails using send_future_email, are not properly internationalized because we aren't passing through the proper language details.  

The correct fix to this for the invitation reminder email is roughly:
```
diff --git a/zerver/worker/queue_processors.py b/zerver/worker/queue_processors.py
index 0ddc730..4b392f5 100644
--- a/zerver/worker/queue_processors.py
+++ b/zerver/worker/queue_processors.py
@@ -235,6 +235,7 @@ class ConfirmationEmailWorker(QueueProcessingWorker):
             to_emails=[invitee.email],
             from_address=FromAddress.tokenized_no_reply_address(),
             context=context,
+            language=referrer.realm.default_language,
             delay=datetime.timedelta(days=2))
 
 @assign_queue('user_activity')
```

however, we need to also tweak `send_future_email` and friends to pass the data through.

@hackerkid @akornor do one of you want to take this one?

",timabbott,b'area: emails area: i18n bug help wanted',2019-01-09T22:33:50Z,2019-07-23T14:16:23Z
11238,Deactivating and reactivating users doesn't create an immediate updation of list. ,"To reproduce go to organization settings >users / organization settings>Deactivated users.Reactivate or Deactivate a user,the cross across the user name is updated immediately.But the list is updated only after closing and reopening settings.
just after reactivating AARON@ZULIP the deactivated users list looks like below.
![issue 1](https://user-images.githubusercontent.com/27897288/50923040-f70a0600-1471-11e9-825e-f5ed14728b88.png)
After closing and re-opening settings both the users and deactivated users list gets updated as below
![issue 3](https://user-images.githubusercontent.com/27897288/50923094-1bfe7900-1472-11e9-8d62-6e39cad0a7ac.png)
![issue4](https://user-images.githubusercontent.com/27897288/50923100-1ef96980-1472-11e9-95d0-65ac63329d93.png)

T0-Do:1)The list should get updated as soon as we confirm reactivation or deactivation
2)Show the corresponding success message.",jeswincyriac,b'area: settings (admin/org) bug',2019-01-09T19:24:49Z,2019-03-21T16:57:50Z
11237,auth: Allow users to login with only username if `LDAP_APPEND_DOMAIN` is set.,"Fixes: #10917.

**Testing Plan:** I have tested the changes manually as well as added automated tests.",HarshitOnGitHub,b'area: authentication bug has conflicts priority: high size: L',2019-01-09T18:24:09Z,2019-01-09T18:53:39Z
11236,outgoing webhooks: Set a Zulip-specific user-agent.,"This now sets the user-agent to something like:

    ZulipOutgoingWebhook/2.0

(It uses the current ZULIP_VERSION.)

Before this change, the user-agent would be
something like `python-requests/2.18.4`.

Fixes #10741

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",showell,b'area: api bug priority: high size: S',2019-01-09T14:32:19Z,2019-01-09T18:46:25Z
11228,portico: Fix overlap of server and frontend errors.,"Clears the errors received from the server whenever there is a chance of
overlap among them.

Fixes #10831

**GIFs or Screenshots:**

![ezgif-4-fdaf66d12d85](https://user-images.githubusercontent.com/33068691/50884349-ad3d0380-1410-11e9-8ab8-dc5c54cde5ee.gif)

The server errors only clear up when the errors overlap, not when there's an error in another field...

![screenshot 2019-01-09 at 12 44 04 pm](https://user-images.githubusercontent.com/33068691/50884391-c9d93b80-1410-11e9-90eb-645f2aee6c86.png)",vrongmeal,b'area: portico bug size: S',2019-01-09T07:47:07Z,2019-01-09T20:59:12Z
11219,Fix handling of duplicate requests to delete a message,"From our server logs, we occasionally see this sequence for users using the webapp, where the the `DELETE` requests are being apparently retransmitted several times to the server in the same second:

```
2019-01-07 23:45:18.583 INFO [zr] IP DELETE  200 155ms (db: 127ms/17q) /json/messages/ID
2019-01-07 23:45:19.069 INFO [zr] IP DELETE  500 640ms (db: 81ms/5q) /json/messages/ID
2019-01-07 23:45:19.069 INFO [zr] IP DELETE  500 641ms (db: 139ms/5q) /json/messages/ID
2019-01-07 23:45:19.072 INFO [zr] IP DELETE  500 643ms (db: 94ms/5q) /json/messages/ID
```

Based on those logs, I'm pretty sure all 4 requests were received by the server essentially simultaneously (i.e. at 18.583 - 155ms ~= 19.069 - 640ms).  I think there's two possibilities for the problem here:

* The click handler logic here is broken, and ends up somehow creating multiple click handlers if you do the right sequence of things.  It seems a bit hard to believe, though, given the chained placement of the `.off()` here:
```
exports.delete_message = function (msg_id) {                                                                        
    $(""#delete-message-error"").html('');                                                                            
    $('#delete_message_modal').modal(""show"");                                                                       
    $('#do_delete_message_button').off().on('click', function (e) {                                                 
        e.stopPropagation();                                                                                        
        e.preventDefault();                                                                                         
        channel.del({                                                                                               
            url: ""/json/messages/"" + msg_id,                                                                        
            success: function () {                                                                                  
                $('#delete_message_modal').modal(""hide"");                                                           
            },                                                                                                      
            error: function (xhr) {                                                                                 
                ui_report.error(i18n.t(""Error deleting message""), xhr,                                              
                                $(""#delete-message-error""));                                                        
            },                                                                                                      
        });                                                                                                         
                                                                                                                    
    });                                                                                                             
};                                                                                                                  
```

* The other possible problem here is just that `DELETE` (hard-delete a message) HTTP requests are allowed to be arbitrarily repeated by browsers, caches, etc., and that's what's happening.  This seems a little suspicious, though, because sending 4 requests in the same ~5ms period is pretty aggressive for this feature.

I believe mobile doesn't yet use this API, so we can get away with changing the endpoint at this stage if we think that's use of HTTP DELETE (as opposed to a POST to /delete) is the root cause of the problem here.

",timabbott,b'area: api bug help wanted priority: high',2019-01-08T00:06:22Z,2019-07-23T14:17:24Z
11216,import: Fix missing import logic for organization avatar and logo,"We don't currently have logic to import the organization avatar and organization logo data, even though those are included in our exports.  I think this shouldn't be super hard to add, given that we already have template logic for e.g. custom emoji, which have a similar structure.",timabbott,b'area: export/import bug',2019-01-07T23:57:00Z,2020-02-03T22:27:10Z
11215,Make attempts to upload a decompression bomb image/avatar not 500,"Currently, if you try to upload a super giant image in Zulip, we throw this 500 exception:

```
  File ""./zerver/views/user_settings.py"", line 196, in set_avatar_backend
    upload_avatar_image(user_file, user_profile, user_profile)
  File ""./zerver/lib/upload.py"", line 727, in upload_avatar_image
    upload_backend.upload_avatar_image(user_file, acting_user_profile, target_user_profile)
  File ""./zerver/lib/upload.py"", line 615, in upload_avatar_image
    self.write_avatar_images(file_path, image_data)
  File ""./zerver/lib/upload.py"", line 603, in write_avatar_images
    resized_data = resize_avatar(image_data)
  File ""./zerver/lib/upload.py"", line 108, in resize_avatar
    im = Image.open(io.BytesIO(image_data))
  File ""/home/zulip/deployments/2019-01-07-01-23-35/zulip-py3-venv/lib/python3.4/site-packages/PIL/Image.py"", line 2642, in open
    im = _open_core(fp, filename, prefix)
  File ""/home/zulip/deployments/2019-01-07-01-23-35/zulip-py3-venv/lib/python3.4/site-packages/PIL/Image.py"", line 2633, in _open_core
    _decompression_bomb_check(im.size)
  File ""/home/zulip/deployments/2019-01-07-01-23-35/zulip-py3-venv/lib/python3.4/site-packages/PIL/Image.py"", line 2568, in _decompression_bomb_check
    (pixels, 2 * MAX_IMAGE_PIXELS))
PIL.Image.DecompressionBombError: Image size (4128062500 pixels) exceeds limit of 178956970 pixels, could be decompression bomb DOS attack.
```

The good news is that PIL already handles not crashing the server and provides a nice exception.  However, ideally, we'd catch that exception, return a JsonableError about it being an invalid image, and thus return a 400 type error for this sort of invalid user input.

(This presumably comes from someone on HackerOne evaluating Zulip).",timabbott,b'area: uploads bug help wanted',2019-01-07T23:41:20Z,2019-07-23T14:17:23Z
11212,ldap integration: Don't ask users to set a password when invited,"For users whose email addresses match the LDAP domain (or more generally, servers with only the LDAP authentication backend enabled), we currently have the following dissonant behavior:
* They can just create an account by entering their LDAP credentials on the login form
* If invited to join Zulip, they get prompted to set a password, which is silly because for an LDAP-only organization, these passwords are completely unused.

The invitation feature is useful in this context because one can set the default streams for a batch of users being invited, and set customized welcome email content.  

So we should fix this by making users who click an invitation link in an organization with only the LDAP backend enabled just enter their LDAP username/password to ""login"", but still get the default streams (etc.) experience from the invitation / PreregistrationUser object associated with it.

(I can't recall if we've addressed the similar issue of folks wanting to use Google auth to signup after being invited, but that's probably a related issue)
",timabbott,b'area: authentication bug priority: high',2019-01-07T18:45:45Z,2019-07-23T14:17:23Z
11183,Mentions with special characters,"In other languages than english, people may have accents or other special characters in their name.

It would be great to be able to search for people regardless of accents when using the `@mention` feature.

For example, If I type `@gael`, I would expect to see as a suggestion `gaël`, however currently it does not appear in the list.

I'm not sure which version of zulip our organization is using, I did not see it in the UI.",edi9999,b'area: compose area: i18n bug priority: high',2019-01-04T15:37:29Z,2019-07-23T14:17:23Z
11177,Success message visible even after switching to other settings on Org settings > Users.,"To reproduce, open Org settings > Users, edit and save any user. An alert ""Update Successfully!"" shows up on top of the page but it does not disappear even if we switch to other settings.",Varunvaruns9,b'area: settings UI bug help wanted',2019-01-03T23:28:47Z,2019-07-23T14:17:22Z
11175,user settings: Fix the position of get api key text and button.,"Fix the alignment of ""Current password"" and move the
""Get API key"" button to next line.

Fixes: #10535.

**GIFs or Screenshots:** 
Previously:
![screen shot 2019-01-04 at 1 36 34 am](https://user-images.githubusercontent.com/29421208/50659930-2200df80-0fc4-11e9-9df2-fa752c7ca45a.png)

Changed:
![screen shot 2019-01-04 at 1 33 10 am](https://user-images.githubusercontent.com/29421208/50659938-27f6c080-0fc4-11e9-8e49-b64682bb8033.png)
",Varunvaruns9,b'area: settings UI bug size: XS',2019-01-03T20:28:53Z,2019-01-03T21:48:39Z
11168,Can't save changes in Organization Permissions > Other,"![image](https://user-images.githubusercontent.com/13354331/50587957-3b990e80-0e80-11e9-9fa1-50210d51d2fd.png)
When I click ""Save changes"", nothing happens...",xerus2000,b'area: settings UI bug priority: high',2019-01-02T10:19:52Z,2019-07-23T14:17:22Z
11167,ui: Fix wrong usage of scrolling to top in ui.updateScrollbar.,"Fixes: #11141.

An alternate solution could be `element[0].scrollTop = 0`, both works fine. Since `ui.update_scrollbar` is used at many places so before merging it would great if this is tested manually (I've tested a few places).
GIFs:
Before:
![peek 2019-01-02 15-33 before](https://user-images.githubusercontent.com/22238472/50587402-cf300680-0ea3-11e9-8765-1ca957750f77.gif)

After:
![peek 2019-01-02 15-32](https://user-images.githubusercontent.com/22238472/50587410-d525e780-0ea3-11e9-8c9d-ca2e76c160b2.gif)
",shubhamdhama,b'area: settings UI bug priority: high size: XS',2019-01-02T10:04:29Z,2019-01-03T11:17:16Z
11157,Hide the message control icons when we are in message edit or view source mode,"Fixes #3802.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
https://github.com/zulip/zulip/issues/3802#issuecomment-304733440
View Source icon misbehaves for the message source being viewed. So the proposal is to hide the 3 message control icons when the message is being edited or source being viewed.


**GIFs or Screenshots:** 
![screenshot from 2018-12-30 00-57-06](https://user-images.githubusercontent.com/5001704/50541534-e59d4000-0bcd-11e9-96eb-5dd4b15baeb0.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",architkshk,b'area: message view bug size: XS',2018-12-29T19:27:42Z,2018-12-30T14:52:35Z
11155,notifications: Fix styling for sending group PM to several people,"Fixes #11058.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes styling for sending group PMs to several people out-of-view.



**GIFs or Screenshots:** 
![screenshot from 2018-12-30 00-15-41](https://user-images.githubusercontent.com/5001704/50541285-488bd880-0bc8-11e9-9ec0-88b3bfd4a40a.png)
![screenshot from 2018-12-30 00-15-51](https://user-images.githubusercontent.com/5001704/50541286-488bd880-0bc8-11e9-8eb8-c19d21728a87.png)
![screenshot from 2018-12-30 00-16-01](https://user-images.githubusercontent.com/5001704/50541287-49246f00-0bc8-11e9-9fce-9644dc5049cb.png)
",architkshk,b'area: compose area: mobile web bug priority: high size: XS',2018-12-29T18:47:34Z,2018-12-29T19:17:24Z
11141,Scrolling in Settings,"On scrolling down in one section of settings, if you move to another section then it is already scrolled down to the same level. When the other section has content enough to be scrolled it shows scrolled down content but when the other section is shorter than the original section it shows blank and we have to scroll up to see the settings.
![capture_1](https://user-images.githubusercontent.com/22577662/50516127-f915b180-0ace-11e9-8327-38daceb05154.PNG)
![capture_2](https://user-images.githubusercontent.com/22577662/50516128-fc10a200-0ace-11e9-9f8a-bdcb5d529041.PNG)
![capture_3](https://user-images.githubusercontent.com/22577662/50516207-793c1700-0acf-11e9-9dd8-bd509b8525be.PNG)


",TheVzard,b'area: settings UI bug priority: high',2018-12-28T13:06:39Z,2019-01-02T19:01:24Z
11138,"message view: We show ""Scroll down to view message"" even if Zulip scrolls message into view.","A bug I've run into a few times since the feature was released is that the ""Scroll down to view messages"" notice will show even if Zulip then subsequently does the scrolling for me. I believe it happens every time, so as long as you can reproduce the ""Zulip subseqeuntly scrolls"" behavior, you can probably reproduce this (sending a really tall message with the top of the compose box near the bottom of the feed is a good approach).

The sequence of events is
* I'll send a message, such that some part of it is hidden.
* The ""scroll down"" banner will show
* The message will scroll up into view",rishig,b'area: message view bug help wanted',2018-12-28T06:38:56Z,2019-07-23T14:17:22Z
11137,message editing: The edit message is unconstrained of MAX_LENGTH,"**Reproducing the issue** : Send a message greater than 10, 000 characters http://www.blindtextgenerator.com/lorem-ipsum , zulip will only take MAX_LENGTH, you won't be able to type anything after it. Now after sending it, click on edit message and append more content to it, you can now expand it to whatever length.

**Expected behaviour** : The text box should enforce a MAX_LENGTH limit while editing the message too.
for reference : https://chat.zulip.org/#narrow/stream/9-issues/subject/the.20edit.20message.20is.20unconstrained",gaharavara,b'area: message-editing bug',2018-12-28T05:34:43Z,2019-01-03T22:32:39Z
11116,bugdown: Trigger test failure for invalid Markdown include statements.,"Fixes #10947.

@timabbott: If you take an existing webhook doc (say `zerver/webhooks/github/doc.md`) and change one of the include statements to refer to a non-existent macro, `zerver/tests/test_docs` should fail and print an informative error message. Thanks! :)
",eeshangarg,b'size: XL',2018-12-23T01:14:25Z,2018-12-28T04:14:31Z
11079,Fix redis flakes on Ubuntu bionic in circleci,"We've been suffering from an annoying test infrastructure flake for a while, where `redis` doesn't start up properly in Ubuntu bionic like 1% of the time.  While rare, this is a significant problem for the project since CI flakes reduce confidence in CI failures being definitely your fault, and can be really confusing for new contributors to try to debug.  See

https://chat.zulip.org/#narrow/stream/43-automated-testing/subject/test.20flake/near/673889 for an example traceback.

I'm not sure we have a good way to debug the root issue of redis flaking, but I think we should do the following:
* Add a check, before test-backend starts, for whether `redis` is running; if it isn't, restart it.  
* Possibly add some logging when `test-backend` fails to check if `redis` is running, and if it isn't, `cat` the redis logs from `/var/log` so we can see if it crashed for a reason.",timabbott,b'area: testing-infrastructure bug help wanted priority: high',2018-12-18T20:18:34Z,2019-05-03T18:35:03Z
11072,stream_color: Fix stream colors always changing when you subscribe to a stream via web UI.,"Reproduction: Go to the ""Manage stream"" ""All"" tab, and click any stream you've never been subscribed to before.  The color will immediately change when you click it.

@showell I feel like I fixed this bug at some point in the past; the strategy is supposed to be that the we send the color the webapp had picked to the server in the subscribe request, so it knows what color to use.  

My guess is we may have broken this with your recent stream color perf optimization branch; can you investigate?
",timabbott,b'area: stream settings bug priority: high',2018-12-18T00:40:55Z,2019-01-26T14:20:29Z
11069,Accepting typeahead in the compose box is not properly advancing,"When you accept the autocomplete in the stream/topic boxes of the compose box, it should automatically advance you to the next field (and I think it used to, though not 100% sure).  Now, accepting the typeahead there leaves you in the same box, which is the correct behavior for PMs (since you may want to add a second user), but not for streams/topics.  

@shubham-padia probably this is a good issue for you, since you've been in the typeahead code a lot and it could be a side effect of one of your search refactors.",timabbott,b'bug priority: high',2018-12-17T22:19:57Z,2019-01-02T20:28:08Z
11063,Cannot install pgroonga for Zulip 1.9.1 on Ubuntu 18.04,"It seems that [pgroonga/migrations/0002_html_escape_subject.py](../blob/master/pgroonga/migrations/0002_html_escape_subject.py#L11) uses syntax that's incompatible with PostgreSQL 10:

```
# sudo -u zulip /home/zulip/deployments/current/manage.py migrate pgroonga
Operations to perform:
  Apply all migrations: pgroonga
Running migrations:
  Applying pgroonga.0001_enable... OK
  Applying pgroonga.0002_html_escape_subject...
    Range of rows to update: [1, 74065]
    Updating range [1,10001)
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/backends/utils.py"", line 62, in execute
    return self.cursor.execute(sql)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
psycopg2.NotSupportedError: source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 3:         SET (search_pgroonga) = (escape_html(subject) || ' '...
                                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 50, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/commands/migrate.py"", line 204, in handle
    fake_initial=fake_initial,
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/executor.py"", line 115, in migrate
    state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/executor.py"", line 145, in _migrate_all_forwards
    state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/executor.py"", line 244, in apply_migration
    state = migration.apply(state, schema_editor)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/migration.py"", line 129, in apply
    operation.database_forwards(self.app_label, schema_editor, old_state, project_state)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/operations/special.py"", line 193, in database_forwards
    self.code(from_state.apps, schema_editor)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/pgroonga/migrations/0002_html_escape_subject.py"", line 12, in rebuild_pgroonga_index
    escape=False, batch_size=10000)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zerver/lib/migrate.py"", line 61, in do_batch_update
    cursor.execute(stmt % tuple(params))
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/backends/utils.py"", line 64, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/utils.py"", line 94, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/utils/six.py"", line 685, in reraise
    raise value.with_traceback(tb)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zulip-py3-venv/lib/python3.6/site-packages/django/db/backends/utils.py"", line 62, in execute
    return self.cursor.execute(sql)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""/home/zulip/deployments/2018-12-13-17-22-20/zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
django.db.utils.NotSupportedError: source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 3:         SET (search_pgroonga) = (escape_html(subject) || ' '...
                                         ^

```",ilyaevseev,b'area: production bug',2018-12-17T00:01:20Z,2019-07-23T14:17:21Z
11061,styles: Fix compose options hidden when editing.,"This PR fixes an issue that when a message is being edited, sometimes compose options are hidden if there is no time limit. This also moves the options further from the time limit to make them more noticeable.

Fixes #11056.

**Screenshots:**

*With Time Limit:*

<img width=""911"" alt=""with time limit"" src=""https://user-images.githubusercontent.com/17259768/50058763-fe1f4c00-0131-11e9-8f50-11db907d9584.png"">

*Without Time Limit:*

<img width=""913"" alt=""without time limit"" src=""https://user-images.githubusercontent.com/17259768/50058765-01b2d300-0132-11e9-8cd7-8fbf7a21c6a7.png"">
",marco,b'area: message-editing bug priority: high size: S',2018-12-16T20:56:55Z,2019-01-05T00:48:46Z
11058,notifications: Fix styling for sending group PMs to several people out-of-view,"Notice the `x` being overlapped by the text content in this screenshot:

![image](https://user-images.githubusercontent.com/2746074/50057739-716d9180-0123-11e9-8e7f-c51a1692b902.png)

Reproducer:
* Make your Zulip window narrow.
* Narrow to a stream.
* Use `x` to compose a PM to a set of several users.
* Send the message; Zulip will notify you that the message appeared off-screen.

",timabbott,b'area: compose area: mobile web bug priority: high',2018-12-16T19:13:49Z,2019-07-23T14:17:21Z
11056,Make message_edit compose options look more similar to the compose box.,"Currently, the message edit area has several of the feature buttons of the main compose box (attachments, message formatting link), but in a weird place that makes them easy to miss:

![local_file 3](https://user-images.githubusercontent.com/2746074/50047969-49275980-0075-11e9-9429-783ab6fb7857.png)

We should at the very least move them to the left of the time limit thing (and maybe just left-justify them?)

Also, those buttons don't always show up in some configurations.  The problem seems to be related to the fact that they're incorrectly inside a duplicate copy of the `message-edit-timer-control-group` div, which is hidden by default.  So it only appears if you have a time limit set :(.",timabbott,b'area: message-editing bug help wanted priority: high',2018-12-15T22:34:54Z,2018-12-16T21:47:13Z
11054, upgrade-zulip: Use deploy_options specified in zulip.conf.,"Fixes #10534.

Manual testing:

- Commit 1: Use `upgrade-zulip-from-git` to deploy the `deploy_options` (the branch for this PR) branch. Add `--skip-migrations` to zulip.conf and run `upgrade-zulip-from-git` again and manually check that migrations were skipped (by making sure `Checking for needed migrations` statement is not printed)
- Commit 2: Use `upgrade-zulip-from-git` to deploy the `deploy_options` (the branch for this PR) branch. Add `--skip-migrations` to zulip.conf and run `upgrade-zulip` with the latest 1.9.1 tarball",shubham-padia,b'area: production installer bug size: M',2018-12-15T21:00:19Z,2018-12-16T15:52:56Z
11043,emails: Fix `.subject` files not being included for translation.,"We have the `templates/zerver/emails/*.subject` template files, several of which are tagged for translation via work in #9223.  However, this grep result:
```
(zulip-py3-venv) tabbott@zaset:~/zulip$ git grep 'Verify your new email address'
templates/zerver/emails/confirm_new_email.subject:{{ _(""Verify your new email address"") }}
zerver/tests/test_email_change.py:            'Verify your new email address'
zerver/tests/test_email_change.py:            'Verify your new email address'
```

shows that our `.subject` files don't appear in the `static/locale` directories, and clearly aren't actually being included for translation.  We should investigate and fix.",timabbott,b'area: emails bug priority: high',2018-12-14T07:22:13Z,2018-12-17T19:30:45Z
11033,frontend refactor: Use stream ids to track topic mutes,"In `static/js/muting.js` we currently keep track of muted topics using a `Dict` with the name `muted_topics`, and the key for that is a stream name.

We should change the data structure to be keyed on stream id, which will prevent the client from breaking on stream renames.  Also, in general, we want to use `stream_id` over `stream_name` everywhere we can in the client.  (It's more difficult for some features than others.)

Part of the problem here is that the backend, for legacy reasons, sends stream names in `page_params`.  The backend code generally works in `stream_id` space (good) but changing the `page_params` payload is a bit tricky (we need to not break mobile, basically).

We can defer changing the backend for now.  Instead, just have `set_muted_topics` immediately convert stream names to stream ids during page load.",showell,b'area: left-sidebar bug',2018-12-13T17:22:02Z,2019-07-23T14:17:20Z
11031,characters in names disappear on small screens,"![screenshot from 2018-12-13 15-02-02](https://user-images.githubusercontent.com/1678423/49943660-c83b5700-fee8-11e8-8c76-72e4640687a5.png)

on small screens part of the characters disappear.  

solution: 

_media.css_
```

    .sender_name {
        max-width: 250px;
   //     overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }

```",Alex-CodeLab,b'area: message view bug',2018-12-13T14:12:42Z,2019-02-05T00:46:19Z
11028,night mode: Alter compose warning background to fit night mode.,"Fixes #10916.
![screenshot at dec 12 18-36-51](https://user-images.githubusercontent.com/15116870/49912308-a2597800-fe3e-11e8-854c-3a00cba56670.png)
",synicalsyntax,b'area: compose bug size: S',2018-12-13T02:49:25Z,2018-12-13T23:25:20Z
11025,/me followed by quote (or other multiple-line content) is not parsed,"'/me' is ignored if the following line (or extra empty line followed by a quote line) is a quote line, eg:
![20181212_zulip-me](https://user-images.githubusercontent.com/29603576/49897369-f2771100-fe23-11e8-8107-601f86d2afed.png)
",catxeger,b'area: markdown area: message view bug help wanted',2018-12-12T20:38:52Z,2019-07-23T14:17:20Z
11015,"Rename ""zulip"" system bot realm to ""zulipinternal""","Folks sometimes get confused when using e.g. `manage.py list_realms` in production that there's usually a realm with the name `` (aka the empty string), which is the one they use, and one with the name `zulip`, which if their hostname is zulip.example.com, sounds a lot like it's the one they want.

We should fix this in these ways:
* [x] Have `manage.py list_realms` print the actual full domains/URLs of the organizations.
* [x] Rename `zulip` to `zulipinternal`.
* [ ] Spell the root domain as `.`, not `''`, at least for management commands.
* [x] Migrate the development environment to also have a `zulipinternal` realm, via patching `populate_db`.",timabbott,b'area: production bug help wanted',2018-12-11T21:24:44Z,2020-02-15T01:11:02Z
11008,emails: Make `ScheduledEmail` code path convert sender into email address in send_email,"This is a somewhat important bug fix for how Zulip's ""schedule an email to send in 2 days"" code path handles changes in the outgoing email configuration in the meantime, which can be quite confusing/difficult for a sysadmin trying out Zulip for the first time.  See #10879 for details.  

The root problem in #10879 was basically that ScheduledEmail objects end up setting the FromAddress value on creation, not at the time they're sent, which means that if you change settings (to fix your outgoing email), we don't actually have a way to update that state for the email system.

Possibly what we want to do is refactor the send_future_email / send_email interface to have e.g. ""NOREPLY"" or ""TOKENIZED_NOREPLY"" be what is included in the email saved in the ScheduledEmail table, and have the substitution for actually sending it happen inside manage.py deliver_email. That would be in line with our general strategy of e.g. rendering the email templates inside the final send_email function. 

This requires a bit of refactoring:
* First, change how tokenized noreply is encoded to have the randomization/substitution happen inside `send_email`, while preserving backwards compatibility.  Probably the right model is to have a new `sender_type` argument to `send_email`, and require either a sender email or a `sender_type`.  If `sender_type` was provided, then we compute the email for that sender type inside `send_email`.
* Then, make `send_future_email` use `sender_type`.  ",timabbott,b'area: emails bug priority: high',2018-12-10T19:14:45Z,2020-03-27T23:44:28Z
11005,Email in the Mobile Login flow is not appending the domain when using ZulipRemoteUserBackend authentication.,"When building the params hash in login_or_register_remote_user for mobile_flow_otp, the domain is not appened to the username when ZulipRemoteUserBackend auth is used. 

As a working I had to set append ""@domain.tld"" to the username on zerver/views/auth.py:161 in order to get the correct username to be sent to the client for the api auth to work correctly.",timapril,b'area: authentication bug',2018-12-10T15:41:34Z,2018-12-10T18:41:04Z
10989,bugdown: Optimize perf by replacing the base python-markdown.,"While this might cause breaking semantic changes at the corners, the benefit is a huge speed boost.
There are 2 options:
1. [mistune](https://github.com/lepture/mistune), pure python, is ~4-5x faster according to a 2014 benchmark [1]
2. [python-hoedown](https://github.com/hhatto/python-hoedown), a binding to an extensible C library, is ~80x faster according to the same benchmark, which most likely also consume a lot less memory.

[1] https://lepture.com/en/2014/markdown-parsers-in-python",rht,b'wontfix',2018-12-07T18:40:49Z,2018-12-07T19:29:28Z
10985,[Fix #10654] Background links work even when a modal is active in user settings,"Fix #10654

**Testing Plan:**
Manually tested by opening and closing the ""change full name"", ""change email"", and the ""change password"" modal. The background links are inactive when the modal is open, and clicking anywhere outside the modal closes it.


**GIFs or Screenshots:** 

![ezgif com-optimize](https://user-images.githubusercontent.com/31250892/49646490-3b565080-fa45-11e8-9365-f3f9c69871f7.gif)",Z0Marlin,b'area: settings (user) bug size: S',2018-12-07T12:03:12Z,2018-12-10T06:34:28Z
10984,help: Fix left sidebar content in smaller window.,"This fixes an issue where some of the content of left
sidebar gets visible even in smaller window which looks ugly.

Fixes: #10898.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

<img src=""https://cl.ly/cea1c4bc9884/download/Screen%20Recording%202018-12-07%20at%2002.50%20PM.gif""/>

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",akashnimare,b'area: documentation (user) bug size: S',2018-12-07T09:19:28Z,2018-12-07T16:21:20Z
10980,"guest users: Fix buggy rendering of ""subscriber count""","Reproduction recipe:
* Login as ""polonius"" (the guest user)
* Go to ""manage streams""
* Unsubscribe from a stream
* View it in ""All streams"" tab
* Notice that the subscriber count is weirdly replaced by a lock icon without a clear explanation:

![image](https://user-images.githubusercontent.com/2746074/49612362-5ea3d180-f959-11e8-9417-7a79dbe99902.png)

Possibly, the root issue is that we shouldn't show guest users streams they used to be subscribed to at all in ""All streams""; they can't interact with them in any way, and it's sorta confusing.  In which case probably the right behavior change is for streams to disappear from that view after a guest user unsubscribes.

@YJDave and @shubhamdhama have relevant context for this issue.


",timabbott,b'area: stream settings bug help wanted',2018-12-06T21:20:03Z,2019-05-14T00:29:26Z
10978,PM tooltip should show the participants when collapsed,"Under ""Private Messages"", when the participants text is too long it is truncated and appended an ellipsis.
When this happens, the tooltip should show the full text, and not ""Private Messages (P)"" like it currently shows.
",ricardoteixeiraduarte,b'area: left-sidebar bug priority: high',2018-12-06T17:56:39Z,2019-07-23T14:17:49Z
10961,manage.py export should be callable from $PATH,"manage.py traces on e.g. export command when running manage.py from $PATH. In Debian .bashrc for zulip user the directory `~zulip/bin` gets added to PATH if it exists:

```bash
install -d -g zulip -o zulip ~zulip/bin
cd ~zulip/bin
ln -s ~zulip/deployments/current/manage.py
```

```bash
manage.py export -r ''
```

```
Exporting realm 
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 56, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2018-12-03-15-40-58/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2018-12-03-15-40-58/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2018-12-03-15-40-58/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2018-12-03-15-40-58/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2018-12-03-15-40-58/zerver/management/commands/export.py"", line 119, in handle
    do_export_realm(realm, output_dir, threads=num_threads)
  File ""/home/zulip/deployments/2018-12-03-15-40-58/zerver/lib/export.py"", line 1292, in do_export_realm
    assert os.path.exists(""./manage.py"")
AssertionError
```",transferkraM,b'area: production bug',2018-12-05T13:23:34Z,2018-12-06T19:07:57Z
10955,hello: Fix header alignment when page is around 375px.,"Fixes: #10771

<!-- What's this PR for?  (Just a link to an issue is fine.) -->



**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![image](https://user-images.githubusercontent.com/30157875/49466695-76574a80-f7df-11e8-8dd2-25115aaf7305.png)
Tested on Chrome ***Version 70.0.3538.77 (Official Build) (64-bit)*** 


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",rogersouza,b'area: portico bug size: XS',2018-12-04T19:33:16Z,2018-12-15T20:22:02Z
10954,"Fix alignment of left-side icons in ""Organization settings"" tab","The icons should be vertically aligned with each other here:

![image](https://user-images.githubusercontent.com/2746074/49462140-3033c400-f7aa-11e8-84d5-57cfc722c125.png)

We've resolved similar issues in the past with various popovers (e.g. the gear menu), so you can probably borrow the approach taken for those here.  

While we're thinking about this (and this should be a separate commit), we probably want to replace some of the lock icons on the left with other things.  E.g. ""organization profile"" could have a greyscale Zulip logo or maybe https://fontawesome.com/v4.7.0/icon/address-card, and ""Authentication methods"" could be `fa-key`.",timabbott,b'area: settings UI bug',2018-12-04T18:11:13Z,2019-07-23T14:17:48Z
10936,tooling: Fix `manage.py` failing if `/etc/zulip/zulip.conf` exists.,"If `/etc/zulip/zulip.conf` exists in development, `manage.py` fails unnecessarily. This PR fixes this by instead check if `deploy_type` is set, as done in `settings.py`.

Fix #10931.

**Testing:**

I have tested manually in the following conditions:

 - If `/etc/zulip/zulip.conf` is not created, `manage.py` commands work.
 - If `/etc/zulip/zulip.conf` is created, but `deploy_type` isn't set, `manage.py` commands work.
 - If `/etc/zulip/zulip.conf` is created and `deploy_type` is set, `manage.py` exits.

(I am unsure if there is a test suite for `manage.py`, but if there is, I would be happy to add tests for this. Thanks!)",marco,b'area: tooling bug size: S',2018-12-01T16:39:23Z,2018-12-03T03:13:55Z
10935,right sidebar: Fix night-mode presence styling.,"This PR fixes the background color of night-mode presence indicators by setting the background color to transparent instead of white when inactive.

Fixes #10932.

**Screenshot:** 

<img width=""230"" alt=""screenshot"" src=""https://user-images.githubusercontent.com/17259768/49330111-ff038b80-f53e-11e8-8792-6f312f02f0bd.png"">
",marco,b'area: right-sidebar bug size: XS',2018-12-01T16:01:05Z,2018-12-03T03:32:13Z
10932,"Fix night mode styling of presence indicators in the ""group PMs"" area","The bottom things in the ""group PMs"" are should look the same as the empty circles above them.

![image](https://user-images.githubusercontent.com/2746074/49312657-9e6e4300-f499-11e8-8b76-8f815753da9d.png)

@synicalsyntax CCing you as our resident night mode maintainer.
",timabbott,b'area: right-sidebar bug',2018-11-30T20:16:12Z,2019-07-23T14:17:46Z
10931,Fix manage.py crashing if /etc/zulip/zulip.conf exists in development,"If there's an `/etc/zulip/zulip.conf` file present on a system, `manage.py` will fail.

The problem here is that this check assumes that if a `zulip.conf` file exists, we're in a production environment:

```
    if (os.access('/etc/zulip/zulip.conf', os.R_OK) and not                                                                                 
            os.access('/etc/zulip/zulip-secrets.conf', os.R_OK)):                                                                           
```

However, the ""correct"" way to check that, as defined in `zproject/settings.py`, involves reading `zulip.conf` and checking the `deploy_type` attribute, which still preserving the `manage.py` structure of not importing Django libraries like `settings.py` at that early stage.

Fixing this unblocks a better approach for implementing https://zulip.readthedocs.io/en/latest/development/remote.html#using-an-nginx-reverse-proxy, without needing a copy of our `nginx` config.",timabbott,b'area: tooling bug help wanted',2018-11-30T19:55:50Z,2019-07-23T14:17:46Z
10917,Allow users to login with just LDAP username (not email) if LDAP_APPEND_DOMAIN is set.,"We currently have an inconsistent set of logic around LDAP login in case B of https://zulip.readthedocs.io/en/latest/production/authentication-methods.html#ldap-including-active-directory.  The user is logging in with LDAP, and we sorta allow entering a username (in that `require_email_format_usernames()` returns false), but then the actual thing we check for is only the email address, not the username.  

This change should be sufficient to make things consistent (And allow you to enter either your email (for backwards compatibility) or your username when logging in as a user in this configuration):

```
@@ -303,6 +303,8 @@ class ZulipLDAPAuthBackendBase(ZulipAuthMixin, LDAPBackend):
 
     def django_to_ldap_username(self, username: str) -> str:
         if settings.LDAP_APPEND_DOMAIN:
+            if '@' not in username:
+                return username
             if not username.endswith(""@"" + settings.LDAP_APPEND_DOMAIN):
                 raise ZulipLDAPExceptionOutsideDomain(""Email %s does not match LDAP domain %s."" % (
                     username, settings.LDAP_APPEND_DOMAIN))
```

But we'll want to add some tests for it as well.",timabbott,b'area: authentication bug priority: high',2018-11-29T20:13:49Z,2019-07-23T14:17:45Z
10916,night mode: compose notification text can be hard to read (and `X` at right is nearly invisible),"![image](https://user-images.githubusercontent.com/2746074/49247924-597cda80-f3cd-11e8-9aa4-ac60c629004c.png)

@synicalsyntax do you want to take this one?",timabbott,b'area: compose bug',2018-11-29T19:53:54Z,2018-12-13T21:34:53Z
10904,Password strength bar retainer fix #10868,"PR for issue #10868 
The code retains the state of password strength bar in the sign up form.
",2208Abhinav,b'area: onboarding bug size: XS',2018-11-28T17:01:38Z,2018-11-28T17:15:50Z
10898,User documentation sidebar should not occupy a column of space at smaller page widths.,"Here's a screenshot of what I'm referring to -

<img src=""https://user-images.githubusercontent.com/12771126/49118154-282ece00-f258-11e8-8276-84b62e5f4418.png"" width=""350px"" />

When a page (from the user documentation) is resized in response to a smaller width, the righthand side of the sidebar continues to occupy a column of space on the lefthand side of the page.

I think this shouldn't be the case, because:
- It takes away from the amount of space for showing the content of the documentation, and
- carrots and border lines from the contents of the sidebar are visible, which has no use when the sidebar isn't expanded.

@zulipbot add ""area: documentation (user)"" ""bug""",jackrzhang,b'area: documentation (user) bug',2018-11-27T23:34:13Z,2018-12-07T16:20:47Z
10894,mobile push notifications in inconsistent state following upgrade,"Our site has never supported mobile push notifications, as it is deployed on a private network.
Following upgrade from 1.6 to 1.9.0, the error log is filled with lines like these:
2018-11-27 14:31:35.975 WARN [] APNs: Dropping a notification because nothing configured.  Set PUSH_NOTIFICATION_BOUNCER_URL (or APNS_CERT_FILE).
2018-11-27 14:31:39.621 WARN [] Skipping sending a GCM push notification since PUSH_NOTIFICATION_BOUNCER_URL and ANDROID_GCM_API_KEY are both unset

In the database, two users have `enable_online_push_notifications` set, and around 75% of users have `enable_offline_push_notifications`.
In the UI, these settings are shown disabled and unchecked for users in both database states.

One of the database migrations run during upgrade could disable these settings in user profiles, or a code change could prevent calls to the push_notifications module at all when globally unconfigured.",shane-kearns,b'area: production bug priority: high',2018-11-27T15:59:44Z,2019-07-23T14:17:43Z
10879,Document how to clear mail queue,"When I set up Zulip I used wrong outgoing mail address: ops@insw.cz, I fixed this ever since but there is one e-mail stuck in queue that zulip keeps on trying to send out, and I can't stop it. Here is mail.log from my mail server:

```
Nov 21 14:43:05 server postfix/smtpd[19951]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:05 server postfix/smtpd[19951]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:07 server postfix/smtpd[19927]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:07 server postfix/smtpd[19927]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:07 server postfix/smtpd[19927]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:07 server postfix/smtpd[19927]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:09 server postfix/smtpd[19951]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:09 server postfix/smtpd[19951]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:09 server postfix/smtpd[19951]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:09 server postfix/smtpd[19951]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:11 server postfix/smtpd[19927]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:11 server postfix/smtpd[19927]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:11 server postfix/smtpd[19927]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:11 server postfix/smtpd[19927]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:13 server postfix/smtpd[19951]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:13 server postfix/smtpd[19951]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:13 server postfix/smtpd[19951]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:13 server postfix/smtpd[19951]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:15 server postfix/smtpd[19927]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:15 server postfix/smtpd[19927]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:15 server postfix/smtpd[19927]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:15 server postfix/smtpd[19927]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:16 server postfix/smtpd[19951]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:16 server postfix/smtpd[19951]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:16 server postfix/smtpd[19951]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:16 server postfix/smtpd[19951]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:18 server postfix/smtpd[19927]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:18 server postfix/smtpd[19927]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:18 server postfix/smtpd[19927]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:18 server postfix/smtpd[19927]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:20 server postfix/smtpd[19951]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:20 server postfix/smtpd[19951]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:20 server postfix/smtpd[19951]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:20 server postfix/smtpd[19951]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:21 server postfix/smtpd[19927]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:21 server postfix/smtpd[19927]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>
Nov 21 14:43:21 server postfix/smtpd[19927]: lost connection after RSET from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:21 server postfix/smtpd[19927]: disconnect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:23 server postfix/smtpd[19951]: connect from terminal.insw.cz[83.167.247.29]
Nov 21 14:43:23 server postfix/smtpd[19951]: NOQUEUE: reject: RCPT from terminal.insw.cz[83.167.247.29]: 553 5.7.1 <ops@insw.cz>: Sender address rejected: not owned by user zulip@insw.cz; from=<ops@insw.cz> to=<bena@insw.cz> proto=ESMTP helo=<zulip.lan.insw.cz>",benapetr,b'area: emails bug',2018-11-21T13:46:17Z,2020-05-24T13:18:36Z
10868,The password strength bar on an onboarding form at /accounts/register is reset after an invalid submission.,"To reproduce:
- Follow a link to a form at /accounts/register.
- Fill out the form with valid values, except don't check the Terms of Service box.
- Press 'Sign up'.

The password strength bar will reset to showing the lowest strength, even though the contents of the password field haven't changed.

Screenshot:
<p align=""center"">
<img alt=""invite-onboarding-form-full-name-cleared"" src=""https://user-images.githubusercontent.com/12771126/48734801-69413580-ebfb-11e8-879d-cab601d279a8.gif"" />
</p>

(#10867 is also observable.)

@zulipbot add ""bug"" ""area: onboarding""",jackrzhang,b'area: onboarding bug good first issue',2018-11-19T21:07:56Z,2019-07-23T14:17:42Z
10867,A valid full name on an onboarding form is cleared after an invalid submission.,"To reproduce:
- Follow a link to a form at /accounts/register.
- Fill out the form with valid values, except don't check the Terms of Service box.
- Press 'Sign up'.

The 'Full name' field will be cleared after the page reloads following a server response, even though it's unrelated to the failed validation.

Screenshot:
<p align=""center"">
<img alt=""invite-onboarding-form-full-name-cleared"" src=""https://user-images.githubusercontent.com/12771126/48734801-69413580-ebfb-11e8-879d-cab601d279a8.gif"" />
</p>

@zulipbot add ""bug"" ""area: onboarding""",jackrzhang,b'area: onboarding bug good first issue',2018-11-19T21:03:29Z,2019-07-23T14:17:42Z
10866,onboarding: Unavailable subdomain help text on the form for creating an new organization results in content overflow scrollbars.,"To reproduce:
- Register for a new organization at zulipchat.com/new, and follow the emailed link to the form at /accounts/register.
- In the 'Organization URL' field, enter a subdomain already in use, like 'asdf'.

Screenshot:
![unavailable-subdomain-content-overflow-scrollbars](https://user-images.githubusercontent.com/12771126/48732751-4dd32c00-ebf5-11e8-94d3-8c450def827c.gif)


@zulipbot add ""bug"" ""area: onboarding""",jackrzhang,b'area: onboarding bug good first issue',2018-11-19T20:19:18Z,2019-07-23T14:17:41Z
10865,onboarding: Help text for the 'Organization URL' field on the form for creating a new organization is misplaced.,"To reproduce:
- Create a new organization on zulipchat.com or in the development environment and follow a link to the form at `/accounts/register`.
- Without filling out any fields, press 'Sign up' at the bottom of the form.

Screenshot:
<img width=""383"" alt=""image"" src=""https://user-images.githubusercontent.com/12771126/48732136-a30e3e00-ebf3-11e8-8112-6fa1e618386b.png"">

@zulipbot add ""bug"" ""area: onboarding""",jackrzhang,b'area: onboarding bug good first issue',2018-11-19T20:08:30Z,2019-07-23T14:17:41Z
10855,One-on-one chats not migrating from Stride,"One-on-one chats are missing from the Stride import (which is otherwise working great; see #10805).

Here's a sample that comes from the Stride export, with the filename format

`users/[orgid]:[user-uuid]/history.json`

```
[
  {
    ""PrivateUserMessage"": {
      ""attachment"": {},
      ""id"": ""3b0b1432-71b9-11e8-8b98-02420aff0003"",
      ""mentions"": [],
      ""message"": ""hi"",
      ""message_attachment"": null,
      ""receiver"": {
        ""id"": ""557058:2d6c88ea-a7ef-4438-ad97-cc7f2e8dad2f""
      },
      ""sender"": {
        ""id"": ""557058:851244af-4c17-4324-8336-dda754d60855""
      },
      ""timestamp"": ""2018-06-16T23:01:40.827038Z"",
      ""type"": ""private""
    }
  }
]
```",jamieson99,b'area: export/import bug',2018-11-16T18:55:44Z,2020-05-06T04:54:51Z
10843,auth: Always force Google to show account chooser,"Fixes #10515

![force-google-to-show-account-chooser2](https://user-images.githubusercontent.com/7190633/48565479-a7e69f80-e91e-11e8-8b8c-8735ca94c1eb.gif)

",hackerkid,b'area: authentication bug priority: high size: XS',2018-11-15T15:46:54Z,2018-11-15T19:18:41Z
10839,message list: Dates on recipient headers don't update appropriately with #10820.,"This is specific to changes introduced with #10820.

Using the thread 'chat.zulip.org' on #announce from czo as an example - the date text on the right hand side of the recipient bar shows the date of the earliest message fetched in the message view's current topic, but doesn't update to show the date of the message at the top of the message view's *currently visible* content.

To reproduce:
1. Go to any topic with messages sent more than a day apart so that a date separator can appear.
2. Scroll up in the message view to fetch earlier messages; observe the date on the recipient bar update to an earlier time.
3. Scroll down in the message view to more recent messages; the date on the recipient bar does not update.

![10820-recipient-header-date-text](https://user-images.githubusercontent.com/12771126/48532214-4fe36680-e854-11e8-9c9a-6aac50d4841d.gif)

For discussion, see https://chat.zulip.org/#narrow/stream/101-design/topic/date.20separators.

@zulipbot add ""area: message view"" ""bug""",jackrzhang,b'area: message view bug',2018-11-15T05:30:02Z,2018-11-15T06:52:05Z
10838,message list: Scrollbar moves underneath the top navigation bar.,"This reproduces on Chrome 70, Safari 12, and Firefox 73; this is the scroll bar for the entire window that moves with the message view: 

![top-nav-bar-in-front-of-scrollbar](https://user-images.githubusercontent.com/12771126/48531459-270da200-e851-11e8-9361-21963d96fb31.gif)


@zulipbot add ""area: message view"" ""area: general UI"" ""bug""",jackrzhang,b'area: general UI area: message view bug',2018-11-15T05:10:07Z,2019-05-17T22:01:34Z
10831,Error reporting overlap bug in login flow,"I was able to get into this buggy state in the enter-password flow:

![image](https://user-images.githubusercontent.com/2746074/48515298-366efa00-e815-11e8-941d-dd724d00a497.png)

Doing so required the following sequence:
* Submit an incorrect password, generating the ""Please enter a correct email and password. Note that both fields may be case-sensitive."" error from the backend.
* Then, select the password and delete it with backspace.  It's important to do this, rather than deleting all the individual characters with backspace to reproduce appearing the second error on top of the first (though it's likely another bug that we should fix that deleting the individual characters doesn't produce the error).

Probably the right fix is to clear the first/backend generated error when you start editing the password field.

@hackerkid @YJDave this is probably a good project for one of you.
",timabbott,b'area: portico bug',2018-11-14T22:03:16Z,2019-07-23T14:19:15Z
10828,Linkification should drop trailing whitespace,"When creating related linkifications, I was copying-and-pasting regexes and URLs. When they came with trailing whitespace, Zulip complained. (And it's impossible to copy from the existing linkifications without picking up one space (regex) or two spaces (URLs)

Desired behavior: drop trailing whitespace silently.

Related: it would be nice if linkifications were editable, rather than requiring deletion and re-creation. But I understand it would be harder to check for duplicate regex that way.",dashdsrdash,b'area: markdown area: settings (admin/org) bug good first issue help wanted',2018-11-14T19:27:40Z,2019-07-23T14:19:15Z
10818,Guest User Invitation,"Hello,

Today it is possible to modify a user to set it as a Guest user (Setting => Organization => Users => Edit => User Role), but it is not possible to invite a user as Guest.

![screen shot 2018-11-12 at 09 28 41](https://user-images.githubusercontent.com/13253032/48335224-6378ac80-e65d-11e8-8e96-fe06f37e09e4.png)

Is it something that is planned ?
",gdelafond,b'area: settings (admin/org) bug priority: high',2018-11-12T08:30:41Z,2019-03-24T17:39:16Z
10787,portico: Fix privacy policy font sizing.,"The text for items in unordered lists is larger than the text for headings:

![privacy-policy-font-sizing](https://user-images.githubusercontent.com/12771126/48171490-01acf100-e2b1-11e8-91f4-d652902b968d.gif)

@zulipbot add ""area: portico"" ""bug""
",jackrzhang,b'area: portico bug',2018-11-08T01:21:55Z,2018-11-28T23:06:01Z
10776,Messages get stuck or disappear,"I'm running the ``zulip/docker-zulip:latest`` image under Kubernetes, using a helm chart based on the ``armooo/zulip-helm`` chart. A while after starting the Zulip server pod, messages stop being delivered. Sometimes the service is up and working for a few days, sometimes just hours before failure.
The sending client doesn't get a server reply with a message timestamp, and server.log does not log any ``/json/message`` entries. Deleting the Zulip server pod, thereby restarting Zulip, but none of the other services, causes (usually) the undelivered messages to get delivered.

* zulip 1.9.0-latest
* memchached: 2.3.1
* redis: 4.2.0
* postgresql: 0.19.0
* rabbitmq: 3.5.0",juselius,b'area: production bug',2018-11-06T10:42:56Z,2019-10-30T23:19:52Z
10772,[Bug] Slack import Zulip 1.9.0-rc2,"Hi,

Problem: when importing, the script stops and fails when importing *messages*.

Command: `manage.py  convert_slack_data mySlack-export.zip --token mytoken  --output converted_slack_data`

Final output:
```Traceback (most recent call last):
  File ""./manage.py"", line 36, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zerver/management/commands/convert_slack_data.py"", line 58, in handle
    do_convert_data(path, output_dir, token, threads=num_threads)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zerver/data_import/slack.py"", line 758, in do_convert_data
    realm, realm['zerver_realmemoji'], domain_name, output_dir)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zerver/data_import/slack.py"", line 478, in convert_slack_workspace_messages
    id_list, domain_name)
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zerver/data_import/slack.py"", line 607, in channel_message_to_zerver_message
    file_user = [iterate_user for iterate_user in users if message['user'] == iterate_user['id']]
  File ""/home/zulip/deployments/2018-11-03-17-13-26/zerver/data_import/slack.py"", line 607, in <listcomp>
    file_user = [iterate_user for iterate_user in users if message['user'] == iterate_user['id']]
KeyError: 'user'
```
This is a fresh install on the docker container of Zulip 1.9.0-rc2. 

",cmorvan,b'area: export/import bug priority: high',2018-11-04T11:02:54Z,2018-11-06T21:16:19Z
10771,portico: Align homepage header text with paragraphs.,"These screenshots were taken using Chrome inspector's device toolbar at 375px width:

<p align=""center"">
<img width=""375"" src=""https://user-images.githubusercontent.com/12771126/47961205-9b2f8680-dfc3-11e8-9d78-c82213ab415f.png"" />
</p>

<p align=""center"">
<img  width=""375"" src=""https://user-images.githubusercontent.com/12771126/47961207-a4b8ee80-dfc3-11e8-9707-60a41a836e60.png"" />
</p>

<p align=""center"">
<img  width=""375"" src=""https://user-images.githubusercontent.com/12771126/47961208-ada9c000-dfc3-11e8-8a85-84895f8ffc43.png"" />
</p>

This might be fixable in conjunction with #10726.

@zulipbot add ""area: portico""",jackrzhang,b'area: portico bug',2018-11-04T06:57:54Z,2019-07-23T14:19:13Z
10762,bugdown: Mention cleanup.,"This PR refactors some of the pain points that the addition of the recent name|id syntax for mentions introduced in the codebase, as well as fixes a flaky test caused by the incorrect assumptions used to generate the data structure when fetching possibly mentioned users from the database.

**Testing Plan:**
Updated the existing tests where necessary. This should fix the flake that @showell pointed out yesterday in: https://chat.zulip.org/#narrow/stream/9-issues/topic/mention.20ids
",aero31aero,b'size: L',2018-11-02T08:33:35Z,2018-11-29T18:20:12Z
10741,outgoing webhook bot request headers lack Content-Type,"Hi,I config a bot with type outgoing,when I custom a http server to handle the hook,there is no Content-Type field in headers,here are all header fields:

```
[ 'Host',
  '127.0.0.1:7001',
  'Connection',
  'close',
  'Content-Length',
  '966',
  'User-Agent',
  'python-requests/2.18.4',
  'Accept',
  '*/*',
  'Accept-Encoding',
  'gzip, deflate' ]
```

so,many framwork can't handle body without Content-Type field,so can you add this field in outgoing webhook?

thanks.",xiaomingplus,b'area: api bug priority: high',2018-10-28T07:10:03Z,2019-07-23T14:19:10Z
10740,Email registration links open and then immediately close.,"Here's two cases I've found on zulipchat.com:
1. Create a new Zulip organization via https://zulipchat.com/new by providing an email address. Receive the email with the subject line 'Activate your Zulip account', and click on the 'Complete registration' button. On my browser (Chrome), a new tab opens and then immediately closes before any contents load.
2. On a realm already created via zulipchat.com, invite a new user. The registration link in the invitation email has the same behavior - a new tab opens and then immediately closes.

@zulipbot label ""area: emails""",jackrzhang,b'area: emails bug priority: high',2018-10-27T22:43:44Z,2018-11-20T02:43:02Z
10726,portico: Top of homepage not responsive at 800 pixels.,![image](https://user-images.githubusercontent.com/890911/47515775-95ee7100-d838-11e8-9959-75ce6af1c1d6.png),rishig,b'area: portico bug help wanted',2018-10-25T16:30:40Z,2019-07-23T14:19:10Z
10681,message view: Recipient bar icons in wrong order.,"To repro:
* Log in as Iago
* Add a linkifier (see ""organization settings"")
* Send a message with a topic linkified by that linkifier

You'll get 
![image](https://user-images.githubusercontent.com/890911/47176182-c9c21780-d2c9-11e8-8e96-df954336f3b6.png)

The blue square should be to the left of the edit pencil. 
",rishig,b'area: message view bug good first issue help wanted',2018-10-18T18:35:27Z,2019-07-23T14:19:09Z
10672,"API documentation should not mention ""dev server""","Today I noticed a pretty embarrassing issue with our API docs:

![image](https://user-images.githubusercontent.com/2746074/47041528-e5001c00-d13d-11e8-804c-d126d036d61a.png)

The phrase ""Download zuliprc-dev from your dev server"" is really poor in two ways: (1) many of our users use these docs in production, so the ""dev"" phrase is misleading, and (2) it's not obvious at all how to download from a server.

I fixed the most egregious part of this with 8481a2fd2d595e467baa0e88b3990cfe28afd19c, but these remain
* (1) We need to add a macro for the API JS docs like `PYTHON_CLIENT_CONFIG` for the basic setup part, replace that everywhere we use it, and then update it to fix the ""dev server"" reference.
* (2) We should do https://github.com/zulip/zulip/issues/10670
* (3) If we can figure it out, it'd be awesome to have a link from the common API docs part to the general ""zuliprc"" docs.  But this may be impossible, since it is in a markdown code block after all.  So this is probably a quick determination for whether it's possible and then giving up.

@YagoGG @eeshangarg @aero31aero one of you may want to claim parts of this.",timabbott,b'area: documentation (api and integrations) bug priority: high',2018-10-16T19:29:04Z,2019-01-07T17:16:03Z
10665,css: Make single-line codeblocks inline.,"**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Before:
![image](https://user-images.githubusercontent.com/8033238/46985961-879ea780-d10a-11e8-8e55-369c6c37442e.png)
After:
![image](https://user-images.githubusercontent.com/8033238/46985969-92f1d300-d10a-11e8-979a-1b24ed02a901.png)
",aero31aero,b'area: message view bug size: XS',2018-10-16T00:43:52Z,2018-10-31T17:03:23Z
10658,user profiles: Remove empty space under profiles with no set fields.,"Add a `.no-fields` class to user profile modals with no custom fields set so we can render the modal without the extra whitespace on the bottom when a user hasn't set any custom fields.

No fields:
![screenshot at oct 12 19-11-12](https://user-images.githubusercontent.com/15116870/46907496-3c955200-cec8-11e8-9d38-9f15e1d96c5d.png)

With fields:
![screenshot at oct 12 19-34-08](https://user-images.githubusercontent.com/15116870/46907497-3c955200-cec8-11e8-90d1-719af96abfd9.png)

Fixes #10652.",synicalsyntax,b'area: general UI bug size: M',2018-10-13T16:13:45Z,2018-12-13T02:01:21Z
10654,"You can click ""Change email"" while the ""Change full name"" modal is open and get exception","The bug here is that if you click outside the modal, it should close the modal (as most of our modals work). 
 This should close the modal first rather than throwing this exception:

![image](https://user-images.githubusercontent.com/2746074/46893888-57fc5080-ce27-11e8-8e15-d254b18cd64e.png)
",timabbott,b'area: settings (user) bug good first issue help wanted',2018-10-12T21:06:24Z,2019-07-23T14:19:08Z
10652,custom user profile: Extra empty space when no custom fields are set.,"We recently moved several user profile fields to be displayed near the avatar by default, but it's resulting in extra space below the user profile modal for people that haven't set any custom fields. 

![](https://chat.zulip.org/user_uploads/2/43/7kxyX9vKo0d1-r9dTX_rFwtu/Screenshot-at-Oct-11-22-28-36.png)

We should hide the `<hr>` element/bottom whitespace in the event that no custom fields are set.
",synicalsyntax,b'area: general UI bug',2018-10-12T20:13:22Z,2019-07-23T14:19:07Z
10650,[wip] Fix bugs related to PM links,"To test this, make sure to try ""Copy link to conversation"" with normal PMs, PMs to yourself, and huddles, and make sure all participants in the conversation are shown.  I did this myself, but I could use double checking.

Also check sidebar links.",showell,b'area: search bug priority: blocker size: XL',2018-10-12T16:50:54Z,2018-10-22T19:26:03Z
10647,hipchat import: Fix newly reported issues.,"Our V1 of the import only worked on a subset of data.

So far I fixed one issue related to avatars.

Other issues:

- we need to skip over things like ArchiveRoomMessage, GuestAccessMessage, TopicRoomMessage, and NotificationMessage that don't really map to Zulip
- we need to handle PrivateUserMessage (non-trivial, although mostly similar to how we handle import stream messages)
- we need to account for guest users not having emails in Hipchat (so either skip over them or generate a fake email/delivery_email)

This is very useful:

https://confluence.atlassian.com/hipchatkb/exporting-from-hipchat-server-or-data-center-for-data-portability-950821555.html",showell,b'area: export/import bug',2018-10-12T11:09:45Z,2018-10-23T22:32:33Z
10631,message_edit: Allow editing topics indefinitely.,"Topic editing was allowed only if the message was no more than one day old.
Removed this condition. We want the topic editing to be allowed only based on
the policies set in realm settings.
Closes #10568.
",onkarshedge,b'area: message-editing bug has conflicts priority: high size: M',2018-10-09T08:37:04Z,2018-12-05T01:48:44Z
10629,en_US.UTF-8 locale is not generated on Debian systems using different locale,"Even after the fix in https://github.com/zulip/zulip/commit/f228eabd900e4eba012f83fc36caec7ef54c1fad I can still replicate the installer error complaining about ascii decode errors from https://github.com/zulip/zulip/issues/9946 (https://github.com/zulip/zulip/issues/9946#issuecomment-405519149)

This is because `locale-gen` does not take any arguments, instead reading locales from `/etc/locale.gen` and if `en_US.UTF-8` is not defined in there, but something else is, then the correct locale is not generated and the installer fails.

Solutions might be to either add the required locale to `/etc/locale.gen` or run `localedef` directly.  ",tdaff,b'area: production installer bug priority: high',2018-10-08T16:23:48Z,2018-10-11T21:44:07Z
10610,message view: Emoji that are vertically aligned across multiple lines overlap.,"This is noticeable for both Unicode and custom emoji. The fix for this might touch some of the same CSS for #10609.

![image](https://user-images.githubusercontent.com/12771126/46392608-c2c6c280-c696-11e8-9a5b-e828a4f714f0.png)

@zulipbot label ""area: message view"" ""bug""",jackrzhang,b'area: emoji area: message view bug',2018-10-03T05:59:21Z,2020-03-22T22:14:54Z
10609,message view: Emoji overlap with the selected message border.,"For custom emoji, if the emoji is on the bottom line of a message in the message view, the bottom of the image overlaps with the selected message border.

<img width=""816"" src=""https://user-images.githubusercontent.com/12771126/46392197-55fef880-c695-11e8-8b09-c68cf0437058.png"">

Visually, this is the same case for Twitter emoji:

<img width=""818"" alt=""screen shot 2018-10-03 at 4 53 45 pm"" src=""https://user-images.githubusercontent.com/12771126/46445764-47fcb680-c72d-11e8-954b-959cad2a26aa.png"">

@zulipbot label ""area: message view""
",jackrzhang,b'area: emoji area: message view bug',2018-10-03T05:52:09Z,2020-03-22T22:15:44Z
10605,Doing a 'Copy link to conversation' on a private message returns an incorrect link,"There's a 'Copy link to conversation' button for each message. I used it on a private message I received from someone (let's call this message `M`). A link was copied to my clipboard.

This is what the link looks like: https://chat.zulip.org/#narrow/pm-with/tabbott.40zulipchat.2Ecom.2Cekurgn.40gmail.2Ecom/near/638841

When I opened the link in a new browser tab, I expected the private conversation to open up and `M` to be highlighted. Instead, the private conversation opened up and only messages sent by me were visible. The message which was highlighted was my last message before `M`.

This is what Zulip's search bar shows: `pm-with:tabbott@zulipchat.com,ekurgn@gmail.com near:638841`

I changed the filter in the search bar to `pm-with:tabbott@zulipchat.com near:638841` and it works as expected. The corresponding URL (https://chat.zulip.org/#narrow/pm-with/7-tabbott/near/638841) works as expected when opened in a new browser tab.",sharmaeklavya2,b'area: search bug priority: blocker',2018-10-01T20:24:12Z,2019-07-23T14:19:05Z
10601,attachments ui: Initialize table sorted by Date uploaded column.,"Previously we only added the active class to the Date uploaded
column, thinking it was already sorted by upload date by default.
However, it wasn't, so now we explicitly make a call to sort it by upload
date to fix an issue with broken sorting.

Fixes #10518.

@showell FYI, since we previously discussed it on the frontend stream on czo.",synicalsyntax,b'area: settings (user) bug size: XS',2018-10-01T16:55:25Z,2018-10-02T18:50:27Z
10597,user settings: Download .zuliprc button is not aligned properly.,"As of now after the user clicks Get API key button, two buttons appear which are not aligned properly.
Image:-
![bug](https://user-images.githubusercontent.com/31280303/46260131-0a671600-c500-11e8-97af-4b7e61f417ca.png)
Both buttons should be aligned and function at all screen sizes.",dipu989,b'area: general UI bug',2018-09-30T17:00:44Z,2019-01-04T17:39:12Z
10592,"search: Tell user when there are ""no results"" because they used stop words.","Related but not quite the same as #7224.

We have 127 stop words, which includes some reasonably uncommon ones. So if you search for something like ""what about"", we'll return 0 results, since both `what` and `about` are stop words.

This makes Zulip search look broken, especially when you then test Zulip's search by sending a message ""What about .."" and then try searching for it. 

Ideally we would just show a small message like ""x, y, and z were excluded from the search"" somewhere, or maybe strike through the stop words in the search bar.

Implementation-wise:
* We'll need have the data for what the stop words are passed to the frontend, probably via direct addition to `page_params` in `zerver/views.home.py`
* We should add a function in something like `search_suggestion.js` to check if the search terms overlap with stop words
* We add some notice in the search UI (probably in a special error area at the bottom of the suggestions/typeahead dropdown widget?) with the text suggested above.",rishig,b'area: search bug help wanted priority: high',2018-09-29T18:59:06Z,2019-06-24T20:15:55Z
10590,stream-settings: Removed restrict posting to org admin from change mo…,"stream-settings: Removed restrict posting to org admin from change modal.

Moved restrict posting to admin option in streams under ""Change"" to outside
in the main stream settings.

Fixes: #10524

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![screenshot from 2018-09-24 22-47-08](https://user-images.githubusercontent.com/24277385/46244772-80388800-c401-11e8-82be-9432a67fdb79.png)
",psg0796,b'area: stream settings bug has conflicts priority: high size: L',2018-09-29T10:35:55Z,2019-02-14T10:40:05Z
10586,emoji: Google modern and google classic have same emoji in settings.,"![image](https://user-images.githubusercontent.com/890911/46239496-23c86080-c34e-11e8-8a51-2bdd391deeda.png)

@HarshitOnGitHub fyi.

Adding blocker since this is probably a blocker for release. ",rishig,b'area: emoji bug priority: blocker',2018-09-29T01:42:32Z,2018-09-30T22:44:05Z
10584,"bug fix: Handle ""Subscribe"" button in empty views.","I don't know how long this has been broken, but it seems
some re-design of our message feed moved the Subscribe
button out #zfilt, so we use a different parent selector
now to turn on the click handler.

Hopefully this was a pretty obscure bug.  To reproduce
it go to ""Manage Streams"" and then select a stream you're
not subscribed to (from ""All Streams""), and don't actually
subscribe, but then hit ""View stream"".

The user experience here is still a bit confusing, but
this is just a quick fix.
",showell,b'size: XS',2018-09-28T17:28:01Z,2018-09-28T21:08:38Z
10579,django.db.utils.integrityerror duplicate key value preventing user from logging in,"Hi there,

We are testing a self hosted Zulip server for our organization. One of our users isn't able to login. I'm fairly certain this is due to duplicate key values as stated below in the error.log:
django.db.utils.integrityerror duplicate key value violates unique constraint ""zerver_userprofile_realm_id_email.xxxxxx_uniq""
DETAIL: Key (realm_id, email)=(2, foo@abcdefg.com) already exists

We are using just LDAP for authentication. However, I think the issue may have been created when we were testing email authentication briefly. There's no option to completely remove an account from the server and deactivation doesn't remove the duplicate user key. Any light you can help shed on the situation would be great.

Regards,
Will Hester",iamwillhester,b'area: authentication area: production bug',2018-09-27T20:08:42Z,2020-01-31T21:05:52Z
10578,Prevent bots from having duplicate full names.,"Bots are not allowed to use the same name as
other users in the realm (either bot or human).

Fixes #10509
",showell,b'area: bots bug size: XL',2018-09-27T18:16:39Z,2018-10-25T00:02:20Z
10572,Update bot parsing code to support the extended mention syntax.,"As seen in #10509 and [here](https://chat.zulip.org/#narrow/stream/9-issues/topic/gifbot.20.7C.20.40mention.20issue) the new mention syntax breaks passing of the messages to the bots. We need to change the bot parsing code to support the extended mention syntax.

@zulipbot label ""area: integrations""
@zulipbot claim

Followup to #10243 .",aero31aero,b'area: integrations bug priority: high',2018-09-26T06:49:15Z,2018-10-16T23:06:04Z
10569,"Unable to search.  function ts_match_locs_array(unknown, text, tsquery) does not exist","Zulip standard install method. All work fine, except for this:

The above exception was the direct cause of the following exception:

`
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 131, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 605, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 587, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 747, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 174, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/messages.py"", line 767, in get_messages_backend
    rows = list(sa_conn.execute(query).fetchall())
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/engine/base.py"", line 948, in execute
    return meth(self, multiparams, params)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/sql/elements.py"", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/engine/base.py"", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/engine/base.py"", line 1200, in _execute_context
    context)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/engine/base.py"", line 1413, in _handle_dbapi_exception
    exc_info
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/util/compat.py"", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/util/compat.py"", line 186, in reraise
    raise value.with_traceback(tb)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/engine/base.py"", line 1193, in _execute_context
    context)
  File ""/home/zulip/deployments/2018-09-25-02-55-09/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/engine/default.py"", line 507, in do_execute
    cursor.execute(statement, parameters)
  File ""./zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) function ts_match_locs_array(unknown, text, tsquery) does not exist
LINE 2: ...ECT message_id, flags, subject, rendered_content, ts_match_l...
                                                             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

 [SQL: 'SELECT /* get_messages */ anon_1.message_id, anon_1.flags, anon_1.subject, anon_1.rendered_content, anon_1.content_matches, anon_1.subject_matches \nFROM ((SELECT message_id, flags, subject, rendered_content, ts_match_locs_array(%(param_1)s, rendered_content, plainto_tsquery(%(param_2)s, %(param_3)s)) AS content_matches, ts_match_locs_array(%(param_4)s, escape_html(subject), plainto_tsquery(%(param_2)s, %(param_3)s)) AS subject_matches \nFROM zerver_usermessage JOIN zerver_message ON zerver_usermessage.message_id = zerver_message.id \nWHERE user_profile_id = %(param_5)s AND (search_tsvector @@ plainto_tsquery(%(param_2)s, %(param_3)s)) AND message_id <= %(message_id_1)s ORDER BY message_id DESC \n LIMIT %(param_6)s) UNION ALL (SELECT message_id, flags, subject, rendered_content, ts_match_locs_array(%(param_1)s, rendered_content, plainto_tsquery(%(param_2)s, %(param_3)s)) AS content_matches, ts_match_locs_array(%(param_4)s, escape_html(subject), plainto_tsquery(%(param_2)s, %(param_3)s)) AS subject_matches \nFROM zerver_usermessage JOIN zerver_message ON zerver_usermessage.message_id = zerver_message.id \nWHERE user_profile_id = %(param_5)s AND (search_tsvector @@ plainto_tsquery(%(param_2)s, %(param_3)s)) AND message_id >= %(message_id_2)s ORDER BY message_id ASC \n LIMIT %(param_7)s)) AS anon_1 ORDER BY message_id ASC'] [parameters: {'message_id_2': 368, 'param_7': 51, 'message_id_1': 367, 'param_3': 'aja', 'param_4': 'zulip.english_us_search', 'param_5': 11, 'param_6': 50, 'param_1': 'zulip.english_us_search', 'param_2': 'zulip.english_us_search'}] (Background on this error at: http://sqlalche.me/e/f405)
`
 Postgresql 10. 
Ubuntu 16 x64

![captura de pantalla de 2018-09-25 18-05-56](https://user-images.githubusercontent.com/1690516/46048165-b0281880-c0ed-11e8-8229-c6d668d3aa9d.png)
",bashman,b'area: dependencies area: production bug',2018-09-25T23:12:08Z,2019-02-26T20:52:00Z
10568,message view: Admin should always be able to edit topic from actions menu.,"Logged in as Iago:
![image](https://user-images.githubusercontent.com/890911/46034167-d8dfec00-c0b4-11e8-9a8d-ae85294bb0a5.png)

The first entry should be `View source / Edit topic`, and it should allow editing the topic when you click on it. (When `Allow message editing` is something other than `Never`.)

Looks like this regardless of whether `Users can edit the topic of any message` is checked. 
",rishig,b'area: message-editing bug help wanted priority: high',2018-09-25T18:20:58Z,2019-01-05T05:05:10Z
10561,settings: Fix real-time updation of `full_name` property in page_params.,"Due to this if someone updates his/her name from accounts page and close
the modal and then reopen the modal the page still have the old name as
we use `page_params.full_name` in `accounts-settings.handlebars`. This
commit fixes this bug.

Fixes: #10529.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->



**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
![peek 2018-09-24 22-26](https://user-images.githubusercontent.com/22238472/45966563-1870ee80-c049-11e8-98a8-e83d51a6f3d5.gif)
@jackrzhang @timabbott FYI.",shubhamdhama,b'area: settings UI bug size: XS',2018-09-24T16:58:24Z,2018-09-25T20:34:36Z
10560,left-sidebar: Match line spacing of user list on left sidebar.,"Vertically aligned presence indicator with names on left sidebar.

Fixes: #10554
![screenshot from 2018-09-24 21-36-21](https://user-images.githubusercontent.com/24277385/45965925-6edd2d80-c047-11e8-96a5-8d1019f9edfa.png)",psg0796,b'area: left-sidebar bug size: XS',2018-09-24T16:47:35Z,2018-12-04T01:07:20Z
10557,message-view: show error icons without hover,"Instead of displaying failed message error on mouse hover the error should be shown normally without hover.
Added opacity: 1 !important  in message_failed class.
Fixes: #10537

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![screenshot from 2018-09-24 14-36-45](https://user-images.githubusercontent.com/24277385/45944375-9d3b1880-c007-11e8-8897-3d0e7f658943.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
This is my first PR, @rishig please review.",psg0796,b'area: message view bug has conflicts size: S',2018-09-24T09:12:25Z,2019-02-14T10:40:48Z
10554,left sidebar: Line spacing is off with users list on left sidebar.,"To repro: enable ""Users list on left sidebar"" from Display settings, and then make the window something like 900 pixels wide.

![image](https://user-images.githubusercontent.com/890911/45931850-9e494880-bf28-11e8-890a-f7b8d6d82415.png)

The line spacing between the user entries is off (it should match that of the streams list), and the presense indicator (circles) are not vertically aligned with the names.",rishig,b'area: left-sidebar bug help wanted',2018-09-23T19:05:16Z,2018-12-04T01:07:35Z
10544,user profile popover: Perfect scrollbar is shown too soon. ,"In user profile popover, we show perfect scrollbar too soon, we should wait until cursor is closer near the scrollbar.

![image](https://user-images.githubusercontent.com/25907420/45912933-5c94a100-be47-11e8-9689-0867ba2b9d82.png)

This issue is part of issue #10303, but it is independent from issues/conversations mentioned in #10303",YJDave,b'area: general UI bug',2018-09-22T03:43:18Z,2019-05-20T23:07:55Z
10537,message view: Show error icons not on hover when the server returns an error.,"If you send a message and the server returns an error, we display two red icons in the upper right corner of the message.
These icons should display whether or not you're hovering on the message, but currently they are only shown on hover.

To see this in action:
* Add `assert(False)` at the beginning of `do_send_messages`
* Send a few messages
* Hover over the messages you sent

As followup, it would be great to add a little bit of horizontal space between the icons (I expect the fact that it's not there is another regression), but that shouldn't block this. 
",rishig,b'area: message view bug good first issue help wanted',2018-09-20T22:35:35Z,2019-03-19T20:32:51Z
10535,user settings: Get API key box is a bit off center.,"To get to this go to Gear menu -> Settings -> Show/change your API key.
![image](https://user-images.githubusercontent.com/890911/45849470-ed07a000-bce6-11e8-80c0-164c839ca3d2.png)

""Current password"" should be left-aligned, and the positioning of the ""Get API key"" box should be fixed.",rishig,b'area: settings UI bug help wanted',2018-09-20T22:09:42Z,2019-01-03T21:48:26Z
10534,upgrade-zulip should respect the same options as upgrade-zulip-from-git,"Specifically around things like skipping migrations and puppet. 

This should be easy to do if we refactor the argument parsing login into a function in `zulip_tools.py` and then import it from both places, for example.",timabbott,b'area: production installer bug help wanted',2018-09-20T18:19:41Z,2019-07-23T14:19:03Z
10532,weird CSS/GL artifacts when scrolling in Chrome 69 / Chromebook,"it happens when I scroll on a thread on rust-lang zulip

Not sure how to provide more actionable debugging info, feel free to ask for more information.

![screenshot 2018-09-19 at 2 26 17 pm](https://user-images.githubusercontent.com/66734/45824976-2b896480-bcbf-11e8-8745-3f81cc5516a5.png)
",qmx,b'area: browser-support area: message view bug',2018-09-20T14:24:11Z,2019-07-02T22:20:28Z
10529,Prior full name appears in the Settings modal after changing the full name and reopening the modal.,"When I change my user full name under 'User settings', the field in the Settings modal changes accordingly. If I close and reopen the Settings modal, though, the old name is displayed.

In this screen recording, I change the full name from 'Jack Zhang' to 'Jack R. Zhang':

![change-full-name-old-name-reappears-after-reopening-settings-modal](https://user-images.githubusercontent.com/12771126/45786152-009e0280-bc24-11e8-97fa-528a1c26d20c.gif)

The correct value for full name is shown after refreshing the window.

@zulipbot add ""bug"" ""area: settings UI""",jackrzhang,b'area: settings UI bug',2018-09-19T22:57:21Z,2019-07-23T14:19:46Z
10526,message editing: Right sidebar doesn't fade when message editing.,"To repro, find a stream where not everyone is subbed, send a message, and then hit left arrow to get into the editing view.

The right sidebar should fade out anyone not subbed to the stream, but it currently doesn't. ",rishig,b'area: message-editing area: right-sidebar bug help wanted',2018-09-19T02:02:28Z,2018-09-27T13:24:44Z
10518,setting: Sorts on uploaded files no longer work.,"Upload a few files.
Go to Settings -> Uploaded files.
Click on a heading at the top of the table:
![image](https://user-images.githubusercontent.com/890911/45602222-1bc40480-b9cf-11e8-88ae-4702b6a90ada.png)

It should resort, but it's currently doing nothing.
Also (maybe relatedly) the sort is not what it claims it is; on czo for me:
![image](https://user-images.githubusercontent.com/890911/45602237-5fb70980-b9cf-11e8-8c89-81daf5c49943.png)

(Note the ""Jul 30"" in the middle).",rishig,b'area: settings (user) bug help wanted',2018-09-16T23:42:07Z,2018-10-02T18:34:33Z
10515,"registration: ""Log in with google"" with no account takes you to the wrong page for invite-only realms.","To reproduce:
* Create an invite-only realm, foo.zulipdev.com
* Log in to a google account not corresponding to any user in foo.zulipdev.com.
* Go to foo.zulipdev.com and click ""Log in with google"".
* It takes you to a page that says ""You need an invitation to join this organization"".

It should instead take you to a page that allows you to log in to the correct google account.
As a V1, it can just give an error like ""the google account xxx@domain doesn't have an account in this organization. Please [log in] to the appropriate google account first.""

In general I suspect there's something wrong in our logic for invite-only realms here; at no point should you ever get to ""You need an invitation to join this organization"" from the login page. ",rishig,b'area: authentication bug help wanted priority: high',2018-09-15T19:35:17Z,2019-07-23T14:19:45Z
10509,bots: Enforce unique names for bots.,"From https://chat.zulip.org/#narrow/stream/9-issues/topic/gifbot.20.7C.20.40mention.20issue:

""""""
I am running giphy bot as @Gifbot. When I use autocomplete @-mention it shows @**Gifbot|9538** and the giphy bot doesn't respond. But @**Gifbot** works fine. What is the number that is added automatically? I think it is causing the issue.
""""""

We should actually just unconditionally enforce unique names for bots, since if you have two bots with the same name it's going to be hard to pick which one you mean from the typeahead, even if we fixed the issues with the user_id syntax.",rishig,b'area: bots bug help wanted',2018-09-13T16:49:50Z,2018-10-25T00:01:16Z
10506,Add confirm dialog for deleting user groups.,"This adds a confirmation dialog for deleting user groups.  It builds this on top of a generic confirm_dialog mechanism.

To test: Add a couple groups, which is pretty fast in the Org screens.  Try deleting user groups.  There are multiple ways to cancel/close the dialog, including clicking outside of it, and you should try all those ways.  It's also good to check clicking on on Delete when another confirmation modal is already open (the prior one will close).
",showell,b'area: settings (admin/org) bug size: XL',2018-09-12T19:18:23Z,2018-10-12T17:37:41Z
10498,user groups: Deleting user group should have confirmation modal.,"Currently an admin can delete a user group just by accidentally clicking on the ""delete"" button. There should be a confirmation modal.",rishig,b'area: settings (admin/org) bug help wanted',2018-09-11T15:45:02Z,2018-10-12T17:40:01Z
10482,frontend: Issue in upload file progress bar.,"I pasted image in the compose box, image successfully uploaded but even progress was 0 and send button was disabled on Safari 11.1.1.

<img width=""740"" alt=""screen shot 2018-09-05 at 10 38 40 pm"" src=""https://user-images.githubusercontent.com/18511177/45211536-2fc18500-b2b0-11e8-9a71-43841343ef15.png"">

related chat https://chat.zulip.org/#narrow/stream/9-issues/topic/file.20upload.20progress

@akashnimare is also facing this issue.",jainkuniya,b'area: uploads bug',2018-09-07T09:41:43Z,2019-05-01T18:27:07Z
10421,stream settings: All streams doesn't show scrollbar at first.,"To reproduce:
* Go to the gear menu, e.g. on chat.zulip.org
* Click Manage settings
* Click ""All streams""

Hover over the streams list. There should be a scroll bar, but there isn't.
If you scroll some other way, e.g. with the middle button on your mouse, and then scroll back up, the scroll bar appears as it should.",rishig,b'area: stream settings bug help wanted',2018-08-25T17:44:07Z,2019-05-17T20:08:57Z
10400,management: Fix send_password_reset_email command,"Fixes #10379



",hackerkid,b'area: authentication bug priority: blocker size: M',2018-08-23T12:49:48Z,2018-08-23T19:06:41Z
10381,"notifications: ""Mobile notifications always"" should be independent of ""Mobile notifications for PMs"".","Currently ""Mobile notifications always"" has a dependency on a parent setting. 
This setting should actually be something like ""Send mobile notifications immediately"" and should not be in the ""Private messages and @-mentions"" section at all.

![image](https://user-images.githubusercontent.com/890911/44377400-68d8b780-a4b1-11e8-9d64-8433b8c9b0bf.png)

The main task is to split the setting from it's parent, so that e.g. if you don't get PM notifications but you do get stream mobile notifications, this setting still works. We can independently do the follow-up work of renaming and moving the setting to another part of the settings UI.",rishig,b'area: mobile area: notifications (messages) bug help wanted',2018-08-21T02:50:05Z,2019-04-23T22:43:26Z
10379,manage.py send_password_reset_email sends email without reset link,"1.8.1; `./manage.py send_password_reset_email -u mail@example.com` sent me this email:

```
Psst. Word on the street is that you need a new password, mail@example.

It's all good. Follow the link below and we'll take care of the rest:



Thanks,
Your friends at Zulip HQ
```

The reset link is missing.

I think that's because the template is supposed to render `send_email('zerver/emails/password_reset', `, which renders [`reset_url`](https://github.com/zulip/zulip/blob/610eb557b8492b0ecf3893f047e705c549e57047/templates/zerver/emails/password_reset.txt#L23), which isn't set by the command but only by https://github.com/zulip/zulip/blob/610eb557b8492b0ecf3893f047e705c549e57047/zerver/forms.py#L234 which as far as I can tell is only for the web form, not the command.",nh2,b'area: authentication bug priority: blocker',2018-08-20T22:44:45Z,2019-07-23T14:19:43Z
10378,Division by zero when upgrading from 1.9 RC1 to master,"Upgrading from 1.9 RC1 to master after having imported a Slack export crashes with this for me:

```
# /home/zulip/deployments/current/scripts/upgrade-zulip-from-git master
...
Operations to perform:
  Apply all migrations: analytics, auth, confirmation, contenttypes, otp_static, otp_totp, sessions, sites, social_django, two_factor, zerver
Running migrations:
  Applying zerver.0182_set_initial_value_is_private_flag...
Start setting initial value for is_private flag...
Traceback (most recent call last):
  File ""./manage.py"", line 36, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/commands/migrate.py"", line 204, in handle
    fake_initial=fake_initial,
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/executor.py"", line 115, in migrate
    state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/executor.py"", line 145, in _migrate_all_forwards
    state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/executor.py"", line 244, in apply_migration
    state = migration.apply(state, schema_editor)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/migration.py"", line 129, in apply
    operation.database_forwards(self.app_label, schema_editor, old_state, project_state)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zulip-py3-venv/lib/python3.6/site-packages/django/db/migrations/operations/special.py"", line 193, in database_forwards
    self.code(from_state.apps, schema_editor)
  File ""/home/zulip/deployments/2018-08-20-23-39-10/zerver/migrations/0182_set_initial_value_is_private_flag.py"", line 36, in set_initial_value_of_is_private_flag
    percent = round((processed / total) * 100, 2)
ZeroDivisionError: division by zero
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-08-20-23-39-10/scripts/lib/upgrade-zulip-stage-2"", line 152, in <module>
    subprocess.check_call([""./manage.py"", ""migrate"", ""--noinput""], preexec_fn=su_to_zulip)
  File ""/usr/lib/python3.6/subprocess.py"", line 291, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['./manage.py', 'migrate', '--noinput']' returned non-zero exit status 1.
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/upgrade-zulip-from-git"", line 71, in <module>
    deploy_path, ""--from-git""] + deploy_options)
  File ""/usr/lib/python3.6/subprocess.py"", line 291, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2018-08-20-23-39-10/scripts/lib/upgrade-zulip-stage-2', '/home/zulip/deployments/2018-08-20-23-39-10', '--from-git']' returned non-zero exit status 1.
```",nh2,b'area: export/import bug',2018-08-20T21:46:46Z,2019-07-23T14:19:43Z
10372,style: Fix the stream and user list buttons on mobile in night mode.,"Currently, these buttons are displayed with a lighter background than other buttons. This PR updates their borders and background colors (along with the border on the search box) so that they match the night theme.

Fixes #10301.

(I made a different PR for this earlier, but I'm opening this PR since I think that I've found a clearer solution, as well as that the reviewer for the earlier PR, synicalsyntax, said on CZO that she won't be able to do reviews for a month or so.)

**Screenshots:**

*Before:*

<img width=""317"" alt=""before"" src=""https://user-images.githubusercontent.com/17259768/44179868-3ba19900-a0ae-11e8-88c1-cf58f367a61c.png"">

*After:*

<img width=""317"" alt=""after"" src=""https://user-images.githubusercontent.com/17259768/44356154-60599000-a463-11e8-8d1a-4524de7ed837.png"">",marco,b'area: left-sidebar area: right-sidebar bug size: S',2018-08-20T17:27:02Z,2018-08-21T19:42:51Z
10358,settings_org: Disable topic editing checkbox when message editing is off,"Fixes: #10327

**GIFs or Screenshots:** 
![image](https://user-images.githubusercontent.com/40331304/44298642-481f2f00-a304-11e8-9607-628e241dbd1c.png)



",pragatiagrawal31,b'area: settings (admin/org) bug size: S',2018-08-18T11:04:57Z,2018-08-31T18:50:37Z
10354,"Multiple invites, duplicate/multiple click handlers","I'm pretty sure the issue with this is setting multiple click handlers: line 70 of `static/js/invite.js` in `exports.launch`.

To reproduce:
1. Go to http://localhost:9991/#invite
2. Close the modal (by clicking out or the `x`)
3. Go to http://localhost:9991/#invite again
4. Close the modal (by clicking out or the `x`)
5. Go to http://localhost:9991/#invite again
6. Invite a person, like `a@zulip.com`
7. See that you invited `a@zulip.com` 3 times!",lonerz,b'area: invitations bug help wanted',2018-08-18T04:51:40Z,2019-07-23T14:19:42Z
10351,Custom GIF emoji - alpha color,"Hello,

After the resizing function for the custom gif was added, every time I upload a new custom GIF emoji, the background, which should be transparent, is now black.

Thanks @HarshitOnGitHub, for the resizing function, do you think this issue could be related ?

<img width=""42"" alt=""screen shot 2018-08-17 at 3 05 13 pm"" src=""https://user-images.githubusercontent.com/9500684/44284255-fb1d5900-a22e-11e8-9153-9cda5c9bde6e.png"">
",julievalet,b'area: emoji bug help wanted priority: high',2018-08-17T19:05:39Z,2020-09-16T21:12:34Z
10348,docs: Link in the docs leads to 'Page does not exist yet',"On doc pages like https://zulip.readthedocs.io/en/1.7.1/code-style.html , a warning pops up showing 

```You are not using the most up to date version of the library. 1.8.1 is the newest version.```

When you click on the link provided in the warning, it leads to 'Page does not exist yet'.

This link needs to be changed to a working one.",shikharvaish28,b'area: documentation (developer) bug wontfix',2018-08-17T14:41:48Z,2018-08-17T19:17:03Z
10335,custom profile field: Limit name and hint.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes #10284 

**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YJDave,b'area: settings (admin/org) bug size: L',2018-08-16T18:28:17Z,2018-08-17T15:59:03Z
10333,'Settings' object has no attribute 'SEND_REMOVE_PUSH_NOTIFICATIONS',"Whenever a new user logs in to our Zulip instance, an error ist generated:

    Logger root, from module zerver.worker.queue_processors line 149:
    Error generated by Anonymous user (not logged in) on df11769d5aac deployment
    
    Traceback (most recent call last):
     File ""/home/zulip/deployments/2018-08-13-14-36-34/zerver/worker/queue_processors.py"", line 132, in consume_wrapper
       self.consume(data)
     File ""/home/zulip/deployments/2018-08-13-14-36-34/zerver/worker/queue_processors.py"", line 310, in consume
       handle_remove_push_notification(data['user_profile_id'], data['message_id'])
     File ""/home/zulip/deployments/2018-08-13-14-36-34/zerver/lib/push_notifications.py"", line 561, in handle_remove_push_notification
       if not settings.SEND_REMOVE_PUSH_NOTIFICATIONS:
     File ""/home/zulip/deployments/2018-08-13-14-36-34/zulip-py3-venv/lib/python3.5/site-packages/django/conf/__init__.py"", line 57, in __getattr__
       val = getattr(self._wrapped, name)
    AttributeError: 'Settings' object has no attribute 'SEND_REMOVE_PUSH_NOTIFICATIONS'
    
    Deployed code:
    - ZULIP_VERSION: 1.9.0-rc1+git
    - version: docker


The error is only triggered when a user logs in that previously hadn't logged in. We use our LDAP Server to authenticate the users.

I tried having a look at the code, but at first glance, everything seems fine to me: The `SEND_REMOVE_PUSH_NOTIFICATIONS` setting does exist in `settings.py` and the code should import the correct settings.

The code using this setting was added in commit 
https://github.com/zulip/zulip/commit/da8f4bc0e956e29b140fa89e963b67e3d23581df#diff-9311e61501fde7dc47af866221b347d1

Please tell me if I you need more information about our setup.
",Mactory,b'area: production bug question',2018-08-16T11:54:21Z,2018-08-27T19:41:39Z
10328,style: Fix the stream and user list buttons on mobile in night mode.,"Currently, these buttons are displayed with a lighter background than other buttons. This PR updates their borders and background colors (along with the border on the search box) so that they match the night theme.

Fixes #10301.


**Screenshots:**

*Before:*

<img src=""https://user-images.githubusercontent.com/17259768/44179868-3ba19900-a0ae-11e8-88c1-cf58f367a61c.png"" alt=""before"" width=""300px"" />

*After:*

<img src=""https://user-images.githubusercontent.com/17259768/44179876-3d6b5c80-a0ae-11e8-89d9-78e711b53352.png"" alt=""before"" width=""300px"" />
",marco,b'area: left-sidebar area: right-sidebar bug size: S',2018-08-16T00:12:39Z,2018-08-20T17:14:24Z
10327,settings: Community topic editing should be grayed out when message editing is off.,"![image](https://user-images.githubusercontent.com/890911/44177203-a8626680-a0a1-11e8-8e73-ccc0b2a71a7e.png)

The checkbox setting has no effect when ""Allow message editing"" is ""Never"".",rishig,b'area: settings (admin/org) bug help wanted',2018-08-15T22:42:03Z,2018-08-31T18:51:10Z
10314,uploads: Create a placeholder when uploading.,"This PR adds a placeholder when uploading files, so that images are properly placed even if a user keeps typing while they are uploading. The placeholder `[uploading file]()` is used. This is based
on GitHub's handling of image uploading.

Fixes #10305.

**Testing Plan:** <!-- How have you tested? -->

This PR adds tests to the `upload` Node tests and update existing tests to account for the new behavior.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

This GIF shows the placeholder inserted, and how the image is placed at its initial location, even after `qwerty` is typed during the upload:

![fileupload](https://user-images.githubusercontent.com/17259768/44129097-85da9868-9ffb-11e8-89d1-71d839b3e619.gif)",marco,b'area: compose area: uploads bug priority: high size: L',2018-08-15T02:52:45Z,2018-08-27T06:37:05Z
10305,compose: Use placeholder when pasting issues.,"This happens to me fairly often:
* I paste an image
* Continue typing or otherwise move the cursor around
* The image finishes uploading, and gets inserted into the wrong part of the input
* I have to manually cut and paste it to the intended location.

GitHub does this really well, so we should just copy how they do it :). They put down a placeholder, and then replace the placeholder when the image has finished uploading.
",rishig,b'area: compose area: uploads bug help wanted priority: high',2018-08-14T18:25:56Z,2019-07-23T14:19:41Z
10301,night mode: Fix sidebar icons in narrow window.,"Sidebar icons appear to haven't been covered in night mode CSS.
![image](https://user-images.githubusercontent.com/16687990/44092182-4e05f08a-9fed-11e8-99a4-796c3b52882e.png)
",HarshitOnGitHub,b'area: left-sidebar area: right-sidebar bug help wanted',2018-08-14T12:41:31Z,2019-07-23T14:19:41Z
10288, compose: Hide subscribe button and change text for waiting period users.,"Fixes #10124.

After commit 2:
![selection_213](https://user-images.githubusercontent.com/13910561/44007734-5251b844-9eb8-11e8-8ad8-f6cf8e363879.png)

I've not added any event-related changes as I did not find any event related specifically to waiting period. Let me know if any event needs to be added. ",shubham-padia,b'area: stream settings bug priority: high size: L',2018-08-12T23:50:48Z,2018-08-13T17:21:25Z
10284,custom profile fields: Limit label length.,"Tried out the custom profile fields, and found some issues with label and hint length.

* http://localhost:9991/#organization/profile-field-settings breaks irrecoverably with a longish label and hint without spaces (some languages don't have spaces, so this is a reasonable thing to support).
* http://localhost:9991/#settings/your-account breaks for medium sized label lengths with or without spaces
* We should restrict label length to something (40 characters?) and make sure everything works at that label and hint length.

Also, while editing a profile field, we should advertise the limits. E.g.
* `Hint` -> `Hint (up to 80 characters)`
* The hint input field should stop you from typing once you get to 80 characters
",rishig,b'area: settings (admin/org) bug help wanted',2018-08-12T01:05:42Z,2019-07-23T14:19:40Z
10283,onboarding: Change logic for preventing new login emails for a new user.,"Fixes #10179.
Issue: When you created a new organization with /new, the ""new login""
emails were emailed. We previously had a hack of adding the
.just_registered property to the user Python object to attempt to
prevent the emails, and checking that in zerver/signals.py. This
commit gets rid of the .just_registered check.
Instead of the .just_registered check, this checks if the user has
joined more than a minute before.
A test test_dont_send_login_emails_for_new_user_registration_logins
already exists.

",shubham-padia,b'area: onboarding bug priority: high size: M',2018-08-12T00:53:17Z,2018-08-13T17:18:28Z
10280,logging: Show timestamp in UTC in non-django production scripts.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->

No automated tests- couldn't find any relevant files to add tests to.

Tested output of `restart-server, upgrade-from-git, upgrade-zulip, upgrade-zulip-part-2`. The other tools should ideally be working as advertised as well but we couldn't trigger them on nightly (`zerver/management/*`, `puppet/zulip*`). We didn't change this in `tools/*` beause they are meant to be used in the dev env.

**Sample output:**

```
2018-08-11 20:02:57,105 upgrade-zulip-stage-2: Restarting Zulip...
2018-08-11 20:03:01,614 restart-server: Filling memcached caches
2018-08-11 20:03:07.142 INFO [] Successfully populated client cache!  Consumed 1 remote cache queries (0.01 time)
2018-08-11 20:03:07.144 INFO [] Successfully populated huddle cache!  Consumed 1 remote cache queries (0.0 time)
2018-08-11 20:03:07.156 INFO [] Successfully populated stream cache!  Consumed 1 remote cache queries (0.0 time)
2018-08-11 20:03:07.160 INFO [] Successfully populated session cache!  Consumed 1 remote cache queries (0.0 time)
2018-08-11 20:03:07.168 INFO [] Successfully populated user cache!  Consumed 1 remote cache queries (0.0 time)
2018-08-11 20:03:07.172 INFO [] Successfully populated recipient cache!  Consumed 1 remote cache queries (0.0 time)
2018-08-11 20:03:07,514 restart-server: Stopping workers
2018-08-11 20:03:07,914 restart-server: Stopping server core
2018-08-11 20:03:08,287 restart-server: Starting server core
2018-08-11 20:03:12,940 restart-server: Starting workers
2018-08-11 20:03:17,626 restart-server: Done!
2018-08-11 20:03:17,653 upgrade-zulip-stage-2: Upgrade complete!
```

Fixes #9678 .",rogeredthat,b'area: production installer bug size: S',2018-08-11T20:11:51Z,2018-08-20T20:00:33Z
10278,portico: Fix frontend email validation on /new.,"Fixes: #10040



**GIFs or Screenshots:** 
![image](https://user-images.githubusercontent.com/40331304/43992425-c6758cd2-9d9b-11e8-8a5b-2ef344917087.png)




",pragatiagrawal31,b'area: portico bug size: XS',2018-08-11T13:53:22Z,2018-08-11T21:56:23Z
10275,hotkeys: Ctr+s doesn't work from compose box.,"To reproduce:
* Click on a stream message
* Type `Ctr + s`

Expected behavior is that the message should star or unstar.
Current behavior is the ""save"" dialog box opens up.",rishig,b'area: keyboard UI bug help wanted',2018-08-11T01:07:04Z,2018-10-22T16:48:01Z
10265,"""more topics"" should not display when there are no more topics to be shown","![moretopics](https://user-images.githubusercontent.com/11819861/43941972-fad03b98-9c2a-11e8-97fd-4bd29d89d45f.gif)

User expects there to be more topics when they select ""More Topics"". It would be a cleaner UI to not display ""more topics"".",melchan15,b'area: left-sidebar bug priority: high',2018-08-10T06:23:33Z,2019-03-15T04:53:02Z
10257,Empty string in 'secret_auth_ldap_bind_password' not possible: Breaks anonymous ldap bind,"The Default setting for the `AUTH_LDAP_BIND_PASSWORD` set by `django_auth_ldap` is an empty string. This is passed to the ldap server at bind time.
The Zulip mechanism to use a config file for the secrets results in the setting beine `None` if it is unset. The `None` value is then passed to the ldap library which results in the anonymous bind failing.

",Mactory,b'area: authentication bug',2018-08-09T16:09:27Z,2018-08-13T16:34:41Z
10253,compose: Update the `New topic` button to say `New stream message` when in PMs.,"If a user is narrowed by `is:private`, `pm-with`, or `group-pm-with`, this PR changes the `New topic` button to say `New stream message` instead for added clarity.

Fixes #9072.

**Testing Plan:** <!-- How have you tested? -->

This PR adds two new tests to the `narrow` Casper tests and updates the Node tests.

**GIFs or Screenshots:**

*When in a public stream (or ""All messages"" and other non-private narrows):*

<img width=""958"" alt=""public-screenshot"" src=""https://user-images.githubusercontent.com/17259768/43877545-5f998b2e-9b4f-11e8-8f65-f26e290f5834.png"">

*When in a PM:*

<img width=""960"" alt=""private-screenshot"" src=""https://user-images.githubusercontent.com/17259768/43877547-617d62f8-9b4f-11e8-853e-ea2d7c53317b.png"">
",marco,b'area: compose bug size: S',2018-08-09T04:10:16Z,2018-08-09T15:56:58Z
10250, user groups: Improve styling and display error on user group name edit failure.,"![](https://i.gyazo.com/75a62fc8e48efae840e2298e36c590c3.gif)


Fixes #10234.",synicalsyntax,b'area: settings UI bug size: XL',2018-08-09T00:45:15Z,2018-08-14T23:06:43Z
10249,night mode: Fix coloring of widgets in night mode.,"![screenshot at aug 08 17-39-58](https://user-images.githubusercontent.com/15116870/43871559-16a14672-9b32-11e8-9be4-63823bfdcd0d.png)

`static/styles/widgets.scss` applies a lot of styling not in RGB colors, resulting in a lot of miscolored elements.

Example:
```css
button.add-task,
button.poll-comment,
button.poll-question {
    border-radius: 3px;
    border: 1px solid #cccccc;
    background-color: white;
    width: 100px;
}

button.add-task:hover,
button.poll-comment:hover,
button.poll-question:hover {
    border-color: #999999;
}

.widget-error {
    color: #b94a48;
    font-size: 12px;
}",synicalsyntax,b'area: general UI bug',2018-08-09T00:42:09Z,2019-03-02T01:36:33Z
10244,user popover: Fix bug in choice and user type custom fields.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![screen shot 2018-08-09 at 1 26 21 am](https://user-images.githubusercontent.com/25907420/43862467-689b55c2-9b77-11e8-984f-5084d038fa17.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YJDave,b'area: general UI bug priority: high size: S',2018-08-08T20:26:37Z,2018-08-08T22:02:16Z
10239,user profile: Choice fields show index of field instead of actual value.,"![screenshot at aug 08 11-02-09](https://user-images.githubusercontent.com/15116870/43855831-ae2db8a4-9afb-11e8-9d5c-cc963fc53181.png)
",synicalsyntax,b'area: general UI bug priority: high',2018-08-08T18:11:21Z,2019-07-23T14:19:39Z
10237,Empty looking message when a URL with an image extension doesn't return an image,"To recreate - upload an image to site like [linx.li](https://linx.li), and post the URL in zulip. 

The returned link ends with an image extension, but opening it opens a website that displays the image instead of just opening the image. When posted in Zulip what you get is an empty looking message whose link is a bit of a pain to copy.

![image](https://user-images.githubusercontent.com/917126/43852743-b57233b0-9b46-11e8-88f4-657400168306.png)
![image](https://user-images.githubusercontent.com/917126/43852795-dfec4a86-9b46-11e8-8a1e-51369c0d008f.png)
",zingmars,b'area: message view bug',2018-08-08T17:10:08Z,2018-10-09T23:07:42Z
10234,user_groups: Handle non-successful edit responses.,"# Description

Whenever the server replies with a non-successful response after attempting to edit a user group, the settings UI doesn't provide any feedback to the user and remains in the ""edit mode"".

# Steps to reproduce

1. Go to the org settings and create a user group called ""foo"".
2. Create another user group called ""bar"".
3. Try to rename ""foo"" to ""bar"".
4. Nothing happens, but in the background the server has replied that it's not possible to do such modification.

![User group update error](https://user-images.githubusercontent.com/7356565/43851017-d6b0a1e0-9b39-11e8-8c23-9830d1904b6a.png)

# Expected behaviour

The UI should let the user know that something is wrong and the user group couldn't be updated.
#10231 changes the backend's behaviour for this specific case, to reply with a proper message rather than just an internal server error. However, other possible cases must be handled in the UI as well (like keeping a field empty).

---

@zulipbot label ""area: settings UI"" ""bug""",YagoGG,b'area: settings UI bug',2018-08-08T16:37:41Z,2018-08-13T23:18:07Z
10230,org settings: Fix a bug where the loading spinner is not visible.,"This issue is caused because the `filter` elements for the loading indicators have **the same ID** across the different sections. (There are multiple `filter` elements with the ID `uil-ring-shadow` on the page.)

To solve this, when generating a new loading SVG element, this PR **appends the container element's ID to the filter's ID**, thus preventing any duplicates.

Fixes #8620.

**GIF of loading indicator on Disabled Users section:**

![loading indicator](https://user-images.githubusercontent.com/17259768/43808859-ca56ebba-9a63-11e8-8dd5-19e9b56f63f8.gif)
",marco,b'area: settings (admin/org) bug size: S',2018-08-08T00:05:53Z,2018-08-08T18:00:57Z
10221,German translation: Link to streams page invalid,"**Steps to reproduce:**

1. Set the display language to ""German"" and reload the page to apply the change
2. Open settings page (""Einstellungen"")
3. Navigate to ""Notifications"" (""Benachrichtigungen"")
4. Click the ""Streams Seite"" link

A 404 error page appears.

When copying the link target, the URL is `https://xxx.zulipchat.com/%22/#streams\""` whereas it should be `https://xxx.zulipchat.com/#streams` instead.

The problem does not appear when selecting English as display language.",max-maurice,b'area: i18n area: settings (user) bug',2018-08-07T09:21:39Z,2018-08-07T18:02:48Z
10201,group pms: Fix unread count not on the same line of text.,"Fixes #10199.
The issue was reproduced on Chrome v68 by @priyankp10.
I was not able to reproduce it on Chrome v64.

Priyank was going AFK soon after discovering the solution, I've made a commit on his behalf with him as the author.

cc: @timabbott ",shubham-padia,b'bug priority: blocker size: XS',2018-08-05T20:43:10Z,2018-08-05T23:04:16Z
10199,"Fix broken line-wrapping for our ""Group PMs"" area in bottom-right","It appears the CSS for our ""group PMs"" area is completely broken:

![image](https://user-images.githubusercontent.com/2746074/43688655-95944616-98a1-11e8-8a16-094f07df9fee.png)

The unread counts should be in the same line as the text, and also the vertical space seems too big.",timabbott,b'bug priority: blocker',2018-08-05T18:21:10Z,2018-08-05T23:04:08Z
10194,stream settings: Fix hide change-sub-type when admin unsubscribe stream.,"Fixes #10163

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![unsub_stream](https://user-images.githubusercontent.com/25907420/43680519-6791a778-985a-11e8-8fa6-c68974246714.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YJDave,b'area: real-time sync area: stream settings bug size: XS',2018-08-04T21:21:29Z,2018-08-15T05:12:16Z
10186,forms: Fix accounts listed in password_reset email to active accounts.,"Previously we were listing both accounts, active as well as non-active.
Fixes: #10130.
![screenshot from 2018-08-04 18-00-21](https://user-images.githubusercontent.com/22238472/43676495-521e4f12-9810-11e8-8bd3-816fbfbd914e.png)
A better alternative for ""Kindly, contact the organization administrators."" required.",shubhamdhama,b'area: emails bug priority: high size: S',2018-08-04T12:31:34Z,2018-08-13T20:00:31Z
10180,emails: Show HHMM timezone on new login emails.,"Email notifications for new logins displayed the login timestamp's timezone in the location format (e.g. ""Asia/Taipei"").
Since that can lead users to understand the login came from that place, the timezone in those emails is now represented in +/-HHMM format.

Fixes #10178.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** backend and lint tests passed locally.

Tried with multiple timezones by changing the `TIME_ZONE` setting in `zproject/settings.py`.


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

*CET timezone*
![Email notification CET](https://user-images.githubusercontent.com/7356565/43669975-9759f5f6-9787-11e8-90d9-86eca72ef54d.png)

*EST timezone*
![Email notification EST](https://user-images.githubusercontent.com/7356565/43670013-ed03ffd8-9787-11e8-8c04-37a827da0abb.png)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YagoGG,b'bug priority: high size: S',2018-08-03T23:44:53Z,2018-08-04T00:15:52Z
10179,"""New login"" security emails are incorrectly sent when users create an organization","Apparently, when you create a new organization with /new, we email you the ""new login"" emails.  Easy to confirm using /emails in development.

The cause is apparently that because for realm creation we call `redirect_and_log_into_subdomain`, attaching a property to the UserProfile object isn't an effective way to pass data to the code that sends the emails.

We should probably just replace that hack with a check for the first 1 minute after a user's account is created (using `user_profile.date_joined`).",timabbott,b'area: onboarding bug priority: high',2018-08-03T22:48:58Z,2019-07-23T14:19:39Z
10178,"Fix timezone display format in ""new login"" emails","I just got this email when testing:

```
Login details:

Server: http://asdasf.zulipdev.com:9991

Account: tabbott@zulipchat.com

Time: Friday, August 03, 2018 at 03:35PM America/Los_Angeles

Device: Chrome on Linux.

IP Address: 127.0.0.1
```

We should display the timezone as e.g. `-05:00`, not with a location.

Tagging as a priority, because we've seen people be confused into thinking this suggested they were in LA.",timabbott,b'bug priority: high',2018-08-03T22:37:02Z,2018-08-04T09:19:23Z
10163,stream privacy [change] link UI update,"If you are an organization administrator and you change the privacy level of a stream to be a private stream, and then immediately unsubscribe, the stream interface makes it look like you can still change the privacy level of the stream. You can't, but the other ""I'm subscribed"" controls (ie the notification controls) disappear, and the '[change]' link does not. It does disappear if you refresh the page.",Lyla-Fischer,b'area: real-time sync area: stream settings bug',2018-08-03T00:31:35Z,2019-07-23T14:19:39Z
10160,custom profile field: Remove order column in custom-field-choices.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This is removes order column in choices and add drag & drop type of rows for ordering. 
Fixes #10129 


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Before:
![screen shot 2018-08-03 at 1 21 59 am](https://user-images.githubusercontent.com/25907420/43610844-f4d90c26-96c4-11e8-8c23-6f5961e2556d.png)
After:
![screen shot 2018-06-12 at 9 33 11 am](https://user-images.githubusercontent.com/25907420/43610843-f46b17fc-96c4-11e8-9154-0d63783175e2.png)

![cp_10129](https://user-images.githubusercontent.com/25907420/43610723-92a85ee4-96c4-11e8-93af-f7d9c22ef5a6.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YJDave,b'area: settings (admin/org) bug has conflicts priority: high size: XL',2018-08-02T20:59:48Z,2018-08-13T17:32:44Z
10156,custom profile fields: Fix click handler executed multiple times.,"We setup click handler on create-custom-field-btn each time settings
overlay opens, which executes handler multiple times results in
more than one HTTP request to server for custom field creation.

To fix this, first removed previously initialized handler on button
before setting new handler.

Fixes #10126

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![cp_10126](https://user-images.githubusercontent.com/25907420/43603145-bcf53b50-96af-11e8-942c-f07567bef044.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YJDave,b'area: settings (admin/org) bug priority: high size: S',2018-08-02T18:22:26Z,2018-08-09T17:14:45Z
10151,[WIP] auth: Force remove session cookies set on root domain for clients.,"This will break the login loops for people who tried login using
github (social auth) and got stuck in endless login loops.
The issue of login loops has been reported to happen on Microsoft Edge
only.
For other browsers like Firefox or Chrome, people seemed to aparantly
get logged out of their sessions on realms (which are hosted on same
Zulip server) when they logged into another realm on same server
using github (social auth). Trying to login back into the realms from
which user got logged out worked fine.

This behaviour difference seems to orginate from the way browsers
arrange the list of cookies to be sent to the server in the headers.
Django seems to maintain the cookies in its Request Objects using
dictionaries with cookie name being used as a key. Therefore if
multiple cookies with same name were sent from browser Django would
retian only one of them and which cookie would be retained would
probably depend on the order they are parsed from the request
headers.

Chrome and Firefox seem to arrange cookies sent in request headers
according to expiry (ascending order). This behaviour makes
logging back in possible because now the expiry of the session
cookie for the subdomain would be greater than that of the cookie
setup by python-social-auth (which was set when user logged into
another realm before causing log outs in the first place).

Microsoft Edge doesn't seem follow the same pattern of arranging
cookies into the request headers. Instead it seems like it always
puts in the cookie setup on root domain at the end. This results
people getting stuck in login loops because no matter what one
may do, once the cookie on root domain is created it will endup
masking other session cookies.

Fixes: #9940.",adnrs96,b'area: authentication bug has conflicts size: M',2018-08-02T09:54:54Z,2018-08-13T22:58:59Z
10150,subs: Fix broken streams list header/search container in Safari.,"Before:
![screenshot at aug 01 19-28-32](https://user-images.githubusercontent.com/15116870/43559326-89e6ff02-95c2-11e8-9b3a-9673191426f8.png)

After:
![screenshot at aug 01 19-28-11](https://user-images.githubusercontent.com/15116870/43559341-91578568-95c2-11e8-92ec-6a46102c081a.png)

Fixes #10064.
",synicalsyntax,b'area: stream settings bug size: XS',2018-08-02T02:39:15Z,2018-08-14T23:05:38Z
10144,right sidebar: Unread count moves on hover.,"![peek 2018-08-01 14-08](https://user-images.githubusercontent.com/890911/43543338-b4ef1c0e-959d-11e8-8f77-a23ec436af99.gif)

This is a recent regression. You can hover over rows with unreads in the left sidebar to see the expected behavior.",rishig,b'area: right-sidebar bug help wanted',2018-08-01T19:15:26Z,2018-08-01T20:27:40Z
10130,Invalid email when trying to reset password for a deactivated account,"> Background: I tried out chat.zulip.org once before, and the deactivated the account using Settings > Your Account > Deactivate Account.

> Today I tried signing up on chat.zulip.org using the same email id and it said the account already exists and I could ask for a password reset.

> So I asked for a password reset and I got this very confusing password reset email (that doesn't let me reset my password):

    Someone (possibly you) requested a password reset email for XXXXXXXXXXXXXXXXX on https://chat.zulip.org, but you do not have an active account in https://chat.zulip.org. However, you do have an active account in the https://chat.zulip.org organization; you can try logging in or resetting your password there.

    Thanks,
    Your friends at Zulip HQ

> The XXXXXXXXXXXXXXXXX was the email address I used, and is the only part I edited from the original message.

Originally reported at https://chat.zulip.org/#narrow/stream/9-issues/topic/Deactivated.20Account.20UX",hackerkid,b'area: emails bug priority: high',2018-07-31T17:40:13Z,2019-07-23T14:19:38Z
10129,"custom profile fields: Improve UX of ""choices"" text boxes","It's definitely worth fixing these issues:
(1) The text boxes for defining choices feel really small.
(2) The ""Order"" column is silly, and should be replaced with being dragged around with sortable.js, just like we have for the fields themselves.  

",timabbott,b'area: settings (admin/org) bug priority: high',2018-07-31T17:28:52Z,2019-07-23T14:19:38Z
10126,Creating custom profile fields displays a flickered error if you've opened form twice,"When setting up custom profile fields on chat.zulip.org, I saw (rather than a loading indicator) a brief flash of a (paraphased, since it's a flash) ""The field already exists"" error.  

After consulting the network tab, I saw that what's happening is we're somehow double-sending the HTTP request to add the field to the server.  And then I was able to reproduce it by opening the settings page multiple times in the same session; so it's definitely a bug where we setup click handlers each time we display the form (rather than only doing it once).

This is a high priority issue, since I think a lot of people using this feature will end up seeing it.",timabbott,b'area: settings (admin/org) bug priority: high',2018-07-31T17:10:14Z,2019-07-23T14:19:37Z
10124,Display subscription error wherever missing,"Follow up to #10123 .
These issues also need design feedback, so were not attempted in the above PR.

- [ ] Improve design and show the error returned by the server when mentioning non-subscribed users in a stream. If a separate line for the error is not possible, consider adding the error in the tooltip.
![selection_206](https://user-images.githubusercontent.com/13910561/43439257-094d2bd6-94b0-11e8-90e1-057d546764f0.png)

- [x] No error occurs when trying to post to an unsubscribed stream, the warning message disappears.
![selection_204](https://user-images.githubusercontent.com/13910561/43439328-655395b4-94b0-11e8-8307-d373efa77494.png)

- [x] No error displayed when the subscribe button show in below image is clicked
![selection_202](https://user-images.githubusercontent.com/13910561/43439361-80f450e2-94b0-11e8-920e-bd6ed594398b.png)

- [x] No full error message displayed when trying to subscribe other users from the ""Manage streams"" UI.
",shubham-padia,b'area: stream settings bug priority: high',2018-07-31T05:27:33Z,2019-07-23T14:19:37Z
10085,Fix scrolling issues in left sidebar/stream settings (from #10010),"Part of PR #10010 

Currently on zoom out from stream topics, scrollbar didn't scroll back
to opened stream. Because call to scroll-to-stream func isn't called
after all streams view is displayed. So wrong stream element is
passed to func.

Fix this by calling scroll-to-stream func after all-stream-list view
is displayed.

Before:
![stream_scroll_2 1](https://user-images.githubusercontent.com/25907420/43306893-500976e2-919a-11e8-9fa6-b0b52740de93.gif)



After:
![stream_scroll](https://user-images.githubusercontent.com/25907420/43306868-40014086-919a-11e8-995f-8efe8ec20a65.gif)



",YJDave,b'area: stream settings bug size: XL',2018-07-27T07:13:56Z,2018-08-07T12:27:06Z
10064,frontend: Stream list is not completely visible on /#streams.,"On Safari 11.1.1
On Chrome it is working fine.


<img width=""632"" alt=""screen shot 2018-07-26 at 8 25 56 am"" src=""https://user-images.githubusercontent.com/18511177/43238847-9342044e-90ad-11e8-84a0-fabd6873998a.png"">
",jainkuniya,b'area: stream settings bug',2018-07-26T02:56:48Z,2018-08-02T17:07:20Z
10058,typeahead: Replace `no-break space (U+00A0)` in query with `space (U+…,"…0020)`.

Fixes #10039.
Typing ""tim "" did not did not produce any match when suggesting person
in composebox typeahead or user group typeahead as the space at the
end of the ""tim "" string passed by the browser was a
`no break-space (U+00A0)`  instead of `space (U+0020)`.
Although there are unicode characters other than `no break-space` which
represent spaces, only U+00A0 is replaced as it was the only space
character encountered when testing this issue manually.

One of the follow up issue after this would be to use `composebox_typeahead.query_matches_person` in user group settings typeahead after extracting `query_matches_*` functions to somewhere appropriate (I'm not sure about what location is appropriate atm, would put some more thought into it.).",shubham-padia,b'area: compose bug size: S',2018-07-25T20:55:16Z,2018-07-25T21:56:06Z
10052,portico: Amazing Community section `1 commits` instead of `1 commit`,"On the **Our amazing community** page, users with one commit in a project have the caption `1 commits` instead of the correct `1 commit`.

For example, on the JS API section:

<img width=""650"" alt=""screen shot 2018-07-25 at 7 13 27 am"" src=""https://user-images.githubusercontent.com/17259768/43206386-7887768a-8fda-11e8-9129-ee4253ccfb60.png"">
",marco,b'area: portico bug',2018-07-25T14:15:19Z,2018-07-27T18:53:48Z
10040,portico: Error handling is broken on /new.,"E.g. if you go to localhost:9991/new, enter `aaa` as your email address, and click `create organization`, nothing happens.

(Possibly this is not limited to /new, haven't checked.)",rishig,b'area: portico bug help wanted',2018-07-24T21:19:39Z,2019-07-23T14:19:36Z
10039,compose: Fix PM typeahead when it ends in a space.,"`tim` and `tim a` work in the compose PM typeahead, but `tim ` doesn't. ",rishig,b'area: compose bug help wanted',2018-07-24T17:45:01Z,2018-07-25T21:59:33Z
10038,static/generated emoji images are being hash-named incorrectly in production,"This manifests in production as this:

![image](https://user-images.githubusercontent.com/2746074/43151702-668cb2a6-8f21-11e8-8c3e-872149f07c88.png)

Inspecting the file tree, one sees this:

```
zulip@zulip:~/deployments/current$ sha1sum ~/prod-static/generated/emoji/images-google-64/1f642*
f0999847e06b80a6187fb16fdf8d2be9d4092cad  /home/zulip/prod-static/generated/emoji/images-google-64/1f642.780de933260e.png
e3c7b559db71b96adeee6fe61f710a18665d9df9  /home/zulip/prod-static/generated/emoji/images-google-64/1f642.ff04ba351bdb.png
f0999847e06b80a6187fb16fdf8d2be9d4092cad  /home/zulip/prod-static/generated/emoji/images-google-64/1f642.png
```

(e3c7b559db71b96adeee6fe61f710a18665d9df9 is the correct/new image, and was generated today, but nothing overwrote the old image file).

There's probably a broader static asset pipeline issue with image files.  I'll investigate.",timabbott,b'area: emoji bug priority: blocker',2018-07-24T16:12:20Z,2018-10-12T23:39:58Z
10034,help: Improve anchor link handling.,"1. Fix a bug with scrolling to anchor links (we were using the wrong container to calculate scrolling offset).
2. Add support for highlighting main articles in the sidebar when navigating to anchor links.

Fixes #10022.",synicalsyntax,b'area: documentation (user) bug size: S',2018-07-24T00:26:52Z,2018-07-24T16:11:21Z
10029,stream settings: Fix a few bugs in weekly traffic calculation. ,,rishig,b'area: stream settings bug size: S',2018-07-23T23:00:34Z,2018-07-24T00:56:54Z
10022,Fix buggy handling of clicking anchor links in /help/ docs,"From #9948:

> This looks good, but there's a bug I found that we should fix on top of this. The reproducer is a bit subtle:

* First, load in a new tab http://127.0.0.1:9991/help/format-your-message-using-markdown#stream-links (this detail is important!)
* Next, click on the anchor icon next to the ""Lists"" heading (or any other heading, really)
* You get up scrolled to the top of the page, rather than to that heading.

I think it's probably the same thing I noticed on the original Simplebar PR, I just now found a reproducer.

",timabbott,b'area: documentation (user) bug',2018-07-23T17:14:19Z,2018-07-24T06:19:31Z
10010,subs: Scroll selected stream row into view on reload/settings modification.,"[![Image from Gyazo](https://i.gyazo.com/6f7224fad22c26e0f53e5c568250b101.gif)](https://gyazo.com/6f7224fad22c26e0f53e5c568250b101)

This PR has a series of commits to fix #9982 with extensive CSS/JS refactoring.

1. Previously, there was a bunch of complex JS attempting to smoothly keep the currently active stream row visible in the subscriptions modal (such as in the case of automatic keyboard arrow navigation). By switching to use the `scroll_util.scroll_element_into_container` method, we can eliminate that. 
2. The CSS overlays in the app (informational, settings, drafts, subscriptions, invites, etc.) all used differing styling. This commit attempts to normalize it a bit by using the same DOM structure and responsive width.
3. Overlay size changes cause considerable issues for subscription modal
stream row scrolling calculations because all stream rows are half
of their supposed height when the scrolling calculation method is
initialized.
4. The `scroll_util.scroll_element_into_container` method failed to account for padding in the stream rows, leading to miscalculated scrolling. Using `innerHeight` instead of `height` solved the issue.",synicalsyntax,b'area: stream settings bug has conflicts size: XL',2018-07-22T04:10:38Z,2019-01-17T18:48:09Z
10007,Tracking for last unread message,"When user comes to chat he sees old messages. There is no such behaviour if user manually marks all messages as read. 

So it seems like a problem with tracking.",FoggyFinder,b'area: message view bug question',2018-07-21T20:06:35Z,2020-02-19T21:55:48Z
10002,Incorrect calculation of average message for week,"It seems like statistic is incorrect. It was a seven day since channel was created although.

![Sample](https://i.imgur.com/ptrztST.png)

Perhaps, earlier there was a label ""New"" or something.",FoggyFinder,b'area: stream settings bug',2018-07-20T19:19:51Z,2018-07-24T00:39:35Z
9998,subs: Fix regression in Filter streams input focus during modal opening.,"This behavior was originally implemented in commit 6993f89, but due to not
specifying a toggle option, the Subscribed/All streams switcher tab was
focused after the input was focused, leading to the input's loss of focus.

Fixes #9981.",synicalsyntax,b'area: stream settings bug size: XS',2018-07-20T18:11:28Z,2018-07-22T21:54:51Z
9989,lightbox: Make `v` close the lightbox during Pan & Zoom.,"When Pan & Zoom (canvas) is enabled in lightbox, the `v` hotkey does not work due to `LightboxCanvas` overriding the `keydown` event. This PR adds `v` as an option in the listener.

Fixes #9777.",marco,b'area: message view bug size: XS',2018-07-19T22:41:40Z,2018-07-23T17:37:45Z
9981,Set default focus to `Filter Streams` when stream setting opens via the gear button in the left sidebar.,"When stream settings is opened via the gear icon in the left sidebar, set the default focus of to `Filter Streams` box at the top of the stream settings( Place the cursor there ).",amanagr,b'area: stream settings bug good first issue help wanted',2018-07-19T12:29:17Z,2018-07-22T14:20:46Z
9980,message edit: Add support for markdown in message edit UI.,"Fixes #9917

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

![rtl](https://user-images.githubusercontent.com/25907420/42927382-fa7af082-8b51-11e8-9fe8-065a7b21bd95.gif)
",YJDave,b'area: compose area: message-editing bug priority: high size: L',2018-07-19T07:20:06Z,2018-07-23T17:43:54Z
9946,Installer failures on Debian 9 stretch,"Hi everybody,

with the current master (f75c0e2) the installer fails a couple of times on **Debian 9 stretch**.

**Missing /etc/lsb-release file**

You need to use the command ""lsb_release"" for that. With the information of ""lsb_release -a"" i created such a file (as in Ubuntu) and the installer ran through smoothly.

```bash
+ /tmp/tmp.LKTxt3LV1j/zulip-master/scripts/lib/create-production-venv /tmp/tmp.LKTxt3LV1j/zulip-master
Traceback (most recent call last):
  File ""/tmp/tmp.LKTxt3LV1j/zulip-master/scripts/lib/create-production-venv"", line 12, in <module>
    from scripts.lib.setup_venv import setup_virtualenv, VENV_DEPENDENCIES
  File ""/tmp/tmp.LKTxt3LV1j/zulip-master/scripts/lib/setup_venv.py"", line 40, in <module>
    codename = parse_lsb_release()[""DISTRIB_CODENAME""]
  File ""/tmp/tmp.LKTxt3LV1j/zulip-master/scripts/lib/zulip_tools.py"", line 310, in parse_lsb_release
    with open('/etc/lsb-release', 'r') as fp:
FileNotFoundError: [Errno 2] No such file or directory: '/etc/lsb-release'

Zulip installation failed!
```

**Missing openssl/ssl.h**

```bash
...
    In file included from src/docstrings.c:4:0:
    src/pycurl.h:164:28: fatal error: openssl/ssl.h: No such file or directory
     #   include <openssl/ssl.h>
                                ^
    compilation terminated.
    error: command 'x86_64-linux-gnu-gcc' failed with exit status 1
...
subprocess.CalledProcessError: Command '['pip', 'install', '--no-deps', '--requirement', '/tmp/tmp.LKTxt3LV1j/zulip-master/requirements/thumbor.txt']' returned non-zero exit status 1
```
Fixed by installing ""libssl-dev""

**Nginx-full not installable**

```bash
Notice: /Stage[main]/Zulip::Base/File[/usr/lib/nagios/plugins/zulip_base/check_debian_packages]/ensure: defined content as '{md5}b5eac9a9df7c09d9cfd73249b0447dae'
Error: Execution of '/usr/bin/apt-get -q -y -o DPkg::Options::=--force-confold install nginx-full' returned 100: Reading package lists...
Building dependency tree...
Reading state information...
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 nginx-full : Depends: libssl1.0.0 (>= 1.0.2~beta3) but it is not installable
E: Unable to correct problems, you have held broken packages.
Error: /Stage[main]/Zulip::Nginx/Package[nginx-full]/ensure: change from purged to present failed: Execution of '/usr/bin/apt-get -q -y -o DPkg::Options::=--force-confold install nginx-full' returned 100: Reading package lists...
Building dependency tree...
Reading state information...
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 nginx-full : Depends: libssl1.0.0 (>= 1.0.2~beta3) but it is not installable
E: Unable to correct problems, you have held broken packages.
```

libssl1.0.2 (1.0.2l-2+deb9u3) is already installed, but the package nginx-full still wants libssl1.0.0 (>= 1.0.2~beta3).
Due to limited time, i didn't resolve this yet - this is for now in this issue and i will update it as soon as i get back to it :)

Thanks alot!",pflueg,b'area: production installer bug question',2018-07-13T10:08:10Z,2018-08-14T18:48:39Z
9944,stats: Fix incorrect data-user attribute on Everyone button.,"For some reason, it was defined as ""realm"" instead of ""everyone"",
resulting in undefined value JS errors when draw_plot() was called.

Fixes #9937.
",synicalsyntax,b'area: analytics bug size: S',2018-07-12T22:18:57Z,2018-07-13T04:58:00Z
9940,GitHub login does not work on Edge,"On Edge, I go to https://python.zulipchat.com/ and get redirected to /login. I then click ""Log in with GitHub"" which bounces through the authorization process but then does not recognized that I'm logged in and sends me back to the login page.

I know it's communicating with GitHub properly, because when I change my Zulip email address to the one I want notifications sent to (via another browser), I get an ""account not found"" page when I try to log in through Edge. After many attempts, Zulip was also flagged as suspicious by GitHub and I was redirected through their authorization page again. Still, no luck getting past the login page.",zooba,b'area: authentication bug',2018-07-12T15:37:21Z,2018-08-08T22:01:29Z
9937,"/stats: can't undo ""Me"" in recipient type section","Steps to reproduce:

* Open https://chat.zulip.org/stats.
* In the ""Messages sent by recipient type"" area (top right), click ""Me"". Pie chart updates to show only my messages as expected.
* Now, in the same area, click ""Everyone"". Pie chart does not go back to showing all users' messages.",rwbarton,b'area: analytics bug',2018-07-12T14:40:39Z,2018-07-13T04:54:15Z
9920, auth: Fix bug with subdomains and social auth causing logouts.,"Basically we add 'www' as a subdomain and start to effectively use
it for the purpose of setting session cookies in case of social
oauth so that it won't interfare with other sessions the people
might have in other subdomains on a zulip server.

Fixes: #9847.

Explanation of why this fixes this issue has been provided by Tim in this message: https://chat.zulip.org/#narrow/stream/57-core-team/subject/important.20bugs/near/608109",adnrs96,b'area: authentication bug priority: high size: M',2018-07-10T06:11:57Z,2018-07-10T11:20:18Z
9917,Add RTL support to the message-edit UI,"This is a probably quick follow-up to #9889, our new RTL support feature (thanks @Shayan-To!).

I think what we actually want to do is refactor `compose.handle_keydown` (which @YJDave has done the most work on it) to support taking an opts object that contains the few details that differ between message-edit and compose (e.g. the name of the textarea object) and register that same key handler function for both.

(Basically, all the other features of the compose keydown handler, like ctrl+B, should also be supported in the message-edit UI).",timabbott,b'area: compose area: message-editing bug priority: high',2018-07-10T05:24:18Z,2018-07-23T17:44:30Z
9909,invitations: Send 'invites_changed' event for invitations events.,"**[DON'T MERGE]** 
This is currently simply rebased #7780.
So what it is doing currently:
* Sending an event when a user is invited or his invite is revoked.
* Simply repeats the whole process of setting up the invite page on those events.

@timabbott what are the problems associated with this approach.

* The bug/improvements I can point currently is it doesn't send an event when a user accepts the invitation.
* Both commits needs to be squashed.
* And obviously below change doesn't work as I've removed the `delete` API recently so before adding it I want to make sure if we want to go with this approach or we have changed the plan to do this in some other way?

```diff
+    var invites_list = list_render.get(""admin_invites_list"");
+
+    if (invites_list) {
+        list_render.delete(""admin_invites_list"");
+    }
```",shubhamdhama,b'area: invitations bug size: L',2018-07-07T17:04:23Z,2018-07-13T12:30:27Z
9883,bugdown: Realm filters do not match patterns with leading non-whitespace characters,"### Background

My company is using Zulip for project management (sales/devs communication etc.)

Since we often have conversations like ""What is the current status of `#5000`?"" or
""I attached the file to the ticket `#123`"", we have set up a custom filter to autolink
the pattern `#<number>`.

![2018-07-04-140225_537x117_scrot](https://user-images.githubusercontent.com/8974561/42258998-70a35ef8-7f99-11e8-8286-3a3feca080a7.png)

### Problem

Autolinking does not work if (non-white) characters are prepended to the pattern
(e.g. 'abc#4000').

This behaviour feels very clumsy for us, particularly because we normally communicate
in a language (Japanese) where words are generally not separated by spaces.

For an example, we often say something like:

> ""チケットは`#4000`です"" (trans: ""The ticket is `#4000`"")

... and Zulip fails to notice the pattern in the sentence.

### Desired Behaviour

Realm filters should work for patterns with leading characters.",fujimotos,b'area: markdown area: settings (admin/org)',2018-07-04T06:01:50Z,2019-01-28T22:49:42Z
9871,left sidebar: Re-narrow after initial streams list rebuild after reload.,"[![https://gyazo.com/23e85037b880f37a39a5c6e07a065bf7](https://i.gyazo.com/23e85037b880f37a39a5c6e07a065bf7.gif)](https://gyazo.com/23e85037b880f37a39a5c6e07a065bf7)

We use `handle_narrow_activated` instead of `update_sidebar_for_narrow` because the latter doesn't call `scroll_stream_into_view`, resulting in wrong scroll position of the left sidebar after the streams list get rebuilt after reload. `handle_narrow_activated` also calls `update_sidebar_for_narrow`, so there should be no issues in switching to this function.

Fixes #9043.",synicalsyntax,b'area: left-sidebar bug priority: high size: M',2018-07-03T01:47:27Z,2018-07-23T19:46:13Z
9862,bugdown: Improve exception handler for BugdownRenderingException.,"This is a WIP because before proceeding I want to know which I should prefer: `logger.exception` or `logger.error`, I have used the `logger.exception` because with this we can get the type of exception in handler code, but I suspect this approach because in the codebase we have mostly used `error` one, so is my doubt is there any concern related to using of `logger.exception`.",shubhamdhama,b'size: M',2018-07-02T09:37:29Z,2018-07-26T16:28:40Z
9851,Emoji reaction pane stuck on,"One of our users keeps getting their emoji reaction pane stuck on. 

No extensions or add ons.

Chromium Version 61.0.3163.79 (Official Build) Built from source for Red Hat Enterprise Linux Server release 6.9 (Santiago) (64-bit)

Zulip server is 1.8.1-rc1

![image](https://user-images.githubusercontent.com/32879218/42105054-db5b4022-7b83-11e8-9313-1bc295d2111f.png)

",swallitsch,b'area: emoji bug',2018-06-29T17:05:07Z,2019-07-23T14:21:11Z
9847,Auto logout from zulipchat servers on Github login,"To reproduce:
* Open a zulipchat server and login (by any method).
* Open another zulipchat server in a new tab. 
* Login into the second zulipchat server using github auth.
* the first zulipchat in the first tab will be logged out.

It doesn't matter if the two accounts are related or not i.e. they can have different emails related to them.
In case multiple zulipchat servers are logged in in multiple tabs, all are logged out when a new one is logged in with Github.
Doesn't affect when logged in with normal email or Google auth.",abhigyank,b'area: authentication bug priority: high',2018-06-28T15:01:34Z,2018-07-10T11:23:07Z
9846,Internal server error after login,"One of our users is experiencing the 500 after successful login. We are running 1.8.1
The traceback in the log is:

```
  File ""/home/zulip/deployments/2018-05-14-13-18-53/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2018-05-14-13-18-53/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2018-05-14-13-18-53/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/views/home.py"", line 83, in home
    return home_real(request)
  File ""./zerver/decorator.py"", line 370, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 415, in _wrapped_view_func
    return rate_limit()(view_func)(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 747, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/views/home.py"", line 124, in home_real
    narrow=narrow)
  File ""./zerver/lib/events.py"", line 650, in do_events_register
    maybe_catch_up_soft_deactivated_user(user_profile)
  File ""./zerver/lib/soft_deactivation.py"", line 191, in maybe_catch_up_soft_deactivated_user
    add_missing_messages(user_profile)
  File ""./zerver/lib/soft_deactivation.py"", line 121, in add_missing_messages
    if (stream_subscription_logs[-1].event_type == 'subscription_deactivated' and
IndexError: list index out of range
```",mvrhov,b'area: export/import area: production bug priority: high',2018-06-28T06:59:10Z,2019-01-10T01:38:45Z
9843,settings: Fix focusing of `your-account` prior complete loading.,"Fixes: #9686.
![fixed](https://user-images.githubusercontent.com/22238472/41976878-b49a1664-7a3b-11e8-9284-cbbb9ca72be9.gif)
",shubhamdhama,b'area: settings UI bug size: XS',2018-06-27T13:26:00Z,2018-06-27T15:21:04Z
9840,Not work email gateway with stream with cyrillic characters in name,"If name stream for example ""Тестовый стрим"", then email gateway have kind ```user_name+Тестовый%0032стрим+id_id_id_id_id_id_id_id_id@example.com```.

When send email to this address Zulipchat throw error and send message with error to admin email (attach screenshot with example).

![screenshot1](https://user-images.githubusercontent.com/6002083/41962634-3425362c-79fe-11e8-8d14-9f4f97623143.PNG)
",mynoheart,b'area: notifications (other) bug priority: high',2018-06-27T08:36:33Z,2019-07-23T14:21:10Z
9834,email notification of mentions leaks private stream's prior messages to new member,"**Observed behavior:**
1. I was added to a private stream.
2. The person who had added me sent a message to that stream, mentioning my user account with @.
3. As expected, I could not see any prior messages in that stream; the first one was that welcome message.
4. I received an email to let me know I had been mentioned on Zulip.
As is typical with ""mention"" notifications, the email included about 5 previous messages in addition to the one where I had been mentioned.

**Zulip version at the time:** 1.8.1

**Concern:**
I don't think people are relying very heavily on the assumption that message history is invisible to new members of locked streams, but this behavior could surprise people who have that assumption.

**Suggested behavior:**
Perhaps have a stream setting that defaults to not providing message context for mentions on private streams.
Another option is to apply whatever filtering is being used to prevent users from seeing private stream messages prior to when that user was a stream member to filtering the message context in ""mention"" notification emails.
",inquiryqueue,b'area: notifications (messages) bug priority: high',2018-06-26T15:46:30Z,2018-07-28T22:19:30Z
9832,"widgets: Fix empty message_content of ""All messages"" widgets.","Well, there were different cases of the empty content of widgets.
Like, when we first load the page with the home screen (""All messages""),
the widgets appear and they still appear even when narrowed to
stream/topic, but things went wrong when again narrowed to
""All messages"".
Another case was when a new widget is created in narrowed stream/topic
but this doesn't appear in ""All messages"".

But amusingly the fix was this simple, that jQuery isn't doing smart
things when a jQuery object is passed to `.html()` which wasn't
expected at all, so we have to pass the HTML string of `widget_elem`
to `content_holder`.

Fixes: #9827.
![peek 2018-06-26 13-27](https://user-images.githubusercontent.com/22238472/41897337-a9e9a9fc-7944-11e8-90e0-11e91049f7c5.gif)",shubhamdhama,b'bug size: L',2018-06-26T07:58:00Z,2018-06-28T18:04:53Z
9827,widgets: Poll widget disappears on narrow to 'All messages'.,"Steps to recreate:
1. Start the poll widget in a stream.
2. Narrow down to `All messages`. The poll widget disappears here. If it doesn't, narrow to the stream and then back to `All messages`.
3. Stay in `All messages`. Refresh your browser. The poll reappears.


![ezgif com-video-to-gif 1](https://user-images.githubusercontent.com/25330892/41866969-58108eb8-78cf-11e8-9f61-d08e3bb1343d.gif)

@zulipbot label ""bug""


",rheaparekh,b'bug',2018-06-25T18:02:37Z,2018-06-28T18:07:39Z
9814,outgoing webhooks: Warn user that PMs are not supported in Slack-format webhook.,"Private messages are not supported in Slack-format webhook. Instead of raising a `NotImplementedError`, we warn the user that PM service is not supported by sending a message to the user.
Added tests for the same.

Fixes #9239

Screenshot:
![screen shot 2018-06-24 at 12 27 58 pm](https://user-images.githubusercontent.com/25330892/41816711-8ae8181e-77a9-11e8-921e-de33ef8938d9.png)
",rheaparekh,b'area: bots bug priority: high size: M',2018-06-24T06:54:43Z,2018-08-13T00:18:54Z
9807,settings UI: Expand bot card width in narrow windows.,"Screen width 800px and above:
![screenshot at jun 22 11-49-43](https://user-images.githubusercontent.com/15116870/41794052-f8cd655c-7612-11e8-988a-1b0345ff2807.png)

Screen width between 800px and 700px:
![screenshot at jun 22 11-49-59](https://user-images.githubusercontent.com/15116870/41794053-f9018e04-7612-11e8-832f-9a8a175d5bed.png)

Screen width between 700px and 500px:

![screenshot at jun 22 11-46-37](https://user-images.githubusercontent.com/15116870/41794049-f880a47e-7612-11e8-934f-40406e802fd5.png)

Screen width 500px and under:

![screenshot at jun 22 11-46-50](https://user-images.githubusercontent.com/15116870/41794051-f8a710a0-7612-11e8-909c-bad17741af04.png)

Fixes #9513

Note to reviewers: Issue #9780 still persists, so it's best to rebase the testing branch to a commit before the settings refactoring such as 541ccfeb7f to review the changes.",synicalsyntax,b'area: bots area: settings (user) bug size: S',2018-06-22T18:58:15Z,2018-07-06T16:38:49Z
9803,Clicking keyboard shortcuts icon on bottom right closes compose box.,From https://chat.zulip.org/#narrow/stream/6-frontend/topic/keyboard.20shortcut.20kills.20msg,shubham-padia,b'area: compose bug',2018-06-22T17:16:55Z,2018-08-10T00:54:24Z
9801,[Django] sateam: maximum recursion depth exceeded while getting the str of an object,"Hi,

I'm getting this in my installation:

```
Logger root, from module zerver.worker.queue_processors line 149:
Error generated by Anonymous user (not logged in) on sateam deployment

Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zerver/worker/queue_processors.py"", line 132, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zerver/worker/queue_processors.py"", line 442, in consume
    url_preview.get_link_embed_data(url)
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zerver/lib/cache.py"", line 169, in func_with_caching
    cache_set(key, val, cache_name=cache_name, timeout=timeout)
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zerver/lib/cache.py"", line 180, in cache_set
    cache_backend.set(KEY_PREFIX + key, (val,), timeout=timeout)
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zulip-py3-venv/lib/python3.5/site-packages/django/core/cache/backends/db.py"", line 87, in set
    self._base_set('set', key, value, timeout)
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zulip-py3-venv/lib/python3.5/site-packages/django/core/cache/backends/db.py"", line 114, in _base_set
    pickled = pickle.dumps(value, pickle.HIGHEST_PROTOCOL)
  File ""/home/zulip/deployments/2018-05-30-12-26-10/zulip-py3-venv/lib/python3.5/site-packages/bs4/element.py"", line 726, in __getnewargs__
    return (str(self),)
RecursionError: maximum recursion depth exceeded while getting the str of an object


Deployed code:
- ZULIP_VERSION: 1.8.1
- version: 1.8.1
```

thanks for any pointers.",ghost,b'area: markdown area: production bug',2018-06-22T11:08:11Z,2020-04-26T12:55:42Z
9799,right sidebar: Expand sidebar block width for greater click area.,Fixes #9797,synicalsyntax,b'area: right-sidebar bug size: S',2018-06-21T21:03:54Z,2018-06-23T19:47:24Z
9797,right sidebar: Clicking to right of name doesn't register as click.,"If you hover over a name in the right sidebar, you get a grey bar. Clicking anywhere in that grey bar should register as a click, similar to how we do it for stream names in the left sidebar.",rishig,b'area: right-sidebar bug help wanted',2018-06-21T19:15:47Z,2018-06-22T12:57:02Z
9780,settings: setting items are broken in the smaller window.,"I can't open the setting items in the smaller window. This works as expected on other Zulip servers.
 

![](https://chat.zulip.org/user_uploads/2/b1/iCkTmgQEg_4Cv-AbPkN7qsuQ/Screen-Recording-2018-06-19-at-09.10-PM.gif)

",akashnimare,b'area: settings UI bug',2018-06-20T13:44:33Z,2018-06-27T15:51:52Z
9777,lightbox: v doesn't close lightbox when pan and zoom is toggled.,"To repro:
* v to open lightbox
* click ""Enable pan and zoom""
* click ""Disable pan and zoom""
* press v.

The second v should close the lightbox, but it doesn't.",rishig,b'area: message view bug help wanted',2018-06-19T22:22:49Z,2018-07-23T17:41:37Z
9768,help: Fix broken anchor link scrolling in documentation pages.,"Whenever a link is clicked, the page link changes, and the content
of the `.markdown .content` node updates, preventing the old
listener to catch any future anchor link clicks. 

We attach the listener to the document instead and only activate
it when the target element is a proper anchor link heading.

Fixes #9767.

(Second commit just prevents anchor link text from being selected on double click, commit can be dropped if behavior is desired)",synicalsyntax,b'area: documentation (user) bug priority: high size: S',2018-06-18T18:53:41Z,2018-06-19T21:20:09Z
9767,help: Clicking on headings in markdown is broken,"If you click on a heading, the page doesn't scroll to the heading. This only works on the first click, later on, the click event is ignored. 

![screen recording 2018-06-18 at 08 37 pm](https://user-images.githubusercontent.com/2263909/41544908-89900d44-7337-11e8-8782-ecc4e6a83281.gif)
",akashnimare,b'area: documentation (user) bug priority: high',2018-06-18T15:08:53Z,2018-06-19T21:19:25Z
9763,Fix a bug in emoticon translation where newlines prevent translation.,"Currently, there is a bug in emoticon translation where a newline before an emoticon prevents it from being translated. This only occurs server-side, as the message initially is translated correctly in the local echo, but then becomes incorrect after receiving the render from the server.

For instance,

 > :) test :) test

is translated into

 > 😃 test 😃 test

but

 > :) test
 > :) test

is incorrectly translated into

 > 😃 test 
 > :) test

due to the newline.

See [discussion](https://chat.zulip.org/#narrow/stream/9-issues/subject/display-setting.3A.20Translate.20emoticons/near/599540).
",marco,b'area: emoji bug',2018-06-18T02:05:21Z,2018-06-20T15:09:19Z
9740,integrations: Hide page content until all data has loaded.,"Set the initial visibility of the page content to hidden via
the stylesheet, and allow any data fetching and rendering to
complete before making content visible.

Adjust the conditional logic within `render` to first check for
the case in which a user goes to a doc link, the case in which
we asynchronously fetch data prior making content visible.

Fixes #9577.",jackrzhang,b'area: integrations bug size: M',2018-06-12T23:09:55Z,2018-06-17T07:54:38Z
9734,popovers: Enable keyboard navigation on user profile menu.,"Fixes #9318.

![peek 2018-06-12 16-09](https://user-images.githubusercontent.com/13910561/41285840-22c6cb24-6e5b-11e8-82a4-908d4cc546d0.gif)

From the original issue:
> poke around other menus while you're at it to see if similar bugs exist

Keyboard navigation worked in the other menus which were being open by keyboard.
```
g | Toggle the gear menu
i | Open message menu
: | Open reactions menu
? | Show keyboard shortcuts
```
",shubham-padia,b'area: keyboard UI bug size: XL',2018-06-12T10:44:24Z,2018-06-13T09:57:27Z
9730,features: Standardize width of feature blocks with pseudoelements.,"Current status:
![screenshot at jun 11 10-10-14](https://user-images.githubusercontent.com/15116870/41246368-b7a07a1c-6d5f-11e8-9afb-8e775cb3d2ce.png)
![screenshot at jun 11 10-10-24](https://user-images.githubusercontent.com/15116870/41246369-b7d3d844-6d5f-11e8-9494-cf12a49ed466.png)
![screenshot at jun 11 10-10-32](https://user-images.githubusercontent.com/15116870/41246370-b7fd0b60-6d5f-11e8-921e-50c65d3bb2b5.png)

Like the blocks in the previous Apps/API/Integrations section, we add 2 pseudoelements to standardize the width of feature blocks so that the last block shares the same width as all previous blocks.

Note: It's possible to fix this without pseudoelements by setting media selector breakpoints that control the default width of elements according to screen size. But since this hack was already previously used above, I wasn't sure if this was supposed to be the advised way to fix it.

Fixes #9195.
",synicalsyntax,b'area: portico bug size: XS',2018-06-11T17:10:04Z,2018-06-13T19:00:24Z
9726,custom fields: Fix exception in rendering custom profile field template.,"Function `settings_account.add_custom_profile_fields_to_settings` called
twice, which results in two templates objects. Function also doesn't
include check whether settings overlay is open or not, which throws
""undefined"" error.

Fixes #9668

",YJDave,b'area: settings UI bug priority: high size: S',2018-06-10T05:41:04Z,2018-06-11T03:56:40Z
9721,"search: Fix ""Enter to search"" while using an input method.","(This is one of the nastiest bugs I've faced(maybe because I've to read complete searching mechanism code which I think is the thing I can keep with me :) and come up with this hack-y solution, not sure whether this is the best solution possible but I tried to explain it as much as possible) 
NOTE:   To test this locally I've used Google Chrome input tool.
        This change will not affect users who don't use input tools.

Here is the algorithm used to deal with this case and other important
points:

* Here I've used `compositionend` event which is triggered
as soon as an input tool completes a word or user press ""enter""
to get the suggested text. (There was a situation where it is
triggered even when input tool wasn't closed, that is when we
press space, but it also triggers another `compositionstart`
event simultaneously so our logic can't be affected by this.)

* We are using a variable `is_using_input_method` which sets to
`true` when `compositionend` event is triggered.

* Basically our searching is initiated by `keyup` event which
is triggered by the same keypress which triggers `compositionend`
event to get the text, so our main goal is to suppress the searching
triggered by this key pressing.

* Observation shows that `compositionend` is triggered before the
`keyup` and calling of callback `narrow_or_search_for_term`
used by typeahead.
    i.e. chronological order of triggering of this event is
`compositionend` > calling of `narrow_or_search_for_term` > `keyup`.

* So the main logic is to set `is_using_input_method` to `false`
by default and if used the input tool then when we press enter
to get the suggested text we set it to `true` which indicate
further events triggered after it to skip the searching and
finally, in `keyup` we set it to default `false` so when pressed
enter again we have it set to false and we have a successful
search.

Fixes: #9396.
",shubhamdhama,b'area: i18n area: keyboard UI bug priority: high size: S',2018-06-09T09:52:54Z,2018-06-20T20:33:38Z
9712,message edit: Fix edit author text overflow on images.,"Fixes #9175.


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

Before:
![](https://user-images.githubusercontent.com/18511177/39080403-21a24932-454b-11e8-9652-5808d2ed65ec.png)

After:

![a](https://user-images.githubusercontent.com/15116870/41130761-ff4a0478-6a6c-11e8-9c9e-d4cd7cfdf52f.png)
",synicalsyntax,b'area: message-editing bug size: M',2018-06-07T23:08:47Z,2018-06-11T16:31:25Z
9706,profile: Fix glitch when exiting custom profile display UI.,"Fixes: #9702.
GIF:
![peek 2018-06-07 14-07](https://user-images.githubusercontent.com/22238472/41088102-3c4e8814-6a5c-11e8-9c02-de11d867280f.gif)
",shubhamdhama,b'area: settings (user) bug priority: high size: XS',2018-06-07T08:38:49Z,2018-06-07T16:06:11Z
9702,Glitch when exiting custom profile display UI,"If you click on Iago's avatar image in the message feed, and click ""User profile"", you get all the custom profile field data.  If you then click outside the profile, it hides, but with a weird glitch where part of the modal briefly appears at the top of the screen.

@shubhamdhama this seems like something you'd be good at debugging.",timabbott,b'area: settings (user) bug priority: high',2018-06-06T22:08:00Z,2018-06-07T16:07:51Z
9699,message view: Add loading indicator to bankruptcy modal.,"Fixes: #9629

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

**GIF:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![ezgif-2-263c127b2d](https://user-images.githubusercontent.com/21174572/41063738-1e213bf8-69f7-11e8-94b4-579ee9774180.gif)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Anupam-dagar,b'area: message view bug priority: high size: XS',2018-06-06T20:35:27Z,2018-06-06T22:05:10Z
9693,attachment: Fix handling of stream history.,"Completes #9685.

Today I found this thing :smile: 
<details><summary><code>git diff</code></summary><p>

```

diff --git a/zerver/models.py b/zerver/models.py
index 418a776..49f45f5 100644
--- a/zerver/models.py
+++ b/zerver/models.py
@@ -1491,8 +1491,7 @@ def validate_attachment_request(user_profile: UserProfile, path_id: str) -> Opti
         user_profile=user_profile,
         active=True,
         recipient__type=Recipient.STREAM,
-        recipient__in=[m.recipient_id for m in messages]).values_list(""recipient_type_id"", flat=True)
-
+        recipient__in=[m.recipient_id for m in messages]).values_list(""recipient__type_id"", flat=True)
     if len(relevant_stream_ids) == 0:
         return False
 
diff --git a/zerver/tests/test_upload.py b/zerver/tests/test_upload.py
index 9324fc5..3c99857 100644
--- a/zerver/tests/test_upload.py
+++ b/zerver/tests/test_upload.py
@@ -16,6 +16,7 @@ from zerver.lib.test_helpers import (
     get_test_image_file,
     POSTRequestMock,
     use_s3_backend,
+    queries_captured,
 )
 from zerver.lib.test_runner import slow
 from zerver.lib.upload import sanitize_name, S3UploadBackend, \
@@ -27,7 +28,8 @@ from zerver.lib.upload import sanitize_name, S3UploadBackend, \
 import zerver.lib.upload
 from zerver.models import Attachment, get_user, \
     get_old_unclaimed_attachments, Message, UserProfile, Stream, Realm, \
-    RealmDomain, RealmEmoji, get_realm, get_system_bot
+    RealmDomain, RealmEmoji, get_realm, get_system_bot, \
+    validate_attachment_request
 from zerver.lib.actions import (
     do_delete_old_unclaimed_attachments,
     internal_send_private_message,
@@ -205,12 +207,6 @@ class FileUploadTest(UploadSerializeMixin, ZulipTestCase):
         result = self.client_post(""/json/user_uploads"")
         self.assert_json_error(result, ""You must specify a file to upload"")
 
-    def test_download_non_existent_file(self) -> None:
-        self.login(self.example_email(""hamlet""))
-        response = self.client_get('/user_uploads/unk/nonexistent_file')
-        self.assertEqual(response.status_code, 404)
-        self.assertIn('File not found', str(response.content))
-
     # This test will go through the code path for uploading files onto LOCAL storage
     # when zulip is in DEVELOPMENT mode.
     def test_file_upload_authed(self) -> None:
@@ -527,27 +523,84 @@ class FileUploadTest(UploadSerializeMixin, ZulipTestCase):
         self.assert_in_response(""You are not authorized to view this file."", response)
 
     def test_file_download_authorization_invite_only(self) -> None:
-        subscribed_users = [self.example_email(""hamlet""), self.example_email(""iago"")]
+        user = self.example_user(""hamlet"")
+        subscribed_users = [user.email, self.example_email(""iago"")]
         unsubscribed_users = [self.example_email(""othello""), self.example_email(""prospero"")]
-        realm = get_realm(""zulip"")
+        stream_name = ""test-subscribe""
+        self.make_stream(stream_name, realm=user.realm, invite_only=True, history_public_to_subscribers=False)
+
         for email in subscribed_users:
-            self.subscribe(get_user(email, realm), ""test-subscribe"")
+            self.subscribe(get_user(email, user.realm), stream_name)
 
-        # Make the stream private
-        stream = Stream.objects.get(name='test-subscribe')
-        stream.invite_only = True
-        stream.save()
+        self.login(user.email)
+        fp = StringIO(""zulip!"")
+        fp.name = ""zulip.txt""
+        result = self.client_post(""/json/user_uploads"", {'file': fp})
+        uri = result.json()['uri']
+        fp_path_id = re.sub('/user_uploads/', '', uri)
+        body = ""First message ...[zulip.txt](http://localhost:9991/user_uploads/"" + fp_path_id + "")""
+        self.send_stream_message(user.email, stream_name, body, ""test"")
+        self.logout()
 
-        self.login(self.example_email(""hamlet""))
+        # Owner user should be able to view file
+        with queries_captured() as queries:
+            self.login(user.email)
+            response = self.client_get(uri)
+            self.assertEqual(response.status_code, 200)
+            data = b"""".join(response.streaming_content)
+            self.assertEqual(b""zulip!"", data)
+            self.logout()
+        self.assertEqual(len(queries), 20)
+
+        # Subscribed user who recieved the message should be able to view file
+        with queries_captured() as queries:
+            self.login(subscribed_users[1])
+            response = self.client_get(uri)
+            self.assertEqual(response.status_code, 200)
+            data = b"""".join(response.streaming_content)
+            self.assertEqual(b""zulip!"", data)
+            self.logout()
+        self.assertEqual(len(queries), 21)
+
+        def assert_cannot_access_file(user_email: str) -> None:
+            self.login(user_email)
+            response = self.client_get(uri)
+            self.assertEqual(response.status_code, 403)
+            self.assert_in_response(""You are not authorized to view this file."", response)
+            self.logout()
+
+        late_subscribed_user = self.example_user(""aaron"")
+        self.subscribe(late_subscribed_user, stream_name)
+        assert_cannot_access_file(late_subscribed_user.email)
+
+        # Unsubscribed user should not be able to view file
+        for user in unsubscribed_users:
+            assert_cannot_access_file(user)
+
+    def test_file_download_authorization_invite_only_with_shared_history(self) -> None:
+        user = self.example_user(""hamlet"")
+        subscribed_users = [user.email, self.example_email(""iago"")]
+        unsubscribed_users = [self.example_email(""othello""), self.example_email(""prospero"")]
+        stream_name = ""test-subscribe""
+        self.make_stream(stream_name, realm=user.realm, invite_only=True, history_public_to_subscribers=True)
+
+        for email in subscribed_users:
+            self.subscribe(get_user(email, user.realm), stream_name)
+
+        self.login(user.email)
         fp = StringIO(""zulip!"")
         fp.name = ""zulip.txt""
         result = self.client_post(""/json/user_uploads"", {'file': fp})
         uri = result.json()['uri']
         fp_path_id = re.sub('/user_uploads/', '', uri)
         body = ""First message ...[zulip.txt](http://localhost:9991/user_uploads/"" + fp_path_id + "")""
-        self.send_stream_message(self.example_email(""hamlet""), ""test-subscribe"", body, ""test"")
+        self.send_stream_message(user.email, stream_name, body, ""test"")
         self.logout()
 
+        late_subscribed_user = self.example_user(""aaron"")
+        self.subscribe(late_subscribed_user, stream_name)
+        subscribed_users.append(late_subscribed_user.email)
+
         # Subscribed user should be able to view file
         for user in subscribed_users:
             self.login(user)
@@ -557,13 +610,56 @@ class FileUploadTest(UploadSerializeMixin, ZulipTestCase):
             self.assertEqual(b""zulip!"", data)
             self.logout()
 
+        def assert_cannot_access_file(user_email: str) -> None:
+            self.login(user_email)
+            response = self.client_get(uri)
+            self.assertEqual(response.status_code, 403)
+            self.assert_in_response(""You are not authorized to view this file."", response)
+            self.logout()
+
         # Unsubscribed user should not be able to view file
         for user in unsubscribed_users:
-            self.login(user)
+            assert_cannot_access_file(user)
+
+    def test_multiple_message_attachment_file_download(self) -> None:
+        user = self.example_user(""hamlet"")
+        stream_name = ""test-subscribe""
+        self.make_stream(stream_name, realm=user.realm, invite_only=True, history_public_to_subscribers=True)
+        self.subscribe(user, stream_name)
+
+        self.login(user.email)
+        fp = StringIO(""zulip!"")
+        fp.name = ""zulip.txt""
+        result = self.client_post(""/json/user_uploads"", {'file': fp})
+        uri = result.json()['uri']
+        fp_path_id = re.sub('/user_uploads/', '', uri)
+        for i in range(20):
+            body = ""First message ...[zulip.txt](http://localhost:9991/user_uploads/"" + fp_path_id + "")""
+            self.send_stream_message(self.example_email(""hamlet""), stream_name, body, ""test"")
+        self.logout()
+
+        with queries_captured() as queries:
+            user = self.example_user(""aaron"")
+            self.login(user.email)
             response = self.client_get(uri)
             self.assertEqual(response.status_code, 403)
             self.assert_in_response(""You are not authorized to view this file."", response)
-            self.logout()
+        self.assertEqual(len(queries), 21)
+
+        self.subscribe(user, stream_name)
+
+        with queries_captured() as queries:
+            response = self.client_get(uri)
+            self.assertEqual(response.status_code, 200)
+            data = b"""".join(response.streaming_content)
+            self.assertEqual(b""zulip!"", data)
+        self.assertEqual(len(queries), 9)
+
+        with queries_captured() as queries:
+            self.assertTrue(validate_attachment_request(user, fp_path_id))
+        self.assertEqual(len(queries), 6)
+
+        self.logout()
 
     def test_file_download_authorization_public(self) -> None:
         subscribed_users = [self.example_email(""hamlet""), self.example_email(""iago"")]
```
</p></details>",shubhamdhama,b'area: uploads bug priority: high size: XL',2018-06-06T13:41:56Z,2018-06-06T17:25:09Z
9692,Cannot add emoji reaction using the website version in a Chrome browser on a phone,"Emoji reaction when writing private message is enabled and works.
Emoji reaction on someone's message is enabled, but when it is pressed gui appears for 1 second and disappears.
This issue was redirected from https://github.com/zulip/zulip-mobile",an3l,b'area: emoji area: mobile web bug',2018-06-06T11:31:57Z,2019-03-12T04:51:48Z
9686,"Fix selection of ""Your account"" first on loading ""Notification"" settings page.","GIF explains this glitch better:
![gif](https://user-images.githubusercontent.com/22238472/40999200-ce724716-6927-11e8-85b4-c717b1c2e485.gif)
For more info see the second point of https://github.com/zulip/zulip/pull/9676#issuecomment-394811677 which exists in master as well.
Steps to reproduce:
* Focus notification setting section.
* Reload the page and observe focused section on left panel carefully.
* You will observe at first it's ""Your account"" focused and changed to notification setting after a lag.
",shubhamdhama,b'area: settings UI bug',2018-06-05T19:53:58Z,2018-06-27T15:23:59Z
9685,Attachments: Fix handling of stream history.,"    attachment: Fix handling of stream history.
    
    This fixes two issues:
    
    * Our upcoming guest users feature needs to not give guest users access to public stream
      attachments even if they couldn't access the public stream.
    
    * After a user joins a private stream with our new shared history
      feature, they couldn't see images uploaded before they joined.
    
    We need to test this change for two major things:
    * Those two cases need good unit tests
    * We need to look at how many database queries are used in the various
      cases for that second model.  This function gets called a lot, and
      we want to keep it fast.
    
    Fixes #9372.

@shubhamdhama my hope is you can pick up adding these tests and finishing this.",timabbott,b'area: uploads bug priority: high size: XL',2018-06-05T19:20:36Z,2018-06-06T16:47:34Z
9682,Fix annoying puppet warning on Ubuntu Bionic,"On Ubuntu bionic, `zulip-puppet-apply` always prints this big yellow warning from puppet:
```
Warning: The string '4039600' was automatically coerced to the numerical value 4039600 (file: /home/zulip/deployments/current/puppet/zulip/manifests/memcached.pp, line: 5, column: 22)
```

This is pretty annoying to fix, because if you do the proper `Integer()` cast for Puppet 5 (what we have on Bionic), it's invalid syntax on Puppet 3.4 (for Trusty), and so puppet 3 prints an error (even if you put it inside a conditional for the distro).  It's possible that the right answer is to fix the warning on bionic and just deal with trusty printing that error (assuming Trusty would still run properly), but it'd be great if we can find a better solution.

Because in both cases it's a parser error, this issue does not seem to be responsive to conditionals.",timabbott,b'area: production installer bug',2018-06-05T15:08:47Z,2019-08-09T23:29:50Z
9679,left sidebar: q + enter opens compose box.,"Going to a stream via `q`, then typing a few characters, then `enter` opens the stream with a compose box, and topic prefilled to whatever is under the blue box.

I suspect a preventdefault or stoppropagation or similar is needed on the enter. ",rishig,b'area: left-sidebar bug help wanted',2018-06-05T13:52:11Z,2018-06-09T16:54:39Z
9678,Logfiles timestamp inconsistency,"When restarting the server I see there is a conflict with the timestamps used in the logfiles. Apparently some services use the server timezone and some others the UTC. Is there the possibility to synchronize this in one single timezone?

Below is the an example while restarting the server. The server is UTC+2 (Central European Summer Time) 

> 2018-06-05 12:27:24,017 restart-server: Filling memcached caches
> 2018-06-05 10:27:25.474 INFO [] Successfully populated client cache!  Consumed 1 remote cache queries (0.0 time)
> 2018-06-05 10:27:25.477 INFO [] Successfully populated recipient cache!  Consumed 1 remote cache queries (0.0 time)
> 2018-06-05 10:27:25.478 INFO [] Successfully populated huddle cache!  Consumed 1 remote cache queries (0.0 time)
> 2018-06-05 10:27:25.481 INFO [] Successfully populated session cache!  Consumed 1 remote cache queries (0.0 time)
> 2018-06-05 10:27:25.486 INFO [] Successfully populated stream cache!  Consumed 1 remote cache queries (0.0 time)
> 2018-06-05 10:27:25.508 INFO [] Successfully populated user cache!  Consumed 1 remote cache queries (0.02 time)
> 2018-06-05 12:27:25,842 restart-server: Stopping workers
> zulip-workers:zulip_deliver_enqueued_emails: stopped
> zulip-workers:zulip_deliver_scheduled_messages: stopped
> zulip-workers:zulip_events_slow_queries: stopped
> zulip-workers:zulip_events_outgoing_webhooks: stopped
> zulip-workers:zulip_events_missedmessage_mobile_notifications: stopped
> zulip-workers:zulip_events_feedback_messages: stopped
> zulip-workers:zulip_events_user_presence: stopped
> zulip-workers:zulip_events_embedded_bots: stopped
> zulip-workers:zulip_events_user_activity_interval: stopped
> zulip-workers:zulip_events_missedmessage_email_senders: stopped
> zulip-workers:zulip_events_missedmessage_emails: stopped
> zulip-workers:zulip_events_deferred_work: stopped
> zulip-workers:zulip_events_embed_links: stopped
> zulip-workers:zulip_events_error_reports: stopped
> zulip-workers:zulip_events_invites: stopped
> zulip-workers:zulip_events_signups: stopped
> zulip-workers:zulip_events_email_mirror: stopped
> zulip-workers:zulip_events_user_activity: stopped
> zulip-workers:zulip_events_digest_emails: stopped
> zulip-workers:zulip_events_email_senders: stopped
> 2018-06-05 12:27:29,092 restart-server: Stopping server core
> zulip-senders:zulip_events_message_sender-0: stopped
> zulip-senders:zulip_events_message_sender-1: stopped
> zulip-senders:zulip_events_message_sender-2: stopped
> zulip-senders:zulip_events_message_sender-3: stopped
> zulip-django: stopped
> zulip-tornado: stopped
> 2018-06-05 12:27:32,064 restart-server: Starting server core
> zulip-tornado: started
> zulip-django: started
> zulip-senders:zulip_events_message_sender-0: started
> zulip-senders:zulip_events_message_sender-1: started
> zulip-senders:zulip_events_message_sender-2: started
> zulip-senders:zulip_events_message_sender-3: started
> 2018-06-05 12:27:36,083 restart-server: Starting workers
> zulip-workers:zulip_events_feedback_messages: started
> zulip-workers:zulip_events_slow_queries: started
> zulip-workers:zulip_events_user_presence: started
> zulip-workers:zulip_events_invites: started
> zulip-workers:zulip_events_outgoing_webhooks: started
> zulip-workers:zulip_events_signups: started
> zulip-workers:zulip_events_embedded_bots: started
> zulip-workers:zulip_events_email_mirror: started
> zulip-workers:zulip_events_user_activity_interval: started
> zulip-workers:zulip_events_missedmessage_emails: started
> zulip-workers:zulip_events_missedmessage_email_senders: started
> zulip-workers:zulip_events_user_activity: started
> zulip-workers:zulip_events_deferred_work: started
> zulip-workers:zulip_events_embed_links: started
> zulip-workers:zulip_events_missedmessage_mobile_notifications: started
> zulip-workers:zulip_events_error_reports: started
> zulip-workers:zulip_events_digest_emails: started
> zulip-workers:zulip_events_email_senders: started
> zulip-workers:zulip_deliver_enqueued_emails: started
> zulip-workers:zulip_deliver_scheduled_messages: started
> 2018-06-05 12:27:38,928 restart-server: Done!",dmarconi,b'area: production installer bug',2018-06-05T13:47:08Z,2019-07-23T14:21:08Z
9677,help: Fix back button on help pages.,"This PR fixes two issues -

* Back button not working for the initial loaded page.
* Update the hash position in left sidebar while
navigating in history.

Fixes: #9617.


![bb](https://user-images.githubusercontent.com/2263909/40891724-84f062ce-67a8-11e8-9ba6-e8018ca7763d.gif)



",akashnimare,b'area: documentation (user) bug priority: high size: L',2018-06-05T12:44:42Z,2018-06-06T20:11:58Z
9669,"Custom profile fields: Can't set a URL field type back to """"","You get the ""invalid URL"" error if you try.

There's similar issues if you try to remove the user or date field (we won't let you save).  For date field, we might eventually want UI for it, but for now, selecting the thing and hitting backspace kinda works visually (but throws this same error).  So let's at least fix the backend/validation problem for that to allow you clearing the field.

@YJDave this seems likely pretty quick to fix.",timabbott,b'area: settings UI bug priority: high',2018-06-04T23:35:35Z,2019-07-23T14:21:08Z
9668,"Clicking back and forth between settings panels with a ""User"" field type throws exception","Here's the exception:

```
Expected one element in jQuery set, 2 found
24363: http://localhost:9991/webpack/common.js | Object.blueslip_error [as error]
62: http://localhost:9991/static/js/setup.js | jQuery.fn.init.$.fn.expectOne
117: http://localhost:9991/static/js/settings_account.js | undefined
66: http://localhost:9991/static/js/settings_account.js | Object.exports.add_custom_profile_fields_to_settings
149: http://localhost:9991/static/js/settings_account.js | exports.set_up
33: http://localhost:9991/static/js/settings_sections.js | Object.exports.load_settings_section
758: http://localhost:9991/static/js/click_handlers.js | HTMLLIElement.
24189: http://localhost:9991/webpack/common.js | HTMLLIElement.blueslip_wrapper
7202: http://localhost:9991/webpack/common.js | HTMLDivElement.dispatch
7010: http://localhost:9991/webpack/common.js | HTMLDivElement.elemData.handle
10268: http://localhost:9991/webpack/common.js | Object.trigger
10346: http://localhost:9991/webpack/common.js | HTMLLIElement.
2373: http://localhost:9991/webpack/common.js | Function.each
2208: http://localhost:9991/webpack/common.js | jQuery.fn.init.each
10345: http://localhost:9991/webpack/common.js | jQuery.fn.init.trigger
```

@YJDave can you look into this?  It looks like some sort of double-initialization problem with the user pills.  The trigger was basically just opening settings, clicking around between the ""organization settings"" UI for custom profile fields and and ""display settings"" with a few closes of settings in there (probably there's a simple 3-step flow; this is just what I did twice and got this each time).",timabbott,b'area: settings UI bug priority: high',2018-06-04T23:30:51Z,2019-07-23T14:21:07Z
9663,"Fix recent ""All Messages"" bugs","To test this, mute a topic, write a message to the topic, then go to ""All Messages.""

",showell,b'bug priority: blocker size: L',2018-06-04T20:57:12Z,2018-06-04T22:15:24Z
9656,Muted topics broken?,"I have a topic muted, but all the messages in that topic are now being shown in the ""All messages"" view when they aren't supposed to be. Also, in that view, I can't select any of the messages in the muted topic with the keyboard arrow keys. ",aripollak,b'bug priority: blocker',2018-06-04T15:53:53Z,2018-06-04T21:36:56Z
9654,Bugs in zulipchat.com homepage (/hello) tour,"We have a couple somewhat annoying bugs with the carousel tour, which is now at the top of the homepage:

* There's a fairly long lag where the dots below the widget disappear temporarily when you're switching slides, which ends up feeling like something's not working right.
* Somehow the work @akashnimare did in 683fbf68ce2d58566cff753dae44cb670cd486a6 to make clicking anywhere advance seems to have stopped working.
* The last slide shouldn't have an the `>` (and the first slide shouldn't have the `<`).  This is especially important once clicking anywhere advances, to avoid the last slide auto-advancing when you mis-click.

@maxnuss FYI, comment if you're fixing any of these so that others don't :).",timabbott,b'area: portico priority: high',2018-06-04T06:06:57Z,2018-06-04T16:00:15Z
9652,stream settings: Add event to update stream privacy for realm-time-sync.,"Add event to update stream settings whenever stream privacy is changed
accordingly.

Fixes #9470

![streamprivacyevent](https://user-images.githubusercontent.com/25907420/40891202-1404d8d2-679f-11e8-9785-12216e4cbbba.gif)
",YJDave,b'area: real-time sync area: stream settings bug priority: high size: XL',2018-06-03T20:50:29Z,2019-05-08T04:33:26Z
9629,"Make ""Declare bankrupcty"" experience with lots of messages reasonable","Currently, if you get 25K messages behind in Zulip, we display our ""declare bankrupcty"" modal, and if the user clicks ""yes"", the page seems to hang, because it turns out, marking 25K messages as read in the database takes a while.

There's hacky things we could eventually do to try to make that delay not user-visible, but the immediate issue is that we really need some some sort of loading indicator + text to explain what's happening here.   

For development, it's easy to get into this state by just using `manage.py populate_db -n5000` and then `manage.py mark_all_messages_unread`.

See https://chat.zulip.org/#narrow/stream/9-issues/subject/coming.20back.20after.20a.20while/near/592172 for some discussion of phrasing etc.

",timabbott,b'area: message view bug priority: high',2018-06-01T19:23:53Z,2018-06-06T22:07:04Z
9627,create stream: Fix widget for changing privacy doesn't render initially.,"When admin user create new private stream, widget for changing privacy
of stream doesn't render. Because we render subscription-settings
template partially on subscription-add event, so this case wasn't
handled.

Fixes #9469
![changestreamprivacy](https://user-images.githubusercontent.com/25907420/40858638-968cef46-65fc-11e8-9801-ae75d21ffb05.gif)
",YJDave,b'area: real-time sync area: stream settings bug size: S',2018-06-01T19:05:19Z,2018-06-01T19:23:51Z
9626,bug: corrected typo(mispelling of problems) in VagrantFile,"Fixes #9596

I have corrected the misspelled word and correct the typo in Vagrant File",kurianbenoy,b'size: XS',2018-06-01T18:54:08Z,2018-06-01T18:58:10Z
9617,user docs: Back button is broken.,"To repro:
* Go to /help
* Click on a dropdown menu on the left sidebar
* Click an article link
* Click your browser's back button

The URL will change, but the page won't.
",rishig,b'area: documentation (user) bug priority: high',2018-06-01T04:18:29Z,2018-06-06T05:39:59Z
9608,export: Ensure zulip->zulip export covers all tables that should be exported,"I just completed the TODO project we'd for a long time had at the top of `ALL_ZERVER_TABLES` (well, now it's `ALL_ZULIP_TABLES`) to validate the list of tables that we export against the list of tables that are actually present; see 42aea68df3cc9e58c8e8ac857aab5bc36022129a.  I suppose this probably increases the priority of making sure we call `sanity_check_output` in CI (or at least refactor so the first piece is run there).

Aside from that bit of tooling work, the TODO list of things to fix is this:

```
    # The fact that these are not exported is a bug
    'zerver_botstoragedata',                                                                                                             
    'zerver_botconfigdata',                                                                                                              
    'zerver_mutedtopic',                                                                                                                 
    'zerver_realmauditlog',                                                                                                              
    'zerver_pushdevicetoken',                                                                                                            
    'zerver_service',                                                                                                                    
    'zerver_usergroup',                                                                                                                  
    'zerver_usergroupmembership',                                                                                                        
    'zerver_userhotspot',                                                                                                                
```

A few of these are larger projects (like `botstoragedata` / `botconfigdata`), just because we may need to add some to `populate_db` to make testing it convenient.  But I think most of these are pretty straightforward and we should just aim to fix quickly.  Some notes:
* user groups are present in populate_db
* hotpots are present in populate_db
* muted topics are easy to make in the UI
* realmauditlog entries are easy to make, but this one make require a bit of work just because of its foreign key pieces.
* push device tokens might need to be made manually (see `test_push_notifications.py`).
* `service` comes from making an outgoing webhook or embedded bot

And then medium priority is to also take along the analytics tables:
```
    'analytics_fillstate',                                                                                                               
    'analytics_realmcount',                                                                                                              
    'analytics_streamcount',                                                                                                             
    'analytics_usercount',                                                                                                               
```

(Check out the docs at http://zulip.readthedocs.io/en/latest/subsystems/analytics.html for how to get a `analytics.ds` realm with good test fixture data for this)",timabbott,b'area: export/import bug priority: high',2018-05-31T17:50:03Z,2018-07-23T15:37:44Z
9607,"Improve ""change stream privacy"" form","![peek 2018-05-31 23-05](https://user-images.githubusercontent.com/22238472/40798137-ef96a7a6-6527-11e8-9f37-4ecf3235dc5f.gif)
- [x] This modal for some reason doesn't have a backdrop. While we're at this, we should audit for others and generally clean things up to make sure all of our modals do this right.
- [x] The positioning feels a bit odd?
- [x] If you hit escape with the modal open, it closes the whole stream settings, leaving the modal open, which is broken. Suggests we're not registering this modal correctly.
- [x] The checkbox in the modal should use our standard settings checkbox styling (though note that it appears correctly in the other rendering of the stream_types.handlebars template, in our settings)",shubhamdhama,b'area: stream settings bug priority: high size: S',2018-05-31T17:42:42Z,2018-06-01T17:08:29Z
9606,"""Copy link to conversation"" does not always link to selected message","Issue: Clicking a link generated by 'Copy link to conversation' does not always reference selected message. Clicking the link loads the last message in the copied topic instead of selected message from which the link was generated.

Reproduction Steps:

Required setup:
1. Select a message somewhere in a stream topic (ensure it's not the last message in topic) 
2. Click the ""message actions""
3. Click ""Copy link to conversation""

Scenario 1: 
Open link in a new browser tab

Scenario 2:
Open link in a new browser window

Scenario 3: 
Open link in current window when viewing same stream",JLoppert,b'bug priority: blocker',2018-05-31T15:55:33Z,2018-06-01T19:56:39Z
9590,"Improve ""change stream privacy"" form","This is the ""Change"" button that organization administrators get when editing a stream's privacy settings, which we recently extended in #9588.

* This modal for some reason doesn't have a backdrop.  While we're at this, we should audit for others and generally clean things up to make sure all of our modals do this right.
* The positioning feels a bit odd?
* If you hit escape with the modal open, it closes the whole stream settings, leaving the modal open, which is broken.  Suggests we're not registering this modal correctly.  
* The checkbox in the modal should use our standard settings checkbox styling (though note that it appears correctly in the other rendering of the `stream_types.handlebars` template, in our settings)

@shubhamdhama I think you may be well-equipped for this.
",timabbott,b'area: stream settings bug priority: high',2018-05-30T21:25:28Z,2018-06-01T17:11:51Z
9580,Markdown: fix overlapping highlight of alert words and mentions.,"Added regex to the process_message function so that anything
in a span tag (which represents a mention or an alert word
that has already been marked) is ignored.

This prevents creation of nested span tags so only one
alert word can be applied to a section of the message.
And also prevents usernames in mentions from being
highlighted, since they are also contained in span tags.

Tests were added to cover the behavior described in
the issues page.

Fixes #9157.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Link to issue: https://github.com/zulip/zulip/issues/9157

**Testing Plan:** <!-- How have you tested? -->
Tests have been added in ```frontend_tests/node_tests/alert_words.js``` to test for the behavior described in the issues link. These tests should be modified if the ```process_message``` function in ```zulip/static/js/alert_words.js``` is changed later.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

Note the order of the alert words, and which ones end up highlighted. This behavior is as described in the issues page.

![image](https://user-images.githubusercontent.com/21148168/40698150-884c667c-6382-11e8-8830-f775b8cf9f6c.png)

![image](https://user-images.githubusercontent.com/21148168/40698153-8cd2a9d6-6382-11e8-92a3-4b9ff0709c55.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",brickbite,b'area: markdown bug size: XS',2018-05-30T03:57:33Z,2018-06-04T18:27:57Z
9577,integrations: Going to any doc link flashes through the home screen first.,"Clicking on a link like http://localhost:9991/integrations/doc/jira takes you first to 
![image](https://user-images.githubusercontent.com/890911/40684189-95603ed4-6345-11e8-8302-d5566e7ac7bf.png)

and then to the correct page.

Not sure how easy or hard this is to fix.",rishig,b'area: integrations bug',2018-05-29T20:39:15Z,2018-06-16T15:54:16Z
9574,upload: Rotate image according to exif data when resizing avatar and …,"…emojis.

Fixes #8177.
Refer https://stackoverflow.com/a/6218425.
Also adds 3 images with different orientation exif tags to test-images.",shubham-padia,b'area: message view bug size: L',2018-05-29T15:46:56Z,2018-09-08T19:31:47Z
9567,search: Handle pm-with/sender failures better. ,"Fixes #3380. Rebasing on the previous PR for this issue was not viable due to the change in validation logic and overwrites due to that.

For the last commit:
The blueslip warning mentioned in #3380 were from paths ending at people.email_list_to_user_ids_string. Some additional blueslip warnings
were raised after using that function.
Although we can put a validation check somewhere in the call stack of
people.email_list_to_user_ids_string, this function itself is used to
validate the operand by the higher order functions,so it wouldn't make
sense to put a  validation check before that. Instead, removing the
blueslip warning altogether was chosen.
people.email_list_to_user_ids_string was replaced by
people.reply_to_to_user_ids_string which is a blueslip-free version
of the same. Other blueslip warnings were removed.

Last commit was made what **I thought** was the best solution. Let me know if any changes need to be made to the last commit :smiley: (since it does not seem like the traditional way to deal with warnings)",shubham-padia,b'area: left-sidebar area: search bug priority: high size: S',2018-05-28T16:37:01Z,2018-09-08T19:32:17Z
9561,activity: Font awesome icons not showing.,"There should be a few icons on this page here:
![image](https://user-images.githubusercontent.com/890911/40591245-4b108fb6-61c2-11e8-81d4-55850b5c2ea9.png)

E.g. at 
![image](https://user-images.githubusercontent.com/890911/40591247-6587a712-61c2-11e8-8784-b8cb04a80242.png)

The html is at `templates/analytics/realm_summary_table.html`.

You can get to the page from http://analytics.zulipdev.com:9991/activity after running `./manage.py populate_analytics_db`.
",rishig,b'area: analytics bug help wanted',2018-05-27T22:29:56Z,2018-05-28T06:24:41Z
9558,Authentification: Added time conversion in new login emails.,"This commit adds code for the date and time conversion in
""new login"" emails according to the user's timezone.

Fixes #9336 ",zy964c,b'area: authentication bug size: M',2018-05-26T22:47:04Z,2018-06-07T15:40:47Z
9549,Weird JS traceback with lightbox unable to find its message,"We see this JS exception in production reasonably often, and I have no idea what code path ends up trying to open the lightbox without a corresponding message (the caller is a jQuery event handler).  Here's the interesting part of the traceback (well, there's actually two that happen in quick succession):

```
Message:
Lightbox for unknown message undefined

Stacktrace:
Error
    at Object.a.open (/static/min/app.1bca5516ccee.js:1946:411)
       = static/js/lightbox.js line 121 column 13

Message:
Cannot read property 'sender_full_name' of undefined

Stacktrace:
TypeError: Cannot read property 'sender_full_name' of undefined
    at Object.a.open (/static/min/app.1bca5516ccee.js:1946:474)
       = static/js/lightbox.js line 124 column 19
```

I'd love it if someone tracked it down, just because it spams up our JS traceback reporting.  ",timabbott,b'area: message view bug',2018-05-25T18:28:57Z,2020-02-10T22:01:56Z
9546,search: Respect spaces in person name in new suggestions only.,"Fixes #6515.
New suggestions for `sender:King ha` will respect spaces and the new
suggestion will be `Sent by King Hamlet <email>` instead of `Sent by King,
search for ha`. But if first term of sender operand is a valid user email,
tokens will be seperated by spaces. e.g `sender:hamlet@zulip.com abc`
will show `Sent by King Hamlet <email>, search for abc`.

![selection_149](https://user-images.githubusercontent.com/13910561/40552992-f5a1d2d8-605e-11e8-865f-a366fc823604.png)

![selection_148](https://user-images.githubusercontent.com/13910561/40552994-f5d83fc6-605e-11e8-91f0-63c600260e10.png)


The original issue mentioned
> considering things with spaces in them if and only if the thing after the : is an exact prefix of someone's name.

I think that will not be necessary in this case as we are using only emails for filtering. If it's not an exact prefix, e.g `sender:Kin ha`, the prefix check would enable to make the suggestion `Sent by Kin, search for ha`. But since `Kin` is not a valid email, it's of no use and any query following it would result in empty search. The result without the prefix check would be `Sent by Kin Ha`. Thus, I think it's better to skip this check and (presumably) save some time. (Let me know if this needs to be changed) ",shubham-padia,b'area: search bug priority: high size: M',2018-05-25T15:44:56Z,2018-09-08T19:31:40Z
9545,Import: system bots should not be imported again if they already exist.,"Fixes #9544

After the import is finished, we check if any of the system bots are imported back in (We check if multiple objects of that bot exist in the database and delete the newly imported realm copy of that bot.)
",rheaparekh,b'area: export/import bug has conflicts size: M',2018-05-25T15:25:17Z,2019-05-01T00:39:25Z
9544,Import: system bots should not be imported again if they already exist.,"If we export a Zulip realm with system bots and try to import the realm back in, we get the error:
```
Exception in thread Thread-20:
Traceback (most recent call last):
  File ""/usr/lib/python3.4/threading.py"", line 920, in _bootstrap_inner
    self.run()
  File ""/srv/zulip/zerver/management/commands/process_queue.py"", line 95, in run
    self.worker.start()
  File ""/srv/zulip/zerver/worker/queue_processors.py"", line 169, in start
    self.consume_batch(events)
  File ""/srv/zulip/zerver/worker/queue_processors.py"", line 347, in consume_batch
    error_bot_realm = get_system_bot(settings.ERROR_BOT).realm
  File ""/srv/zulip/zerver/lib/cache.py"", line 167, in func_with_caching
    val = func(*args, **kwargs)
  File ""/srv/zulip/zerver/models.py"", line 1544, in get_system_bot
    return UserProfile.objects.select_related().get(email__iexact=email.strip())
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/query.py"", line 384, in get
    (self.model._meta.object_name, num)
zerver.models.MultipleObjectsReturned: get() returned more than one UserProfile -- it returned 2!
```
Hence, the system bots should be prevented from being imported back in.",rheaparekh,b'area: export/import bug',2018-05-25T15:20:59Z,2020-05-12T20:03:42Z
9536,linter: Fix issue with check-templates output.,"We fix the issue of check-templates spitting out diff between
expected and found indentation of a file before mentioning the
error message and the file name. Basically stuff was being in the
wrong order despite the fact that in code stuff was happening in the
correct order ie, first print the error message along with the filename
and then the actual diff between expected and found file indentation.

Fixes: #9533.

Outputs Before:
```
(zulip-py3-venv)vagrant@vagrant-base-trusty-amd64:/srv/zulip$ tools/lint
templates | 26,29c26,29
templates | <               {{partial ""settings_checkbox""
templates | <                 ""setting_name"" ""night_mode""
templates | <                 ""is_checked"" page_params.night_mode
templates | <                 ""label"" settings_label.night_mode}}
templates | ---
templates | >             {{partial ""settings_checkbox""
templates | >               ""setting_name"" ""night_mode""
templates | >               ""is_checked"" page_params.night_mode
templates | >               ""label"" settings_label.night_mode}}
templates | Invalid Indentation detected in file: static/templates/settings/display-settings.handlebars
templates | Diff for the file against expected indented file:
```

Outputs now: 
```
(zulip-py3-venv)vagrant@vagrant-base-trusty-amd64:/srv/zulip$ tools/lint
templates | Invalid Indentation detected in file: static/templates/settings/display-settings.handlebars
templates | Diff for the file against expected indented file:
templates | 26,29c26,29
templates | <               {{partial ""settings_checkbox""
templates | <                 ""setting_name"" ""night_mode""
templates | <                 ""is_checked"" page_params.night_mode
templates | <                 ""label"" settings_label.night_mode}}
templates | ---
templates | >             {{partial ""settings_checkbox""
templates | >               ""setting_name"" ""night_mode""
templates | >               ""is_checked"" page_params.night_mode
templates | >               ""label"" settings_label.night_mode}}
```",adnrs96,b'area: tooling bug size: XS',2018-05-24T19:39:08Z,2018-05-24T19:43:59Z
9533,check-templates output happens in the wrong order,"@adnrs96 can you fix this?  The heading part is below the diff :/.

```
templates | 27,30c27,30
templates | <                 {{partial ""settings_checkbox""
templates | <                   ""setting_name"" ""dense_mode""
templates | <                   ""is_checked"" page_params.dense_mode
templates | <                   ""label"" settings_label.dense_mode}}
templates | ---
templates | >             {{partial ""settings_checkbox""
templates | >               ""setting_name"" ""dense_mode""
templates | >               ""is_checked"" page_params.dense_mode
templates | >               ""label"" settings_label.dense_mode}}
templates | Invalid Indentation detected in file: static/templates/settings/display-settings.handlebars
templates | Diff for the file against expected indented file:
```",timabbott,b'area: tooling bug',2018-05-24T18:56:23Z,2018-05-24T19:42:33Z
9529,frontend: Unread count badges not rendering properly.,"![image](https://user-images.githubusercontent.com/16687990/40502375-62f91c7c-5fa8-11e8-9875-fb4e1233e5fe.png)

This seems to be a recent regression. They used to render properly earlier. FWIW I am Firefox 60.0.1 on Ubuntu with 150% zoom setting.
Related discussion: https://chat.zulip.org/#narrow/stream/6-frontend/topic/unread.20count.20badges",HarshitOnGitHub,b'area: left-sidebar bug',2018-05-24T17:47:22Z,2020-07-10T09:51:43Z
9525,Control-[ stopped working to dismiss the new message entry box? ,"The issue is just what it sounds like: `control+[` used to be a synonym for esc and now it doesn't seem to be (it does nothing), despite the ? dialog box still saying Esc, Ctrl + [ | Cancel compose

Originally reported by @glyph - https://github.com/zulip/zulip-electron/issues/489 
",akashnimare,b'area: keyboard UI bug',2018-05-24T15:22:35Z,2018-05-24T15:32:58Z
9524,"messages: Allow ""no topic"" topics editable indefinitely.","Fixes: #9484.
Just to make sure, message who don't have any topic have `subject` as `(no topic)`?",shubhamdhama,b'area: topics bug size: S',2018-05-24T12:14:09Z,2018-05-24T14:36:43Z
9513,settings: Make bot cards look nicer in narrow windows.,"If you have a somewhat narrow window (or maybe just a long host name or bot name?) the bot cards get a scrollbar instead of just being a little taller.

We should make it a bit more responsive.",showell,b'area: bots area: settings (user) bug',2018-05-23T16:39:00Z,2018-07-05T10:31:53Z
9498,org settings: Use do_settings_change for auth method checkboxes.,"Fixes: #9224.
![peek 2018-05-22 23-10](https://user-images.githubusercontent.com/22238472/40380001-666aaa18-5e15-11e8-9324-9703fdc37da1.gif)
I've added the label so that the ""Saving"" indicator looks like everywhere else.",shubhamdhama,b'area: settings (admin/org) bug size: L',2018-05-22T17:41:40Z,2018-05-22T21:07:42Z
9494,org settings: Show pointer on hovering labels of checkboxes.,"Fixes: #9447.
GIF:
![peek 2018-05-22 17-43](https://user-images.githubusercontent.com/22238472/40361676-c2610dc2-5de7-11e8-86be-abb6baaea585.gif)
",shubhamdhama,b'area: settings UI bug size: XS',2018-05-22T12:14:37Z,2018-05-22T15:04:11Z
9484,"Allow editting topic ""(no topic)"" indefinitely.","Trying to rename topic name `(no topic)` shows a modal saying ""Error Saving Edit"" as shown below.
![image](https://user-images.githubusercontent.com/8033238/40326625-943f0b18-5d5d-11e8-8974-172ea6921bfb.png)

The intended behavior is to be able to save edits to a `(no topic)` topic indefinitely.

@zulipbot label ""bug"" ""help wanted"" ""area: topics""",aero31aero,b'area: topics bug help wanted',2018-05-21T19:48:14Z,2019-07-23T14:21:05Z
9478,portico: Align ToS checkbox with full name input box.,"Fixes #9328.
Makes the width on checkbox input-group same as full name input box
width and centers it horizontally.

![selection_133](https://user-images.githubusercontent.com/13910561/40302696-9c5e9b06-5d0d-11e8-9a13-9bf76e2f8759.png)
",shubham-padia,b'area: portico bug priority: high size: XS',2018-05-21T10:12:53Z,2018-09-08T19:32:04Z
9477,search: fix negated suggestions not working in some cases,"fixes #9461.
fixes #9313.

negated special filter operator suggestions
![selection_127](https://user-images.githubusercontent.com/13910561/40293281-da46bd4c-5ced-11e8-91fe-697cdc7689ba.png)

negated special filter operand suggestions
![selection_128](https://user-images.githubusercontent.com/13910561/40293307-f5ef2174-5ced-11e8-8251-1ebfe73899dd.png)

negated stream suggestions:
![selection_129](https://user-images.githubusercontent.com/13910561/40293319-052b48fc-5cee-11e8-9eec-3705e1e59d7f.png)

negated sent_by_me suggestions:
![selection_130](https://user-images.githubusercontent.com/13910561/40293340-25e3ee50-5cee-11e8-8319-3ac52e16a1f9.png)

previously sent by me suggestion was not occurring in the below query:
![selection_131](https://user-images.githubusercontent.com/13910561/40293384-4c74bbc6-5cee-11e8-93d4-9c542dd6490c.png)





",shubham-padia,b'area: search bug size: XL',2018-05-21T06:29:02Z,2018-09-08T19:32:05Z
9473,Tag `validate_email_for_realm`  error conditions for translation,"These are cases like the user's email already having a (potentially deactivated) account when attempting to register an account.

Opening an issue rather than just doing it because I'd prefer for @rishig to do a pass on these strings before we tag them; should be pretty quick.

",timabbott,b'area: i18n bug good first issue help wanted',2018-05-21T02:22:45Z,2019-08-22T04:20:04Z
9470,Add an event for changes to stream history and privacy settings,"Currently, we don't have any sort of real-time sync event for updating browsers about streams changing from private->public or vise versa (and this problem will be inherited by our stream private-with-history feature).  

Especially once #9243 is merged, I think it'll make sense for us to clean this up, since it's the main significant remaining wart in our real-time sync logic for stream settings.

@YJDave this is probably a good one for you, and maybe @eeshangarg can help review/test this.

Also @shubham-padia FYI, since this may become relevant reading for your ""announcement-only"" feature UI.",timabbott,b'area: real-time sync area: stream settings bug priority: high',2018-05-20T21:36:08Z,2019-05-08T00:39:57Z
9469,"stream create: The ""Change"" widget for changing privacy doesn't render initially","If an organization admin creates a new stream, the little ""[Change]"" button for changing stream the stream's invite-only status doesn't render until one refreshes the page (or similar).  

@YJDave this is probably a good quick one for you.",timabbott,b'area: real-time sync area: stream settings bug',2018-05-20T21:34:58Z,2018-06-01T19:14:29Z
9461,search: negated suggestions not working in some cases,"For special filters i.e `is` and `has`, negated filters are not suggested when suggesting that operator and also when the negated operator has been selected. While for some of the operators, negated suggestions are not shown once the operator has been decided.

e.g. exclude is not shown for has operator:
![selection_125](https://user-images.githubusercontent.com/13910561/40266293-4833f934-5b66-11e8-9018-3df22351a8ca.png)

e.g. after deciding the operator, negated suggestions don't appear:
![selection_126](https://user-images.githubusercontent.com/13910561/40266304-868e3352-5b66-11e8-85d5-259c5cdfc6ea.png)

![selection_124](https://user-images.githubusercontent.com/13910561/40266310-98c736fe-5b66-11e8-8ae1-a79c73622536.png)


 ",shubham-padia,b'area: search bug',2018-05-19T07:28:58Z,2018-05-22T05:43:20Z
9459,user groups: Sanitize pill_container selector to avoid escaped strings.,"Fixes #9325.

![screenshot at may 18 13-09-02](https://user-images.githubusercontent.com/15116870/40255642-b87b2f02-5a9c-11e8-8e7e-ea1e4620cdc1.png)

User groups with common string escape characters can now be safely created without throwing any jQuery selector errors.",synicalsyntax,b'area: settings (admin/org) bug size: S',2018-05-18T20:10:06Z,2018-05-25T19:41:29Z
9457, bots: Do not show `not_subscribed` warning for bots on private streams.,"Fixes #9373.
I noticed that test for `needs_subscribe_warning` was msising, so added a test in the second commit. I divided this into two commits as the test was added for the whole `needs_subscribe_warning` and not just the `is_bot` change (let me know if this needs to be changed).",shubham-padia,b'area: bots bug priority: high size: M',2018-05-18T14:31:18Z,2018-09-08T19:31:35Z
9456,edit bot: Fix UI element shows incorrect interface for outgoing webhook.,"Fixes #9419

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![editoutgoingwebhookbot](https://user-images.githubusercontent.com/25907420/40237433-0d01870c-5ace-11e8-90e6-518db4ea23b9.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",YJDave,b'area: bots bug size: S',2018-05-18T13:33:05Z,2018-08-12T19:15:18Z
9455,tools: Allow optional arguments after file arguments in test_backend.,"Fixes #9233.
Uses nargs='*' instead of nargs='argparse.REMAINDER'.
nargs='argparse.REMAINDER' gathers remaining terms as arguments
even if it is an option e.g --coverage, while '*' gathers all the
command-line arguments until the next option is encountered.

From https://docs.python.org/3/library/argparse.html#nargs:
-  '*'. All command-line arguments present are gathered into a list.:
```python
>>> parser = argparse.ArgumentParser()
>>> parser.add_argument('--foo', nargs='*')
>>> parser.add_argument('--bar', nargs='*')
>>> parser.add_argument('baz', nargs='*')
>>> parser.parse_args('a b --foo x y --bar 1 2'.split())
Namespace(bar=['1', '2'], baz=['a', 'b'], foo=['x', 'y'])
```
- argparse.REMAINDER. All the remaining command-line arguments are gathered into a list. This is commonly useful for command line utilities that dispatch to other command line utilities:
```python
>>> parser = argparse.ArgumentParser(prog='PROG')
>>> parser.add_argument('--foo')
>>> parser.add_argument('command')
>>> parser.add_argument('args', nargs=argparse.REMAINDER)
>>> print(parser.parse_args('--foo B cmd --arg1 XX ZZ'.split()))
Namespace(args=['--arg1', 'XX', 'ZZ'], command='cmd', foo='B')
```
",shubham-padia,b'area: testing-infrastructure bug size: XS',2018-05-18T12:15:11Z,2018-09-08T19:31:19Z
9453,search: Show category-wise suggestions for has operator.,"**Commit 1**:
Default suggestion e.g `messages with one or more abc` as a suggestion for `has:abc` is not shown in a new suggestion. But if the has operator is already present before any other operator, the default message text will be used. e.g `has:abc sender:abc@zulipchat.com` will have all the suggestions with the prefix `messages with one or more abc, sent by abc@zulipchat.com`.

![selection_122](https://user-images.githubusercontent.com/13910561/40228887-2dbb2a52-5ab0-11e8-81de-0cbc5e12f64b.png)

![selection_121](https://user-images.githubusercontent.com/13910561/40228894-2fd5cf90-5ab0-11e8-8e5c-4c0cccbdbb17.png)

**Commit 2:**
`has` operator uses predefined categories. This commit displays an invalid operand message if the operand does not fall in to any of these categories and the `has` operator is not at the last.
e.g. `has:abc sender:abc@zulipchat.com` will have `invalid abc operand for has operator, sent by abc@zulipchat.com` as a prefix for all its suggestions.
![selection_123](https://user-images.githubusercontent.com/13910561/40228987-7d355fda-5ab0-11e8-97b5-502d9b5ab1ef.png)

**Commit 3:**
Another issue was getting the default suggestion `messages with one or more` when getting the suggestions for chosing the operator as shown below:
![screenshot from 2018-05-18 11-40-48](https://user-images.githubusercontent.com/13910561/40229106-ee4a8934-5ab0-11e8-9761-d76d3fee8f2f.png)

This commit takes care of that issue.
Results:
![screenshot from 2018-05-18 12-21-27](https://user-images.githubusercontent.com/13910561/40229274-67f0f778-5ab1-11e8-8e9f-e658a52a67b9.png)

Note: categories exist for the `is` operator, removal of default suggestion needs to be done.",shubham-padia,b'area: search bug priority: high size: XL',2018-05-18T10:08:47Z,2018-09-08T19:31:35Z
9447,settings: Mouse should change to hand when hovering over label.,"We allow clicking on labels to change the setting, and ideally the mouse would reflect that.",rishig,b'area: settings UI bug help wanted',2018-05-17T16:06:49Z,2018-05-22T15:04:59Z
9422,Can't invite people via EMail when LDAP is activated,"Both 'zproject.backends.EmailAuthBackend' and 'zproject.backends.ZulipLDAPAuthBackend'
are enabled in my configuration. If I invite someone via ""Invite more users"" and said user clicks on the invite link, the user is pointed to /accounts/register/ and receives an ""Internal Server Error"". 

This is from the errors.log:

```
2018-05-16 13:37:01.214 ERR  [django.request] Internal Server Error: /accounts/register/
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-05-16-13-07-28/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2018-05-16-13-07-28/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2018-05-16-13-07-28/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/decorator.py"", line 121, in wrapper
    return func(request, *args, **kwargs)
  File ""./zerver/views/registration.py"", line 136, in accounts_register
    ldap_attrs = _LDAPUser(backend, backend.django_to_ldap_username(email)).attrs
  File ""./zproject/backends.py"", line 405, in django_to_ldap_username
    raise ZulipLDAPException(""Username does not match LDAP domain."")
zproject.backends.ZulipLDAPException: Username does not match LDAP domain.
```",lennartgrunau,b'area: authentication bug priority: high',2018-05-16T13:39:49Z,2019-07-23T14:21:04Z
9419,Edit bot page: Display the correct interface for slack outgoing webhooks.,"This bot has the `outgoing_webhook` type and the `Outgoing webhook message format` is `Slack compatible`. However upon trying to edit the bot, it shows the interface to be `Generic`, where it was supposed to be `Slack outgoing webhooks`. Also we are unable to save it as shown in the gif.

![slack bot](https://user-images.githubusercontent.com/25330892/40112975-744c32e0-5925-11e8-93ef-ec849c6df3ca.gif)
",rheaparekh,b'area: bots bug',2018-05-16T11:00:50Z,2018-05-21T17:11:29Z
9409,Some users cannot log into Zulip with Safari,https://github.com/zulip/zulip/issues/9127#issuecomment-387513747 has a bunch of context and debugging details (and we've determined is unrelated to the GitHub auth specific issue originally reported there).  @danking @tpoterba FYI.,timabbott,b'area: authentication bug',2018-05-15T18:22:26Z,2018-07-31T21:51:27Z
9401,Improve error message in bot settings when EXTERNAL_HOST isn't a proper domain,"If you set `EXTERNAL_HOST` to e.g. `abcdef`, not `abcdef.com`, the bot email addresses that we generate automatically when creating a bot don't validate, and we don't provide a clear error message as to why (which is essentially that the machine is misconfigured).

We should either come up with a hack to make this kinda work (maybe having a `BOT_DOMAIN` setting that defaults to `EXTERNAL_HOST`), or give a clear error.",timabbott,b'area: bots bug in progress priority: high',2018-05-15T15:37:08Z,2019-08-30T22:02:28Z
9400,message-view: Handle trailing slashes in narrowing URLs.,"Fixes #9305.
Empty operators are not allowed while parsing narrowing URLs.
`parse_narrow` stops parsing further if it encounters an empty string
operator.

Another approach would have been to fix the trailing slash before passing it to `parse_narrow`, but that would require trusting the developer to take care of the trailing slashes anywhere this function is used.",shubham-padia,b'area: message view bug priority: high size: S',2018-05-15T14:36:55Z,2018-09-08T19:31:16Z
9396,"typeahead: ""keydown"" events for Enter and Arrow keys should be ignored while ""composition""","First, I describe what is the ""composition"".

In CJK language regions, people use some software named ""IM"" (input method) to input heir local language text. For example, when I search a Japanese term ""日本語"" (means ""Japanese language"") in a Zulip instance with Firefox, I need to do:

 1. Click the search field.
 2. Activate the IM. The ""composition"" session starts.
 3. Type keys: `n`, `i`, `h`, `o`, and `n`. (in a composition session)
 4. Hit the Space key to convert the text to Japanese term. ""日本"" is suggested. (in a composition session)
 5. Hit the Enter key to determine the text ""日本"". (in a composition session)
 6. Type keys: `g`, and `o`. (in a composition session)
 7. Hit the Space key to convert the text to Japanese term. ""語"" is suggested. (in a composition session)
 8. Hit the Enter key to determine the text ""語"". (in a composition session)
 9. Deactivate the IM. The ""composition"" session ends.
 10. Hit the Enter key again to search ""日本語"" on Zulip.

While the composition session, ""keydown"" events for special keys (Enter and Arrow) are handled by the IM to choose a term from variations or determine the choice. Thus I hit the Enter key three times in this case. The first time and the second are notified only to IM, so Zulip receives only the third time.

And, there is one problem on lately development build of Firefox.

 * [1446401 - Start to dispatch keydown/keyup events even during composition in Nightly and early Beta](https://bugzilla.mozilla.org/show_bug.cgi?id=1446401)
 * [Intent to ship: Start to dispatch ""keydown"" and ""keyup"" events even if composing (only in Nightly and early Beta) - Google Group](https://groups.google.com/forum/#!topic/mozilla.dev.platform/oZEz5JH9ZK8/discussion)

Due to the change, now development build of Firefox (aka Nightly) notifies ""keydown"" events to the webpage, for all keyboard operations while ""composition"" sessions. As the result, the search field shows suggested results while I'm typing alphabet keys. This is good improvement, but there is one new problem: when I hit the Enter key to determine a chosen term, it is also notified to Zulip. Thus, when I just determine the first part term ""日本"" of the joined term ""日本語"", Zulip unexpectedly handles the Enter key to search the part ""日本"" and I cannot input following part ""語"" anymroe.

To fix this problem, Zulip need to ignore keydown events for Enter and Arrow keys while the composition session. While a composition session, all keydown events have the [`isComposing`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/isComposing)  property with `true` value, so you just need to return when the property is `true`. Could you apply this change to Zulip?

Environment:

 * Zulip 1.8.0
 * Mozilla Firefox Nightly 62.0a1
 * Ubuntu 16.04LTS + IIIMF ATOK X3",piroor,b'area: i18n area: keyboard UI bug priority: high',2018-05-15T12:23:01Z,2018-06-20T20:35:53Z
9385,Redirect loop on login page from Firefox,"I'm having an issue logging into our zulip server (https://hail.zulipchat.com/login/) from Firefox. It's reproducible, and the issue has persisted since the creation of our server a week ago. Here are some more details:

* Clicking either ""Login"" or ""Login with GitHub"" bounces me to the same login page. However, the authentication succeeded somewhere because I get ""new login"" email notifications or GitHub warnings about too many authentication attempts.
* I have this issue on Firefox, but not Chrome. I tried disabling all extensions and restarting Firefox, but the issue persisted.
* The issue occurs for both GitHub and email authentication.
* I _don't_ have a problem logging into chat.zulip.org from Firefox.

Happy to provide more information as necessary!",tpoterba,b'area: authentication bug priority: blocker',2018-05-14T19:12:01Z,2018-08-08T22:06:59Z
9384,"search typeahead: ""has:im"" completes to something that doesn't make sense.","![image](https://user-images.githubusercontent.com/890911/40017616-e0cc4ee0-5787-11e8-9800-c065f64cc5a6.png)

If I hit enter, it selects the first option. The first option should either not be in the typeahead, or it should be called ""Sent by .., search for has:im"".
",rishig,b'area: search bug help wanted priority: high',2018-05-14T19:05:11Z,2019-07-23T14:21:03Z
9381,emoji: Don't start typeahead for colon-space.,"Fixes #9339.

The PR fixes the case mentioned in the issue as well as the general case when a space is following a colon (e.g.  typehead should start for `:t`, but not for `: t`).",alenavolk,b'area: compose bug size: S',2018-05-14T17:26:57Z,2018-05-15T19:15:27Z
9376,AWS S3 Region Security Error,"When trying to authenticate with AWS S3 for Avatar and Uploads in the US East 2 Region (Ohio) we get the following security error:

 File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 131, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 605, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 587, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 747, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/views/upload.py"", line 104, in upload_file_backend
    uri = upload_message_image_from_request(request, user_file, user_profile)
  File ""./zerver/lib/upload.py"", line 559, in upload_message_image_from_request
    content_type, user_file.read(), user_profile)
  File ""./zerver/lib/upload.py"", line 538, in upload_message_file
    target_realm=target_realm)
  File ""./zerver/lib/upload.py"", line 257, in upload_message_file
    file_data
  File ""./zerver/lib/upload.py"", line 187, in upload_image_to_s3
    key.set_contents_from_string(contents, headers=headers)  # type: ignore # https://github.com/python/typeshed/issues/1552
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py"", line 1438, in set_contents_from_string
    encrypt_key=encrypt_key)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py"", line 1305, in set_contents_from_file
    chunked_transfer=chunked_transfer, size=size)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py"", line 762, in send_file
    chunked_transfer=chunked_transfer, size=size)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py"", line 963, in _send_file_internal
    query_args=query_args
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/connection.py"", line 671, in make_request
    retry_handler=retry_handler
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py"", line 1071, in make_request
    retry_handler=retry_handler)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py"", line 940, in _mexe
    request.body, request.headers)
  File ""/home/zulip/deployments/2018-05-11-16-38-38/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py"", line 896, in sender
    response.status, response.reason, body)
boto.exception.S3ResponseError: S3ResponseError: 400 Bad Request
<?xml version=""1.0"" encoding=""UTF-8""?>
<Error><Code>InvalidRequest</Code><Message>The authorization mechanism you have provided is not supported. Please use AWS4-HMAC-SHA256.</Message><RequestId>D37F11433B97B292</RequestId><HostId>WZ5mYxq96JZWblntymvMzXC3+4zJ0qpw/+VRaXiKoAReaa7l2FGmmBVEvwmK9UVwUtWhOhH14X4=</HostId></Error>",hunden5,b'area: production area: production installer bug',2018-05-14T13:56:46Z,2020-08-24T19:12:33Z
9373,"One gets the ""not subscribed"" warning when mentioning a bot","The interface for many of our bots is that, when mentioned, they receive the message mentioning them even if on a private stream where they are not subscribed.  We should make this notice not appear in that case:

![image](https://user-images.githubusercontent.com/2746074/39994596-a6cae3a4-572e-11e8-8920-ea3884592249.png)
",timabbott,b'area: bots bug priority: high',2018-05-14T11:24:53Z,2018-05-18T22:29:37Z
9372,Attachments inaccessible to new subscribers,"I changed a stream from PRIVATE to PUBLIC. However, new subscribers are not able to access the attachments. 

How can I make the attachments accessible to them?",shivams,b'area: uploads bug priority: high',2018-05-14T07:34:43Z,2018-06-06T16:41:36Z
9361,Update S3 integration docs,"This block should reflect the fact that we moved the configuration (and ideally be just automated away somehow).
```
# (2) Edit /etc/nginx/sites-available/zulip-enterprise to comment out                                 
# the nginx configuration for /user_uploads and /user_avatars (see                                    
# https://github.com/zulip/zulip/issues/291 for discussion of a better                                
# solution that won't be automatically reverted by the Zulip upgrade                                  
# script), and then restart nginx.                                                                    
```",timabbott,b'area: production bug priority: blocker',2018-05-11T18:53:18Z,2018-06-05T15:15:13Z
9344,left-sidebar: Remove non-clickable vertical space between topics.,"Fixes #8952.
Tested on local development server.",utkarsh23,b'area: left-sidebar bug size: XS',2018-05-08T23:13:13Z,2018-05-23T21:56:36Z
9339,emoji: Typeahead should not start for paren-colon-space.,"Currently something like
`item): t` will (incorrectly) start the emoji typeahead on `t`. 

Note that `item: t` correctly does not start the typeahead.

",rishig,b'area: compose bug help wanted',2018-05-08T07:49:44Z,2018-05-15T18:22:42Z
9336,"Use the user's timezone in generating the ""new login"" emails","Currently, we display the user's timezone in the ""new login"" emails in UTC, which can be confusing for folks who live in another time zone (e.g. it might show a login happening ""tomorrow"").  Since we do collect users' timezones in ""display settings"" (and automatically in the signup process), we should use that data to provide our best guest of the timezone to the user.  ",timabbott,b'area: authentication bug',2018-05-08T03:33:07Z,2018-06-07T15:44:14Z
9328,portico: ToS box is a bit off in /accounts/register,"![image](https://user-images.githubusercontent.com/890911/39682199-6a5c61de-5163-11e8-94a5-c60bb906022c.png)

I got here by joining a realm via google auth, but I suspect it doesn't matter.

The ToS checkbox should be left-aligned with the Full name input box above it.
",rishig,b'area: portico bug help wanted priority: high',2018-05-07T02:27:19Z,2018-05-22T05:54:35Z
9325,"user-groups: Inserting a double quote character in the ""Name"" throws SyntaxError","If a double quote is inserted in a new User-Group `Name`, this [line of code](https://github.com/zulip/zulip/blob/aac76c14bdc1a6f7041cb996eb74996b6b1ac131/static/js/settings_user_groups.js#L40) will process the following jquery selector: 
```js
$('.pill-container[data-group-pills=""""""]');
```
which will throw a `SyntaxError unrecognized expression` JavaScript error due to quote mismatching. Subsequent reloads of the ""User groups"" Organization settings tab will re-throw the exception, making it impossible to manage user groups through the UI.

## Steps to reproduce
1. On a zulip instance where you have access to the organization settings, visit your_org.zulipchat.com/#organization/user-groups-admin
1. Create a new user group named `""`, with any description
1. Reload your_org.zulipchat.com/#organization/user-groups-admin
1. Feature not available anymore
",ldionmarcil,b'area: settings (admin/org) bug',2018-05-06T00:31:34Z,2018-05-25T19:05:38Z
9318,keyboard ui: Fix arrow key navigation for user profile menu.,If you enter the user profile menu (such as by hitting `u`) the arrow keys don't work to select menu items.  We should fix this.,showell,b'area: keyboard UI bug',2018-05-04T23:28:49Z,2019-07-23T14:21:02Z
9315,settings: Fix 500 when trying to change email to disposable email,"![disposable-followup](https://user-images.githubusercontent.com/7190633/39640157-bfa27afc-4fe7-11e8-9352-5418ea0834d9.gif)
Fixes #9240",hackerkid,b'area: settings (user) bug priority: high size: M',2018-05-04T16:48:34Z,2018-05-04T17:52:44Z
9305,Fix handling of trailing slashes in narrowing URLs,"This link is broken; you need to remove the trailing slash:

https://chat.zulip.org/#narrow/stream/6-frontend/subject/select_first_unread/

We should fix our parsing to still have that take you to the narrow.
",timabbott,b'area: message view bug priority: high',2018-05-03T19:57:53Z,2018-05-15T16:38:48Z
9298,stream-settings: Improve selection behavior around the stream-settings.,"Fixes: #9276.


<img src=""https://dzwonsemrish7.cloudfront.net/items/0t052U0K2m1r1z1v1N0w/Screen%20Recording%202018-05-03%20at%2004.44%20AM.gif?v=3b548309""/>",akashnimare,b'area: stream settings bug size: S',2018-05-03T00:43:44Z,2018-05-04T17:15:52Z
9292,push_notifications: Format blockquotes properly in text_output.,"New output is of the format:

```
Hamlet said:
> Polonius said:
> > This is the.
> > Second layer of nesting.
> First layer of nesting.
```
Fixes #9251.

**Testing Plan:** <!-- How have you tested? -->

Modifies existing testcases.",aero31aero,b'area: notifications (messages) bug size: S',2018-05-02T05:13:04Z,2018-05-02T15:57:19Z
9286,#8857 outgoing webhooks: Improve error handling when non-JSON response returned,"Fixes #8857.

I decided to put logic for notifying `bot_owner` about error during response parsing in `do_rest_call()` method, because it already notifies `bot_owner` about error during request execution to third-party service. That's why I change return type of  `OutgoingWebhookServiceInterface.process_success` to 2-elements tuple with `(success_message, failure_message)` structure. If `success_message` was returned in `do_rest_call()` method, then existing logic works. If `failure_message` was returned, then logic for notifying the `bot_owner` starts, similar to case when request to service was failed due to `RequestException`.",novokrest,b'area: bots area: integrations bug has conflicts size: XL',2018-05-01T14:02:10Z,2018-10-12T09:44:54Z
9279,sidebars: Disable autocomplete for user and stream search inputs.,"Fixes #9269.

**Testing Plan:** <!-- How have you tested? -->
Manual testing
",aero31aero,b'area: left-sidebar area: right-sidebar bug size: XS',2018-05-01T04:56:29Z,2018-05-01T16:24:49Z
9277,Retrieving API Keys Fails When Authenticating via LDAP *AND* Username and E-mail Address Are Different,"The fix for https://github.com/zulip/zulip/issues/806 (https://github.com/zulip/zulip/pull/809) assumes that the [username used for authenticating to LDAP is also the e-mail address](https://github.com/zulip/zulip/pull/809/files#diff-70a138eff954186bf078592d42b9510cR1100).  This works for scenario A described [here](https://github.com/zulip/zulip/blob/9a0fdf5b8dca376570bc182428ba6148fdba52c1/zproject/prod_settings_template.py#L366-L394), but not for scenarios B and C.  For scenarios B and C, I believe that you'd want to use the `username` field [defined in the AbstractUser superclass](https://docs.djangoproject.com/en/2.0/ref/contrib/auth/#django.contrib.auth.models.User.username), but I could easily be wrong since I'm not super familiar with the Zulip codebase.

Also, thanks for developing this project using an open source license!  My team has really enjoyed testing it out.",jpellman,b'area: authentication bug priority: high',2018-04-30T21:55:12Z,2020-01-31T21:05:09Z
9276,Improve selection behavior around the stream-settings checkmark,"If you try to click the checkmark to toggle subscriptions and misclick, you end with a selection like this:

![image](https://user-images.githubusercontent.com/2746074/39444168-ac31c54c-4c6b-11e8-8398-cefd17919b1f.png)

We should at least make those vertical lines not selectable.",timabbott,b'area: stream settings bug',2018-04-30T18:44:10Z,2018-05-03T04:08:43Z
9273,stream settings: Fix quick bugs in stream subscription settings.,"This fixes issue #9028, #9029 and one bug which I found while testing this changes.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Preview button on private stream creation:
![prieviewbutton](https://user-images.githubusercontent.com/25907420/39430250-f5757ff2-4caa-11e8-8342-a3b84cb8b82b.gif)

Unsubscribing themselves from stream:
![scrollbarunsubscribethemselves](https://user-images.githubusercontent.com/25907420/39430247-f514b1ae-4caa-11e8-9d6b-49ec8b1704ec.gif)

To reproduce the last bug:
* Create private stream to only one admin is subscribed
* Unsubscribe admin from created private stream
The stream page will not get updated and it still shows admin in subscriber list.",YJDave,b'area: stream settings bug size: M',2018-04-30T13:51:08Z,2018-08-08T07:51:50Z
9269,sidebars: Search box hides on reload.,"There's an issue with both the left and right sidebar search states. Steps to reproduce:

1. `q` (search streams) -> `test` (write 'test' to the search box)
2. `w` (search streams) -> `test` (write 'test' to the search box)
3. Reload the page. The sidebars state is preserved, but the search box is hidden.

Edit: expected behavior is to show all the users but some caching on Firefox is preserving the state of the hidden search input, which needs to be cleared. /edit.


![image](https://user-images.githubusercontent.com/8033238/39421652-95527058-4c87-11e8-93e0-a4eab0bdb7dd.png)

@zulipbot label ""bug""
@zulipbot label ""area: right-sidebar""
@zulipbot label ""area: left-sidebar""
@zulipbot label ""help wanted""
",aero31aero,b'area: left-sidebar area: right-sidebar bug help wanted',2018-04-30T09:34:38Z,2018-05-01T16:24:42Z
9256,org settings: Handle floating point durations better.,"Fixes: #9253.

Tests: Added node tests.
(Casper may fail, I'll fix them once below points are addressed)

Needed feedback about:
* Up to what precision we want to handle floating point value as there are various problems in converting minutes in decimal to seconds and vice-versa beyond a single floating point. Currently, I've limited it to one floating point.
* I guess there should be a minimum value below which we don't need to set edit limit like don't allow value set below 10 sec and maybe we should enforce this in backend and frontend both, thoughts? 
* There is a small bug if the limit is set to <0.05 it get converted to 0.0 and automatically set to ""Any time"". This bug will get fixed once above point is addressed. 
* How we want to show pure integer time: 100 or 100.0

@timabbott @rishig  FYI.",shubhamdhama,b'area: settings (admin/org) bug size: L',2018-04-28T13:53:49Z,2018-04-28T17:17:49Z
9253,message editing and deletion settings: Handle floating point durations better,"Currently, if you enter `0.1` minutes as your custom time limit with either the message editing or deletion organization settings time limit dropdown, something totally broken ends up happening (it sets things back to ""any time"").   ",timabbott,b'area: settings (admin/org) bug',2018-04-28T02:20:31Z,2018-04-28T16:40:17Z
9251,Make our `text_output` markdown integration do something reasonable with block quotes,"Right now, if a user sends a block-quoted message to another user and it ends up in a push notification, one can end up with what would read in the webapp as
```
> something
your reply
```

looking like ""something\n your reply"" in the `text_output`, which is super confusing, since it makes it look like you said ""something"", when actually you're replying to it.

What we should do is translate the HTML `<blockquote>something</blockquote>` tag that we generate in Zulip into a `> something\n`, instead of ""something"".  Or if we can't get that working in a way that feels good because of issues around newlines, just hide the `<blockquote>` content entirely.

(This is the correct way to fix https://github.com/zulip/zulip-mobile/issues/2419).

@HarshitOnGitHub this seems like a good quick issue for you, given your expertise with that feature :).",timabbott,b'area: notifications (messages) bug',2018-04-27T21:35:20Z,2018-05-02T16:00:20Z
9249,compose_actions.js: Scroll if message is short than viewport.,"
![scrolling-wrt-viewport-height](https://user-images.githubusercontent.com/22795943/39382576-90e8c25c-4a83-11e8-8c4d-2ab03b1c22ca.gif)
Resolves #8941 

Earlier, the messages scrolled on click only if it was long enough but now I've changed it to scroll for the message whose height < height of the viewport. Upon clicking, the message scrolls to the bottom of the screen.

Please see the above gif for further reference.",shikharvaish28,b'area: message view bug size: S',2018-04-27T20:01:06Z,2018-04-27T21:21:52Z
9248,Message View: Started scroll for every message and not only for long messages ,"Resolves #8941 

Earlier, the messages scrolled on click only if it was long enough but now I've changed it to scroll for the message whose height < height of the viewport. Upon clicking, the message scrolls to the bottom of the screen. 

![scrolling-wrt-viewport-height](https://user-images.githubusercontent.com/22795943/39373685-04701022-4a66-11e8-8a9d-3a7ce09521f4.gif)




Please see the above gif for further reference.",shikharvaish28,b'area: message view bug size: XL',2018-04-27T16:28:35Z,2018-04-27T19:45:19Z
9241,messages still appear in stream after having their topic changed to a muted topic.,"after changing the topic of a message, in the view source/edit message view, to a topic that has already been muted the message will still appear in the stream.

![muted topic](https://user-images.githubusercontent.com/35310981/39334538-a9c704b0-4974-11e8-94d1-6f490254cf44.JPG)

",Jmullan6,b'area: message view bug',2018-04-26T22:26:10Z,2018-04-27T16:04:01Z
9240,Fix 500 when trying to change your email to a disposable email,"This validation error should be being reformatted as a JsonableError for the ""email change"" UI:

```
  File ""./zerver/decorator.py"", line 605, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 587, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 747, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 423, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 174, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/user_settings.py"", line 105, in json_change_settings
    error, skipped = validate_email(user_profile, new_email)
  File ""./zerver/lib/actions.py"", line 4113, in validate_email
    email_allowed_for_realm(email, user_profile.realm)
  File ""./zerver/models.py"", line 398, in email_allowed_for_realm
    raise DisposableEmailError
zerver.models.DisposableEmailError
```

Tagging as a priority since this is part of our goal to get back to 0 known 500 errors in Zulip.

@hackerkid this is probably a good task for you.",timabbott,b'area: settings (user) bug priority: high',2018-04-26T16:42:57Z,2018-05-04T17:55:40Z
9239,outgoing webhooks: Add support for PMs in Slack-format webhook,"I don't have a precise reproducer, but I suspect if you create an outgoing webhook bot with the Slack format and then send that bot a PM, you get this exception:

```
  File ""/home/zulip/deployments/2018-04-06-05-05-13/zerver/lib/outgoing_webhook.py"", line 79, in process_event
    raise NotImplementedError(""Private messaging service not supported."")
NotImplementedError: Private messaging service not supported.
```

We should implement that feature, since it should be pretty simple.

Tagging as a priority as part of our goal to get back to 0 known 500 errors in Zulip.",timabbott,b'area: bots bug priority: high',2018-04-26T16:39:01Z,2018-08-10T00:46:20Z
9237,"org settings: Fix word-wrapping CSS in ""users"" section.","Fixes: #9225.
I think this is the desirable behavior (here is `IagoIago...` is a very large name and only it gets split)
![users](https://user-images.githubusercontent.com/22238472/39312812-08db6d56-498e-11e8-9eed-aefacb9cdc8a.png)
",shubhamdhama,b'area: settings (admin/org) bug size: XS',2018-04-26T14:43:47Z,2018-04-26T15:34:55Z
9236,settings: Make bot-settings tabs look better in dark mode.,"Fixes: #9230.
Here are two prototype one with the complete white border and one with a blue border for active tab. Which one looks better?
![whitebackground](https://user-images.githubusercontent.com/22238472/39298825-ded80c0e-4964-11e8-8a0c-360cdf6f1ab0.gif)
![blueborder](https://user-images.githubusercontent.com/22238472/39298826-df3ad564-4964-11e8-8a47-19db599ca48a.gif)
Currently, PR has the ""complete white border"" changes.",shubhamdhama,b'area: settings (user) bug size: S',2018-04-26T09:52:13Z,2018-04-26T16:01:12Z
9235,settings: Fix escaping of HTML in checkbox labels.,"Some labels like one for `translate_emoticons` which contains HTML
get escaped because of use of `{{ label }}` syntax, which escapes
the string for XSS security purpose but since labels aren't any
threat to any such security cases, we can use triple curly brackets
`{{{ label }}}` syntax.

Fixes: #9231.
![fixed](https://user-images.githubusercontent.com/22238472/39288676-95c1f43a-4946-11e8-84ca-f13504c0bc53.png)
",shubhamdhama,b'area: emoji area: settings (user) bug size: XS',2018-04-26T06:10:38Z,2018-04-26T07:36:36Z
9233,test-backend argument parsing doesn't work with options at end,"I've been finding this pretty annoying recently:

```
(zulip-py3-venv) tabbott@zaset:~/zulip$ test-backend test_decorators --coverage
-- Running tests in serial mode.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/tools/test-backend"", line 366, in <module>
    failures, failed_tests = test_runner.run_tests(suites, full_suite=full_suite)
  File ""/home/tabbott/zulip/zerver/lib/test_runner.py"", line 459, in run_tests
    self.test_imports(test_labels, suite)
  File ""/home/tabbott/zulip/zerver/lib/test_runner.py"", line 435, in test_imports
    check_import_error(test_name)
  File ""/home/tabbott/zulip/zerver/lib/test_runner.py"", line 362, in check_import_error
    raise exc from exc  # Disable exception chaining in Python 3.
  File ""/home/tabbott/zulip/zerver/lib/test_runner.py"", line 360, in check_import_error
    __import__(test_name)
ImportError: No module named '--coverage'
```",timabbott,b'area: testing-infrastructure bug',2018-04-26T04:58:38Z,2018-05-18T21:07:23Z
9231,Buggy HTML escaping of description for emoticons setting,"The code block is just showing the HTML text for the code block, not an actual code block:

![](https://d2mxuefqeaa7sj.cloudfront.net/s_FD7ABAEEEC5705F9B28D4931C9D262373E329F43B2642B8C4C4422EE0A5A8DA6_1524681884438_image.png)
",timabbott,b'area: emoji area: settings (user) bug',2018-04-25T23:40:47Z,2018-04-26T07:39:36Z
9230,"User-level ""bot settings"" page looks a bit off in night mode","This white stands out strongly (and the blue text is hard to read), and then some weird flicker happens when you hover your mouse over the other panels.

![](https://d2mxuefqeaa7sj.cloudfront.net/s_FD7ABAEEEC5705F9B28D4931C9D262373E329F43B2642B8C4C4422EE0A5A8DA6_1524698198200_image.png)
",timabbott,b'area: settings (user) bug',2018-04-25T23:38:57Z,2019-07-23T14:21:02Z
9225,"Fix word-wrapping CSS for admin ""User settings"" page","If you have long names, they split words awkwardly:

![](https://d2mxuefqeaa7sj.cloudfront.net/s_FD7ABAEEEC5705F9B28D4931C9D262373E329F43B2642B8C4C4422EE0A5A8DA6_1524698000895_image.png)

This should be a pretty simple CSS fix.",timabbott,b'area: settings (admin/org) bug',2018-04-25T23:32:28Z,2018-04-26T15:37:48Z
9224,"Fix glitch in ""Authentication methods"" settings","This ""save changes"" button feels misplaced:

![](https://d2mxuefqeaa7sj.cloudfront.net/s_FD7ABAEEEC5705F9B28D4931C9D262373E329F43B2642B8C4C4422EE0A5A8DA6_1524697947588_image.png)

We could probably just convert this widget to use our normal ""administrative checkbox"" system and get rid of the ""Save changes"" button entirely...",timabbott,b'area: settings (admin/org) bug',2018-04-25T23:31:38Z,2018-05-22T21:10:38Z
9217,slack import fails with TypeError: 'NoneType' object is not subscriptable,"Running
 ../manage.py convert_slack_data RemObjects\ Software\ Slack\ export\ Apr\ 25\ 2018\(1\).zip --token *** --output test_import

fails with:

2018-04-25 10:32:45.843 INFO [] ######### IMPORTING MESSAGES STARTED #########

Traceback (most recent call last):
  File ""../manage.py"", line 25, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zerver/management/commands/convert_slack_data.py"", line 58, in handle
    do_convert_data(path, output_dir, token, threads=num_threads)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zerver/lib/slack_data_to_zulip_data.py"", line 872, in do_convert_data
    realm, realm['zerver_realmemoji'], domain_name)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zerver/lib/slack_data_to_zulip_data.py"", line 581, in convert_slack_workspace_messages
    domain_name)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zerver/lib/slack_data_to_zulip_data.py"", line 637, in channel_message_to_zerver_message
    user = get_message_sending_user(message)
  File ""/home/zulip/deployments/2018-04-18-08-04-12/zerver/lib/slack_data_to_zulip_data.py"", line 813, in get_message_sending_user
    user = message.get('user', message['file']['user'])
TypeError: 'NoneType' object is not subscriptable

Obviously I don't want to post the full import here, what can I do to narrow this down?",carlokok,b'area: export/import bug',2018-04-25T10:57:00Z,2018-05-14T13:23:27Z
9208,emoji: Update emoji-datasource-* packages.,"This PR updates the emoji datasource packages to the latest version.

**Testing Plan:** 
1: Re-provision.
2: Open emoji picker and see all the changes documented in the commit message are indeed there and there no other changes which aren't documented.

@timabbott FYI. :)

While working on this I realized that we seriously need to complete our migration to iamcal datasource packages as it is unnecessarily complicating the emoji infra code.(PR #7329)
This PR also made me think that we should start working on adding a test suite for emoji infra itself which would make this process of package updation a little bit easy.",HarshitOnGitHub,b'area: emoji bug size: XL',2018-04-24T16:40:06Z,2018-07-23T15:04:47Z
9207,Fix email mirror handling of emails without a subject line,"I saw this exception in production:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/worker/queue_processors.py"", line 132, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/worker/queue_processors.py"", line 423, in consume
    rcpt_to=event[""rcpt_to""], pre_checked=True)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/lib/email_mirror.py"", line 339, in process_message
    process_stream_message(to, subject, message, debug_info)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/lib/email_mirror.py"", line 307, in process_stream_message
    send_zulip(settings.EMAIL_GATEWAY_BOT, stream, subject, body)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/lib/email_mirror.py"", line 200, in send_zulip
    email_gateway=True)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/lib/actions.py"", line 2021, in internal_send_message
    realm=realm)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/lib/addressee.py"", line 105, in legacy_build
    return Addressee.for_stream(stream_name, topic_name)
  File ""/home/zulip/deployments/2018-04-23-18-38-07/zerver/lib/addressee.py"", line 118, in for_stream
    raise JsonableError(_(""Topic can't be empty""))
zerver.lib.exceptions.JsonableError: Topic can't be empty
```

It's pretty clear this is caused by an email arriving at the email mirror without a subject line; we should be setting the topic to `(no topic)` in that case, not throwing an exception.",timabbott,b'area: notifications (messages) bug priority: high',2018-04-24T16:14:11Z,2018-04-26T17:25:24Z
9201,Favicon is now covered by Chrome notification dot,"A recent version of Chrome added a blue dot on the favicon of a tab that has updates. (As far as I know there's no way to disable to blue dot.) The dot covers the unread count on the zulip tab favicon. Can we move the unread count to a position where it's visible?
One:
![image](https://user-images.githubusercontent.com/1857780/39161208-77fc2a02-4724-11e8-9b9f-498946cf90d7.png)
Six:
![image](https://user-images.githubusercontent.com/1857780/39161275-c607a53c-4724-11e8-8d0b-efde7a1cf7d9.png)
",akaptur,b'area: browser-support area: notifications (messages) bug priority: high',2018-04-24T01:33:57Z,2018-08-16T07:09:31Z
9195,Botton of /features page doesn't look right with really wide screens,"![image](https://user-images.githubusercontent.com/2746074/39154958-1f4b5712-4705-11e8-8214-649320968fc5.png)

@synicalsyntax do you want to fix this one?  We should have the column width the same for those bottom 2",timabbott,b'area: portico bug',2018-04-23T21:47:02Z,2018-06-13T01:39:42Z
9191,unread: Fix messages that cannot be marked as read in narrows.,"If you visit a narrow that has unread messages on it that aren't part
of the home view (e.g. in a muted stream), then we were never calling
`message_util.do_unread_count_updates`, and more importantly,
`unread.process_loaded_messages` on those messages.  As a result, they
would be unread, and moving the cursor over them would never mark
those messages as read (which was visible through the little green
marker never disappearing).

I can't tell whether this fixes #8042 and/or #8236; neither of them
exactly fits the description of this issue unless the PM threads in
question were muted or something, but this does feel related.
",timabbott,b'area: left-sidebar bug priority: high size: S',2018-04-23T18:31:42Z,2018-04-23T23:32:48Z
9177,doc tests: Add portico pages to tools/test-help-documentation.,"Fixes #9117.

@timabbott: FYI! I tested this thoroughly by placing broken links inside all of the extra pages I added! Should be good to go! :)",eeshangarg,b'area: tooling bug size: S',2018-04-21T18:14:23Z,2018-04-22T04:52:58Z
9175,frontend: Message text & Label overlap in message history dialog.,"<img width=""560"" alt=""screen shot 2018-04-21 at 10 00 01 am"" src=""https://user-images.githubusercontent.com/18511177/39080403-21a24932-454b-11e8-9652-5808d2ed65ec.png"">


message link: https://chat.zulip.org/#narrow/stream/48-mobile/subject/android/near/567505",jainkuniya,b'area: message-editing bug',2018-04-21T04:33:07Z,2018-06-08T14:49:30Z
9174,Fix issues with newlines while copy-pasting from html,"Fixes #8963

The two main offenders were:
* At the beginning and the end caused by extra divs/spans
* Around lists.

I've added workarounds for both those cases.Worked fine on initial testing while pasting from Github/Dropbox Paper.",sampritipanda,b'area: compose bug size: S',2018-04-21T00:00:07Z,2018-04-24T15:29:03Z
9164,analytics: Eliminate slider-focused text selection in Firefox.,"Fixes #9151.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->



**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
[![https://gyazo.com/739f68f11052169ff2c566f28e9e5994](https://i.gyazo.com/739f68f11052169ff2c566f28e9e5994.gif)](https://gyazo.com/739f68f11052169ff2c566f28e9e5994)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",synicalsyntax,b'area: analytics area: portico bug size: S',2018-04-20T16:06:30Z,2018-04-20T16:50:44Z
9160, settings: Make saving spinner visible in night mode.,"settings: Make saving spinner visible in night mode.
Fixes: #9154.

Here I've added another unrelated commit:
org settings: Refactor code for get_property_value.
@timabbott FYI.
![lightmode](https://user-images.githubusercontent.com/22238472/39030799-f68d0b98-4481-11e8-94a6-02b6661909aa.gif)
![darkmode](https://user-images.githubusercontent.com/22238472/39030800-f6d4025a-4481-11e8-8e33-49df7d5dc25e.gif)
",shubhamdhama,b'area: settings (admin/org) bug size: S',2018-04-20T04:15:01Z,2018-04-20T04:49:13Z
9158,compose: Refactor compose box from `<table>` to `<div>` structure.,"`<td>` elements are fixed-width, so we refactor the entire
`<table>` structure for responsive design.

![screenshot at apr 19 16-58-56](https://user-images.githubusercontent.com/15116870/39024008-fdb9f8e8-43f2-11e8-8c17-50a0cc291ce7.png)


Fixes #9152.
",synicalsyntax,b'area: compose area: i18n bug size: XS',2018-04-19T23:59:19Z,2018-04-20T06:05:02Z
9154,Settings saving spinner invisible in night mode (and looks bad in light mode),"I was seeing the loading spinner state after clicking ""save"" had the spinner missing, and realized the problem was that it's invisible in night mode.

@shubhamdhama FYI.",timabbott,b'area: settings (admin/org) bug',2018-04-19T18:31:56Z,2018-04-20T04:53:01Z
9152,Fix styling for `To:` widget being fixed in size,"![image](https://user-images.githubusercontent.com/2746074/39006160-1b96a96a-43b7-11e8-9566-5f325336884a.png)

@synicalsyntax can you take fixing this one?",timabbott,b'area: compose area: i18n bug',2018-04-19T16:51:07Z,2018-04-20T05:55:21Z
9151,stats: Sliding results in selecting text.,"On the stats page, if you drag the slider, the text gets selected as well.

![image](https://user-images.githubusercontent.com/8033238/39005324-8e047246-441d-11e8-8dc3-cc71994c5a48.png)

On: Firefox 59, Ubuntu 16.04

@zulipbot label ""area: portico""
@zulipbot label ""area: analytics""",aero31aero,b'area: analytics area: portico bug',2018-04-19T16:39:50Z,2018-04-20T16:49:21Z
9144,narrow: Fix narrowing behavior when loading a new tab.,"In the very early days of Zulip, we didn't have unread counts; just
the pointer, and the correct behavior when opening a new tab was to
place you near the pointer.  That doesn't make any sense now that we
do have unread counts, and this corner case has been a wart for a long
time.

This commit does the main behavior change here.  However, there's a
bug we need to fix, where we might end up trying to pre-render a view
of the narrow based on the `all_msg_list` data before `all_msg_list`
is caught up).  We need to fix that bug before we can merge this; it
should be possible to determine that using `FetchStatus` on
`all_msg_list`, or with better performance by using the `unread_msgs`
structure to determine whether the message we should be selecting is
present locally.

Fixes #789.

----------------------------

For testing this and working on the outstanding bug, the test procedure is this:
* `manage.py populate_db -n2000` 
* `manage.py mark_all_messages_unread`
* Login as Iago, pick a stream/topic pair, narrow and hit end in that narrow to mark as read.
* Reload.

Before this change, you'd be placed at the first message to that topic ever.  With this change, you get placed somewhere random that appears to be the bottom, and then a fetch from the server adds a few more messages below where you're placed.  Correct would be to be placed at the very bottom.

I made some notes on fixing the remaining issue above.  I believe what we need to do is as follows:
* For the on-reload case, first (correct but potentially not optimized version), just unconditionally do a fetch from the server when doing rendering.  I have an idea for how to do this that I'll try in a commit after getting home.  
",timabbott,b'area: message view bug size: S',2018-04-19T00:31:50Z,2018-04-23T22:29:19Z
9143,Buttons to add emoji/file/call to a message have no label,"The buttons to add something to a message have no label and might be unusable for screenreader users. For example:

`<a class=""message-control-button icon-vector-paper-clip"" id=""attach_files"" href=""#"" title=""Attach files""></a>`

Normally, the title might be used as an accessible label if there is no link text. However, since the icon seems to be displayed using some unicode character, it counts as the link content and the title is discarded. We could solve this by adding an aria-label with the same content as the title. The only problem with this approach is that the label might be read twice if users have a screenreader that reads title attributes for links.

Besides the label, I think that a button element should be used here instead. The use of `href=#` usually is a red flag that a button might be more appropriate. This is important for example when using speech recognition and giving a command like ""click button video call"". If the button is not a button, the speech recognition software will not be able to find this.",bramd,b'accessibility bug',2018-04-18T23:01:02Z,2020-08-14T22:49:56Z
9142,portico: Minor UI fix in plans page.,"Renamed `zulip-cloud` class to `responsive-title` so that we can re-use this class in other sections also.

Fixes: #9133.

Before - 

![image](https://user-images.githubusercontent.com/2263909/38959642-058f1ac2-437f-11e8-92a7-d9e871eb0c85.png)


After - 

![image](https://user-images.githubusercontent.com/2263909/38959623-f38b75f0-437e-11e8-9ab3-90d1f0bdd195.png)



",akashnimare,b'area: portico bug priority: high size: S',2018-04-18T21:37:22Z,2018-04-18T23:39:56Z
9133,"plans: ""Zulip On-Premise"" invisible in 2x2 responsive shape","In the 2x2 responsive shape, the heading for the second 2 items of ""Zulip On-Premise"" is invisible.

![image](https://user-images.githubusercontent.com/2746074/38949194-89901378-42f6-11e8-97ae-4e9f8349a177.png)

This should be an easy fix -- in that responsive state, we should make the font black, not white.",timabbott,b'area: portico bug priority: high',2018-04-18T17:53:15Z,2018-04-18T23:42:55Z
9130,slack importer: Ensure zerver_realm_skeleton is present in prod system.,"Fix #9123

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Untested

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",rht,b'area: export/import bug priority: blocker size: XS',2018-04-18T17:15:32Z,2018-05-14T13:23:27Z
9129,compose: Eliminate empty input pill placeholder.,"Fixes #9128.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

![screenshot at apr 18 10-06-28](https://user-images.githubusercontent.com/15116870/38947099-5963b5fc-42f0-11e8-9359-bbf4f0d525bd.png)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",synicalsyntax,b'area: compose bug priority: blocker size: S',2018-04-18T17:07:57Z,2018-04-19T17:12:22Z
9128,Fix buggy click area for input pills ,"As reported in https://github.com/zulip/zulip/issues/8775#issuecomment-382424867, we have a bug in the input pill area:

![image](https://user-images.githubusercontent.com/12458563/38941107-0d06586c-4341-11e8-8730-621a8080d5a4.png) ![image](https://user-images.githubusercontent.com/12458563/38941147-2d879ac4-4341-11e8-91e2-6c74335cbfc1.png)

I think that this is not a good design, as it requires the user to click on the very small area (
![image](https://user-images.githubusercontent.com/12458563/38941252-62e1c33e-4341-11e8-96a8-3e258b552f2d.png)) to be able to add a user. Shouldn't the bar be extended to the right?

",timabbott,b'area: compose bug priority: blocker',2018-04-18T16:52:21Z,2018-04-19T17:04:55Z
9127,Can't create account or login on chat.zulip.org with GitHub,"I found out about the demo server and I wanted to test it. Unfortunately using this GitHub account for authentication doesn't seem to work.

These are the steps I have taken:

 - Went to https://chat.zulip.org/register/
 - Chose **Sign up with GitHub**
 - Approved **Authorize zulip**
 - Got redirected to ""Sign up for Zulip"" (`https://chat.zulip.org/complete/github/?redirect_state=...`)
 - Went to https://chat.zulip.org/ and got redirected to https://chat.zulip.org/login/
 - Chose **Login with GitHub**
 - Got the error message _""Zulip account not found.""_


(reporting here as suggested on [HN][1])

[1]: https://news.ycombinator.com/item?id=16867395",ciupicri,b'area: authentication bug priority: blocker',2018-04-18T16:41:24Z,2018-07-03T18:49:08Z
9123,Import data from Slack - FileNotFoundError: [Errno 2],"Zulip installation was very smooth but trying to import data from slack I'm getting the following error:

```bash
zulip@team:/etc/zulip$ /home/zulip/deployments/current/manage.py convert_slack_data slack_data.zip --token xxxxxxxxx --output converted_slack_data
Converting Data ...
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 25, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 364, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py"", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 283, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py"", line 330, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zerver/management/commands/convert_slack_data.py"", line 58, in handle
    do_convert_data(path, output_dir, token, threads=num_threads)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zerver/lib/slack_data_to_zulip_data.py"", line 868, in do_convert_data
    slack_data_dir, custom_emoji_list)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zerver/lib/slack_data_to_zulip_data.py"", line 57, in slack_workspace_to_realm
    zerver_realm = build_zerver_realm(fixtures_path, realm_id, realm_subdomain, NOW)
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zerver/lib/slack_data_to_zulip_data.py"", line 105, in build_zerver_realm
    zerver_realm_skeleton = get_data_file(fixtures_path + 'zerver_realm_skeleton.json')
  File ""/home/zulip/deployments/2018-04-18-11-15-51/zerver/lib/slack_data_to_zulip_data.py"", line 1036, in get_data_file
    data = json.load(open(path))
FileNotFoundError: [Errno 2] No such file or directory: '/home/zulip/deployments/2018-04-18-11-15-51/zerver/lib/../fixtures/zerver_realm_skeleton.json
```",mangandini,b'area: export/import bug priority: blocker',2018-04-18T11:55:43Z,2019-07-23T14:21:46Z
9119,bugdown: Add {settings_tab|my-setting} macro,"#8889

Related to https://github.com/zulip/zulip/pull/9105 

@adnrs96 Can you check this to make sure I'm on the right path?",Lyla-Fischer,b'size: XL',2018-04-18T02:34:55Z,2018-04-25T23:00:39Z
9117,Add more portico pages to tools/test-help-documentation,"Following d340c8d46df400b7d10fd0d2819142d4592cea36, I'd love to extend `tools/test-help-documentation` to also check the major portico pages explaining Zulip in checking for broken links.",timabbott,b'area: tooling bug help wanted',2018-04-17T20:39:56Z,2018-04-22T04:52:54Z
9111,Fix screenshots on /api/api-keys,"These show a super-ancient version of the UI:

![image](https://user-images.githubusercontent.com/2746074/38837624-7bfda3e4-4187-11e8-8cec-38089e69a166.png)

(There's probably other cleanup that would be valuable on this page)

We should make sure the screenshots show sensible examples (e.g. a ""GitHub Bot"" with the GitHub logo as its avatar)",timabbott,b'area: api area: documentation (api and integrations) bug help wanted priority: high',2018-04-16T22:05:04Z,2018-05-14T20:01:49Z
9096,compose: Pills broken when they have to line-wrap.,"Start a private message, and add a bunch of people until you reach the end of the line. Add one more. The pills should line wrap as units, but instead each pill independently line-wraps.

I feel like I've seen this work correctly before, so I think this is probably a regression somewhere?",rishig,b'area: compose bug priority: blocker',2018-04-15T05:43:18Z,2018-04-16T16:50:03Z
9094,compose: Private stream lock icon offset in compose.,"To reproduce:
* Create a private stream
* Compose to it

The lock icon is vertically off from the text.
For the correct position, send the message, and see where the icon falls when it is in the recipient bar. ",rishig,b'area: compose bug help wanted priority: blocker',2018-04-14T19:01:23Z,2018-04-16T16:50:04Z
9091,components: Simplify toggle component.,"We now make sure our toggler exists before invoking its `goto`
method.  Usually a toggler exists pretty early during app
startup, but _setup_info_overlay is wrapped in i18n.ensure_i18n,
which asynchronously fetches translation data.

This commit also simplifies how we find the toggler, by just
storing it in the module where it gets created and consumed.

Fixes #9085.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",showell,b'area: message view bug size: XL',2018-04-13T21:03:39Z,2018-04-20T20:49:16Z
9085,Exception accessing informational overlays,"We've started seeing this exception in production:

```
Message:
Cannot read property 'goto' of undefined

Stacktrace:
TypeError: Cannot read property 'goto' of undefined
    at Object.show (https://chat.zulip.org/static/min/app.c6aec61aeec1.js:1957:235)
       = static/js/info_overlay.js line 82 column 9

    at HTMLAnchorElement.<anonymous> (https://chat.zulip.org/static/min/app.c6aec61aeec1.js:1984:167)
       = static/js/click_handlers.js line 461 column 9

```

@showell this may be a good one for you to investigate, given your recent work on that component.

(I'm guessing it's some sort of initialization ordering problem)",timabbott,b'area: message view bug',2018-04-13T17:17:10Z,2018-04-14T18:44:04Z
9079,Subscription: Fixed subscription bug.,"![issue_9034](https://user-images.githubusercontent.com/15901908/38712259-13037a5a-3ed3-11e8-9192-f9ee239b22ad.gif)
Admin can now unsubscribe others from private stream after stream is renamed.

Fixes #9034.
",zy964c,b'area: stream settings bug size: S',2018-04-13T01:28:40Z,2018-04-20T05:02:33Z
9072,"compose: ""New topic"" should change to ""New stream message"" when in PMs.","The ""New topic"" text should change to ""New stream message"" when you are in a PM narrow. 
* If you're in ""Private messages"" or a PM thread with someone, that should definitely trigger the change
* If you're in a search that's limited by is:private, pm-with:, and whatever we use for group pms, that would ideally also trigger the change.

If the second bullet is hard, just the first is sufficient for a V1.",rishig,b'area: compose bug help wanted',2018-04-12T16:30:48Z,2019-07-23T14:21:46Z
9070,Messages missing in private chat,"I'd like to report a bug I've seen multiple times where messages aren't being loaded in the private messages view. I have a chat session with 2 people. I also have an independent chat going in the same view with one of the members. Since this could potentially be a pretty important bug I'd like to report it even though I don't have a deterministic way of reproducing the bug. 

Description of how I've seen this bug. It appears on loading the site into the private messages view. With the thread in question selected. What I see is that a large section of the latest messages between me and the chat member are missing and instead, the latest message is actually from an older date.

Strangely though, when the page is refreshed all the messages seem to load. I've seen this a few times and I saw it today as well. I'm currently on a very slow connection somewhere between 3 and 4G. Thats the best I can do currently to help reproduce the bug. Will update this description as I have more details if I see it again.",armaanahluwalia,b'area: message view bug',2018-04-12T15:57:36Z,2018-04-23T04:36:39Z
9068,Multiple bugs in the progress bar,"This is a follow up for #8863. I see few issues with the progress bar -
 - [x] If you cancel an upload and then try to upload a new file, the previous progress bar is not removed -

<img src=""https://d2ffutrenqvap3.cloudfront.net/items/202E2Q4629172h252b2r/Screen%20Recording%202018-04-12%20at%2003.55%20PM.gif?v=32224dd3""/>
 
We might need to call `maybe_hide_upload_status()` if upload error occurs. 

- [ ] In case of multiple uploads should we show the progress bar for each file? Currently the progress bar gets confused if you paste multiple files -

![image](https://user-images.githubusercontent.com/2263909/38672315-6e81b602-3e6b-11e8-8f07-9d15a2ab6b6f.png)


FYI, @timabbott, @skunkmb.  

**Note** - to reproduce this issue, I would suggest using ""Slow 3G"" network -

![image](https://user-images.githubusercontent.com/2263909/38672193-161e6cc6-3e6b-11e8-89d6-09c03393011b.png)
",akashnimare,b'area: compose bug',2018-04-12T10:32:35Z,2018-05-02T19:39:21Z
9043,left sidebar: Scroll position incorrect on reload if desired stream is off-screen.,"I think this reproduces:
* Add 2.5 screenfuls worth of streams
* go to a topic narrow of a stream, like 1.5 screenfuls down 
* Ctrl-R to reload.

The expected behavior is that the stream stays on screen in the left sidebar. Instead, the scroll position is off (too far down). 

Let me know if that doesn't make sense.
",rishig,b'area: left-sidebar bug help wanted priority: high',2018-04-10T05:25:06Z,2018-07-23T17:34:58Z
9039,Scroll bar displaying in a broken way in Firefox on Mac,"A user reported this happening in Firefox but not other browsers. The user saw it, and I've reproduced it, in Firefox on macOS.

To reproduce:
* Open up the streams modal, with the gear next to ""Streams"" in the left sidebar.
* Note the scrollbar in the list of streams in the left pane of the modal. (Resize the window if necessary to cause a scrollbar to appear.)
* Scroll that pane. Either swiping on a trackpad, or clicking on the scrollbar itself and dragging, reproduce the issue for me.
* The scrollbar behaves very strangely -- typically it shrinks first at one end, without extending at the other, and also at the end where it's shrinking the rounded end gets replaced by a sharp cap. The effect is very conspicuous.

I tried reproducing this also in the list of streams in the left sidebar itself, and the problem *doesn't* seem to appear there. So that might be a clue.
",gnprice,b'area: stream settings bug help wanted',2018-04-09T19:41:43Z,2019-05-21T04:06:20Z
9034,subscription: Admin can't unsubscribe others from private stream after stream is renamed.,"To reproduce the issue:
* Create private stream without Iago subscribed to it
* Rename this stream
* Try to unsubscribe others from stream

",YJDave,b'area: stream settings bug',2018-04-09T10:18:50Z,2018-04-20T05:06:07Z
9031,streams: Stream doesn't get updated in other clients when stream's type is changed. ,"When stream type(private/public) is changed, we don't get update on other browser. Though if we change any other property of stream(stream name or description) it's get updated. 

To reproduce the issue:
* Login with Cordelia in one tab and Iago in another
* Iago: Create public stream both subscribed to
* Cordelia: Open stream setting page of newly created stream
* Iago: Make created public stream to private

This stream isn't get updated in Cordelia's browser. ",YJDave,b'area: stream settings bug',2018-04-09T09:16:07Z,2019-06-08T11:40:42Z
9029,subscription: Scrollbar scroll to bottom when user unsubscribe themselves from stream. ,"When user unsubscribe themselves from stream subscriber list(user must be realm admin here, then only user can unsubscribe other user from stream subscribers list), scrollbar scroll to bottom. 

![unsubscribeyourself](https://user-images.githubusercontent.com/25907420/38479368-536c0e26-3bdc-11e8-8fe4-ad0b791a76e6.gif)
",YJDave,b'area: stream settings bug',2018-04-09T04:27:08Z,2018-04-30T18:20:03Z
9028,create stream: Preview button doesn't appear when newly private stream is created. ,"When user create private stream a preview button `View stream` doesn't appear, it should. 

![createprivatestream](https://user-images.githubusercontent.com/25907420/38479235-50d96402-3bdb-11e8-8a93-ce32d837ebfc.gif)
",YJDave,b'area: stream settings bug',2018-04-09T04:19:50Z,2018-04-30T18:20:03Z
9025,#3938 Show default cursor inside message_edit_form,Fixes part of #3938 ,novokrest,b'area: message-editing bug feedback wanted size: XS',2018-04-08T13:54:32Z,2018-04-12T22:09:25Z
9023,Traceback being re-subscrubed to a private stream,"@YJDave here's the reproducer for this traceback:
* Open one browser as Iago.  Create a new private stream (with cordelia subscribed)
* Open another browser as Cordelia, open ""manage streams""
* In Iago browser, unsubscribe and then resubscribe Cordelia from the private stream.

```
Error
    at Object.blueslip_error [as error] (webpack:///./static/js/blueslip.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:399:17)
    at jQuery.fn.init.$.fn.expectOne (http://localhost:9991/static/js/setup.js:62:26)
    at Object.exports.rerender_subscribers_count (http://localhost:9991/static/js/subs.js:163:46)
    at Object.exports.update_settings_for_subscribed (http://localhost:9991/static/js/subs.js:224:17)
    at Object.exports.mark_subscribed (http://localhost:9991/static/js/stream_events.js:111:14)
    at http://localhost:9991/static/js/server_events_dispatch.js:256:35
    at Function._.each._.forEach (webpack:////srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/underscore/underscore.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:153:9)
    at Object.dispatch_normal_event (http://localhost:9991/static/js/server_events_dispatch.js:252:15)
    at dispatch_event (http://localhost:9991/static/js/server_events.js:76:43)
    at http://localhost:9991/static/js/server_events.js:82:13
    at Function._.each._.forEach (webpack:////srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/underscore/underscore.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:153:9)
    at get_events_success (http://localhost:9991/static/js/server_events.js:80:7)
    at success (http://localhost:9991/static/js/server_events.js:174:17)
    at Object.wrapped_success (http://localhost:9991/static/js/channel.js:64:16)
    at Object.blueslip_wrapper [as success] (webpack:///./static/js/blueslip.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:225:25)
    at fire (webpack:////srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/jquery/dist/jquery.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader!/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:3268:31)
    at Object.fireWith [as resolveWith] (webpack:////srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/jquery/dist/jquery.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader!/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:3398:7)
    at done (webpack:////srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/jquery/dist/jquery.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader!/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:9305:14)
    at XMLHttpRequest.eval (webpack:////srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/jquery/dist/jquery.js?/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader!/srv/zulip-npm-cache/37dc57eb8136a75521f8425cfd536b90b329ad18/~/source-map-loader:9548:9)
```",timabbott,b'area: stream settings bug',2018-04-08T03:14:11Z,2018-04-09T00:09:18Z
9022,settings: Fix label for message_content_in_email_notifications.,"This was a regression introduced in deduplication of settings
template.
Fixes: #9021.
![notification](https://user-images.githubusercontent.com/22238472/38458752-6800af72-3abf-11e8-899c-4d4290ce19a5.png)
",shubhamdhama,b'area: settings (user) bug priority: blocker size: XS',2018-04-07T18:23:14Z,2018-04-08T03:22:41Z
9021,"settings: ""Include message content in missed message emails"" has wrong label.","https://chat.zulip.org/#narrow/stream/19-documentation/topic/email.20digest.20settings

@shubhamdhama could you take a look to check what happened? ",rishig,b'area: settings (user) bug priority: blocker',2018-04-07T17:03:17Z,2018-04-08T03:25:35Z
9016,Import script: Fix bugs.,Fixes #8949 and #8959,rheaparekh,b'area: export/import bug priority: high size: XS',2018-04-07T14:16:42Z,2018-05-14T13:23:26Z
9012,browser-support: Add startswith and codepointat polyfills.,"Fixes #8944.
~~Adds `pollyfill.js` which will contain imports to all polyfills in
order to avoid adding a new polyfill to each entry point in
webpack.assets.json . This `pollyfill.js` is placed at each entry point
in webpack.assets.json instead.~~

I implemented the code mentioned in the [comment on the original issue](https://github.com/zulip/zulip/issues/8944#issuecomment-379043205) but when writing tests for the same, it did not fulfil many of the test cases used in [a robust implentation of the same]( https://github.com/mathiasbynens/String.prototype.startsWith/blob/master/tests/tests.js)  recommended by the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith#Polyfill).

`pollyfill.js` is added to ~~each~~ entry point in the webpack(refer [here](https://babeljs.io/docs/usage/polyfill/))

I've also added an extra commit adding `string.prototype.codepointat` which was added earlier on in the project but was not added at ~~each~~ entry point. Do let me know if this wasn't needed/should be part of another PR.",shubham-padia,b'area: browser-support bug size: S',2018-04-06T23:23:10Z,2018-09-08T19:31:02Z
8998,stream settings: make deactivate stream handler global,"Configure the click event handler for #do_deactivate_stream_button once
in click_handlers.js to avoid adding click handlers for it more than
once.

Fixes #8979",AasthaGupta,b'area: settings (admin/org) area: stream settings bug size: M',2018-04-06T17:39:02Z,2018-04-06T19:25:15Z
8996,css: User groups UI wobbles when hovering mouse over group name,"Something is wrong with the user groups settings page's hover CSS, such that when you hover of the name of the group, the whole page wobbles a bit.  We should clean that up.",timabbott,b'area: settings (admin/org) area: settings (user) bug',2018-04-06T17:18:44Z,2018-04-08T03:07:25Z
8981,Fix narrow bug.,,showell,b'area: api bug priority: high size: XL',2018-04-05T21:22:54Z,2018-04-06T16:07:59Z
8979,Fix bugs with deactivating a recently renamed stream.,"Here's the original report:
https://chat.zulip.org/#narrow/stream/9-issues/subject/Red.20Error.20Message.20appeared.20when.20deleting.20a.20stream.20(Minor)/near/555251

What I can reproduce is that if you do the following:
* Rename a stream in ""Manage streams""
* Go to ""manage organization"" -> ""Delete streams"" and delete the renamed stream

Then we throw an exception in the development environment with ""Stream deactivation canceled due to non-matching fields."" as the error, coming from this code path:
```
        if ($(""#deactivation_stream_modal .stream_name"").text() !== $("".active_stream_row"").find('.stream_name').text()) {   
            blueslip.error(""Stream deactivation canceled due to non-matching fields."");                                      
            ui_report.message(i18n.t(""Deactivation encountered an error. Please reload and try again.""),                     
               $(""#home-error""), 'alert-error');                                                                             
        }                                                                                                                    
```

The actual bug here is that we should be using stream IDs to refer to streams, not their names.  I think if we fixed that, this whole conditional could go away.

I think `blueslip.error` may be more fatal in development than production (i.e. it may stop execution), which is why I didn't see the `ui_report.message` here.  

The secondary bug is that the `ui_report` call here shouldn't be using the `#home-error` element (see the chat.zulip.org thread for how this looks); it should be displaying in an element in the settings form.  
",timabbott,b'area: settings (admin/org) area: stream settings bug',2018-04-05T20:14:33Z,2018-04-06T19:29:34Z
8978,Fix use of `../../` in  add_api_uri_context,"Currently, we have this logic for producing direct links to the Zulip settings/streams pages:
```
    if html_settings_links:                                                                                                  
        settings_html = '<a href=""../../#settings"">Zulip settings page</a>'                                                  
        subscriptions_html = '<a target=""_blank"" href=""../../#streams"">streams page</a>'                                     
    else:                                                                                                                    
        settings_html = 'Zulip settings page'                                                                                
        subscriptions_html = 'streams page'                                                                                  
```

This is broken, since a `../` based structure is correct for handling i18n (rather than just doing `/#settings`; e.g. for /de/login), but it's only correct on the /integrations pages (Where we have /integrations/doc/github, e.g.), not for use on other pages like `/help/message-a-stream-by-email` with a different number of steps from the root.

We could potentially just move to e.g. `/#settings`; the alternative is to do something that actually looks at the URL structure.  I think I currently favor just moving this to e.g. `/#settings`, since we're not translating /help/ pages anyway.

@eeshangarg thoughts?",timabbott,b'area: documentation (api and integrations) area: documentation (user) bug',2018-04-05T20:06:02Z,2018-04-05T21:49:10Z
8977,Fix styling of OR lines on login pages for non-english,"Apparently our CSS incorrectly sets the width of the bars based on the exact size of ""OR"", so /de/login is pretty broken looking:  

![image](https://user-images.githubusercontent.com/2746074/38388958-ae15251e-38d1-11e8-8f98-2130b67da84c.png)

@synicalsyntax is this something you can fix quickly?",timabbott,b'area: i18n bug priority: blocker',2018-04-05T20:04:03Z,2018-04-05T22:28:10Z
8973,subscription: Add real time sync for user-just-deactivated case.,"Currently, stream subscriptions aren't getting updated without
hard reload when user is deactivated in realm.

Fix this issue by updating stream subscription widgets on user
deactivation event.

Fixes #5623

**Testing Plan:** <!-- How have you tested? -->
Manual testing:
* Open any stream subscription(say X) in incognito window
* Login as realm admin in another window
* Deactivate any user subscribed to stream X
* Check if user is removed from stream subscribers in another window or not
* You can also check in admin window, by opening stream subscribers tab",YJDave,b'area: stream settings bug size: XL',2018-04-05T13:51:26Z,2018-04-09T04:31:25Z
8963,compose: Copy-pasting from html often adds a lot of newlines.,"To reproduce, copy a couple of paragraphs from gmail or dropbox paper, and paste them into the zulip compose box. 

This likely requires some tweak to `toMarkdown` to tell it that we use the nl2br extension (Markdown, as specced, requires a blank line between blocks, which we turned off because it is too hard to do). 

Whlie we're at it we should also check if we're pasting spaces as `&nbsp;` (I think we likely are).

Edit: Now disabled in production so not a blocker; see 7a141e8b08d1a22269897bb164f07aec8fd25f40",rishig,b'area: compose bug',2018-04-04T19:01:17Z,2018-04-24T15:32:34Z
8960,"toggles: Fix ""manage streams"" opening with the data for ""All streams"" but 'Subscribed"" selected","Visiting ""all streams"" via the gear menu shows all streams with ""Subscribed"" selected.

@showell this is likely a regression in your recent work on the toggles component.",timabbott,b'bug priority: blocker',2018-04-04T17:41:05Z,2018-04-04T19:04:57Z
8959,slack import: Generalize fix_slack_upload_links for zulip->zulip import,"Now that the zulip->zulip export/import model renumbers IDs, I think we may need to do the same `SlackImportAttachment` sort of rewriting of message content when importing a Zulip-exported organization as well.  ",timabbott,b'area: export/import bug',2018-04-04T17:03:48Z,2018-05-14T13:23:26Z
8958,get_messages: Fix interaction between include_history and use_first_unread_anchor,"@borisyankov helped me discover a subtle bug where `use_first_unread_anchor` and `include_history` don't interact correctly in a situation where the only messages on a topic were before the current user subscribed to that stream.  Basically if you set things up like this:
* Send a single message to a new topic ""test"" to a public stream Hamlet is not subscribed to (""Denmark"" in this example).
* Subscribe hamlet to that stream
* Do the API query the mobile app does to try to view topic ""test"". (e.g. stream Denmark, topic ""test"", use_first_unread_anchor=True, anchor=0, num_before=25, num_after=25).  Then the API query will return 0 messages (!).  So effectively one sees messages in the webapp, but none appear on mobile.

Here's how this happens:
* Because `use_first_unread_anchor` is True, we end up going down the non-`include_history` code path in `get_messages_backend` and thus joining with UserMessage.  The user has 0 rows for that topic in UserMessage (since they weren't subscribed when the message was sent), so everything from there on returns no messages.

What we should actually be doing is in `get_messages_backend`:
* The main query should just be on `Message` (i.e. we should get rid of the `and not use_first_unread_anchor` part of the `include_history` line)
* In the `use_first_unread_anchor` code block, we should check `include_history`, and if True, we do the join against UserMessage in constructing `first_unread_query`, since we do need that join for getting the first unread message ID (just not for fetching the messages themselves, i.e. no changes to the main query).  This should require a moderately sized refactor.
* The rest of the code path correctly splits the logic based on whether `include_history` is True (i.e. does a UserMessage query to splice in the `flags` data as needed).

@showell since you were just in this code, would you be up for tackling this in the next day or so?  Ideally we'd have a fix in before the 1.8 release (aka Monday).
",timabbott,b'area: api bug priority: high',2018-04-04T16:51:28Z,2018-04-05T21:42:19Z
8953,markdown: Show link href if title is empty.,"Fixes #6221.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Adds three tests for the links system.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",aero31aero,b'area: markdown bug size: L',2018-04-04T08:40:11Z,2019-08-11T13:38:05Z
8952,left sidebar: Non-clickable space between topics.,"There is currently vertical space between the topic click targets. E.g. there is no way to click ""between"" two streams, or between two users in the right sidebar, but there is a way to click between two topics.",rishig,b'area: left-sidebar bug help wanted',2018-04-04T06:16:18Z,2018-05-23T21:59:33Z
8950,enhancement: Add a progress bar to uploads with a percentage.,"enhancement: Add a progress bar to uploads with a percentage.

There was already a progress bar set up, but it became non-functional after refactoring (see discussion here: https://github.com/zulip/zulip/issues/8863#issuecomment-377706603). This PR fixes it and adds a percent indicator to the middle of it. There are also some related fixes including styles for night mode and setting up jQuery animations.

Fixes #8863.

**Testing Plan:** <!-- How have you tested? -->

Some edits were made to frontend tests in order to fix the templates and change the functions used.

**GIFs or Screenshots:** 

*Light mode:*

![light mode](https://user-images.githubusercontent.com/17259768/38288760-7910efec-3787-11e8-8c62-3735f10d6e02.gif)

*Night mode:*

![night mode](https://user-images.githubusercontent.com/17259768/38288763-7ddb8528-3787-11e8-97a6-70c7b358da5d.gif)
",marco,b'area: uploads bug size: XL',2018-04-04T04:40:48Z,2018-04-11T18:05:52Z
8949,Slack import: Fix mis-imported user avatars,"If you import a Slack organization with the new user/stream ID importing process, any mentions for the users/streams that are imported end up with the wrong `data-user-id` / `data-stream-id` values in the `rendered_content`.  I haven't figured out why, but it's pretty obvious (users have each others' avatars). 

This is using https://github.com/zulip/zulip/pull/8943 in case it matters.",timabbott,b'area: export/import bug priority: high',2018-04-04T01:34:44Z,2018-05-14T13:23:25Z
8945,"streams settings: Bug in switching between ""Subscribed"" and ""All streams"".","To reproduce:
* Click the gear next to Streams
* Click the plus to create a new stream
* Click the ""Subscribed"" button.

It should toggle the panel from All streams to Subscribed, but it doesn't. 
Subsequently clicking ""All streams"" does toggle it, but now when you click ""All streams"" it gives you the subscribed list, and vice-versa.",rishig,b'area: stream settings bug help wanted',2018-04-03T20:36:27Z,2018-04-04T23:40:39Z
8944,IE11 support: Stop using `startsWith` in the JS codebase,"https://www.w3schools.com/jsref/jsref_startswith.asp is only supported in IE12 or newer; since we intend to support IE11 and above, we should purge use of it and lint for it to prevent new introductions.  ",timabbott,b'area: browser-support bug',2018-04-03T19:48:19Z,2018-04-09T19:20:44Z
8941,Double click select scrolls large multiline message to bottom,"With [large, multi-line messages](https://chat.zulip.org/#narrow/stream/94-bot-testing/subject/testing/near/553990), double clicking text at the top (which normally selects a word and then line) scrolls the stream to the bottom of the message instead of performing a select action.

To replicate: 
* Find a [long, long message](https://chat.zulip.org/#narrow/stream/94-bot-testing/subject/testing/near/553990) and click the expand button 
* While staying at the top of the message, double click to select a word OR double click and drag to begin a drag selection, starting at the start of the word
* Witness the stream immediately scroll to the end of the message

Expected Behavior:
* Don't scroll

Thoughts:
What's happening probably has nothing to do with double clicking- and everything to do with that first click. When you click on a message that is longer than the current window, Zulip will scroll the window to the bottom of that message. This makes a lot of sense if the message is only a few lines longer than the current window. The behavior is unintuitive [here](https://chat.zulip.org/#narrow/stream/94-bot-testing/subject/testing/near/553990) because it ends up scrolling the start of the message out of the window, and makes it impossible to double click to select (which works fine if the bottom of the message is visible).

Impacted user workflows:
Sharing code snippets, logs.",swallitsch,b'area: message view bug good first issue',2018-04-03T16:55:44Z,2019-07-23T14:21:45Z
8934,IE11 exception when exiting overlays,"```
Unable to get property 'blur' of undefined or null reference

Stacktrace:
TypeError: Unable to get property 'blur' of undefined or null reference
   at blur_active_element (/static/min/app.fd57b55c3303.js:1953:60)
       = static/js/ui_util.js line 44 column 5
   at e.exit_overlay (/static/min/app.fd57b55c3303.js:2127:294)
       = static/js/hashchange.js line 306 column 9
   at r.close (/static/min/app.fd57b55c3303.js:1884:202)
       = static/js/subs.js line 572 column 5
   at Anonymous function (/static/min/app.fd57b55c3303.js:1968:299)
       = static/js/click_handlers.js line 368 column 13
```

@AasthaGupta can you investigate this one as well?  I suspect the issue is that `document.activeElement.blur()` isn't a thing in IE11 and we need some fallback.",timabbott,b'area: browser-support bug',2018-04-03T02:06:03Z,2020-04-26T10:14:24Z
8933,scrollbars: Fix exception when trying to remove scrollbar on non-existent element,"@gooca I don't have a reproducer for this, but I saw this exception in production

```
Message:
Cannot read property 'destroy' of undefined

Stacktrace:
TypeError: Cannot read property 'destroy' of undefined
    at Object.destroy_scrollbar (/static/min/app.3d71f40e224c.js:1947:118)
       = static/js/ui.js line 34 column 5

    at Object.u.hide_emoji_popover (/static/min/app.3d71f40e224c.js:2420:4)
       = static/js/emoji_picker.js line 203 column 9

    at Object.n.hide_all (/static/min/app.3d71f40e224c.js:2032:509)
       = static/js/popovers.js line 886 column 5

    at HTMLDivElement.d (/static/min/app.3d71f40e224c.js:1959:92)
       = static/js/click_handlers.js line 136 column 13
```

The `click_handlers.js` code is for a hard-to-trigger corner case involving dragging; I haven't been able to reproduce this.  We could just make the click-handler-destroy code suppress the exception, except that could mask issues where we're actually leaking the scrollbar objects...",timabbott,b'area: message view bug difficult',2018-04-03T01:02:44Z,2019-06-19T00:49:44Z
8932,Clean up compose update/close behavior when updating topics,"This is an attempt to implement the concept described in #6473, but it's a version of that I think could make sense.  

@rishig can you do manual testing with this?  I don't think it exactly matches what you suggested, but it might be what we want.",timabbott,b'area: message view bug priority: blocker size: M',2018-04-03T00:46:50Z,2018-04-05T22:22:19Z
8925,slack import: Custom emoji seem to not import properly,"@rheaparekh I don't know if this is a problem with the Slack export process or the import process, but if you upload a bunch of animated emoji in Slack, the RealmEmoji import correctly (have the right image in the ""custom emoji"" settings page) but reactions seem to end up with the names correct but corresponding images mixed up.
",timabbott,b'area: export/import bug priority: high',2018-04-02T18:47:41Z,2018-05-14T13:23:25Z
8924,#8838 Service bot code leads to database queries in loop for organization administrators,"Fixes #8838 

Implement `get_service_dicts_for_bots()` for reading bots dicts by constant number of queries from database and use it in `get_owned_bot_dicts()`:
- add `models.get_user_profiles_by_ids()` for reading bots profiles by single query from database
- add `models.get_services_for_bots()` for reading services for bots by single query from database
- add `bot_config.get_bot_configs()` for reading config data for bots by single query from database",novokrest,b'bug priority: blocker size: L',2018-04-02T18:07:25Z,2018-04-03T16:16:08Z
8921,Web and app versions of the client scroll back a few pages worth of messages seemingly randomly,Running the current master (1bba6cc) we are seeing the web and app clients on many different platforms scroll back to previous messages at a seemingly random interval. I am trying to watch the console and network traffic for my client to see if I can identify if it is a message from the server that is triggering this but I have not found anything yet.,timapril,b'bug priority: blocker',2018-04-02T14:40:56Z,2018-04-03T02:20:11Z
8905,"style: Inputs with `type=""number""` do not have a dark background in night mode.","For example, in this screenshot `Favorite integer` is a `number` field and `Phone number` is a `text` field. Since `Favorite integer` is not `text`, the dark background isn't added.

<img width=""239"" alt=""example"" src=""https://user-images.githubusercontent.com/17259768/38167660-a004fdf6-34ed-11e8-9023-415407757f8f.png"">
",marco,b'area: general UI bug',2018-03-31T21:15:15Z,2018-04-01T22:17:44Z
8900,copy_and_paste.js: Check if clipboardData is defined,Fixes #8850,AasthaGupta,b'area: browser-support bug size: S',2018-03-31T15:51:28Z,2018-04-02T16:35:01Z
8892,real-time sync: Server sends recipient data with delete_message event.,"Fixes #8853.
Replace mark_message_as_read with process_read_messages_event as
the latter function is only correct for marking a message as
having been read by this browser.
In certain cases, the browser is not able to look up the message.
Include the recipient data for the message in the delete_message
event, so look up of those attributes by the browser isn't required.
",shubham-padia,b'area: real-time sync bug priority: blocker size: L',2018-03-30T20:48:49Z,2018-09-08T19:30:55Z
8891,compose: Prevent inputs from being automatically selected after changing tabs.,"The stream and topic inputs are sometimes fully selected after the user changes tabs and then switches back. To fix this, remove the jQuery `focus` listener on the inputs so that the same amount of text (or no text) is selected before and after a user switches tabs. Also, completely remove `select_on_focus` because it is not used anywhere else.

See [discussion on this issue](https://chat.zulip.org/#narrow/stream/9-issues/subject/Topic.20autoselect.20on.20tab.20change/near/503595).

Fix #8414.

**Testing Plan:** <!-- How have you tested? -->

 - This removes the original `select_on_focus` tests because `select_on_focus` is deleted.

**GIFs:**

*Before:*

![before](https://user-images.githubusercontent.com/17259768/38068779-d04763aa-32c7-11e8-93be-a926b5b02fb3.gif)

*After:*

![after](https://user-images.githubusercontent.com/17259768/38068812-fca96cb8-32c7-11e8-8617-6713bd31e2bc.gif)

",marco,b'area: compose bug size: M',2018-03-30T20:27:47Z,2018-04-05T23:59:00Z
8887,user docs: Searching for something (e.g. via Ctrl+F) doesn't scroll /help.,"As an example, search for something like ""emoji"", which appears halfway down the page. 
More discussion at https://chat.zulip.org/#narrow/stream/9-issues/topic/scroll.20on.20.2Fhelp.
",rishig,b'area: documentation (user) bug help wanted priority: high',2018-03-30T19:15:24Z,2018-07-13T12:35:38Z
8883,"left sidebar: Fix ""Compose"" in stream actions popover prefills topic.","Fixes #8824.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


 <!--**Testing Plan:** How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![stream_topic](https://user-images.githubusercontent.com/22166422/38126177-798e21fc-340c-11e8-827e-da3b6be20543.gif)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Balaji2198,b'area: left-sidebar bug size: S',2018-03-30T05:52:16Z,2018-04-01T23:25:36Z
8870,i18n: Fix handling of OR on login/register pages.,"Closes #8860

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:**
 - Lint checks passed.",YagoGG,b'area: i18n bug priority: high size: S',2018-03-29T18:12:52Z,2018-03-29T18:19:50Z
8869,night mode: Fix unreadable new user tips.,"This PR fixes: 

 - the border color, 
 - the shadow color, 
 - the arrow color, and 
 - the background color 

of the tips popovers for new users in dark mode.

Fix #8868.

**Screenshots:**

*Before:*

<img width=""278"" alt=""before"" src=""https://user-images.githubusercontent.com/17259768/38103859-62c2944c-333c-11e8-8b0e-c5f26cc172b5.png"">

*After:*

<img width=""285"" alt=""after"" src=""https://user-images.githubusercontent.com/17259768/38103858-61c5b024-333c-11e8-9c16-788639df61f3.png"">
",marco,b'bug priority: blocker size: L',2018-03-29T17:31:33Z,2018-03-29T17:58:18Z
8868,Unreadable Newbie Tips,"Switch to night mode in your browser, then log-in to the dektop app. The desktop app will automatically be in night mode. Next, look at the hints that pop up when you're a new user.

The hints have a white background with light grey text. It's entirely unreadable.

---

Zulip 1.9.0
Electron 1.8.4
linux x64 4.4.0-116-generic
![38097332-768b318c-334b-11e8-8738-f4dd1a228327](https://user-images.githubusercontent.com/1524476/38100955-375fd008-3355-11e8-9fc1-a2fb3f3dc8ae.png)
",Valkryst,b'bug priority: blocker',2018-03-29T16:29:35Z,2018-03-29T17:58:18Z
8867,stream_sort.js: Separate pinned streams into active and dormant.,"In case of non-pinned streams, whenever we receive a message or click on inactive streams, the stream un-fades in the left side bar.
But this is not the case for pinned inactive streams.This is because active and dormant pinned streams are treated the same way.
This will separate pinned streams into two lists: active and dormant.

Fixes #8201 ",AasthaGupta,b'area: left-sidebar bug has conflicts size: M',2018-03-29T15:07:49Z,2019-09-26T19:57:11Z
8863,Enhancement: Progress Bar on Uploads,"On Linux/Ubutnu Electron Client, file upload does not show a progress indicator.

**To Reproduce:**

Within a stream, upload a file using the paper clip icon. You will see a blue bar with blue text ""Uploading..."" but it gives no progress.

**Justification:**

Well, progress bars are useful right?  Especially for larger files.

(also you cannot send messages while you are waiting for your upload and it would be nice to know if you will have to wait a long time and should maybe try the file again later)",stone212,b'area: uploads bug priority: blocker',2018-03-29T08:55:05Z,2018-04-10T05:57:06Z
8861,compose: Prevent input from being selected after tab change.,"The stream and topic inputs are sometimes fully selected after the user changes tabs and then switches back. To fix this, remove the jQuery `focus` listener on the inputs so that the same amount of text (or no text) is selected before and after a user switches tabs. Also, completely remove `select_on_focus` because it is not used anywhere else.

See [discussion on this issue](https://chat.zulip.org/#narrow/stream/9-issues/subject/Topic.20autoselect.20on.20tab.20change/near/503595).

Fix #8414.

**Testing Plan:** <!-- How have you tested? -->

 - This removes the original `select_on_focus` tests because `select_on_focus` is deleted.

**GIFs:**

*Before:*

![before](https://user-images.githubusercontent.com/17259768/38068779-d04763aa-32c7-11e8-93be-a926b5b02fb3.gif)

*After:*

![after](https://user-images.githubusercontent.com/17259768/38068812-fca96cb8-32c7-11e8-8617-6713bd31e2bc.gif)

",marco,b'area: compose bug size: M',2018-03-29T03:40:13Z,2018-03-30T20:25:09Z
8860,i18n: Fix handling of OR widget on login/register type pages,"We currently have a not-tagged-for-translation ""OR"" widget in a few of our signup pages:

![image](https://user-images.githubusercontent.com/2746074/38064504-1fd5b9e0-32b3-11e8-89a3-cc19f7fb7f6a.png)

Here's the markup:

```
$ git grep 'class=""or""'
templates/zerver/accounts_home.html:                            <div class=""or"">or</div>
templates/zerver/login.html:                                <div class=""or"">or</div>
templates/zerver/register.html:                        <div class=""or"">or</div>
```

Ideally, these should be tagged for translation; this probably requires some CSS changes (since CSS is currently what's capitalizing it).

@umairwaheed can you take a crack at this?",timabbott,b'area: i18n bug priority: high',2018-03-29T01:09:38Z,2018-03-29T18:15:11Z
8858,Race condition with soft deactivation,"I saw this exception in production for a user coming back from soft-deactivation.

I think what's happening is that he attempted to load the Zulip browser, noticed that it was taking a long time (backfilling a ton of UserMessage rows, probably), and then tried to reload.  This of course resulted in two copies of the job running at the same time; the second one loses the race and 500s.  

I think basically the root problem here is that we need some sort of interstitial ""loading..."" state for users who've been soft-deactivated for a long time.  Ideally, we'd display a page that has (1) a loading indicator and (2) some sort of explanation about how they've been away for a long time and we're calculating all their unread history.

That, or we should implement the cron job that we discussed for the original soft-deactivation feature, to call `add_missing_messages` for all soft-deactivated users daily.  

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
psycopg2.IntegrityError: duplicate key value violates unique constraint ""zerver_usermessage_user_profile_id_71a38b2c30f35402_uniq""
DETAIL:  Key (user_profile_id, message_id)=(x, y) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/views/home.py"", line 84, in home
    return home_real(request)
  File ""./zerver/decorator.py"", line 341, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 386, in _wrapped_view_func
    return rate_limit()(view_func)(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 686, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/views/home.py"", line 125, in home_real
    narrow=narrow)
  File ""./zerver/lib/events.py"", line 629, in do_events_register
    maybe_catch_up_soft_deactivated_user(user_profile)
  File ""./zerver/lib/soft_deactivation.py"", line 191, in maybe_catch_up_soft_deactivated_user
    add_missing_messages(user_profile)
  File ""./zerver/lib/soft_deactivation.py"", line 158, in add_missing_messages
    UserMessage.objects.bulk_create(user_messages_to_insert)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/query.py"", line 443, in bulk_create
    ids = self._batched_insert(objs_without_pk, fields, batch_size)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/query.py"", line 1093, in _batched_insert
    inserted_id = self._insert(item, fields=fields, using=self.db, return_id=True)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/query.py"", line 1076, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/sql/compiler.py"", line 1107, in execute_sql
    cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/utils.py"", line 94, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/utils/six.py"", line 685, in reraise
    raise value.with_traceback(tb)
  File ""/home/zulip/deployments/2018-02-28-14-29-15/zulip-py3-venv/lib/python3.4/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
django.db.utils.IntegrityError: duplicate key value violates unique constraint ""zerver_usermessage_user_profile_id_71a38b2c30f35402_uniq""
DETAIL:  Key (user_profile_id, message_id)=(x, y) already exists.
```

@adnrs96 FYI.",timabbott,b'area: misc bug difficult priority: high',2018-03-29T00:48:58Z,2019-03-14T18:55:08Z
8855,Fix exception when updating bot permissions.,"**settings: Fix exception on updating bot_creation_policy.**
This initializes the bot_creation_policy_values after the page
is loaded.

Previously we initialize these values in `settings.js` when settings page
is loaded at least once, so if we open two tabs, one(1) in which we
haven't opened the settings page yet and if in another tab (2) we
update the `bot_creation_policy` value, then because of the event
which calls `settings_bots.update_bot_permissions_ui` causes exception
in (1) because `bot_creation_policy_values` isn't initialized yet.

Fixes: #8852.

**org settings: Sync only when settings page is opened once.**

This fixes a minor bug in which if we have two tabs opened and
in one we haven't opened settings page at least once and in
another we change an org setting, then we get an exception in
the former tab because of the event as `sync_realm_settings`
isn't defined yet.

Another approach to fix this can be to check whether settings overlay is opened or not. Which(if any) is fine?",shubhamdhama,b'area: settings (user) bug size: XS',2018-03-28T21:16:07Z,2018-03-29T15:04:01Z
8854,Exception in set_message_offset when removing selected message in a narrow,"There's a few ways to reproduce this exception:
(1) Mute the last topic in a stream.
(2) Edit the topic to move all messages in the current topic to a new one.

In each case, we end up calling `rerender_preseving_scrolltop` in a situation where the currently selected message ID is going to disappear.  The eventual exception happens in `set_message_offset`, where it tries to preserve the scroll position of the selected message that no longer appears in the narrow.

This is probably going to be a difficult bug to fix correctly, but it's also a fairly common JS exception, and I worry about releasing with it still present.  

```
Failed to update messages
Cannot read property 'top' of undefined

Stacktrace:
TypeError: Cannot read property 'top' of undefined
    at Object.a.set_message_offset (/static/min/app.23a9bf297e66.js:1539:108)
       = static/js/message_viewport.js line 228 column 45
    at MessageListView.rerender_preserving_scrolltop (/static/min/app.23a9bf297e66.js:1647:425)
       = static/js/message_list_view.js line 821 column 13
    at MessageList.rerender (/static/min/app.23a9bf297e66.js:1666:427)
       = static/js/message_list.js line 552 column 9
    at Object.update_messages (/static/min/app.23a9bf297e66.js:2141:502)
       = static/js/message_events.js line 253 column 9
    at g (/static/min/app.23a9bf297e66.js:2150:305)
       = static/js/server_events.js line 121 column 13
    at success (/static/min/app.23a9bf297e66.js:2151:424)
       = static/js/server_events.js line 174 column 17
    at Object.a.success (/static/min/app.23a9bf297e66.js:1519:237)
       = static/js/channel.js line 64 column 16
```

@sarahcstringer FYI, since you did an attempt at fixing this is your topic-editing PR.",timabbott,b'bug difficult priority: blocker',2018-03-28T19:13:32Z,2018-04-13T23:32:20Z
8853,Exception when browser learns about a deleted message it didn't have locally,"This exception I saw in production error reporting only, but the cause is clear from reading the code:
* A browser receives a notification from the server about a message having been deleted that had not been locally cached by the browser (e.g. because it was older than the batch of ~1200 messages the browser fetches from the server, or was on a stream the user had just subscribed to (but not narrowed to!) and the message had been sent before the user subscribes).

In that case, `message_store.get(message_id)` will return undefined, since the browser doesn't know about the message yet.  Then `unread_ops.mark_message_as_read(message);` will throw the below exception.  Were execution not stopped here, we'd also have a problem with the `topic_data` calls on the following lines.  I think the correct fix is probably to just (1) we should be calling `unread_ops.process_read_messages_event`, not `unread_ops.mark_messages_as_read` (the latter function only being correct for marking a message as having been read by this browser), and for the `topic_data` thing, I think for now it would work to just do nothing, but once we switch to server-managed unread counts, we'll want this code path to still call the `topic_ops` function.  So I think that means we want to change the `delete_message` event sent from the server to include the recipient data for the message (type, and (stream_id, topic) or (PM recipient user ID list)) required to do this correctly in the absence of the brower being able to look up the message.

```
Cannot read property 'id' of undefined

Stacktrace:
TypeError: Cannot read property 'id' of undefined
    at /static/min/app.23a9bf297e66.js:1569:79
       = static/js/unread.js line 341 column 36

    at Object.a.get_unread_messages (/static/min/app.23a9bf297e66.js:1569:44)
       = static/js/unread.js line 340 column 12

    at Object.mark_messages_as_read (/static/min/app.23a9bf297e66.js:1527:247)
       = static/js/unread_ops.js line 64 column 16

    at Object.mark_message_as_read (/static/min/app.23a9bf297e66.js:1528:6)
       = static/js/unread_ops.js line 84 column 5

    at Object.dispatch_normal_event (/static/min/app.23a9bf297e66.js:2170:344)
       = static/js/server_events_dispatch.js line 385 column 9
```

@shubham-padia FYI, since this in code you touched recently; do you agree with the solution for (1)?  Also @showell FYI.",timabbott,b'area: real-time sync bug priority: blocker',2018-03-28T19:09:26Z,2019-07-23T14:21:44Z
8852,Exception when updating bot permissions,"I got this exception from production error reporting, so I don't have a reproducer.

But it seems like we're processing a server_event via `server_events_dispatch` before we've done the initialization in `exports.setup_bot_creation_policy_values`.  We should look at whether there's an initialization order here.

```
Failed to process an event
Cannot read property 'code' of undefined

Stacktrace:
TypeError: Cannot read property 'code' of undefined
    at Object.update_bot_settings_tip (https://elimsbpt.zulipchat.com/static/min/app.23a9bf297e66.js:2240:277)
       = static/js/settings_bots.js line 109 column 32

    at Object.update_bot_permissions_ui [as bot_creation_policy] (https://elimsbpt.zulipchat.com/static/min/app.23a9bf297e66.js:2241:40)
       = static/js/settings_bots.js line 120 column 5

    at Object.dispatch_normal_event (https://elimsbpt.zulipchat.com/static/min/app.23a9bf297e66.js:2158:291)
       = static/js/server_events_dispatch.js line 81 column 13

    at https://elimsbpt.zulipchat.com/static/min/app.23a9bf297e66.js:2149:103
       = static/js/server_events.js line 76 column 20
```",timabbott,b'area: settings (user) bug',2018-03-28T18:59:47Z,2018-03-29T15:07:38Z
8851,Exception updating perfectScrollbar (from JS error reporting),"I don't have a reproducer for this, since it comes from our production JS error reporting, but it seems like something we might be able to debug by reading code.

@gooca @YJDave FYI.

```
Failed to process an event
Cannot read property 'perfectScrollbar' of undefined

Stacktrace:
TypeError: Cannot read property 'perfectScrollbar' of undefined
    at Object.update_scrollbar (/static/min/app.23a9bf297e66.js:1936:256)
       = static/js/ui.js line 28 column 9

    at Object.rerender_subscribers_list (/static/min/app.23a9bf297e66.js:1841:223)
       = static/js/stream_edit.js line 39 column 13

    at HTMLDocument.<anonymous> (https:///static/min/app.23a9bf297e66.js:1856:3)
       = static/js/stream_edit.js line 617 column 9
```",timabbott,b'area: stream settings bug',2018-03-28T18:57:12Z,2019-05-17T20:13:16Z
8850,Exception in paste handler on Windows,"I don't have a reproducer for this since it comes from logging, but this error traceback shows up in our logs a few times a day from folks trying to paste content into the Zulip compose box:

```
Message:
Unable to get property 'getData' of undefined or null reference

Stacktrace:
TypeError: Unable to get property 'getData' of undefined or null reference
   at d.paste_handler (/static/min/app.23a9bf297e66.js:1981:184)
       = static/js/copy_and_paste.js line 217 column 5
```

Here's the code in question:
```
exports.paste_handler = function (event) {                                                           
    var clipboardData = event.originalEvent.clipboardData;                                           
                                                                                                     
    var paste_html = clipboardData.getData('text/html');                                             
``

So I think `clipboardData` is undefined here.  Probably this is some corner case with the browser; I've only seen it with this type of Windows user-agent:

`User agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E; rv:11.0) like Gecko`

It's likely that we just need to check for `clipboardData` being undefined and return, but it's probably worth investigating the browser or trying to reproduce in case it's something more interesting.  ",timabbott,b'area: browser-support bug',2018-03-28T18:51:12Z,2018-03-31T22:51:26Z
8846,"settings: Fix error handling for uploading an invalid file for ""Uploa…","…d icon"".

Fixes #8842.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


 <!--**Testing Plan:** How have you tested? -->


**Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
When there is no organization icon.
![image](https://user-images.githubusercontent.com/22166422/38034227-6d3d6582-32bf-11e8-88ee-6bdc85f9f797.png)

When there is an organization icon already exists.
![image](https://user-images.githubusercontent.com/22166422/38034185-58d148e8-32bf-11e8-9aaa-c330280e1b96.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Balaji2198,b'area: settings (admin/org) bug size: XS',2018-03-28T14:14:27Z,2018-03-29T04:53:06Z
8842,"Fix error handling for uploading an invalid file for ""Upload icon""","Here's what currently happens if you upload a `.py` file as the organization icon in organization settings:

![image](https://user-images.githubusercontent.com/2746074/38000898-c5a19022-31de-11e8-838c-0475d2c2ab50.png)


",timabbott,b'area: settings (admin/org) bug',2018-03-27T23:49:53Z,2018-03-28T17:56:50Z
8841,Exception when adding multiple Android PushDeviceToken objects with the same token,"We're most likely seeing this exception because of https://github.com/zulip/zulip-mobile/issues/2128. 

What I suspect is happening is the flurry of duplicate requests to register for push notifications at the same time end up racing with each other and trying to create duplicate entries.  

However, I think there's a deeper bug here: if a user has accounts with multiple organizations on zulipchat.com, it appears that the Android app will use the same `token` for each of those apps.  So I think we need to change the `unique` constraint on `token` in the PushDeviceToken model to instead be a unique constraint on `(token, realm_id)` (or maybe just not exist, since there are testing reasons, one might want to have multiple accounts in the same realm and access both from a mobile device).  

We got rid of a similar issue for the push bouncer in 735b49e505112798dbd4f7f6380b0cf0eecc40d8, though I think that fix probably shares this problem of multiple realms hosted on the same RemoteZulipServer installation; that's just a lot less common than the zulipchat.com case.  

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-03-23-17-37-15/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2018-03-23-17-37-15/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 124, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2018-03-23-17-37-15/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/decorator.py"", line 508, in _wrapped_func_arguments
    return rate_limit()(view_func)(request, profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 716, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 409, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 174, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/push_notifications.py"", line 44, in add_android_reg_id
    add_push_device_token(user_profile, token, PushDeviceToken.GCM)
  File ""./zerver/lib/push_notifications.py"", line 366, in add_push_device_token
    ios_app_id=ios_app_id))
... (25 more lines of internal Django junk omitted)
django.db.utils.IntegrityError: duplicate key value violates unique constraint ""zerver_pushdevicetoken_token_key""
```",timabbott,b'area: mobile area: production bug priority: high',2018-03-27T23:20:29Z,2019-07-23T14:21:44Z
8838,Service bot code leads to database queries in loop for organization administrators,"I saw in our server logs on chat.zulip.org that my own account needed about 300 database queries to load the home view.  This is a clear sign of database queries in a loop.

Some debugging determined that this is a regression only for organization administrators, which is how it was missed by our existing test (which uses a non-admin user).  

Further debugging showed that the queries are being done in `get_owned_bot_dicts`, which calls `get_service_dicts_for_bots` in a loop; the latter does a database query.

This is a classic case where we just need to do a bulk query for these data.

I merged 5404edaf0377cded36f95360e940dbb98324c3dd adding a test showing the too-high query counts to help ensure after we fix this, it never regresses again.

Tagging as a release-blocker, since this can be a major perf issue for org administrators.
",timabbott,b'bug priority: blocker',2018-03-27T19:53:19Z,2018-04-03T16:16:39Z
8835,right sidebar: Fading doesn't work in dark mode.,"To reproduce just go to a stream where not everyone is subscribed, while in night mode. ",rishig,b'area: right-sidebar bug',2018-03-27T07:16:05Z,2018-03-27T17:18:43Z
8824,"left sidebar: ""Compose"" in stream actions popover prefills topic.","To replicate:
* Narrow to a topic T in stream X
* Go to stream actions popover for stream Y, and click ""Compose a message to stream Y""

It will prefill the topic of the new message with T. ",rishig,b'area: left-sidebar bug',2018-03-25T22:58:32Z,2018-04-01T23:29:11Z
8823,Floating topic bar doesn't have correct background in dark theme.,"When you narrow to a topic, and that's not the same as the topic on the top of the view(floating topic), the floating topic bar lacks the CSS class needed to make it blend properly with the dark theme. This is likely a bug with the compose-fade logic.

![image](https://user-images.githubusercontent.com/8033238/37880185-3a0e5ece-30a2-11e8-82fe-fe60252b51e3.png)

Refer to https://chat.zulip.org/#narrow/stream/101-design/subject/night.20mode/near/548445 for initial conversation and further discussion.

@zulipbot add ""bug"" ""area: message view"" ""design""",aero31aero,b'area: message view bug design',2018-03-25T21:35:45Z,2018-03-27T22:27:01Z
8798,Improve email hint widget in stream subscription,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This PR fixes both issues mentioned in #8743 
* Style of email hint widget
* Bug in email hint popover display



**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

![emailhint](https://user-images.githubusercontent.com/25907420/37840252-903943e8-2ee2-11e8-95d7-32dbe4f119b0.gif)
",YJDave,b'area: stream settings bug priority: blocker size: S',2018-03-23T16:09:25Z,2018-03-23T16:58:11Z
8795,message view: show spinner on topic change,"On clicking the checkbox in topic edit form, display a spinner and hide the cancel icon.
Also, do not display any success message.

Fixes #8793",AasthaGupta,b'area: message view bug priority: blocker size: M',2018-03-23T07:54:24Z,2018-03-23T14:21:46Z
8793,message view: Success/error message for changing the topic from the recipient bar needs updating.,"If you change the topic from the recipient bar (you need to be an admin to do this), it'll give you a success message that sort of looks like this, but in green:
![image](https://user-images.githubusercontent.com/890911/37803707-a4af1410-2ded-11e8-9346-11fbc7f2e935.png)

Instead of having a success message, we should just have the checkbox turn into a spinner when you click it, and the `X` disappear. 
Not sure what to do if the backend returns an error, but we can handle that as followup.",rishig,b'area: message view bug priority: blocker',2018-03-22T23:28:32Z,2018-03-23T14:25:16Z
8792,"Fix positioning of ""disposable email addresses"" errors","Fixes: #8784

<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This PR is for issue no. [8784](https://github.com/zulip/zulip/issues/8784)

**Testing Plan:** <!-- How have you tested? -->


**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Before:
![screenshot from 2018-03-23 02-28-44](https://user-images.githubusercontent.com/21174572/37798773-be953958-2e43-11e8-8df0-66d58210ecb1.png)

After:
![screenshot from 2018-03-23 02-30-52](https://user-images.githubusercontent.com/21174572/37798736-9f26d4dc-2e43-11e8-8a76-3d76e493e3ce.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Anupam-dagar,b'area: portico bug priority: blocker size: S',2018-03-22T21:12:01Z,2018-06-01T11:00:16Z
8784,"Fix positioning of ""disposable email addresses"" errors",See https://github.com/zulip/zulip/pull/8549#issuecomment-375159396 for details.,timabbott,b'area: portico bug help wanted priority: blocker',2018-03-22T18:23:32Z,2018-03-22T21:42:57Z
8781,CSS Fixes,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->

dark-mode: Change miscolored popover arrow colors.
Fixes #8768.

dark-mode: Darken background color of unread topic/PM counts. 
Fixes #8763.

left-sidebar: Properly align unread counts with topic names.
Fixes #7492.

Before:
![screenshot at mar 22 10-18-09](https://user-images.githubusercontent.com/15116870/37786649-6aeaa1c8-2dba-11e8-8913-757317f12da9.png)
After:
![screenshot at mar 20 21-56-07](https://user-images.githubusercontent.com/15116870/37783417-b0eccc4e-2db2-11e8-9e50-7ca66679483d.png)

input-pill: Fix vertically-misaligned PM compose pills.
Fixes #8775.
Before:
![screenshot at mar 22 10-19-36](https://user-images.githubusercontent.com/15116870/37786755-a689d320-2dba-11e8-881b-1534fd331e08.png)

After:
![screenshot at mar 22 10-21-32](https://user-images.githubusercontent.com/15116870/37786884-fa991732-2dba-11e8-9ae1-6a44b6b9e27e.png)



message-view: Align controls and timestamps to the right on mobile.
Fixes #8110.

Before:
![screenshot at mar 22 10-16-50](https://user-images.githubusercontent.com/15116870/37786779-b57ee550-2dba-11e8-99ea-9e43b6deb4fe.png)

After:
![screenshot at mar 22 10-22-19](https://user-images.githubusercontent.com/15116870/37786869-f39576b0-2dba-11e8-8ab0-15cc923549b1.png)


#### input-pill: Force words to break to prevent text overflow.
Before:
![screenshot at mar 22 10-08-00](https://user-images.githubusercontent.com/15116870/37786064-ef3bd16a-2db8-11e8-8517-b0bf0fac4b86.png)

After:
![screenshot at mar 20 22-10-32](https://user-images.githubusercontent.com/15116870/37783583-18bb98dc-2db3-11e8-85f6-0578930660d4.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",synicalsyntax,b'area: compose area: left-sidebar area: mobile bug design priority: blocker priority: high size: XL',2018-03-22T16:22:12Z,2018-04-17T03:54:31Z
8775,Incorrect margins/paddings for PM pills,"This problem is there in the light theme as well, but is not visible.

I think maybe a border for the box that contains the pills would be good (in both the themes).

![image](https://user-images.githubusercontent.com/12458563/37716321-7aaffa18-2d33-11e8-9a3e-a8c8c4043c86.png)
",Shayan-To,b'area: compose bug design priority: blocker',2018-03-21T14:43:09Z,2018-04-18T16:52:35Z
8774,search: check 'pm-with' operands for validity,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes #3380

If the operands for 'pm-with' are all invalid then,
- do not update pm list
- cancel compose
- show non existent user message
",AasthaGupta,b'area: left-sidebar area: search bug has conflicts priority: high size: L',2018-03-21T07:38:21Z,2019-07-12T05:41:44Z
8773,Drag and drop file upload not working on Safari.,"We did recently do some refactoring to support drag-and-drop file upload when editing messages, so it's certainly possible that somehow accidentally broke this on Safari.

https://chat.zulip.org/#narrow/stream/9-issues/topic/drag.20and.20drop.20file.20upload.20not.20working",jainkuniya,b'area: uploads bug priority: blocker',2018-03-21T04:56:19Z,2018-03-24T05:10:13Z
8768,Misscolored tip of the streams pop-up in the dark theme,"As you can see in the screenshot, the triangle to the left of the pop-up is white, and there is a smaller black triangle above it.

![image](https://user-images.githubusercontent.com/12458563/37688731-b9a599da-2cb6-11e8-92cf-87856be3cfa9.png)
",Shayan-To,b'area: left-sidebar bug priority: high',2018-03-20T23:51:47Z,2018-03-23T04:30:15Z
8763,Incorrect coloring of topic unread counts in the dark theme,"Unread counts of topics should be less intense than unread counts of streams, as they are in the light theme. But in the dark theme, they are more intense.

![image](https://user-images.githubusercontent.com/12458563/37671224-8335c5e0-2c80-11e8-8d34-b17210de4b9d.png) ![image](https://user-images.githubusercontent.com/12458563/37671387-dbaddc9e-2c80-11e8-95b0-5b2afeff459d.png)

",Shayan-To,b'area: left-sidebar bug priority: blocker',2018-03-20T17:28:25Z,2018-03-23T04:30:16Z
8762,"compose: Fix ""compose fade"" not working when private message focused.","The problem was that we now have pills instead of emails.
Fixes: #8755.


![private message focus](https://user-images.githubusercontent.com/22238472/37666309-4741d9de-2c85-11e8-83c4-d593c8ccf571.gif)
",shubhamdhama,b'area: compose bug priority: blocker size: S',2018-03-20T15:56:12Z,2018-03-20T22:24:18Z
8755,Compose fade doesn't work properly with the new compose pills system,"It used to be the case that if you started composing a PM to a user, messages not in that thread would be faded.  It appears this feature disappeared with the migration to the new compose pills.  

I haven't tried to figure out why.  @showell FYI in case yo have any ideas.
",timabbott,b'area: compose bug priority: blocker',2018-03-19T22:45:29Z,2018-03-20T22:15:34Z
8751,Errors when running `manage.py makemessages`,"I get these errors in my local development environment:

```
(zulip-py3-venv) tabbott@zaset:~/zulip$ ./manage.py makemessages
UnicodeDecodeError: skipped file brainstorm_notes.txt in ./var/uploads/files/15/3d/47qkB-BgaArZ7wrTMTr-nsTK (reason: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte)
UnicodeDecodeError: skipped file -.txt in ./var/uploads/files/15/9e/fqVojOZvoTZuGZ39r2_37NBn (reason: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte)
UnicodeDecodeError: skipped file -.txt in ./var/uploads/files/2/fc/IfxNDeGaie57gWdOOok1Pyb5 (reason: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte)
processing locale ca
processing locale es
```

I'm not sure why `manage.py makemessages` is parsing these uploaded files at all.   

@umairwaheed can you try to track this down?  We don't have a clear reproducer, but it seems like this sort of thing should be findable when reading code.",timabbott,b'area: i18n bug',2018-03-19T18:05:28Z,2018-03-25T16:11:39Z
8750,Editing topic of messages present before subscribing to a stream doesn't work.,"Demo:
![topic_editing](https://user-images.githubusercontent.com/25124304/37606979-c830247a-2bbc-11e8-8743-2a6063f846ba.gif)
",amanagr,b'area: message-editing bug good first issue help wanted',2018-03-19T16:00:58Z,2019-07-23T14:21:43Z
8743,"CSS for ""stream settings"" email address widget is broken","If you hover over this `?` widget on the per-stream settings page, you'll encounter two issues: ![image](https://user-images.githubusercontent.com/2746074/37568842-e20898e4-2a97-11e8-95e2-3ab15c49e5b3.png).  

(1) The hover behavior is super buggy (the explanation widget seems to randomly appears and disappears while you have your mouse over it).

(2) The thing that appears doesn't have appropriate padding around it.

(Not reproducible on chat.zulip.org, since we don't have `EMAIL_GATEWAY_PATTERN` set there, but reproducible in development).
",timabbott,b'area: stream settings bug priority: blocker',2018-03-18T17:37:30Z,2018-03-23T17:01:11Z
8740,subscriptions: Fix broken line wrapping in subscriptions modal.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Also includes miscellaneous CSS modifications (e.g. cleaning up broken selectors). Fixes #8718.

## Testing Plan: <!-- How have you tested? -->
Manual testing on various screen widths.

## GIFs or Screenshots:

Before:

![screenshot at mar 17 21-20-28](https://user-images.githubusercontent.com/15116870/37562677-a5e7f6a0-2a2b-11e8-82ab-ee0ec6d5ee1e.png)


After:

![screenshot at mar 17 21-23-05](https://user-images.githubusercontent.com/15116870/37562672-98ef6f1e-2a2b-11e8-9127-00fda55cd9e0.png)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",synicalsyntax,b'area: i18n area: stream settings bug priority: blocker size: L',2018-03-18T04:41:10Z,2018-03-20T17:04:46Z
8735,Hotspot sync,"
**hotspots: Fix real-time sync for dismissing hotspots.**
This closes all the hotspots which aren't included in the event.hotspots.
This means we treat all the hotspots in event.hotspots as the hotspot
which need to be shown.

Fixes: #8690.
Is this is what you're referring @timabbott .
**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
**[GIF LINK](https://i.imgur.com/QHj9FT6.gifv)**


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",shubhamdhama,b'accessibility area: onboarding bug priority: high size: S',2018-03-17T18:53:49Z,2018-03-18T17:23:11Z
8731,"""More topics"" scrollbar area ends a few pixels too high","In the left sidebar, if you click on ""more topics"" for a stream like 'development help' on chat.zulip.org that has a lot of topics, our scrollbar's top position ends up a bit higher than it should in a way that looks buggy.

![image](https://user-images.githubusercontent.com/2746074/37541379-a694a4c8-2917-11e8-8c45-b78f4a8f8a38.png)
",timabbott,b'area: left-sidebar bug',2018-03-16T19:44:55Z,2019-07-23T14:21:43Z
8725,message view: Narrow back to the last unread message.,"Fixes #2091
Currently on doing a topic narrow, then replying, and then
doing a stream narrow, results in narrowing to the sent message
and all the intermediate unread messages are marked as read.

This will narrow to last unread message in the stream instead of
the sent message.",AasthaGupta,b'area: message view bug difficult needs review priority: blocker size: XS',2018-03-16T10:02:30Z,2018-05-13T11:29:05Z
8723,topic: Topics on hover should show complete topic in tooltip.,"Currently if you hover on a long topic, the tooltip shows topic truncated by ellipsis(...) which makes it almost impossible to know the what is the complete topic. We should fix it to show complete topic name in tooltip. Should be an easy fix. To reproduce the issue, hover on the following topic: https://chat.zulip.org/#narrow/stream/7-test-here/topic/A.20really.20lonnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnng.20topic
Would have fixed it straight away but don't have access to my laptop right now. :(",HarshitOnGitHub,b'area: left-sidebar bug',2018-03-16T05:22:28Z,2018-03-18T17:43:07Z
8721,Fix panels.js check for local storage support,"If local storage isn't available in a browser, our check for the ""dontAskForNotifications"" key doesn't work (this is part of the feature to show our ""Do you want desktop notifications"" prompt).  We get this browser exception:

```
Message:
localStorage is null at /static/min/app.d166ff204de5.js:1487

Stacktrace:
getData@/static/min/app.d166ff204de5.js:1487:802
       = static/js/localstorage.js line 35 column 13
get@/static/min/app.d166ff204de5.js:1489:50
       = static/js/localstorage.js line 111 column 24
panels</g.open@/static/min/app.d166ff204de5.js:2389:529
       = static/js/panels.js line 45 column 10
panels</g.initialize@/static/min/app.d166ff204de5.js:2389:391
       = static/js/panels.js line 29 column 9
@https:///static/min/app.d166ff204de5.js:2369:86
       = static/js/ui_init.js line 285 column 5
```

I think we just want to do a check for whether local storage is enabled (we have something in our library for it), and if it isn't, just skip that check.  Ideally we'd test this manually as well as with node unit tests",timabbott,b'area: notifications (messages) bug',2018-03-16T02:00:17Z,2018-03-18T19:58:21Z
8720,expectOne() exceptions in `rerender_subscribers_count`,"We're getting tons of these on chat.zulip.org (giant bunches of one for each logged-in user, presumably whenever anyone joins a stream).  While it's not user-facing, its sufficiently spammy for our JS exception collection that we really need to fix it.  @YJDave can you look into this?

```
Message:
Expected one element in jQuery set, 0 found

Stacktrace:
error@https://chat.zulip.org/static/webpack-bundles/common-f4465164739557a99ea2.0bc51db7251e.js:1:5416
       = webpack:///./static/js/blueslip.js line 399 column 1
expectOne@https://chat.zulip.org/static/min/app.8906d90d73c9.js:1523:415
       = static/js/setup.js line 62 column 17
rerender_subscribers_count@https://chat.zulip.org/static/min/app.8906d90d73c9.js:1861:79
       = static/js/subs.js line 157 column 9
https://chat.zulip.org/static/min/app.8906d90d73c9.js:1880:122
       = static/js/subs.js line 790 column 9
c@https://chat.zulip.org/static/webpack-bundles/common-f4465164739557a99ea2.0bc51db7251e.js:1:3726
       = webpack:///./static/js/blueslip.js line 225 column 1
dispatch@https://chat.zulip.org/static/webpack-bundles/common-f4465164739557a99ea2.0bc51db7251e.js:24:34748
       = webpack:////srv/zulip-npm-cache/c94ceacb4125bf9375b4c2b46d3f3140ef71ef79/~/jquery/dist/jquery.js?cba4 line 5206 column 1
trigger@https://chat.zulip.org/static/webpack-bundles/common-f4465164739557a99ea2.0bc51db7251e.js:24:55721
       = webpack:////srv/zulip-npm-cache/c94ceacb4125bf9375b4c2b46d3f3140ef71ef79/~/jquery/dist/jquery.js?cba4 line 8201 column 1
https://chat.zulip.org/static/webpack-bundles/common-f4465164739557a99ea2.0bc51db7251e.js:24:56244
       = webpack:////srv/zulip-npm-cache/c94ceacb4125bf9375b4c2b46d3f3140ef71ef79/~/jquery/dist/jquery.js?cba4 line 8269 column 1
each@https://chat.zulip.org/static/webpack-bundles/common-f4465164739557a99ea2.0bc51db7251e.js:14:14823
       = webpack:////srv/zulip-npm-cache/c94ceacb4125bf9375b4c2b46d3f3140ef71ef79/~/jquery/dist/jquery.js?cba4 line 362 column 1
https://chat.zulip.org/static/min/app.8906d90d73c9.js:2162:105
       = static/js/server_events_dispatch.js line 242 column 21
```",timabbott,b'bug priority: blocker',2018-03-16T01:52:10Z,2018-03-19T17:36:11Z
8718,Improve CSS for .stream-message-hover-content,"Currently, the size for the .stream-message-hover-content and .subscriber-count-hover-content sets a fixed width, which means things line-wrap in an ugly fashion if internationalization means these areas are a different width.  We should fix this by improving the hover popover component used here so that it's always 1 line (with width depending on the size of the content).  Ideally, that'd make the component something we can reuse elsewhere on the site.

",timabbott,b'area: i18n area: stream settings bug priority: blocker',2018-03-15T23:35:58Z,2018-03-18T19:53:52Z
8716, settings: Auto save user group members on blur.,"Fixes #8088.
- Cancel button fades out if user removes the changes manually i.e without clicking the cancel button.
- Clicking on cancel button discards the changes and the user group returns to its original state.
- Suppose you've made a change to the name, clicking on the description edit or pill input of the same group does not save that name, but if you click 
any input that is not present in the current group, then that change is saved before allowing the user to edit the second group.
- Solved: If user has added 1 user and tries to add another user (the 1st user is unsaved), then as typeahead is outside the input box, blur event is triggered resulting in the saving of 1st member which wasn't the intention.

![saveonblur1](https://user-images.githubusercontent.com/13910561/37492839-dd55fa38-28c8-11e8-9a4e-0de996681cab.gif)

Changes saved if any other user group input clicked:
![saveonblur2](https://user-images.githubusercontent.com/13910561/37492870-f7ba75d4-28c8-11e8-93b0-e5585eef7463.gif)
",shubham-padia,b'area: settings (admin/org) bug priority: blocker size: XL',2018-03-15T21:50:47Z,2018-09-08T19:31:01Z
8703,user-groups: Fix disappearing of group when name/description is edited.,"This PR fixes #8692.
When we edit a user group's name or description, it is disappearing due to the fact that 'members' is already a dict when user_groups.add is called from the editing function, so the add function fails and it does not get added to list when groups are populated. We fix by checking if 'members' is an Array, if yes, then we convert it to dict, otherwise not. Also, when we fix this issue, the edited group is going to the bottom, it is not staying at its position, so to fix this we sort by ids of the groups to maintain proper relative order.
",Kumar-Tarun,b'area: settings (admin/org) bug priority: blocker size: S',2018-03-14T09:49:49Z,2018-03-14T17:44:24Z
8699,org settings: Adding a realm filter returns an error.,"To replicate, just add a realm filter. It seems to successfully add it, but returns an error that the filter already exists.",rishig,b'area: settings (admin/org) bug priority: blocker',2018-03-14T06:23:18Z,2018-03-15T21:00:29Z
8695,Fix administration of subscribers for private streams,"Following up on #8361, we have a few bugs in administration of subscribers for private streams:
(1) Realm administrators don't get the initial subscribers for private streams they're not on from the backend on page load; this means that subscriber lists start empty even if the stream actually has subscribers.  

(2) The real-time sync mostly works, in that if you add a new subscriber, they show up, but it appears that somehow a second copy of the stream gets created in the stream list when a new subscriber is sent:

![image](https://user-images.githubusercontent.com/2746074/37372028-9cfed6fe-26ce-11e8-8fd1-2e48511a886b.png)

which in turn leads to these exceptions in the JS console from our `expectOne()` sanity checks:
```
    at Object.blueslip_error [as error] (webpack:///./static/js/blueslip.js?/srv/zulip-npm-cache/0eccedf6dfd9028cb901944f0a302669b35b6f86/~/source-map-loader:399:17)
    at jQuery.fn.init.$.fn.expectOne (http://southparkcommons.zulipdev.com:9991/static/js/setup.js:62:26)
    at Object.exports.rerender_subscribers_count (http://southparkcommons.zulipdev.com:9991/static/js/subs.js:159:51)
    at HTMLDocument. (http://southparkcommons.zulipdev.com:9991/static/js/subs.js:790:17)
    at HTMLDocument.blueslip_wrapper (webpack:///./static/js/blueslip.js?/srv/zulip-npm-cache/0eccedf6dfd9028cb901944f0a302669b35b6f86/~/source-map-loader:225:25)
    at HTMLDocument.dispatch (webpack:////srv/zulip-npm-cache/0eccedf6dfd9028cb901944f0a302669b35b6f86/~/jquery/dist/jquery.js?/srv/zulip-npm-cache/0eccedf6dfd9028cb901944f0a302669b35b6f86/~/source-map-loader!/srv/zulip-npm-cache/0eccedf6dfd9028cb901944f0a302669b35b6f86/~/source-map-loader:5206:27)
```

For fixing (1), I think it's possible we want the webapp to do a `GET /.../members` query when you click into the stream, rather than maintaining the data for every stream, but probably the simplest solution would be to just send subscriber data for all streams down in the initial requests for realm admins.  Probably requires some refactor of the `gather_subscriptions_helper` code path.

@YJDave FYI, since you're probably best equipped to debug these.",timabbott,b'area: stream settings bug priority: blocker',2018-03-13T22:00:43Z,2018-03-16T19:29:00Z
8692,user groups: Fix edit button for name and description.,"If you edit a user group description, and click the green checkbox, the user group disappears.",rishig,b'area: settings (admin/org) bug priority: blocker',2018-03-13T19:49:06Z,2018-03-14T17:14:13Z
8690,Fix real-time sync for dismissing hotspots,"Apparently, we don't correctly sync hotspots state on the UI layer.

The `server_events_dispatch.js` code for hotspots calls `hotspots.load_new()` -- which suggests that we only implemented showing the next hotspot, not dismissing older ones.  One can check the `events` data structures sent via the JS console, but my read is that `do_mark_hotspot_as_read` sends the list of hotspots that should still be visible on a change, so the browser should be able to diff that list with whatever was before, and hide any that are no longer in the list (i.e. have been dismissed).

(Read the ""new feature tutorial"" if you're not sure how this stuff works).

The best way to test this is to create a new user account (so you have hotspots), open two browser windows, and click the ""Got It!"" in one.  The second browser window should dismiss the hotspot.",timabbott,b'accessibility area: onboarding bug priority: high',2018-03-13T18:39:10Z,2018-03-18T17:26:35Z
8688,user settings: Fix user avatar not updated in settings page.,"On uploading new avatar, user avatar in settings page doesn't
get updated. Cause we have set `src` attribute of wrong html
element instead of image element in user settings page.

Fixes #8680

![useravatar](https://user-images.githubusercontent.com/25907420/37359496-c160489e-2713-11e8-9211-38d0c9c1ac2e.gif)
",YJDave,b'area: settings (user) bug size: XS',2018-03-13T17:41:10Z,2018-03-14T16:45:24Z
8680,Updating user avatar does not update the avatar on the settings page,"While trying to update my user avatar, I noticed that as I uploaded a new avatar, the settings page still shows the old avatar. On closing it though, my avatar has been successfully changed, and on opening the settings page the new avatar is displayed.",dgarvit,b'area: settings (user) bug',2018-03-13T04:02:30Z,2018-03-13T17:58:23Z
8664,portico: Prevent Firefox from bfcaching the page.,"Firefox stores the last state of the page in its back/forward cache
in memory and uses that for quickly rendering the page. Since our page's
last state was 'faded-out', the content wasn't visible when the browser
rendered the page from it's bfcache.

Fixes #7907.

Deployed a version with some console.logs at https://nightly.zulipdev.org/hello/
",aero31aero,b'area: browser-support area: portico bug size: S',2018-03-12T04:39:16Z,2018-03-12T05:17:25Z
8658,emoji: Realm emoji migration.,"Replaces PR #7832.


**Testing Plan:**
1: Try adding a realm emoji.
2: Delete it.
3: Try adding a realm emoji with same name.
4: Operation should be successful.

Fixes: #6977.",HarshitOnGitHub,b'area: emoji bug priority: high size: XL',2018-03-11T18:30:32Z,2018-03-21T18:24:05Z
8656,bugdown: Clarify walk_tree_with_family via ElementPair NamedTuple.,"While reviewing this code to add the cast for mypy 0.570, I thought this code might be clearer with use of a NamedTuple. I left the declaration outside of the function so that it doesn't need to repeatedly generate it.

I had hoped to set the NamedTuple to be defined in terms of itself for the parent type, but this seems to cause recursion and I'm not sure if there is a way around this?

This should be a straight substitution of data structure; it passed travis.",neiljp,b'size: S',2018-03-11T17:31:04Z,2018-03-11T22:04:47Z
8646,tests: Make test-js-with-node handling smarter.,"Added support for passing a filename without `.js` suffix.
This then fixed the issue of no complaints for invalid test
files.

Fixes #8579.

**Testing Plan:** <!-- How have you tested? -->
Run the following:
* `./tools/test-js-with-node unread` 
* `./tools/test-js-with-node unread.js`
* `./tools/test-js-with-node doesnotexist`
* `./tools/test-js-with-node unread doesnotexist`
",lonerz,b'area: tooling bug size: M',2018-03-10T19:28:31Z,2018-05-15T21:48:58Z
8641,"Fix issues with stacking ""you unsubscribed from stream"" notices","From #7468 reported by @roberthoenig this issue remains:

* unsubscribing from a stream and then revisiting the stream shows the stream, with a ""you unsubscribe from this stream"" ino in the bottom. being resubscribed makes that infodisappear. there is no new ""you subscribed to this stream"" info. unsubscribing again creates another ""you unsubscribed"" info. These stack up:
![image](https://user-images.githubusercontent.com/7950151/33082154-5da4af5a-cedc-11e7-801c-3df07ef091a5.png)

https://github.com/zulip/zulip/issues/7468#issuecomment-356615067 has some discussion.",timabbott,b'area: stream settings bug',2018-03-09T22:34:12Z,2018-03-26T16:51:39Z
8634,compose: Remove private stream warning when membership has full overlap.,"Currently if you type `#private-stream-name` in compose, it'll pop up a warning like 
`Warning: private-stream-name is a private stream.`

We should suppress that warning if you're composing to a stream whose membership is a subset of `#private-stream-name`.",rishig,b'area: compose bug help wanted',2018-03-09T06:41:26Z,2018-03-09T18:49:47Z
8628,pills: Improve style of placeholder texts in pills. ,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
This PR improves placeholder text styles, fixes #8622 

**pills: Show data-some-recipients placeholder text only on focus.**
    
    Show data-some-recipients placeholder text only when input
    element to add recipients is focused.
    
    Fixes #8622

**pills: Show data-no-recipients text only if no recipients selected.**
    
    Currently, we shows data-no-recipients placeholder text even if
    there are recipients selected. It's not visible cause it's value
    is override by data-some-recipients helper text in case if there
    are recipients selected.
    
    Show data-no-recipients placeholder text only when `input` element
    is first child of `pill-container`, which means there are no `pills`
    selected by user yet.

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![pillsplaceholder](https://user-images.githubusercontent.com/25907420/37169411-d077ee98-232d-11e8-8e17-a7746543e8d5.gif)
",YJDave,b'area: compose bug priority: blocker size: XS',2018-03-08T18:39:12Z,2018-03-09T11:54:13Z
8622,compose: Remove pills placeholder text when pills match the narrow.,"![image](https://user-images.githubusercontent.com/890911/37141142-f709b14c-2268-11e8-9a15-7fbedf0c073a.png)

We should remove the ""Add another user .."" text when
* You're narrowed to the PM or Group PM corresponding to the pills
* Your cursor is not focused on the ""To:"" line. 

Discussion at https://chat.zulip.org/#narrow/stream/101-design/topic/PM.20compose.
",rishig,b'area: compose bug priority: blocker',2018-03-08T08:40:28Z,2018-03-20T17:03:24Z
8620,org settings: Loading spinner are not visible.,"In organization settings, `Bots` and `Deactivated user` section's loading spinners are not visible. 
To reproduce the issue:
If you do not have many users/bots listed, you will not be able to see loading animations. In that case, you can comment out the code of destroying spinner(in `static/js/settings_users.js` function `populate_users` last lines).

This is followup of PR #8537 ",YJDave,b'area: settings (admin/org) bug help wanted',2018-03-08T04:41:54Z,2019-07-23T14:21:42Z
8611,Fix clipping of stream and topic name in left sidebar,"Changed a little bit the rule for line-height and top, so now it does not clip ""g"" letter in of stream and topic name in the left sidebar. 

Fixes #8209.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Three conditions that trigger this issue:

Using Chrome and zoomed in at 125%
Using Chrome and zoomed out at 90%
Using Firefox, with not zoomed in or out (100%)

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
Was:
![37033267-0f347f84-214e-11e8-8bd7-395641970ba6](https://user-images.githubusercontent.com/10120566/37084732-f5b4356e-21fb-11e8-8c1f-800ffdec8de1.png)

Now:
![37033273-1407e28a-214e-11e8-8f68-ed557c99529f](https://user-images.githubusercontent.com/10120566/37084739-fa72bdaa-21fb-11e8-85ee-4fcf49e9dd28.png)
![screenshot from 2018-03-07 11-28-06](https://user-images.githubusercontent.com/10120566/37084748-fee42ff4-21fb-11e8-8646-741fbc978a16.png)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Retsediv,b'area: browser-support area: message view bug size: XS',2018-03-07T09:38:39Z,2018-03-10T18:04:43Z
8610,"compose: Fix ""New Topic"" button behaviour auto-populates the current …","…topic.

Previously, Clicking a ""New Topic"" in a topic narrow auto-populates
the current topic.

Fixes #8608.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Test it by clicking a Clicking a ""New Topic"" button in a topic narrow

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![new-topic](https://user-images.githubusercontent.com/22166422/37074125-25660ff4-21f1-11e8-9a47-e7e6419cddbd.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Balaji2198,b'area: compose bug size: XS',2018-03-07T04:53:11Z,2018-03-16T19:21:44Z
8608,"compose: Clicking ""New Topic"" in a topic narrow auto-populates the current topic.","To reproduce: 
* Go to a topic narrow
* Click the ""New topic"" button

To see the correct behavior, use the `c` hotkey.
",rishig,b'area: compose bug help wanted',2018-03-07T00:36:15Z,2018-03-16T19:24:38Z
8603,compose: Improve error message for mentioning unsubscribed users.,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
Fixes #8550

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

![screenshot at mar 05 20-48-15](https://user-images.githubusercontent.com/15116870/37045832-b47826fe-211b-11e8-8852-e3b0eb079a89.png)
![screenshot at mar 05 20-48-03](https://user-images.githubusercontent.com/15116870/37045833-b4996936-211b-11e8-81c5-3a8dde5d3eeb.png)

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",synicalsyntax,b'area: compose bug priority: high size: M',2018-03-06T16:52:49Z,2018-03-17T17:39:45Z
8602,Fix clipping of stream and topic name in left sidebar,"Changed the rule for text overflow, that clipped stream and topic name in the left sidebar.

I changed the rule of text overflowing and deleted ""top"" property to align it properly.  

Fixes #8209.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
Three conditions that trigger this issue:

1. Using Chrome and zoomed in at 125%
2. Using Chrome and zoomed out at 90%
3. Using Firefox, with not zoomed in or out (100%)

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->

Was:
![screenshot from 2018-03-06 14-51-08](https://user-images.githubusercontent.com/10120566/37033267-0f347f84-214e-11e8-8bd7-395641970ba6.png)

Now:
![screenshot from 2018-03-06 14-51-31](https://user-images.githubusercontent.com/10120566/37033273-1407e28a-214e-11e8-8f68-ed557c99529f.png)



<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",Retsediv,b'area: browser-support area: message view bug size: XS',2018-03-06T12:57:59Z,2018-03-07T09:42:23Z
8601,compose: Improve error message for mentioning a user who isn't subscr…,"Fixes: #8550  Changed error message and styled it according to different screen sizes
![screenshot from 2018-03-06 16-21-27](https://user-images.githubusercontent.com/22816171/37029123-49ff33d0-215c-11e8-8bba-6c3f0c4ab403.png)
![screenshot from 2018-03-06 16-21-46](https://user-images.githubusercontent.com/22816171/37029125-4dedf940-215c-11e8-93fa-5963e27d3f65.png)
![screenshot from 2018-03-06 16-22-18](https://user-images.githubusercontent.com/22816171/37029130-505f92d8-215c-11e8-8042-dd7f156f1436.png)
",ihsavru,b'area: compose bug priority: high size: S',2018-03-06T11:08:34Z,2018-03-06T21:03:07Z
8592,signup: Wrap hostname overflow with scrolling in realm creation form.,"![](https://i.gyazo.com/5a961a3a7bb3b26889fe340bd56fe954.gif)

Fixes #8488.",synicalsyntax,b'area: authentication area: portico bug size: S',2018-03-05T16:50:20Z,2018-03-06T02:16:26Z
8589,"compose: Changes to make ""Sending..."" appear on the right of ""Drafts""","
<!-- What's this PR for?  (Just a link to an issue is fine.) -->
fixes: #8570

**Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![screenshot from 2018-03-05 14-08-26](https://user-images.githubusercontent.com/20434085/36965144-cc170c1e-207e-11e8-94f0-d90f1d0aac7c.png)

Removed `float:left` css property from ""Sending..."" and used `inline-block` to `display` instead of `block`.",abhigyank,b'area: compose bug size: S',2018-03-05T08:40:50Z,2018-03-09T22:45:28Z
8588,Clicking on an old-style mention doesn't pop the user-mention popover,"I saw a few production exceptions caused by people trying to click on mentions for very old messages, rendered before the `data-user-id` was added.

@adnrs96 I think you're well-equipped to do this given your work on removing that field in #8121.

This block:

```
    $(""#main_div"").on(""click"", "".user-mention"", function (e) {                                       
        var id = $(this).attr('data-user-id');                                                       
        if (id === '*') {                                                                            
            return;                                                                                  
        }                                                                                            
        var row = $(this).closest("".message_row"");                                                   
        e.stopPropagation();                                                                         
        var message = current_msg_list.get(rows.id(row));                                            
        var user = people.get_person_from_user_id(id);                                               
        show_user_info_popover(this, user, message);                                                 
    });                                                                                              
```

Should have fallback logic like that in `mention_button_refers_to_me` to `data-user-email`.  Probably makes sense to refactor to move that logic into a function and call it from both places, or something.",timabbott,b'area: message view bug',2018-03-05T03:58:43Z,2018-03-06T14:44:19Z
8585,Fix local echo marked.js implementation of emoticon translation,"The new emoticon translation implementation from bdb86f1b5ed745c5023e311d9cd960bcbc164190 doesn't correctly handle whitespace in the frontend markdown processor.  As a result, the local echo is wrong for messages containing potential emoticons (e.g. `a:)b` will get translated to emoji by the `marked.js` implementation; it should not be).  While fixing this, we should clean up how the marked.js unit tests work to cover this well; I think some tests will want to enable/disable the setting.  

Since it's a new optional setting that's default-off, I've elected to merge the feature despite the fact that this doesn't work.

Very soon, and regardless before a release, we should either fix the marked.js implementation to match the backend or disable the feature, since the local echo emoticon translator is sufficiently buggy as to cause bad interactions with things like pasted URLs.",timabbott,b'area: emoji area: markdown bug priority: blocker',2018-03-04T23:38:22Z,2018-03-28T00:21:37Z
8579,Make test-js-with-node argument handling a bit smarter,"This has two major problems that keep coming up:
* It doesn't support passing a filename without the `.js` suffix, e.g. `test-js-with-node unread` tests everything, not just `unread.js`.
* It doesn't complain if you pass an invalid test file.

",timabbott,b'area: tooling bug',2018-03-04T18:10:11Z,2018-03-26T10:39:01Z
8577,Exception with can_admin in real-time sync of bot data,"I saw this in production; don't have a clear reproducer.  I think it's worth something trying to play around with creating/editing bots in one browser with another browser open while looking for it, though.  See #8576 as a sidenote.  

My guess is that when a user is changed to be the admin of a bot (and thus the bot enters that user's bot data), that user doesn't get an event telling the client that the bot exists before they get an event telling them about the bot's new owner.  Or something like that.

```
Message:
Failed to process an event
Cannot set property 'can_admin' of undefined

Stacktrace:
TypeError: Cannot set property 'can_admin' of undefined
    at c (static/min/app.9ddad22036f3.js:2320:610)
       = static/js/bot_data.js line 16 column 9

    at Object.g.update (static/min/app.9ddad22036f3.js:2321:160)
       = static/js/bot_data.js line 45 column 9

    at Object.dispatch_normal_event (static/min/app.9ddad22036f3.js:2122:468)
       = static/js/server_events_dispatch.js line 124 column 13

    at static/min/app.9ddad22036f3.js:2111:103
       = static/js/server_events.js line 76 column 20

    at Function.q.each.q.forEach (static/webpack-bundles/common-ae9d0dc177dbe7eea9c3.c3a91c4a19f2.js:179:265399)
       = webpack:////srv/zulip-npm-cache/b32afb2e7b04fe936fa9afa9bbf4a59aedde022f/~/underscore/underscore.js?b4bb line 153 column 1

    at g (static/min/app.9ddad22036f3.js:2110:657)
       = static/js/server_events.js line 80 column 5

    at success (static/min/app.9ddad22036f3.js:2113:424)
       = static/js/server_events.js line 174 column 17
```

@roberthoenig FYI since you've done some recent work in this area.",timabbott,b'area: bots area: settings (user) bug',2018-03-04T18:01:53Z,2018-03-08T15:59:02Z
8573,authentication: Properly handle long domain names,"Fixes #8488
This shrinks the textbox according to the domain name
in the realm creation form.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->

<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
",AasthaGupta,b'area: authentication area: portico bug size: S',2018-03-04T13:54:59Z,2018-03-05T17:49:16Z
8570,"compose: ""Sending .."" appears to the left of ""Drafts"" instead of to the right.","![image](https://user-images.githubusercontent.com/890911/36941437-0260052a-1f10-11e8-8588-95e005239adf.png)

Not sure how to reproduce it normally, but you can remove the `display: none` from `#sending-indicator` to see it. ",rishig,b'area: compose bug help wanted',2018-03-04T02:25:04Z,2018-03-09T22:48:51Z
8569,@ hotkey doesn't add a space properly,"If you use the `@` hotkey when you have a message focused, it adds a mention, but is missing a trailing ` `.

@shubhamdhama I suspect this is a regression in your recent work to use `insert_syntax_and_focus`",timabbott,b'area: keyboard UI bug priority: high',2018-03-04T00:03:25Z,2018-03-04T21:20:05Z
8568,message-editing: Remove topic from recents on delete_message.,"Fixes #8411.
",shubham-padia,b'area: message-editing bug size: S',2018-03-03T18:57:16Z,2018-09-08T19:30:45Z
8559,uploads: Convert CMYK to RGB when saving avatar/realm icon as png.,"Fixes #8546.
PNG does not support CMYK mode. CMYK file is converted to RGB and
then saved as PNG.

see: https://github.com/python-pillow/Pillow/issues/1380

~~The file used for testing is obtained from [wikipedia](https://en.wikipedia.org/wiki/File:Channel_digital_image_CMYK_color.jpg), so there are no copyright concerns.
I tried converting the zulip logo used in test images, but converting to CMYK increases the image size by a lot ( >2MB ), i tried many solutions (using ImageMagick and Gimp) but couldn't reduce the size of the converted file.~~
Converted the zulip logo to cmyk with ImageMagick :tada: 

@timabbott Please review.",shubham-padia,b'area: dependencies area: uploads bug size: S',2018-03-02T18:22:14Z,2018-09-08T19:31:09Z
8555,Improve error message for mentioning a user who isn't subscribed,"New error message:
![screenshot from 2018-03-02 11-50-27](https://user-images.githubusercontent.com/22816171/36885968-056aeb82-1e10-11e8-840b-86fe386d9eb9.png)
",ihsavru,b'area: compose bug priority: high size: XS',2018-03-02T06:21:47Z,2018-03-06T11:24:40Z
8550,Improve error message for mentioning a user who isn't subscribed,"This error message:

![image](https://user-images.githubusercontent.com/2746074/36872127-0d95fdae-1d59-11e8-8e4d-7f8797dbf220.png)

Should make clear that the target user won't be notified if you mention them in a place they are not subscribed, since that's a key piece of information that's missing here.

(We could also open an issue for changing that behavior if we desired, but fixing this confusion is a small tweak).",timabbott,b'area: compose bug priority: high',2018-03-01T22:02:32Z,2018-03-06T21:06:56Z
8548,message edit: Cancel button is red.,"It should use our standard styling for cancel buttons, which is closer to black. Currently it's
![image](https://user-images.githubusercontent.com/890911/36868433-27a9e72a-1d4d-11e8-9e6c-685ec6c9d9aa.png)

",rishig,b'area: message-editing bug help wanted',2018-03-01T20:36:39Z,2018-03-02T17:42:25Z
8546,Problems uploading certain image files as avatars,"I suspect that this is a bug that will be chased down to our not having installed some library that is needed for PIL to handle these types of PNGs.  I'd start working on this by reading the PIL documentation for what files it can handle.  I don't have a sample actual file handy, unfortunately.

I think there's 2 things we need to do here:
(1) Make the error handling for this case a nice error message, not a 500.
(2) Ideally, make this file type work.

This is a somewhat challenging task requiring some research into Python libraries (and maybe some investigation to find a PNG that uses this feature), but it doesn't require special context on Zulip.

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/PIL/PngImagePlugin.py"", line 724, in _save
    rawmode, mode = _OUTMODES[mode]
KeyError: 'CMYK'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 124, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 543, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 525, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 686, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 129, in wrapper
    return func(request, user_profile, *args, **kwargs)
  File ""./zerver/views/realm_icon.py"", line 24, in upload_icon
    upload_icon_image(icon_file, user_profile)
  File ""./zerver/lib/upload.py"", line 526, in upload_icon_image
    upload_backend.upload_realm_icon_image(user_file, user_profile)
  File ""./zerver/lib/upload.py"", line 332, in upload_realm_icon_image
    resized_data = resize_avatar(image_data)
  File ""./zerver/lib/upload.py"", line 91, in resize_avatar
    im.save(out, format='png')
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/PIL/Image.py"", line 1930, in save
    save_handler(self, fp, filename)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/PIL/PngImagePlugin.py"", line 726, in _save
    raise IOError(""cannot write mode %s as PNG"" % mode)
OSError: cannot write mode CMYK as PNG
```",timabbott,b'area: dependencies area: uploads bug help wanted',2018-03-01T19:04:24Z,2018-03-02T21:01:07Z
8544,Scrolling in the /api documentation is messed up,"Try using `spacebar` to scroll down in http://127.0.0.1:9991/api/integration-guide in Chrome on Linux, and it's really choppy and hardly moves.  I'm guessing somehow we have the settings configured wrong for perfectScrollbar, but could be something else.",timabbott,b'area: documentation (api and integrations) bug priority: high',2018-03-01T16:18:06Z,2018-03-21T05:03:26Z
8523,Fix data model for user groups descriptions around field length,"I saw this exception in production:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 124, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 543, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 525, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 686, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 174, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/user_groups.py"", line 26, in add_user_group
    check_add_user_group(user_profile.realm, name, user_profiles, description)
  File ""./zerver/lib/actions.py"", line 4406, in check_add_user_group
    user_group = create_user_group(name, initial_members, realm, description=description)
  File ""./zerver/lib/user_groups.py"", line 70, in create_user_group
    description=description)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 394, in create
    obj.save(force_insert=True, using=self.db)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 808, in save
    force_update=force_update, update_fields=update_fields)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 838, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 924, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/base.py"", line 963, in _do_insert
    using=using, raw=raw)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 1076, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 1107, in execute_sql
    cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/utils.py"", line 94, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/utils/six.py"", line 685, in reraise
    raise value.with_traceback(tb)
  File ""/home/zulip/deployments/2018-02-21-02-06-42/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
django.db.utils.DataError: value too long for type character varying(100)
```

I think (A) if we have a limit on size, a limit in the UI layer is important (e.g. a limit to the text field size), and one only at the database level is crazy and (2) I'm not sure a 100 character limit makes sense.  I think we should probably just switch the database table to TextField so that we have some freedom to manage this just at the UI and Backend layers, and then set a reasonable limit on length in the UI.

@hackerkid can you take this one?  ",timabbott,b'area: settings (user) bug',2018-02-27T02:15:36Z,2018-03-01T19:33:13Z
8510,message view: Fix hiding of connection-error message on narrowing streams.,"When there is some error in connecting to server(more specifically to the
tornado server) the ""Unable to connect to Zulip"" connection error message
gets cleared as Django server could send the response of ""get"" request of
old messages and hence get_old_messages_success hides the error message
even though the connection is not properly established.

Fixes: #5599.

Is my understanding of issue and event system is correct?
@timabbott FYI.",shubhamdhama,b'area: message view area: real-time sync bug size: S',2018-02-25T12:39:55Z,2018-11-29T20:34:27Z
8495,user docs: Fix unwanted scrollbar on navigation on /help.,"You can get a scrollbar when the sidebar isn't shown in the mobile view.

![help-page-bug](https://user-images.githubusercontent.com/6378532/36591328-abbf3910-18b7-11e8-8c24-bf3fb15353d3.gif)
",aedorado,b'area: portico bug',2018-02-23T11:06:58Z,2018-03-04T23:43:28Z
8494,Bug on documentation of Zulip Advanced installation manual,"For installing postgres  pgrongo module, the manual does not contain the latest installation guideline for Ubuntus version from 16.04 onwards

Do check this link for information:
https://pgroonga.github.io/install/ubuntu.html
",kurianbenoy,b'area: documentation (developer)',2018-02-23T10:06:17Z,2018-03-16T20:46:35Z
8488,Realm creation form doesn't properly handle long domain names,"On /create_realm with a moderately long hostname, It'd be better to shrink the text box than do this line-wrapping.

![image](https://user-images.githubusercontent.com/2746074/36553370-fee81a38-17b0-11e8-9efa-b1761afb4f6c.png)
",timabbott,b'area: authentication area: portico bug',2018-02-22T17:17:28Z,2018-03-05T17:51:33Z
8476,auth: Preserve anchor during log in process.,"Currently, if you click on a link like https://chat.zulip.org/#narrow/stream/137-feedback/subject/Delay.20loading.20messages/near/483275, and get to the login page, we don't preserve the anchor post login (so you need to go back and re-click the link after logging in).

I'm not sure we preserve the URL in a situation like https://chat.zulip.org/stats either. 

This will become even more relevant after the public archive feature. ",rishig,b'area: authentication bug help wanted priority: high',2018-02-21T21:11:58Z,2018-03-21T20:55:18Z
8475,Adding custom emoji succeeds but says it failed,"Sometimes adding a new custom emoji will get a ""Failed"" or ""Failed: Realm emoji with this Realm and Name already exists."" but the emoji gets successfully added, appears in the list and can be immediately used.

The following traceback is generated:

```
Logger root, from module zerver.middleware line 281:
Error generated by Anonymous user (not logged in) on zulip deployment

Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
psycopg2.IntegrityError: duplicate key value violates unique constraint ""zerver_realmemoji_realm_id_cd513837_uniq""
DETAIL:  Key (realm_id, name)=(2, owlgenji) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 124, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 543, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 525, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 663, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 170, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/realm_emoji.py"", line 38, in upload_emoji
    check_add_realm_emoji(user_profile.realm, emoji_name, emoji_file_name, author=user_profile)
  File ""./zerver/lib/actions.py"", line 4108, in check_add_realm_emoji
    emoji.save()
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/base.py"", line 808, in save
    force_update=force_update, update_fields=update_fields)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/base.py"", line 838, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/base.py"", line 924, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/base.py"", line 963, in _do_insert
    using=using, raw=raw)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/query.py"", line 1076, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/models/sql/compiler.py"", line 1107, in execute_sql
    cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/utils.py"", line 94, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/utils/six.py"", line 685, in reraise
    raise value.with_traceback(tb)
  File ""/home/zulip/deployments/2018-01-20-06-09-50/zulip-py3-venv/lib/python3.4/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""./zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""./zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
django.db.utils.IntegrityError: duplicate key value violates unique constraint ""zerver_realmemoji_realm_id_cd513837_uniq""
DETAIL:  Key (realm_id, name)=(2, owlgenji) already exists.

Request info: none
```

Our deployment is from this commit: 8530ed0b5e8ee8f62bceb5202ecf3e69c7bcf210

Possibly related to #6977 which we also run into.",swallitsch,b'area: emoji bug',2018-02-21T19:41:49Z,2018-03-11T23:29:04Z
8474,Errors searching for characters in Unicode code planes above Latin Extended A,"The report below is for Firefox v.58.0 and Chrome v.63.0.3239.132, both on Mac OS 10.13.2.

1. On the Recurse Center instance I searched for the character `無` (U+7121), which I know is present in some posts. No hits are returned, and I get the error:

   > Unable to connect to Zulip. Updates may be delayed. Retrying soon...

   over and over, and the circle around the Z logo turns constantly. But at these times I can search for regular ASCII text in another browser tab and get hits back without difficulty. So the error message is inaccurate and must have something to do with something specific to the failed search.
   
   After I send the request, the browser's URI field shows binary encoding of the UTF-8 value of 無: https://recurse.zulipchat.com/#narrow/search/.E7.84.A1. Normal URL quoting format would be `%E7%84%A1` rather than `.E7.84.A1`, but I suppose Zulip has its own ways. Manually changing the URL to use `%` instead of `.` returns empty results.

2. I also tried searching one by one for some other non-ASCII strings that I know are in a post:

    * lǎomóu
    * wěishàn
    * fēiwén

   Like 無, the characters `ǎ`, `ě`, and `ē` in these strings are all not only non-ASCII but their codepoints are above the Latin Extended-A code plane, so they're a good test. In Firefox only fēiwén is found; the other two give me the same error message as before. Chrome finds all three. The highlighting of the found strings is off, as per #7021, but that's a separate problem.

3. I tried sending myself a message containing combining characters:

   ```
   m̥ o̦ n̑
   ```

   Both Firefox and Chrome succeed in finding (and correctly highlighting) the pairs of ASCII and a combining character; neither can find the message in question if I submit just the combining characters alone.

---

I've been thinking of setting up a Zulip instance to start a sinological discussion board, but if the application can't handle Chinese and Pīnyīn and the IPA Extensions codeplane consistently, that will be impossible.
",brannerchinese,b'bug',2018-02-21T12:19:00Z,2018-02-21T17:45:52Z
8429,popovers: Show hotkey reminder for sender info popovers only.,"Hotkey reminders in user popovers( i.e. `@` and `R`) should be present
only for sender info popovers, hence for user-mention and user-presence
popovers it will show no such reminders.

Fixes: #8313.

<!-- What's this PR for?  (Just a link to an issue is fine.) -->


**Testing Plan:** <!-- How have you tested? -->
**MANUAL TESTING**

**GIFs or Screenshots:** <!-- If a UI change.  See:
  https://zulip.readthedocs.io/en/latest/tutorials/screenshot-and-gif-software.html
  -->
![popover](https://user-images.githubusercontent.com/22238472/36340856-ec134b48-140a-11e8-8966-bd9a801343a4.gif)


<!-- Also be sure to make clear, coherent commits:
  https://zulip.readthedocs.io/en/latest/contributing/version-control.html
  -->
When sender mentions himself in a message it shows these reminders(which I think is okay).",shubhamdhama,b'area: documentation (user) bug in progress size: S',2018-02-17T12:20:04Z,2018-02-21T21:07:16Z
8424,features page: Fix keyboard shortcuts overflow on iPhone 7 sizing,"Several ideas are discussed in https://github.com/zulip/zulip/pull/8360#issuecomment-366090006; I'd probably prefer the ""change HTML"" version of that solution.",timabbott,b'area: portico bug',2018-02-16T23:43:08Z,2020-03-31T22:00:27Z
8419,bugdown: Duplicate links in a post will only make one embed #8379,"<!-- What's this PR for?  (Just a link to an issue is fine.) -->
When the same link is duplicated in a message only a single embed will be generated for it. Fixes #8379

Before:
![capture2](https://user-images.githubusercontent.com/4214851/36327427-a0c0e08c-1384-11e8-95cd-1ce29be67e19.PNG)

After:
![capture](https://user-images.githubusercontent.com/4214851/36327429-a100096a-1384-11e8-90d7-aba34056b560.PNG)
",aayushagra,b'has conflicts size: M',2018-02-16T20:18:48Z,2019-06-04T14:18:21Z
8416,Popover leaks memory,"In static/js/popovers.js there's an array of all popovers used to keep track of open popovers for the purposes of close_all, and making sure the popped open tooltip element is correctly deleted. This array should be truncated in order to release the Popover elements themselves (as they maintain references to orphaned DOM elements via jQuery objects).

I will submit a PR for this momentarily, as it's a one-liner.",ericeslinger,b'area: message view bug',2018-02-16T19:14:41Z,2018-02-16T21:34:01Z
8411,Improve live-update when a message is deleted by an administrator,"When all the (unread) messages in a topic are deleted, the Zulip webapp (and mobile app, but that's https://github.com/zulip/zulip-mobile/issues/1926) don't properly clear unread counts.

Here's our current handler for a deleted message in `server_events_dispatch.js`:
```
    case 'delete_message':                                                                           
        var msg_id = event.message_id;                                                               
        ui.remove_message(msg_id);                                                                   
        break;                                                                                       
```

We should also be clearing any unread counts related to that message (effectively marking it as read; though we need to be careful, as the message might have already been read).

A secondary thing we may need to do (but I wouldn't block resolving the first issue on finishing this, since it's much less user-visible as broken) is removing the topic from the recent topics data structures if the last message in that topic was deleted.

(This is the ""Delete message"" option in the actions popover available to administrators)",timabbott,b'area: message-editing bug',2018-02-16T15:54:05Z,2018-03-04T21:14:34Z
8393,User report: Clicking on twitter preview links from mobile crashes the app on iOS,"This should be easy to test/verify with #twitter on chat.zulip.org.

",timabbott,b'bug',2018-02-14T20:48:04Z,2018-02-14T20:48:42Z
8387,"Linter: linting as XHTML, but we're writing HTML5","The linter emits an unterminated tag error if you use something like `<hr>` . It is one of the few empty elements (input, img) that should not have a terminating tag, and shouldn't be an xhtml-style self-closing tag either: `<hr>` by itself is valid HTML5, `<hr></hr>` is not valid, and `<hr/>` is questionable.

The actual doctype of the zulip page is HTML5 (line 1 is `<!DOCTYPE html>`), so the linter should probably accept that certain tags are self-terminating. The terminating slash there is not forbidden by the HTML5 spec, but it's also not encouraged.",ericeslinger,b'area: tooling bug',2018-02-14T17:50:22Z,2018-02-15T22:47:45Z
8379,Bugdown: Duplicate links in embeds,"When you send multiple duplicate links in a single chat message there are two embeds created for the exact same content.

Example: (https://www.youtube.com/watch?v=4bfECHhoBBQ https://www.youtube.com/watch?v=4bfECHhoBBQ) would create two embeds for the exact same video",aayushagra,b'area: markdown',2018-02-14T10:15:52Z,2019-07-11T20:39:26Z
8378,stream notification settings: send bulk query when applying change to all streams,"fixes #5898.
No changes in the backend were needed, the api endpoint was already accepting a list for multiple changes.
@timabbott please review",shubham-padia,b'area: notifications (messages) area: stream settings bug size: S',2018-02-14T09:20:02Z,2018-09-08T19:30:37Z
8352,help: Fix link with query selector from left sidebar won't work,"Please review this PR.
This resolves the issue of scrolling to correct position when loaded from left sidebar to a link with query selector.",jainaman224,b'area: documentation (user) bug in progress size: S',2018-02-12T19:21:30Z,2018-02-14T17:29:15Z
8346,Hotspots got it 8275,,patricknaughton01,b'area: general UI bug in progress size: S',2018-02-11T21:17:18Z,2018-02-15T03:19:20Z
8322,bug: when pasting some .pdf from the web memcached breaks,"this relates to [partial connection problems](https://chat.zulip.org/#narrow/stream/production.20help/subject/partial.20connection.20problems/near/489927)
@timabbott will know more about this as well

* user in conversation pastes a certain type of URL with pdf
* the unrendered content in the db would be find
* the rendered content in zerver_messages ends up being huge (in our case 3500000 characters)
* memcached can't handle such big messages 
* suscribers of that stream can't use zulip anymore as it can't connect properly to the server
* other users still can continue without problems

I'm not sure how to describe all this as I lack background understanding and terminology. I can explain more though. Tim also has the link to the particular pdf. It would be good to build in a mechanism that checks the rendered content for length before it created the entry in the database. ",penCsharpener,b'area: markdown bug',2018-02-09T10:23:54Z,2018-02-09T19:02:07Z
8313,Remove keyboard shortcut hint from user card,"When you click on a user, and the user card pops up, you have an option to ""Send private message (R)"", even though that particular shortcut is not very useful when you are already in a mouse-using mode. We should remove the keyboard shortcut hint and add it to the actions popover menu instead (which is where it is most likely to be actually used.) https://chat.zulip.org/#narrow/stream/feedback/subject/keyboard.20shortcut.20for.20private.20messages

",Lyla-Fischer,b'area: documentation (user) bug',2018-02-08T19:42:34Z,2018-02-21T21:10:32Z
8301,Fix typeahead ordering for user group mentions,"Here's what you currently get when trying to autocomplete `@mobile` on chat.zulip.org with the typeahead:

![image](https://user-images.githubusercontent.com/2746074/35933630-02a71c68-0bf0-11e8-9d1a-e6361996220c.png)

We should definitely sort user group exact prefix matches ahead of users who don't have a prefix match.  

@*hamletcharacters* is the test user group present in the dev environment by default.

It's possible the quick fix here is to just put user groups before everything else.",timabbott,b'area: compose bug priority: high',2018-02-07T18:19:29Z,2018-02-16T18:15:07Z
8295,stream settings: Should update view for permissions when leaving private stream,"If I leave a private/invite-only stream, I still see the list of members and the edit icons:
![image](https://user-images.githubusercontent.com/28173/35891634-33636c76-0b5a-11e8-8c84-5b93389a0f60.png)

even though if I then switch to some other stream and back, I (correctly) can't:
![image](https://user-images.githubusercontent.com/28173/35891678-68f0ba06-0b5a-11e8-8715-5bc62c3135dd.png)
",gnprice,b'area: stream settings bug',2018-02-07T00:26:18Z,2018-03-13T16:58:20Z
8289,dev env: Pre-populate open graph cache in populate_db.,"Getting this error on do-destroy-rebuild-database, when not connected to the internet.
```
+ ./manage.py populate_db -n100 --threads=1
2018-02-06 00:31:57.070 ERR  [] Unable to fetch information from url https://zulip.readthedocs.io/en/latest/subsystems/emoji.html, traceback: Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/urllib3/connection.py"", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/urllib3/util/connection.py"", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File ""/usr/lib/python3.4/socket.py"", line 533, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known
```

Tim says: 
It's trying to do an open graph preview, I think.
Because that's part of the test data.
I think we should be able to address that by pre-populating a certain cache a bit earlier in populate_db.
In particular, all the URLs in zerver/fixtures/config.generate_data.json should probably be pre-populated.",rishig,b'area: tooling bug help wanted',2018-02-06T18:30:35Z,2018-03-27T23:46:58Z
8279,typeahead: Don't autocomplete for suffixes followed by a space. ,"Things like `#s ` (with a space at the end) trigger the autocomplete, which is not what we want. More generally, for `#word text` (and similar situations, like `@word text` and `:word text`), we should only show the autocomplete for entries where `word` matches the full first word of something being completed (and similarly for multi-word phrases).

Note this should apply even if `text = ''`. 
",rishig,b'area: compose bug help wanted',2018-02-06T01:58:42Z,2018-03-01T22:49:06Z
8275,"hotspots: ""Got it"" text in button is cut off in longer translations.","In particular, https://screenshots.firefox.com/wvCF7r9PhYf4QPj7/nerdocs.zulipchat.com in German. This is from the ""New Topic"" hotspot.",rishig,b'area: general UI bug good first issue help wanted',2018-02-05T17:06:00Z,2018-04-11T00:50:46Z
8253,Broken user avatar if sourced from gravatar.,"User avatar which is sourced from gravatar is broken in account setting -

![image](https://user-images.githubusercontent.com/2263909/35737239-ddb78c1e-0850-11e8-91c0-0b332ebe868e.png)

More discussion [here](https://chat.zulip.org/#narrow/stream/frontend/topic/avatars).",akashnimare,b'area: settings (user) bug',2018-02-02T14:13:46Z,2018-03-20T17:03:24Z
8249,Give a user-facing error for dev_direct_login failures,"Currently, we just 500 when a client tries to use the direct login backend in production; we should return an error HttpResponse instead.  I'd check what we currently do for other login failures, and copy that.

```
@csrf_exempt                                                                                                             
def dev_direct_login(request: HttpRequest, **kwargs: Any) -> HttpResponse:                                               
    # This function allows logging in without a password and should only be called                                       
    # in development environments.  It may be called if the DevAuthBackend is included                                   
    # in settings.AUTHENTICATION_BACKENDS                                                                                
    if (not dev_auth_enabled()) or settings.PRODUCTION:                                                                  
        # This check is probably not required, since authenticate would fail without                                     
        # an enabled DevAuthBackend.                                                                                     
        raise Exception('Direct login not supported.')                                                                   
```

There's a second `raise Exception` a bit later in the file that we should fix too.

@umairwaheed can you take this one?  ",timabbott,b'area: authentication bug',2018-02-02T02:16:56Z,2018-02-21T06:39:14Z
8247,Make it easy to copy-paste extra long emails,"Reproducer:
(1) Change a user's email to something super long
(2) Click that user's avatar to get the profile popover.
(3) Try to copy-paste the actual email address.  You can only access it via hover, see here:
![image](https://user-images.githubusercontent.com/2746074/35706657-77e643d0-075b-11e8-9056-c3244eab0b1e.png).  

(The screenshot is a bit messed up since the hover was fading as I took it).

Ideally, for long emails that are truncated, the line would be a link where you can copy the email address (or perhaps better, we would have a little copy-to-clipboard button, like we have in the ""show original"" message actions menu).

@cPhost want to take this?  It's a follow-up to 97c3d5fce3ee5c905d5479a7e0a908f85357ba83.",timabbott,b'area: message view bug',2018-02-01T22:25:46Z,2018-03-12T19:26:04Z
8242,right sidebar: Change coloring algorithm for group PMs.,"The current algorithm feels buggy to people; we've gotten several reports like 
https://chat.zulip.org/#narrow/stream/electron/topic/.5BBug.5D.20Group.20PMs.20showing.20as.20online

A better algorithm would be
* full green = everyone in the PM is green
* light green = at least one person in the PM green
* white otherwise
",rishig,b'area: right-sidebar bug good first issue help wanted',2018-02-01T20:15:47Z,2018-05-02T19:45:42Z
8236,Stuck unreads that I've read elsewhere,"I have three PMs that a Zulip tab of mine thinks are unread:
![image](https://user-images.githubusercontent.com/28173/35658406-fe671e62-06b5-11e8-83ad-665448607576.png)
The favicon and title agree with the sidebar: both show 4 unreads, and the favicon alternates showing the ""person"" icon.

I actually have a second tab -- something I don't usually do -- and I read the messages there, and it has the correct count (there's 1 genuine unread, in a stream):
![image](https://user-images.githubusercontent.com/28173/35658470-4c56c0e6-06b6-11e8-9057-8ba897408cdf.png)

Since noticing this situation, I've gotten several more PMs in the same thread, and read them in that same left-hand tab that I read the others (and replied). Each time, the messages make both unread counts go up; and when I read them on the left, both go back down. The one on the right stays 3 too high.

OK, and in the tab with the stuck unreads, I just went to PMs. It immediately went to a specific message, which promptly became read (and the count updated accordingly). That message had been edited, which is interesting in light of #7229.

The next message received in that thread was also unread -- but not edited.

The next was already read.

The next was also unread, and not edited.

See also #8042. Unlike both #8042 and #7229, though, the unread flag and count promptly updated when I went and looked at the messages -- the issue is that when I read them elsewhere first, this tab didn't get/understand that update from the server.

@showell, I think you made some fixes in this general area in recent weeks.
",gnprice,b'area: left-sidebar bug priority: high',2018-02-01T02:50:59Z,2020-01-31T20:52:19Z
8235,emoji: Walking emoji has funny line on top with Apple emoji set.,"I think this isn't true in our default google emoji set, but I believe `:walking:` looks like following in one of the other ones:
![image](https://user-images.githubusercontent.com/890911/35643284-b1277402-067a-11e8-9ca2-9ebd65a5807d.png)
",rishig,b'area: emoji bug help wanted',2018-01-31T19:35:18Z,2018-07-23T15:06:11Z
8230,stream creation: Creating a stream without yourself in it doesn't take you to the stream page afterwards.,"To reproduce:
* Log in as Iago
* Create a public stream without Iago in it

Expected behavior is to get to the stream page, just like you would if you were in it.

I didn't explore this thoroughly, but when resolving this I would test with each of the four possibilities:
* public and private stream
* admin and non-admin

@YJDave fyi. ",rishig,b'area: stream settings bug help wanted',2018-01-31T01:12:09Z,2018-03-13T16:55:26Z
8209,Clipping of stream and topic name in left sidebar,"Under certain conditions, some parts of the topic and stream names in the left sidebar overflow, and hidden. I have discovered three conditions that trigger this issue:
 1) Using Chrome and zoomed in at 125%
 2) Using Chrome and zoomed out at 90%
 3) Using firefox, with not zoomed in or out (100%)

Sometimes a specific stream needs to be in focus (no necessarily the stream that is clipping), so to reproduce this issue you may need to try clicking on various streams.
![clipped_stream_name](https://user-images.githubusercontent.com/16677912/35479811-60ecefe4-0454-11e8-97db-5413a4e357fb.PNG)
![topic_clipping](https://user-images.githubusercontent.com/16677912/35479812-612765f2-0454-11e8-91d3-9dba85c32fcf.PNG)

Discussion on czo: https://chat.zulip.org/#narrow/stream/feedback/topic/Stream.20name.20clipping",XavierCooney,b'area: browser-support area: message view bug',2018-01-28T06:59:19Z,2018-04-19T17:26:45Z
8205,portico: Hide realm details when registering new realm.,"If there was a realm on the base URL, its logo and name were being
displayed when registering a new realm (i.e. the page where realm details
are entered, after confirming email). This commit prevents the realm
details from being displayed.

Fixes #8186",adishegde,b'area: portico bug size: XS',2018-01-27T13:51:48Z,2018-02-01T10:04:36Z
8204,Clicking between Users and magnifying glass opens User search.,Fixes #8161.,dgarvit,b'area: right-sidebar bug in progress size: XS',2018-01-27T10:05:46Z,2018-01-28T00:32:46Z
8202,Zooming in 150% overrides scrollbar,"After loading in a page on 100%, zooming in 150+% causes the navbar to lay on top the scrollbar, also causing some elements to be misaligned.

![zoomerror](https://user-images.githubusercontent.com/15152698/35468229-ec6f16c8-02e7-11e8-98fc-5282d65c86b3.gif)
",gooca,b'area: browser-support bug',2018-01-27T03:30:00Z,2019-05-17T21:40:39Z
8201,"left sidebar: The fading on inactive, pinned streams doesn't update when messages come in.","I haven't tried to repro this, but it happens fairly often in regular use:
* I have some pinned streams that are inactive (meaning, have no messages loaded), and hence show up in a muted grey in the left sidebar
* Someone sends a message to that stream

Expected behavior is that the stream should become active, e.g. the name should change color to the normal near-black. Instead, even clicking on the stream, reading the message, etc. doesn't change the color. Refreshing the window does change the color. 

Another similar bug (possibly the same bug) is that if a stream is pinned and inactive, clicking on the stream should make it active, since just clicking on the stream loads a bunch of messages.",rishig,b'area: left-sidebar bug help wanted priority: high',2018-01-27T03:04:38Z,2019-06-04T00:26:20Z
8190,settings: add loading indicator for account deactivation,Fixes #8175,AasthaGupta,b'area: settings (user) bug size: M',2018-01-26T09:20:29Z,2018-02-23T16:22:02Z
8186,portico: Don't show org name and logo on /accounts/register if realm_creation.,"If there is an realm on the base URL, you'll see it when you go through the create_realm flow (at least in the dev environment; I'm not sure if this is dev specific):
![image](https://user-images.githubusercontent.com/890911/35421625-1a175b70-01f9-11e8-8ac8-9f3f33aae0d7.png)

To reproduce: 
* go to localhost:9991/create_realm
* Follow the create_realm flow (click on /emails on the next page, and then the registration button in the topmost email on that page)
* create a realm with the base URL (zulipdev.org:9991, or something like that), and call it something memorable for the realm name, like ""SHOULD NOT APPEAR""

Repeat steps 1 and 2 above. You should see ""SHOULD NOT APPEAR"" in a place it should not appear :).",rishig,b'area: portico bug good first issue help wanted',2018-01-26T01:59:47Z,2018-01-31T23:20:09Z
8184,message view: Search view doesn't mark messages as read in some situations.,"I may have seen this in a more general situation as well, but an easy to replicate bug:
* Search for something, like `stream:test+here hello`
* reply to the last message with `hello`

expected behavior: the message you just sent should have been marked as read.

* use arrow keys to go up and down

message is still not marked as read.
",rishig,b'area: message view bug help wanted needs product review',2018-01-26T01:33:25Z,2018-04-28T21:45:09Z
8182,Scrolling through messages on mobile result in opening compose box ,"The compose box keeps opening in chrome on android when scrolling through the messages. This has become too annoying to the point I cant use Zulip on Chrome(Android).
https://chat.zulip.org/#narrow/stream/general/subject/mobile.20web/near/466648",hackerkid,b'area: compose area: mobile web bug priority: high',2018-01-25T21:00:29Z,2020-05-30T19:08:01Z
8180,left sidebar: Clicking on a stream clears the stream search.,"Clears and hides the search bar when a stream is selected from the
filtered stream list.

Fixes: #7909.",loganwilliams,b'area: left-sidebar bug in progress size: S',2018-01-25T20:24:41Z,2018-01-29T19:15:04Z
8178,Recent messages never appear (in a muted stream),"I opened https://chat.zulip.org/#narrow/stream/test.20here directly in a new tab. 

Then I went to the end (using the Page Down key as usual). But what I actually see isn't the end -- it only goes up to a message from Dec 29, weeks ago and probably 100 or more messages:
![image](https://user-images.githubusercontent.com/28173/35408513-3f9a7c5e-01c4-11e8-98d4-c191ee687078.png)
Hitting the Page Down key again, or Down, or scrolling up a bit and then back down, all have no effect; no spinner appears, and no more messages load. The message view behaves exactly like this is really the latest message in the stream and there's nothing else to see.

The sidebar is right, though -- it shows the actual most recent topics:
![image](https://user-images.githubusercontent.com/28173/35408521-47d1b676-01c4-11e8-9b0f-82a2775d6c6c.png)

As the sidebar (correctly) also shows:
* I was already fully caught up in the stream;
* I have the stream muted.

Then: if I hit `s` to narrow to the stream, the app promptly loads a bunch more messages, and scrolling to the end now takes me to the genuine end.

After I first saw this, I tried the whole thing in a new tab and it reproduced exactly.

I've never seen a bug like this before (and a good thing that is!), which leads me to guess it's related to the stream being muted. @showell, do you have any thoughts on where it might lie or how to debug?

(Marking as high priority because any bug that causes the user to silently not see messages is scary, even if rare.)
",gnprice,b'area: message view bug priority: high',2018-01-25T19:48:54Z,2018-03-12T04:34:45Z
8177,"message view: EXIF orientation is ignored, causing images to look rotated","(@gnprice:) Here's a [nice description of the issue](https://help.gigsalad.com/article/117-fix-rotated-photos) from a different webapp, complete with instructions for how to fix it as a user:

* The cause:

  > You may notice that sometimes when [posting a photo on Zulip] that the image is not rotated correctly. This is not a bug [in Zulip]! Rather, this is a fairly technical behind-the-scenes issue that involves the photo's orientation meta data and a web browser's inability to interpret it. [...]

  > Cameras, especially those on mobile phones and tablets, have built-in orientation sensors that assign special rotation information to every photo they take. Behind the scenes, this tells other apps what the correct rotation angle should be for that photo. In other words, your photos are actually taken and saved sideways but then extra orientation meta data specifies a rotation angle for correctly displaying the photo. When you view that photo in your phone's gallery, or in an app that understands the orientation meta data, it appears as if the image is rotated properly when it's actually not. Unfortunately, web browsers [don't] honor orientation meta data. This is why a photo might appear sideways after it has been uploaded [to Zulip].

  Sad but true. Some phones prevent this problem by rotating the actual image data, but many (even many recent, high-end phones) do not.

* How to fix it for your photos:

  > To make sure that a photo will be displayed properly in web browsers the best option is re-save the photo with proper rotation and without orientation meta data. On a mobile device, you can often achieve this by opening a photo and rotating it 360 degrees or until it appears correctly then re-saving it as a new photo. Alternatively, you could save a slightly cropped version of the same photo. You could also download the photo onto a desktop computer and adjust it using the basic photo apps built into OSX and Windows (both called Photos) or an advanced photo editing program such as Adobe Photoshop or Lightroom.

We should also develop a solution that fixes photos up automatically, so people don't have to do it themselves. More on that below.

---
(@gnprice's technical description, following the investigation below:)

By default in a JPEG photo, the pixels around coordinates (0, 0) -- i.e., the first pixels in the file -- go in the upper left. Many devices produce JPEG files that start somewhere else. These contain some metadata, in the EXIF format, to say something like `orientation=upper-right`, meaning the pixel at (0, 0) goes in the upper right instead of the upper left. This means any software displaying the photo needs to respect that metadata; if it doesn't, the photo will come out wrong, e.g. rotated sideways.

Unfortunately, while a lot of software does respect EXIF orientation metadata, the web does not. Specifically, an `<img>` element in HTML ignores it. The result, given we don't do anything to deal with this, is that these photos are shown sideways in the Zulip webapp, desktop app, and most of the mobile app.

Devices that produce photos with this problem include some phones, but not others, from each of Apple, Samsung, and Google; also some phones from Motorola and probably other vendors; probably some standalone digital cameras too, but nobody in these threads has tried one. Reports of this issue have referred to uploaded photos in messages and to user avatars.

To fix this, we'll need to inspect uploaded images (including user avatars) on the server at upload time to extract the EXIF orientation metadata. Then we can do either of the following:
* Normalize the orientation to `upper-left`, rearranging the pixels as needed. (A [Medium post](https://medium.com/@ageitgey/the-dumb-reason-your-fancy-computer-vision-app-isnt-working-exif-orientation-73166c7d39da) linked below has example code to do this in Python, using PIL.)
* Convey that metadata to the client (perhaps in a `data-` attribute on the `img`?) so it can apply a CSS transform to fix the orientation.

For more detail and background, see https://github.com/zulip/zulip/issues/8177#issuecomment-534310596 below, and the comments after it.

---
(original report:)

quoting a conversation:

A: my pictures come in sideways when i upload them, even when they are the correct orientation

B: If they are coming from a phone, this might be a matter of browser support. The image is rotated, but has metadata that specifis the correct orientation taken from the phone's gyro. Browser not respecting this metadata might result in the issue.

C: I remember hearing about something crazy that iPhones specifically did here -- like if you go and rotate them in the built-in camera app, it just does something in some idiosyncratic metadata that Apple's stuff all pays attention to.

D: Yeah this happens w iPhone metadata and browser uploads. Just detect the orientation by width vs height and make sure it's not rotated.

E: This is relevant:
https://developer.mozilla.org/en-US/docs/Web/CSS/image-orientation#Browser_compatibility",rishig,b'area: message view bug priority: high',2018-01-25T18:09:58Z,2020-04-30T18:55:17Z
8175,settings: Add loading indicator for account deactivation.,"Account deactivation is fundamentally a slow process, and so should have a loading indicator. 
Deactivate account appears on http://localhost:9991/#settings/your-account. ",rishig,b'area: settings (user) bug help wanted',2018-01-25T17:46:00Z,2018-02-23T16:24:54Z
8162,"settings: Allow selecting ""restrict to domain"" even if no domains selected.","Allow a user to click anywhere on the ""restrict to domain"" line to open the modal.

Fixes: #7626.",brockwhittaker,b'area: settings (admin/org) bug priority: high size: S',2018-01-24T22:19:38Z,2018-02-05T21:36:27Z
8161,right-sidebar: Clicking between Users and magnifying glass should open User search.,"This whole region should be a click target, similar to how we do Stream search.
![image](https://user-images.githubusercontent.com/890911/35358405-675a10ce-010b-11e8-9004-b5951b1cfe26.png)

It's a bit confusing not to have it work, given that we do it on the streams side.",rishig,b'area: right-sidebar bug good first issue help wanted',2018-01-24T21:36:05Z,2018-02-18T06:03:53Z
8159,markdown: Require double-asterisk around all mentions.,"This enforces `**` around all the mentions(excluding group mentions)
including ""at-all"" and ""at-everyone"" mentions.
Covered above changes in tests and added some tests
other corner cases.
In case I'm missing something as a followup please tell me.
Fixes: #8143.
(Travis might be failing but CirlcleCI is passing.)",shubhamdhama,b'area: markdown bug size: XL',2018-01-24T17:43:32Z,2018-02-16T19:48:31Z
8145,Commit message linter doesn't accept revert commits,"I got this error:

`1: T7 Title does not match regex (^(.+:\ )?[A-Z].+\.$): ""Revert ""katex: Update the `require` path to point to the new one.""""`

We should add an exception for the standard Git-generated Revert commits.

@tommyip FYI.",timabbott,b'area: tooling bug',2018-01-23T20:29:49Z,2018-02-13T17:23:27Z
8143,markdown: Require ** around at-all mentions.,"Sending a message to `@alleycat.com` (as in, the domain for someone's email address) triggers at an at-all mention, as does just sending a message with `@all`.

The correct way to at-all mention is `@**all**`.

http://zulip.readthedocs.io/en/latest/subsystems/markdown.html may be helpful documentation.",rishig,b'area: markdown bug good first issue help wanted',2018-01-23T18:58:21Z,2018-04-20T18:02:56Z
8140,Really long filter regex causes window malfunction,"A really long filter causes the window to be too thin and the trash button no longer appears.

Closing the org settings and re-opening has no effect. Stretching the window's aspect ratio extremely wide has no effect.

Workaround: Inspect elements, set max-width of settings page to 1920 or so.",swallitsch,b'area: settings (admin/org) bug',2018-01-22T21:34:03Z,2018-02-06T17:00:12Z
8134,messages: Make checking for status message consistent with backend.,"Adds a check for newline that was present on backend, but missing in the
frontend markdown implementation. Updating messages uses is_me_message flag
received from server instead of its own partial test. Similarly, rendering
previews uses markdown code.

Fixes #6493.",wjkg,b'bug size: M',2018-01-21T19:33:31Z,2018-01-25T00:50:18Z
8119,lightbox: Make image description responsive.,"This is a series of fixes by @ihsavru, with one minor change to fix for linting (adding a new line in the CSS).

Fixes: #7789.

This is #7808, but with the tests fixed.",brockwhittaker,b'area: message view bug design in progress size: S',2018-01-19T23:39:09Z,2018-01-20T01:13:20Z
8116,`/srv/zulip_npm_cache` is being over-aggressively deleted in production,"Something is deleting everything under `/srv/zulip_npm_cache` too aggressively (i.e. `/home/zulip/deployments/current/node_modules was a broken symlink, because the whole directory was empty).  I noticed this on chat.zulip.org and zulipchat.com.  @gnprice any ideas what could be causing this problem?  Noticed while debugging #7620.

@harshitongithub FYI, since the `purge-old-deployments` script could be the culprit (though it seemed to not delete the things in a quick test after remaking them, so if it is the cause, the time delay is involved)",timabbott,b'bug difficult priority: blocker',2018-01-19T20:40:04Z,2018-03-28T22:50:00Z
8111,bugdown: Linkify Bitcoin URI.,"I should have used an actual validator in addition to just regex, but this solution is leaner.",rht,b'size: S',2018-01-19T10:24:51Z,2018-01-19T11:07:53Z
8110,message-box css: incorrect time stamp location on smaller screens.,"When someone sends a second message or more continuously the time stamp shifts to the left on smaller screens, which for example (in case of edited messages) leads to overlapping of 'EDITED' and the time stamp, as shown in the following image -
![issue](https://user-images.githubusercontent.com/23361315/35144169-c42f60d2-fd29-11e7-981d-83a0f8fba061.PNG)

",Kumar-Tarun,b'area: mobile bug',2018-01-19T09:36:30Z,2018-03-23T04:30:15Z
8100,User - Change Password -> Internal Server Error,"I'm on a fresh installation of Zulip 1.7.1 and have the problem, that users are unable to change their passwords via settings. Whenever a user tries to save his password the following error message occurs:

An internal error occurred; try reloading the page. Sorry for the trouble!

Changing the password via ""reset password"" functionality works fine. I don't have anything in the error logs. The installation is on a fresh Ubuntu 16.04.3 Server VM. Theres nothing installed except:

- open-vm-tools
- certbot (from certbot/certbot ppa)

Does anybody else have this issue. Are there some more logs on which I could see where the error occurs? ",noboevbo,b'area: authentication bug help wanted',2018-01-18T13:53:45Z,2018-02-10T06:18:14Z
8088,User groups CSS looks a bit off when line-wrapping,"If you add enough users to a user group to line-wrap, the padding looks a bit wrong:

![image](https://user-images.githubusercontent.com/2746074/35014471-8cbdf304-fac5-11e7-8f7a-87a6395d1b87.png)

@synicalsyntax @brockwhittaker FYI; tagging as a blocker since we'll want to advertise this feature in our next release, so we should make sure it looks right.
",timabbott,b'area: settings (admin/org) bug priority: blocker',2018-01-16T22:01:03Z,2018-03-16T00:42:47Z
8086,bugdown: Add preview for vimeo videos.,"This also amends a commit from Brock Whittaker <brock@zulipchat.com>
that merges two separate functions for YouTube videos and Vimeo videos
into a generic video recall function.

Fixes #7550.

This is good for merging @showell.",brockwhittaker,b'area: markdown size: L',2018-01-16T20:04:26Z,2018-01-17T14:11:57Z
8065,Unreadable alert words section in settings when in night mode.,"Open settings, go to **Display settings** and enable night mode. Go to **Alert words** section. The text is unreadable: [Preview in chat.zulip.org](https://lambda.sx/FFR.webm)

Chromium Version 63.0.3239.84 (Developer Build) built on Debian 9.3, running on Debian 9.3 (64-bit)",Privisus,b'bug design',2018-01-12T08:24:19Z,2018-01-17T08:32:09Z
8054,Error in searching for the character '>' in the search bar in development environment.,"In the development environment, if we try to search for the character `>` in the search bar, we get the error:

```
File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/base.py"", line 1182, in _execute_context
    context)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/default.py"", line 470, in do_execute
    cursor.execute(statement, parameters)
  File ""/srv/zulip/zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""/srv/zulip/zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
psycopg2.OperationalError: pgroonga: query_extract_keywords: failed to parse expression: Syntax error: <>||>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""/srv/zulip/zerver/lib/rest.py"", line 124, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 543, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 525, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 686, in wrapped_func
    return func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/lib/request.py"", line 170, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/views/messages.py"", line 702, in get_messages_backend
    query_result = list(sa_conn.execute(query).fetchall())
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/base.py"", line 945, in execute
    return meth(self, multiparams, params)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/sql/elements.py"", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/base.py"", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/base.py"", line 1189, in _execute_context
    context)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/base.py"", line 1402, in _handle_dbapi_exception
    exc_info
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/util/compat.py"", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/util/compat.py"", line 186, in reraise
    raise value.with_traceback(tb)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/base.py"", line 1182, in _execute_context
    context)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/sqlalchemy/engine/default.py"", line 470, in do_execute
    cursor.execute(statement, parameters)
  File ""/srv/zulip/zerver/lib/db.py"", line 33, in execute
    return wrapper_execute(self, super().execute, query, vars)
  File ""/srv/zulip/zerver/lib/db.py"", line 20, in wrapper_execute
    return action(sql, params)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) pgroonga: query_extract_keywords: failed to parse expression: Syntax error: <>||>
 [SQL: 'SELECT /* get_messages */ anon_1.message_id, anon_1.flags, anon_1.subject, anon_1.rendered_content, anon_1.content_matches, anon_1.subject_matches \nFROM ((SELECT message_id, flags, subject, rendered_content, pgroonga.match_positions_character(rendered_content, pgroonga.query_extract_keywords(%(query_extract_keywords_1)s)) AS content_matches, pgroonga.match_positions_character(subject, pgroonga.query_extract_keywords(%(query_extract_keywords_1)s)) AS subject_matches \nFROM zerver_usermessage JOIN zerver_message ON zerver_usermessage.message_id = zerver_message.id \nWHERE user_profile_id = %(param_1)s AND message_id >= %(message_id_1)s AND (search_pgroonga @@ %(search_pgroonga_1)s) AND message_id <= %(message_id_2)s ORDER BY message_id DESC \n LIMIT %(param_2)s) UNION ALL (SELECT message_id, flags, subject, rendered_content, pgroonga.match_positions_character(rendered_content, pgroonga.query_extract_keywords(%(query_extract_keywords_1)s)) AS content_matches, pgroonga.match_positions_character(subject, pgroonga.query_extract_keywords(%(query_extract_keywords_1)s)) AS subject_matches \nFROM zerver_usermessage JOIN zerver_message ON zerver_usermessage.message_id = zerver_message.id \nWHERE user_profile_id = %(param_1)s AND message_id >= %(message_id_1)s AND (search_pgroonga @@ %(search_pgroonga_1)s) AND message_id >= %(message_id_3)s ORDER BY message_id ASC \n LIMIT %(param_3)s)) AS anon_1 ORDER BY message_id ASC'] [parameters: {'message_id_2': 158, 'param_2': 50, 'query_extract_keywords_1': '>', 'param_1': 49, 'message_id_1': 0, 'search_pgroonga_1': '>', 'message_id_3': 159, 'param_3': 50}]
```",rheaparekh,b'area: search bug help wanted',2018-01-11T12:05:27Z,2018-03-09T04:00:34Z
8042,Unread count stuck at >0 in a topic I've read,"For the topic https://chat.zulip.org/#narrow/stream/design/topic/settings.20save , I seem to have an unread count of 6:
![image](https://user-images.githubusercontent.com/28173/34742722-f901cda4-f53b-11e7-860e-8957cecb35b4.png)
But I've just gone and read through the whole thread, beginning to end.
![image](https://user-images.githubusercontent.com/28173/34742767-28cd9a04-f53c-11e7-8fb5-3020490461bf.png)

Scanning through it, I don't see any messages that are shown as unread, either (in contrast to #7229). Everything looks like a normal, already-read message, as it should. It's just the count that's wrong.
",gnprice,b'area: left-sidebar bug priority: high',2018-01-09T20:55:18Z,2020-01-31T20:51:31Z
8025,Handle quoted-mention edge cases properly.,"If somebody does a quote-and-reply to a message that has a mention, and they leave the mention inside the quoted portion, Zulip currently behaves as if the **new** message also mentions the original mentioned person.

This was probably never an intentional decision, as the naive implementation doesn't distinguish whether the message is in quoted section.

The current behavior is somewhat defensible in some cases.  If somebody mentions me, and then another person replies to the message that mentions me, I may want to know about both parts of the conversation.

If I reply to myself, that's a bit different, since I obviously know about the message, and the primary use cases that we know about for self-mentioning are a) testing mentions works and b) marking a message as something to come back to, but neither of those use cases is really necessary when the first message is already mentioned.

We have to make a decision here:
* just ignore this, and let folks work around the self-mention issue
* only fix the quote-self-mention use case
* consistently ignore mentions inside quoted blocks

I think the second option is best for users, but it may lead to a complicated implementation and it may hard to explain to users how things work.

  ",showell,b'area: markdown area: notifications (messages) bug priority: high',2018-01-08T12:11:15Z,2019-01-17T00:09:52Z
8016,Links to Zulip messages should open in app.,"In a long running topic, it is sometimes helpful to link back to an earlier comment. Currently this can be done by copying and pasting the externally accessible URL for the post, but this is annoying because it opens a browser window for users of the stand-alone apps. Alternatively, the old post can be quoted, but that's not the greatest solution either.",Be-ing,b'area: markdown bug help wanted',2018-01-07T15:16:13Z,2018-02-12T23:30:43Z
7992,Mobile client cannot log in via google,"Google complains that embedded browsers (web-view) aren't allowed. I don't know if this is fixable, but it is an issue nonetheless.

Tried with chat.zulip.org",oktayaa,b'area: authentication area: mobile bug',2018-01-04T20:55:49Z,2018-02-10T06:18:45Z
7982,settings: broken settings page on continous use of tab key.,"![peek 2018-01-03 22-59](https://user-images.githubusercontent.com/22238472/34533528-9a0511d0-f0e0-11e7-8e84-913f81a20013.gif)
 Easy to reproduce, simply go to ""Organization settings"" and hit tab a couple times.",shubhamdhama,b'area: settings UI bug',2018-01-03T18:19:15Z,2018-01-12T12:34:55Z
7971,Minor CSS defect in portico header,"I noticed a minor issue in the portico header of the [zulip website](https://zulipchat.com/). 
The menu that appears on clicking the collapsed navbar on smaller screens has its 'cross' overlapping with the original button (you can see the cross a little smaller on the right hand side) due to which on clicking the 'cross', the menu does not close, instead one has to click somewhere to the top of it to close it.

The snap has screen size of iphone 7. For exact size one can inspect (in Chrome) and select 'toggle device toolbar' thereafter.

![issue](https://user-images.githubusercontent.com/23361315/34499710-5006b628-f02d-11e7-8695-c17d4e92d867.JPG)
",Kumar-Tarun,b'area: portico bug design',2018-01-02T21:00:28Z,2018-01-16T22:56:38Z
7925,/features page: Make it mobile responsive.,"Current layout on 5.5 inch mobile screen.
![3003392414096748236](https://user-images.githubusercontent.com/18511177/34420434-8cf7d8c0-ec2f-11e7-80d7-f4c96fc8bc04.jpg)
![4921402093258601817](https://user-images.githubusercontent.com/18511177/34420435-8d45bb80-ec2f-11e7-891f-fa9dd650532f.jpg)
![5017062135705131892](https://user-images.githubusercontent.com/18511177/34420436-8d945196-ec2f-11e7-8104-a15753927530.jpg)
![7270890310472409241](https://user-images.githubusercontent.com/18511177/34420437-8df84a52-ec2f-11e7-94cb-ca588cbfd501.jpg)
![8233086490225245824](https://user-images.githubusercontent.com/18511177/34420438-8e4b3f0a-ec2f-11e7-8318-8d0c5e333495.jpg)
",jainkuniya,b'area: portico bug',2017-12-28T19:02:43Z,2018-02-16T23:42:28Z
7916,user docs: Lack of support for external URLs,"The Existing integrations link at https://chat.zulip.org/api/ links to https://chat.zulip.org/integrations. However, clicking on the link doesn't immediately move the page, and the following error is thrown in the console:

![screenshot at dec 27 09-49-12](https://user-images.githubusercontent.com/15116870/34388895-3d70c6e4-eaeb-11e7-93dc-b1c254735c18.png)

Support for external URLs needs to be added.

As a bonus enhancement, a link back to the home page can be added to the bottom of the documentation sidebar (given that there is none, currently).",synicalsyntax,b'area: documentation (user) bug',2017-12-27T17:51:44Z,2017-12-31T13:11:27Z
7909,left sidebar: Clicking on a stream should clear the stream search.,"If you type ""gen"" and then click on #general, it should clear the stream search bar and collapse it. ",rishig,b'area: left-sidebar bug good first issue help wanted',2017-12-27T03:39:57Z,2018-01-29T19:07:50Z
7907,portico: Back button on some portico pages doesn't work in firefox.,"https://chat.zulip.org/#narrow/stream/issues/topic/zulipchat.2Ecom

When I visit zulipchat.com and click on ""See plans and pricing!"", and then hit the back button, the page content just disappears. Same if I click one of the buttons on /plans/ and hit back. (FF 57)

(you can get to this in dev by going to localhost:9991/hello).",rishig,b'area: browser-support area: portico bug good first issue help wanted',2017-12-27T01:37:56Z,2018-03-12T05:17:20Z
7896,[BUG] Stream Side-Menu closes itself while typing in the search box(Mobile Web).,"_From @MadElf1337 on December 25, 2017 12:38_

* Whenever a person tries to search for a stream in the search box provided in the streams' side menu in 
   mobile version of chat.zulip.org, the menu closes itself.

## Instructions For Reproduction:-
1. Go to https://chat.zulip.org from the mobile browser.
2. Login with valid credentials.
3. Open the side-menu of streams.
4. Tap on the search box to enable keyboard.

* After following these steps, one sees that the menu closes itself to go back to the home-page.
(GIF attached below)

![bug](https://user-images.githubusercontent.com/34575523/34339764-875225c6-e99e-11e7-94d9-f3b51452bdaa.gif)




_Copied from original issue: zulip/zulip-mobile#1631_",MadElf1337,b'area: left-sidebar bug',2017-12-26T00:38:26Z,2018-01-04T14:15:09Z
7854,Investigate left sidebar scrolling.,"This is a task for somebody who has some understanding of how our left sidebar scrolls.

Recently we've gotten reports that the left sidebar is laggy when you scroll through it, and it also appears that we don't properly keep the selected stream in view any more.

The best way to track this down may be to:

* create lots of streams with populate_db
* go back maybe 500 commits and see if the behavior is different (you'll need to re-provision)
* continue to either go back in time or bisect toward the present

",showell,b'area: left-sidebar bug help wanted priority: high',2017-12-21T11:26:08Z,2018-01-08T15:22:53Z
7844,dark mode: Alert words are unreadable,"![screenshot at dec 19 19-05-09](https://user-images.githubusercontent.com/15116870/34189279-9925accc-e4ef-11e7-9c49-0c924899d018.png)

Not enough contrast between the foreground and background colors makes the text unreadable.",synicalsyntax,b'area: message view bug design',2017-12-20T03:06:20Z,2018-01-12T01:27:43Z
7843,Combining diacritical marks overflow into other messages,"I wrote a script to write some combining diacritical marks into a file:
```python
diacritical_mark = unich(0x347)
with open(""combining_diacrtical_out.txt"", ""w"") as f: f.write(((""."" + diacritical_mark * 99) * 20).encode(""utf-8""))
```
Run this and open `combining_diacrtical_out.txt`. If you copy that into a message and then send that message, the combining diacritical marks will overflow out of the message box, obscuring other messages. I think the solution to this would be to set `overflow: hidden` in the css for for the `message_content` class.

![combining_diacritical_marks](https://user-images.githubusercontent.com/16677912/34185930-8862d9cc-e57c-11e7-90aa-e2deb02b71b2.PNG)
",XavierCooney,b'area: message view bug help wanted',2017-12-20T00:56:51Z,2019-09-23T23:09:59Z
7796,onBoarding: Error Message overlaps with Password Field.,"When typing a not valid email address in the input box. The error message overlaps with the Password Field.
![zulip_sign_in](https://user-images.githubusercontent.com/22166422/34068927-57c76350-e26b-11e7-8d75-0793318ba030.png)

This occurs only on Firefox Quantum Ubuntu 16.04 for all the Screen sizes.
Chat discussion: https://chat.zulip.org/#narrow/stream/issues/topic/signin.",Balaji2198,b'area: portico bug help wanted',2017-12-16T08:26:41Z,2017-12-30T16:08:41Z
7794,left sidebar: Streams list chevrons don't have enough contrast in dark mode.,"![](https://chat.zulip.org/user_uploads/2/df/KZG3OxF_VFlDVe3d_6P43HdQ/zulip-nightmode-sidebar.png)

@zulipbot claim",synicalsyntax,b'area: left-sidebar bug design',2017-12-16T04:58:40Z,2018-01-16T22:21:53Z
7789,Make image description responsive in lightbox  ,"* Image descriptions (image name, sender) and image-actions (Download, Open button) in lightbox is not responsive when the width is < 511px. We need to make both the sections responsive.


<img src=""https://chat.zulip.org/user_uploads/2/3e/3hnGRwf8oh0M9Edjzv3ACBr7/pasted_image.png"">

* Both the sections look inconsistent when width is 511 to 786px. For an example at width 700px -

![image](https://user-images.githubusercontent.com/2263909/34058756-49659a8e-e202-11e7-8fc9-ac53115cd43a.png)

We should either hide everything when the width is <786px or make them responsive and proper aligned.

 ",akashnimare,b'area: message view bug design',2017-12-15T20:13:35Z,2018-01-20T01:16:36Z
7779,bugdown: Add preview for vimeo videos. Fixes #7550,Fixes #7550 ,shreyanshdwivedi,b'needs review',2017-12-14T21:18:05Z,2018-01-17T19:02:46Z
7768,server-settings: Some parts of disabled checkboxes have cursors,"Steps to reproduce:
 1) Login as a user who cannot modify the organization settings.
 2) Hover your mouse just outside any of the checkboxes (e.g. ""Users can delete their messages"")
 3) Notice that sometimes the cursor to a mouse pointer

My (probably limited) understanding is that this is because there is some CSS that sets the cursor to a pointer for all labels with the checkbox class, and there is a border and padding around the child span, which displays the actual checkbox, thus meaning that that border and padding has the pointer cursor. This is all related to https://github.com/zulip/zulip/blob/master/static/styles/components.css.",XavierCooney,b'area: settings (admin/org) bug',2017-12-14T10:45:04Z,2018-01-12T12:29:40Z
7760,bugdown:  Remove whitespace strip from inline code,Fixes #4507,PentaHiggs,None,2017-12-13T21:30:02Z,2018-01-16T22:56:38Z
7712,Stream Settings : css bug in mobile view,"![25075305_1248702288606889_693532273_o](https://user-images.githubusercontent.com/25428397/33793906-1fecbd60-dce7-11e7-811d-b1eb3220af63.png)

As it can be clearly seen that buttons are not aligned properly. Also, textboxes have the similar problem.
",shreyanshdwivedi,b'area: stream settings bug',2017-12-09T08:16:07Z,2017-12-14T22:52:19Z
7711,stream settings: Admin view of private streams has buttons you can't click.,"This is the admin view of a private stream they are not subscribed to: 
![image](https://user-images.githubusercontent.com/890911/33791862-1deba1f6-dc48-11e7-9285-c37b98b3d8a5.png)

The `Subscribe` and `Unsubscribe` buttons don't do anything, and should be removed.
The box with the `Add` also can't be used, and should be removed.

If you look at a private stream you're subscribed to, there should be text that looks like:
![image](https://user-images.githubusercontent.com/890911/33791874-59c4fa74-dc48-11e7-88e1-cfb82db2ee58.png)

In this case, the text should be
""This is an :lock: **invite-only stream**. As an organization administrator, you can see the list of subscribers, but cannot add or remove members.""
(with no [Change] at the end).

Finally, if the admin has been subscribed to the stream in the past, we should keep the `View Stream` button. If they haven't, it should be removed.

Also currently, if you click on `View stream`, you get to
![image](https://user-images.githubusercontent.com/890911/33791910-fd026334-dc48-11e7-8083-8cf3c437a80f.png)
The `Subscribe` button should be removed from there as well, if the stream is private.",rishig,b'area: onboarding area: stream settings bug priority: high',2017-12-09T02:51:39Z,2018-03-13T21:42:04Z
7702,Some API documentation sidebar links don't do anything,"Some of the links in the left sidebar at the API documentation page (https://chat.zulip.org/api/), such as `REST API` and `Integrations` display a pointer cursor on hover, but don't seem to do anything when you click on them. It seems as if they were originally meant to collapse the pages under them.

Relevant discussion: https://chat.zulip.org/#narrow/stream/issues/topic/API.20Documentation",XavierCooney,b'area: general UI bug',2017-12-08T11:08:49Z,2017-12-14T12:54:51Z
7678,"""Night mode"" checkbox is no-op","Normally, when I check a checkbox on one of these settings, a green box appears to confirm that I have changed the setting, and when I exit out of Settings and re-enter, the checkbox is still checked and the setting has successfully been applied. For example:

<img width=""756"" alt=""screen shot 2017-12-06 at 2 41 11 pm"" src=""https://user-images.githubusercontent.com/3229696/33689383-1a58e95a-da94-11e7-9009-e2a274b51223.png"">

However, when I check the ""Night mode"" checkbox, no such green box appears; additionally, when I exit out of Settings and re-enter, state has not been saved and ""Night mode"" is again unchecked.

I am using Chrome version 62.0.3202.94 on macOS Sierra version 10.12.6.

I was so excited for the night mode feature that I had already scraped the night mode CSS from this repo into a private Stylish stylesheet, so I personally will be fine in the meantime :)",csvoss,b'area: settings UI bug',2017-12-06T22:46:57Z,2018-01-04T02:00:40Z
7665,invitations: Add send_event for invitations events.,"Currently most of the invitation pathways don't have send_event calls, which means they aren't updating browsers correctly (in particular, the ""invitations"" tab of admin settings). 

See http://zulip.readthedocs.io/en/latest/subsystems/events-system.html for an explanation for why we need send_event calls. ",rishig,b'area: invitations bug help wanted',2017-12-05T06:04:05Z,2019-07-23T14:21:41Z
7664,invitations: Invited at column shows UTC instead of local time.,"The middle column here is showing the time in UTC rather than the local time: 
![image](https://user-images.githubusercontent.com/890911/33591802-7d89c796-d93c-11e7-8891-a1d7c6fe2e89.png)

The fix is two fold:
* The backend should return a timestamp (see `datetime_to_timestamp` function in timestamp.py)
* The frontend (`settings_invites.js`) should put that into an appropraite function from timerender.js. 

This should be applied to both `do_get_user_invites` and `do_resend_user_invite_email` in actions.py.
",rishig,b'area: invitations area: settings (admin/org) bug good first issue help wanted',2017-12-05T05:51:08Z,2017-12-20T23:48:29Z
7648,bugdown: Rewrite markdown link to relative link conditionally.,,tommyip,None,2017-12-03T22:12:06Z,2019-02-03T10:08:54Z
7626,"org settings: Allow selecting ""restrict to domain"" even if no domains selected.","Currently, the top setting at https://chat.zulip.org/#organization/organization-permissions is unselectable if no domain is given:
![image](https://user-images.githubusercontent.com/890911/33511579-f4b1135a-d6d1-11e7-841d-0a08bafaeee0.png)

Instead, it should be selectable, and if you click on it and no domain is there, it should just open the modal (i.e. do the same thing that [Add or Change] does). 
",rishig,b'area: settings (admin/org) bug priority: high',2017-12-02T04:01:34Z,2018-02-05T21:36:50Z
7624,user settings: Emoji style in Display settings is broken in mobile view,"On a mobile device (screen width < 700px), navigate to the [Display settings](https://chat.zulip.org/#settings/display-settings) page.

The following is observed:
![screenshot at dec 01 18-44-23](https://user-images.githubusercontent.com/15116870/33510953-e0febe8e-d6c7-11e7-99dc-001c13875759.png)
",synicalsyntax,b'area: settings (user) bug design',2017-12-02T02:46:12Z,2017-12-09T02:25:32Z
7623,dark mode: Background colors of sidebars and modals aren't switched in mobile view.,"On a mobile device (screen width < 700 px),

1. Open the [Settings modal](https://chat.zulip.org/#settings/your-account) 
2. Open the [New streams](https://chat.zulip.org/#streams/new) page
3. Click on the menu icon on the top left corner to open the left sidebar.

The following is observed: 

![screenshot at dec 01 18-41-43](https://user-images.githubusercontent.com/15116870/33510919-7128c55a-d6c7-11e7-8f03-5dbc0373a50d.png)
![screenshot at dec 01 18-41-12](https://user-images.githubusercontent.com/15116870/33510920-71465cd2-d6c7-11e7-87c3-dfc521d4b0aa.png)
![screenshot at dec 01 18-39-58](https://user-images.githubusercontent.com/15116870/33510921-71639ef0-d6c7-11e7-917d-384c0613fe12.png)
",synicalsyntax,b'area: general UI bug design',2017-12-02T02:43:38Z,2017-12-12T15:14:36Z
7621,lightbox hotkey v: show_from_selected_message doesn't jump recipient blocks.,"The desired behavior for the `v` hotkey (which just calls the `show_from_selected_message` function) is:
* Search backwards in the current view till it finds an image
* If it doesn't find anything, search forwards instead

Currently, it seems to search only in its recipient block. 
See https://chat.zulip.org/#narrow/stream/issues/topic/lightbox.20v for more information.",rishig,b'area: keyboard UI bug help wanted',2017-12-02T01:56:46Z,2017-12-13T21:17:20Z
7620,bugdown: Latex shifts superscripts and other offset characters downwards.,"To reproduce, send a message like
```
Subscripts and superscripts: $$a^X B^X a^x a_X B_X$$. 
\frac: $$\frac{a}{b}$$, \over: $${a \over b}$$ and \bar: $$\bar{\theta}$$. 
Integrals: $$\int_0^1$$.
This seems to be okay: $$a^{a^{a^a}}$$.
```

The frontend markdown processor is doing the right thing, but the backend markdown processor returns:
![image](https://user-images.githubusercontent.com/890911/33510153-870b9668-d6bd-11e7-8456-ec9d4002b79a.png)

I would start by figuring out what is different between what the frontend and backend markdown returns. 
http://zulip.readthedocs.io/en/latest/subsystems/markdown.html is useful reading.",rishig,b'area: LaTeX area: markdown bug help wanted priority: high',2017-12-02T01:35:56Z,2020-04-01T22:04:46Z
7596,Strikethrough doesn't work with auto-links,"@tommyip pointed out that if you write something like `~~sdfsddsaf #7515 fffsdafdsa~~`, with an auto-linkified term inside strikethrough markup `~~`, the strikethrough doesn't happen:

![](https://chat.zulip.org/user_uploads/2/9b/jCZxws2flyppXlQWKDESvRf-/pasted_image.png)
",gnprice,b'area: markdown bug help wanted',2017-11-30T20:04:52Z,2017-12-28T21:02:06Z
7582,invitations: Make stream names click targets.,"To reproduce:
Click ""Invite more users"" in the right sidebar.

Try clicking on ""Denmark"" below:
![image](https://user-images.githubusercontent.com/890911/33408027-fdec3f4e-d528-11e7-9811-92d00076091d.png)

It should toggle the checkbox, but currently it doesn't.",rishig,b'area: invitations bug good first issue help wanted',2017-11-30T01:17:18Z,2017-12-07T22:40:25Z
7581,invitations: Don't reformat emails if invitations not sent.,"Currently, if you try to invite some people and there is an error, it reformats the emails in the input box.

To repro, click on ""Invite more users"" in the right sidebar, and fill out the form like this:
![image](https://user-images.githubusercontent.com/890911/33407683-53764984-d527-11e7-86a9-e78a7232bb90.png)

Then hit Invite. I get 
![image](https://user-images.githubusercontent.com/890911/33407660-3ced1152-d527-11e7-8179-7f005c1a8be0.png)
up top.

There's currently a spacing error (there shouldn't be a space before the 2), but the best thing is probably just to leave the input box as is.
If leaving the input box as is is hard, we should just fix the fact that we add a space before the 2. 

",rishig,b'area: invitations bug help wanted',2017-11-30T01:06:18Z,2017-12-12T16:01:36Z
7567,user profiles: Really long emails break popover,"![screenshot at nov 28 22-12-22](https://user-images.githubusercontent.com/15116870/33360605-47b416a6-d489-11e7-9995-692d5ef4d775.png)

Feedback would be appreciated on how this should be resolved",synicalsyntax,b'area: message view bug feedback wanted',2017-11-29T06:13:13Z,2017-12-13T20:20:20Z
7550,bugdown: Add preview for vimeo videos.,"If you search for youtube in `zerver/lib/bugdown/__init__.py`, you can see the code that does a special preview for youtube videos. We should have similar functionality for vimeo. 

You can test the youtube functionality by sending a youtube link to ""#test here"" on chat.zulip.org.
Note also the youtube links are about to change; if you take this issue before #7549 is resolved, follow the new format (with the name) rather than the old format (with the visible link).

Make sure to add appropriate tests for this. You can search for (and mostly copy) the youtube tests by doing `git grep -i youtube zerver/tests/test_bugdown.py`.",rishig,b'area: markdown good first issue help wanted',2017-11-28T19:27:49Z,2018-01-17T14:14:45Z
7549,bugdown: Change youtube preview to show name of video instead of link.,"Currently our youtube previews look like 
![image](https://user-images.githubusercontent.com/890911/33339183-3a05ddd4-d42d-11e7-9a6d-1d22d45ae9fb.png)

And it would be better if they looked like
![image](https://user-images.githubusercontent.com/890911/33339206-49d300f2-d42d-11e7-90a9-b841b13bc38f.png)

(namely, the url is replaced by a link with the name as the text of the link).

I think you can find the relevant code by grepping for youtube in `zerver/lib/bugdown/__init__.py`.


",rishig,b'area: markdown good first issue help wanted',2017-11-28T19:17:10Z,2019-07-23T14:21:40Z
7535,Keep typeahead open if even the user tabs away.,"This seems to be a recent regression.  On FF if I start a compose typeahead, then alt-tab to another application and back, without doing anything else of substance, the typeahead disappears.  This seems like it might be annoying if you're trying to do something like check another app (gmail, github, etc.) to find somebody's user name when you're in the middle of the typeahead.

And it definitely feels like new behavior.  The way it manifests for me is that I can no longer create screenshots of typeahead.",showell,b'area: compose bug priority: high',2017-11-27T19:57:01Z,2018-06-11T21:15:37Z
7534,Bot name persists in @mention typeahead after renaming.,"## Steps to reproduce

0. Type `@botname`. Typeahead shows `botname`.
1. Rename the bot to `newname`.
2. Do not reload the page.
3. Type `@new...`. Typeahead shows `botname`.
4. Reload the page.
5. Type `@new...`. Typeahead shows `newname`.

## Expectation

3. Typeahead shows the updated botname `newname`.

## Details

A bot was renamed (and page not reloaded) and the search as well as selection works fine but the typeahead shows incorrect(previous) name.

This was resolved by reloading the page and is most likely an issue with live-sync.

![zulip-regression-typeahead](https://user-images.githubusercontent.com/8033238/33285519-8dda456c-d3d8-11e7-9b9c-cc92c237df01.png)
",aero31aero,b'area: compose area: integrations area: real-time sync bug',2017-11-27T19:40:40Z,2017-12-13T20:42:55Z
7533,"typeahead: Don't autocomplete ""@ "".","If you type `@ ` (with a space after the @), it will show the typeahead. It should not, similar to how we handle `# ` and `: `. 

hm .. none of the spaces are showing, due a bug in github's markdown. There is a single space at the end of each of the codeblocks above.",rishig,b'area: compose bug good first issue help wanted',2017-11-27T18:07:26Z,2017-11-27T23:16:32Z
7529,Bugdown images,Fixes #7324.,aero31aero,None,2017-11-27T09:13:06Z,2017-11-27T21:26:57Z
7526,PM button on @mention overlay populates compose box with incorrect email,"## Steps to reproduce

1. Find a message where X mentions Y.
2. Click on Y's name
3. Click on ""Send PM"" button in Y's info overlay.
4. Message field populates with X's email.

## Expectation

4. Message field populates with Y's email.

## Possible fix

Change the click handler to not use `respond_to_message`.
",aero31aero,b'area: compose bug priority: high',2017-11-26T21:54:05Z,2017-11-27T06:59:38Z
7511,Emoji picker categories overflow in Firefox at 90% zoom,"
![image](https://user-images.githubusercontent.com/2746074/33190146-654f606e-d05e-11e7-9b7f-acf622e0e9ef.png)

",timabbott,b'area: emoji bug',2017-11-23T22:56:01Z,2018-01-25T00:21:22Z
7500,Lightbox: Clicking elements that aren't UI widgets above  and below image should hide lightbox,"We appear to have a regression in the lightbox.  Historically, clicking anywhere in the blue border area that wasn't one of the buttons would close the lightbox.  Today I noticed that while clicking the left/right areas still closes the lightbox, clicking the blue areas above or below doesn't.

@brockwhittaker thoughts on this?  I'm guessing this is a bug introduced in some of the recent CSS refactoring, since it feels very recent.",timabbott,b'area: message view bug',2017-11-23T01:20:40Z,2017-11-29T19:33:47Z
7492,Topic unread count spacing if off when we need to wrap,"@brockwhittaker it appears we don't quite have this right yet:

![image](https://user-images.githubusercontent.com/2746074/33142635-0970e2e2-cf6c-11e7-893c-cef1350d5509.png)
",timabbott,b'area: left-sidebar bug priority: high',2017-11-22T18:01:29Z,2018-04-16T17:07:01Z
7488,design: Properly align elements in invite users setting,"<img width=""546"" alt=""admin"" src=""https://user-images.githubusercontent.com/2263909/33123373-00f298f2-cfa0-11e7-829f-a8f4fced1838.png"">


* The **Check-All | Uncheck All** is not aligned properly. 
* Add margin-top in **Add as administrator** span.",akashnimare,b'bug design',2017-11-22T10:44:40Z,2017-11-26T17:17:15Z
7485,Pasting markdown headings does not work,"Instead, it comes along with a '#'. I think we need to add the correct markdown for such a situation.

![peek 2017-11-22 13-13](https://user-images.githubusercontent.com/24482726/33115705-fb0cae7c-cf87-11e7-8710-4e59b47e8809.gif)
",dgarvit,b'area: compose bug',2017-11-22T07:50:17Z,2017-11-28T18:02:46Z
7483,bugdown:  Remove whitespace strip from inline code,Fixes #4507,PentaHiggs,None,2017-11-22T06:22:05Z,2017-11-23T23:54:04Z
7482,bugdown: Fix handling of nested fenced math blocks.,"Change any fence delimiters (backticks and tildes) to be
interpreted literally inside of math fenced_code blocks.

Fix #5190",PentaHiggs,None,2017-11-22T05:58:07Z,2017-11-22T20:20:34Z
7479,Extra spaces in links to new streams in digest emails,"I got a digest email containing
```html
    <p>Some new streams were created:</p>

    <p><a href='https://chat.zulip.org/  # narrow/stream/mystery.20hunt'>mystery hunt</a>.</p>

    <p>Click on the name to check out some of the traffic, or visit your <a href=""https://chat.zulip.org/#streams"">Streams page</a> to subscribe.</p>
```
The link to the stream doesn't work because of the extra spaces around the `#`. (If I remove the spaces the link does work.)",rwbarton,b'area: notifications (messages) bug priority: high',2017-11-22T03:46:08Z,2017-11-22T18:07:37Z
7475,"stream creation: ""People to add"" filter should show your name.","This input should show your name if you search for it:
![image](https://user-images.githubusercontent.com/890911/33101155-fe638224-cecb-11e7-92a3-47ca53a13dd2.png)

It is very confusing that it doesn't, since it feels like there is no way to subscribe yourself. (Or unsubscribe yourself, if you are an admin in a realm where non-admins can't create streams, and you are creating the stream on behalf of another group of users.)",rishig,b'area: stream settings bug help wanted',2017-11-21T22:57:13Z,2017-12-13T20:19:09Z
7473,stream creation: Stream name box loses focus.,"To repro:
Gear -> Manage streams -> click Create Stream 

Expected behavior: Focus stays in ""Stream name"" box.
Observed behavior: Focus starts in ""Stream name"" box, and then leaves it maybe half a second later.

Note: if I then click the ""+"" to the right of Filter streams, it does the same thing. If I click the ""+"" a second time, focus goes to the Stream name box and stays, as it should.",rishig,b'area: stream settings bug good first issue help wanted',2017-11-21T22:50:11Z,2017-11-28T19:01:27Z
7469,Lightbox Pan & Zoom UI don't work well with longed names when translated,"Reproducer: Go to localhost:9991/es/, upload an image, and open the lightbox.

![pasted_image 20](https://user-images.githubusercontent.com/2746074/33086728-603417fe-ce9d-11e7-94c0-414bd6e72646.png)
",timabbott,b'area: message view bug priority: high',2017-11-21T17:22:29Z,2017-11-22T17:59:33Z
7468,Bugs with private stream subscriptions.,"### Unwanted behavior

* after unsubscribing from a private stream, the stream can still be found in the `All streams` list, **along with a ""Subscribe"" button. That subscribe button is clickable, but has no effect. It sends a subscription request to the server that is rejected:
![image](https://user-images.githubusercontent.com/7950151/33082307-c036e80e-cedc-11e7-81d3-e8c3cbe25029.png)

*  after unsubscribing from a private stream, the stream can still be found in the `All streams` list, **along with the list of users for the stream. This list is cached in the browser, it drops to ""0 users"" after reloading the page. (When the page is not reloaded, it doesn't show newly added users though, so that's wanted behavior.)


### Potentially unwanted behavior

* after unsubscribing from a private stream, the stream can still be found in the `All streams` list. It should either be removed completely, or at least display ""users hidden for this stream"" instead of ""0 users"" in the user table.

* unsubscribing from a stream and then revisiting the stream shows the stream, with a ""you unsubscribe from this stream"" ino in the bottom. being resubscribed makes that infodisappear. there is no new ""you subscribed to this stream"" info. unsubscribing again creates another ""you unsubscribed"" info. These stack up:
![image](https://user-images.githubusercontent.com/7950151/33082154-5da4af5a-cedc-11e7-801c-3df07ef091a5.png)

Thanks @showell for helping debugging this!",roberthoenig,b'area: stream settings bug',2017-11-21T15:59:06Z,2018-03-09T22:34:46Z
7460,Use a queue with retry support for sending new-login emails,"We just got this exception (basically a transient network error trying to send email), which I think prevented the user in question from logging in:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/views/auth.py"", line 550, in login_page
    extra_context=extra_context, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/views.py"", line 54, in inner
    return func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/views.py"", line 150, in login
    )(request)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/views/generic/base.py"", line 68, in view
    return self.dispatch(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/debug.py"", line 76, in sensitive_post_parameters_wrapper
    return view(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/cache.py"", line 57, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py"", line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/views.py"", line 90, in dispatch
    return super(LoginView, self).dispatch(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/views/generic/base.py"", line 88, in dispatch
    return handler(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/views/generic/edit.py"", line 183, in post
    return self.form_valid(form)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/views.py"", line 119, in form_valid
    auth_login(self.request, form.get_user())
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/__init__.py"", line 160, in login
    user_logged_in.send(sender=user.__class__, request=request, user=user)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/dispatch/dispatcher.py"", line 193, in send
    for receiver in self._live_receivers(sender)
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/dispatch/dispatcher.py"", line 193, in <listcomp>
    for receiver in self._live_receivers(sender)
  File ""./zerver/signals.py"", line 91, in email_on_new_login
    context=context)
  File ""./zerver/lib/send_email.py"", line 92, in send_email
    if mail.send() == 0:
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/core/mail/message.py"", line 348, in send
    return self.get_connection(fail_silently).send_messages([self])
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/core/mail/backends/smtp.py"", line 104, in send_messages
    new_conn_created = self.open()
  File ""/home/zulip/deployments/2017-11-17-20-18-14/zulip-py3-venv/lib/python3.5/site-packages/django/core/mail/backends/smtp.py"", line 64, in open
    self.connection = self.connection_class(self.host, self.port, **connection_params)
  File ""/usr/lib/python3.5/smtplib.py"", line 251, in __init__
    (code, msg) = self.connect(host, port)
  File ""/usr/lib/python3.5/smtplib.py"", line 337, in connect
    (code, msg) = self.getreply()
  File ""/usr/lib/python3.5/smtplib.py"", line 393, in getreply
    raise SMTPServerDisconnected(""Connection unexpectedly closed"")
smtplib.SMTPServerDisconnected: Connection unexpectedly closed
```

I think the right fix for this is to just move new-login emails to be sent using a queue, like many of our other emails are.  Ideally, we'd move this into an existing queue.

E.g. possibly `missedmessage_email_senders` should be turned into a more generic `email_senders` worker that several things push emails into.  ",timabbott,b'area: notifications (other) area: production bug priority: high',2017-11-20T21:14:19Z,2017-12-21T03:39:29Z
7455,Make compose-box emoji modal's bottom line opaque.,"In order to reproduce this, use FF and set the zoom to 90%:

![image](https://user-images.githubusercontent.com/142908/33026268-eb2591d2-cdc4-11e7-8450-10a3b4b1899d.png)

If you open the emoji modal at 90% zoom, and then select one of the emojis, you'll see stuff leaking through the bottom line, as shown in the image above.

Here is the place where it's too transparent:

![image](https://user-images.githubusercontent.com/142908/33026481-5dae3bd2-cdc5-11e7-9411-ea23d26ffb07.png)

",showell,b'area: emoji bug',2017-11-20T15:35:24Z,2018-02-21T05:28:25Z
7454,desktop notifications: Empty topic name.,"Desktop notifications are displaying an empty topic name.
This occurred on Chrome/Windows 10.
![image](https://user-images.githubusercontent.com/7950151/33025242-bfa6c3d4-ce0d-11e7-98d5-8646ec854a08.png)
",roberthoenig,b'area: notifications (messages) bug priority: blocker',2017-11-20T15:15:24Z,2017-11-27T18:42:05Z
7441,iOS - Chrome identified as Safari,"After a failed login in Chrome on iOS, I got an email in which the device was identified as `Safari on iOS`.

```
Login details:
Server: https://recurse.zulipchat.com
Account: <email>
Time: Thursday, November 16, 2017 at 10:03PM UTC
Device: Safari on iOS.
IP Address: <ip>
--
```
I also noticed this behavior with other apps, most recently with [Piskel App](https://www.piskelapp.com/) - Chrome is incorrectly identified as Safari.

I'm wondering if it's even worth fixing, since it's a marginal user behavior, nonetheless might be a nice small issue.",trueskawka,b'area: emails bug feedback wanted',2017-11-18T19:18:47Z,2017-11-20T01:10:35Z
7396,Fix minor translation bugs,"One gets this output from `manage.py makemessages` right now:

```
./zerver/lib/actions.py:2940: warning: 'msgid' format string with unnamed arguments cannot be properly localized:
                                       The translator cannot reorder the arguments.
                                       Please consider using a format string with named arguments,
                                       and a mapping instead of a tuple for the arguments.
./zerver/lib/actions.py:2955: warning: 'msgid' format string with unnamed arguments cannot be properly localized:
                                       The translator cannot reorder the arguments.
                                       Please consider using a format string with named arguments,
                                       and a mapping instead of a tuple for the arguments.
./zerver/lib/actions.py:2957: warning: 'msgid' format string with unnamed arguments cannot be properly localized:
                                       The translator cannot reorder the arguments.
                                       Please consider using a format string with named arguments,
                                       and a mapping instead of a tuple for the arguments.
./zerver/lib/actions.py:2968: warning: 'msgid' format string with unnamed arguments cannot be properly localized:
                                       The translator cannot reorder the arguments.
                                       Please consider using a format string with named arguments,
                                       and a mapping instead of a tuple for the arguments.
```",timabbott,b'accessibility area: i18n bug',2017-11-15T18:41:26Z,2017-11-16T19:09:50Z
7395,/api page CSS issues,"We just moved our documentation for writing bots into /api in #7392; this lists some CSS bugs 

* [ ] The multi-line bold section here is oddly not wrapped automatically:
![image](https://user-images.githubusercontent.com/2746074/32851853-0b1664fe-c9eb-11e7-8a4d-b7f47eaa2270.png)
* [ ] The pagedown key on /api/writing-bots moves much less than one would expect.
* [ ] This multi-line code block looks wrong:
![image](https://user-images.githubusercontent.com/2746074/32851837-fc989118-c9ea-11e7-889b-6790e5700c8d.png)
* [x] Including a code block in the heading looks wrongs: 
![image](https://user-images.githubusercontent.com/2746074/32851917-446dc10c-c9eb-11e7-95e3-9e63ceb8e520.png)
(This one we might want to just fix by changing the text to ""Zulip bots package"".

",timabbott,b'area: api area: portico bug priority: high',2017-11-15T17:58:50Z,2017-12-29T13:48:39Z
7374,Clicking on edit for first bot in Bot List breaks the table,"Discussion here https://chat.zulip.org/#narrow/stream/issues/topic/bot.20list

![img](https://chat.zulip.org/user_uploads/2/97/_Qcq9JEdjzly1o7hJNhSx1dt/Screenshot-from-2017-11-12-17-01-45.png)

",hackerkid,b'area: settings (admin/org) bug priority: high',2017-11-12T17:42:07Z,2017-11-21T17:16:47Z
7358,private messages area in left sidebar doesn't scroll if you have too many,"I somehow ended up with more recent private message threads in my left sidebar than fit on my screen, and discovered it doesn't scroll properly.",timabbott,b'area: left-sidebar bug priority: high',2017-11-10T21:51:17Z,2017-11-14T19:44:44Z
7349,/teams/ page does not look nice on mobile,"![img_5645](https://user-images.githubusercontent.com/15116870/32641532-5034b84a-c583-11e7-9625-e67a5d6543f3.PNG)
![img_5646](https://user-images.githubusercontent.com/15116870/32641533-507317f2-c583-11e7-8612-06541ef50252.PNG)
![img_5647](https://user-images.githubusercontent.com/15116870/32641534-50ba692c-c583-11e7-8c25-6733f6f19701.PNG)
 
Picture 3: Overflow of GitHub username outside the box outline for Harshit",synicalsyntax,b'area: portico bug design',2017-11-10T03:24:08Z,2017-11-16T01:14:19Z
7346,bugdown: Some minor code cleanup.,Follow-up PR for PR #7335.,HarshitOnGitHub,None,2017-11-09T19:15:34Z,2017-11-16T06:48:03Z
7336,zendesk integration docs don't render,"Something is wrong with the `raw` tag, which looks to have a proper start/end in both places we use it; I don't see what on inspection but it's reproducible in development:

```
2017-11-09 02:35:11.416 ERR  [django.request] Internal Server Error: /integrations/doc-html/zendesk
Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/tabbott/zulip/zerver/lib/request.py"", line 173, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""/home/tabbott/zulip/zerver/views/integrations.py"", line 143, in integration_doc
    doc_html_str = render_markdown_path(integration.doc, context)
  File ""/home/tabbott/zulip/zerver/templatetags/app_filters.py"", line 106, in render_markdown_path
    html_template = jinja.from_string(html)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/template/backends/jinja2.py"", line 41, in from_string
    return Template(self.env.from_string(template_code), self)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/environment.py"", line 880, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/environment.py"", line 591, in compile
    self.handle_exception(exc_info, source_hint=source_hint)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/environment.py"", line 780, in handle_exception
    reraise(exc_type, exc_value, tb)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/_compat.py"", line 37, in reraise
    raise value.with_traceback(tb)
  File ""<unknown>"", line 59, in template
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/environment.py"", line 497, in _parse
    return Parser(self, source, name, encode_filename(filename)).parse()
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/parser.py"", line 896, in parse
    result = nodes.Template(self.subparse(), lineno=1)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/parser.py"", line 878, in subparse
    rv = self.parse_statement()
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/parser.py"", line 144, in parse_statement
    self.fail_unknown_tag(token.value, token.lineno)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/parser.py"", line 97, in fail_unknown_tag
    return self._fail_ut_eof(name, self._end_token_stack, lineno)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/parser.py"", line 90, in _fail_ut_eof
    self.fail(' '.join(message), lineno)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/jinja2/parser.py"", line 59, in fail
    raise exc(msg, lineno, self.name, self.filename)
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'endraw'.
```

",timabbott,b'bug priority: blocker',2017-11-09T02:36:39Z,2017-11-09T22:39:41Z
7308,bugdown: Fetch complete data for tweet.,"This makes an extended instead of a normal query,
resulting in the full text of a tweet being fetched
instead of just a truncated version.

@gnprice FYI.",roberthoenig,None,2017-11-06T17:14:38Z,2017-11-07T17:15:43Z
7290,Stream popover is not fully visible for streams which are at the bottom of stream list.,"
<img width=""556"" alt=""screen shot 2017-11-04 at 10 29 39 pm"" src=""https://user-images.githubusercontent.com/18511177/32407943-f793cd5a-c1b5-11e7-8459-ae9ce6510302.png"">

https://chat.zulip.org/#narrow/stream/frontend/topic/Stream.20popover.20is.20not.20fully.20visible",jainkuniya,b'area: message view bug',2017-11-04T17:45:59Z,2019-02-15T00:59:27Z
7280,Unicode formatting broken for timezone change confirmation.,"When changing my timezone to Europe/Prague, the confirmation message is broken:
![image](https://user-images.githubusercontent.com/7950151/32391144-4b637dda-c0d1-11e7-9b26-3e60a57218bb.png)
",roberthoenig,b'area: misc bug',2017-11-03T18:58:25Z,2017-11-07T18:00:01Z
7279,bugdown: Fix $$ whitespace handling,"The intended use of $$ is for inline expressions, not for multiline
ones; ```math is an acceptable alternative for the latter.  Hence,
the $$-syntax for inline TeX no longer permits newlines within it.

This was also necessary for the next change to be sensible; namely
allowing for spaces around both $$ when crafting inline TeX instead of
forcing everything to be crammed together, e.g. $$x=7$$.  In order to
avoid uninentionally creating inline expressions, the opening and
closing $$'s of an inline expression must now both exactly consist of
two dollar signs, no more and no less.

Fixes: #6488",PentaHiggs,None,2017-11-03T17:38:20Z,2017-11-11T00:56:42Z
7251,Limited settings scrolling on wide and short windows.,"I have a browser window looking like this:

![image](https://user-images.githubusercontent.com/7950151/32252839-d3aa4b56-be97-11e7-9e08-5a033df0698d.png)

Due to the short window height (shorter than the settings page), I cannot fully scroll down the entire menu. In this case, I cannot scroll down to the ""change/show api key"" section. The same problem occurs for diferent settings panes.",roberthoenig,b'area: settings UI bug',2017-10-31T23:05:37Z,2018-01-16T22:56:37Z
7250,bugdown: Rewrite links to local server to be relative links.,Is the use of Global here fine?,tommyip,None,2017-10-31T21:52:33Z,2017-11-10T00:00:43Z
7248,message view: Top navbar covers lightbox in mobile view,"![img_5621](https://user-images.githubusercontent.com/15116870/32245675-b2c545e8-be39-11e7-83da-153f76f82858.PNG)
",synicalsyntax,b'area: message view bug',2017-10-31T19:49:45Z,2017-11-17T18:01:25Z
7230,popovers: Hide open popovers on navigating back.,"Steps to reproduce:
*    Open settings and then close them.
*    Open emoji reaction modal,
*    Now go back using ""back button in browser"".

![image](https://user-images.githubusercontent.com/16687990/32199849-7f5815cc-bdf4-11e7-90f0-f2cf482eab51.png)

@shubhamdhama FYI, seems to be a good project for you. :)",HarshitOnGitHub,b'area: general UI bug',2017-10-30T23:03:32Z,2017-10-31T15:51:08Z
7229,message feed: Unread counts don't go away for edited messages in changed topics.,"The basic problem is the unread count not going away here:
![image](https://user-images.githubusercontent.com/890911/32194896-e6ee121c-bd78-11e7-8512-df9642873ed9.png)

Don't have a reproducer, but it has happened twice to me. More info at https://chat.zulip.org/#narrow/stream/issues/topic/unread.20count.20not.20going.20away.

",rishig,b'area: message view bug help wanted',2017-10-30T20:48:40Z,2018-02-08T23:15:14Z
7223,Welcome back message hangs,"I havent visited https://chat.zulip.org/ for about a year, probably before the 2016 GCI.

My window bar tells me I have 71098 unread messages.

I am now greeted with

> It's been a while! Since you were last here, you received 5000 new messages.
> Do you want to skip to your latest messages?

With buttons for ""Yes, please!"" and ""No, I'll catch up.""

I accept, and the box hangs indefinitely (30 mins and counting) without any UI feedback as to what is happening.

When I open a new tab, the message re-appears.

Some UI improvement might be part of https://github.com/zulip/zulip/issues/7209 , and [this thread](https://chat.zulip.org/#narrow/stream/issues/topic/Number.20of.20unread.20messages.2E) but the re-occurring message and hanging seems to be a separate issue.",jayvdb,b'area: notifications (messages) area: onboarding bug',2017-10-30T07:04:06Z,2020-07-10T09:58:05Z
7219,Replace HTML differ with lxml.html.diff/html_diff ,"This is an issue to improve the algorithm we use for the ""edit history"" feature.

Currently, in `zerver/lib/html_diff.py`, we try to use Google's diff-match-patch library to diff HTML.  The problem is, it's a text differ, not an HTML differ, and so it ends up messing up the HTML tags.  We have code to handle this in some common cases in `zerver.lib.html_diff.py`, but it doesn't work well for cases where markup adds/removes HTML tags.  For example, here's what happens with the `lxml` library: 

```
In [17]: htmldiff('<p>text</p><img src=""anything"">', '<p>delete</p>')
Out[17]: '<p><ins>delete</ins></p> <p><del>text</del></p><del><img src=""anything""></del>'
```

vs. our existing code (with a few print statements to show what's going on):

```
In [18]: highlight_html_differences('<p>text</p><img src=""anything"">', '<p>delete</p>')
[(0, '<p>'), (-1, 'text</p><img src=""anything""'), (1, 'delete</p'), (0, '>')]  # ops
2017-10-29 20:23:46.973 ERR  [] HTML diff produced mal-formed HTML for message None
<p><span class=""highlight_text_deleted"">text</span></p><img src=""anything""<span class=""highlight_text_inserted"">delete</span></p<>
Out[18]: '<p>delete</p>'
```

(The error line is how we we avoid the UI totally breaking).

We should be able to remove almost all of the code in that file when we replace it with the `lxml` version.

(We may need to use `lxml` to rewrite the `ins/del` tags to fit the span tags our frontend expects afterwards)

@HarshitOnGitHub this is probably a good project for you, given your recent work on lxml stuff.",timabbott,b'area: message-editing bug priority: high',2017-10-29T20:27:19Z,2017-10-30T21:15:09Z
7217,copy-paste: Copy the recipient bar if and only if selecting from more than one recipient block.,"![image](https://user-images.githubusercontent.com/890911/32147560-c7066616-bca6-11e7-816d-e59265c63f97.png)

Copying the messages with bar and baz (select with mouse, and use Ctrl-c) gives
```
Rishi Gupta: bar

test here > recipient block 2 Today

Rishi Gupta: baz
```

The desired behavior would be to also have `test here > recipient block 1 Today` up top.
Note that if you copy all three messages, it works as desired. 

In the other direction: if you select messages foo and bar, it does copy the recipient bar header, which it should not. 

Basically, the current algorithm seems to be: the recipient bar header is copied if: you select more than 1 message, and select the first message in the recipient block.

The correct algorithm is: the recipient bar header is copied if: you select messages from more than 1 recipient block, and select any message in the recipient block.
",rishig,b'area: message view bug good first issue help wanted',2017-10-29T19:52:53Z,2018-03-21T05:02:15Z
7216,copy-paste: Add newlines between recipient blocks.,"Copying and pasting across recipient blocks currently looks like
```
commits > zulip / master Yesterday

GitHub Bot: timabbott pushed 1 commit to branch master.

subdomains: Avoid exception when creating realm on root domain. (63489eb)
commits > zulip / master Today

GitHub Bot: timabbott pushed 2 commits to branch master. Commits by rishig (2).

server settings: Add setting for MAILING_ADDRESS. (a08543f)
emails: Send first welcome email right away. (e7ba4c5)
announce > chat.zulip.org Today

Tim Abbott: Deploying from master :)
```

There should be newlines between the recipient blocks, i.e. above `announce > chat.zulip.org Today` and `commits > zulip / master Today`. 

To reproduce just select a block of messages that spans a few recipient blocks, and Ctrl-c to copy and Ctrl-v to paste.",rishig,b'area: message view bug good first issue help wanted',2017-10-29T19:40:46Z,2017-10-29T21:49:03Z
7198,Fix traceback error output from test_realm_scenarios,"I think this error output is the result of our having recently changed the queue processors to run the `consume` methods when `queue_json_publish` is called in tests.  Not sure yet. 

```
Running zerver.tests.test_messages.TestCrossRealmPMs.test_realm_scenarios
2017-10-27 23:29:50.575 ERR  [] Error queueing internal message by welcome-bot@zulip.com: You can't send private messages outside of your organization.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1523, in validate_recipient_user_profiles
    raise ValidationError(_(""You can't send private messages outside of your organization.""))
django.core.exceptions.ValidationError: [""You can't send private messages outside of your organization.""]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1811, in _internal_prep_message
    content, realm=realm)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1763, in check_message
    raise JsonableError(e.messages[0])
zerver.lib.exceptions.JsonableError: You can't send private messages outside of your organization.
2017-10-27 23:29:50.645 ERR  [] Error queueing internal message by welcome-bot@zulip.com: You can't send private messages outside of your organization.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1523, in validate_recipient_user_profiles
    raise ValidationError(_(""You can't send private messages outside of your organization.""))
django.core.exceptions.ValidationError: [""You can't send private messages outside of your organization.""]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1811, in _internal_prep_message
    content, realm=realm)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1763, in check_message
    raise JsonableError(e.messages[0])
zerver.lib.exceptions.JsonableError: You can't send private messages outside of your organization.
2017-10-27 23:29:50.713 ERR  [] Error queueing internal message by welcome-bot@zulip.com: You can't send private messages outside of your organization.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1523, in validate_recipient_user_profiles
    raise ValidationError(_(""You can't send private messages outside of your organization.""))
django.core.exceptions.ValidationError: [""You can't send private messages outside of your organization.""]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1811, in _internal_prep_message
    content, realm=realm)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1763, in check_message
    raise JsonableError(e.messages[0])
zerver.lib.exceptions.JsonableError: You can't send private messages outside of your organization.
2017-10-27 23:29:50.775 ERR  [] Error queueing internal message by welcome-bot@zulip.com: You can't send private messages outside of your organization.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1523, in validate_recipient_user_profiles
    raise ValidationError(_(""You can't send private messages outside of your organization.""))
django.core.exceptions.ValidationError: [""You can't send private messages outside of your organization.""]
```",timabbott,b'area: testing-infrastructure bug priority: high',2017-10-27T23:33:56Z,2017-11-29T01:35:23Z
7197,Fix tracebacks creating inactive users with do_create_user in `test_people`,"We currently get this exception when running `test_people`.  It's the indirect consequence of (1) the fact that `do_create_user` with `active=False` user still sends welcome PMs (etc.) to the user, which would normally fail, and (2) the fact that we now run the actual queue processor code by default in the test suite.  Here's the exception:

```
Running zerver.tests.test_home.HomeTest.test_people
2017-10-27 22:23:35.802 ERR  [] Error queueing internal message by welcome-bot@zulip.com: 'defunct-0@zulip.com' is no longer using Zulip.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1517, in validate_recipient_user_profiles
    raise ValidationError(_(""'%s' is no longer using Zulip."") % (user_profile.email,))
django.core.exceptions.ValidationError: [""'defunct-0@zulip.com' is no longer using Zulip.""]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1811, in _internal_prep_message
    content, realm=realm)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1763, in check_message
    raise JsonableError(e.messages[0])
zerver.lib.exceptions.JsonableError: 'defunct-0@zulip.com' is no longer using Zulip.
2017-10-27 22:23:35.828 ERR  [] Error queueing internal message by welcome-bot@zulip.com: 'defunct-1@zulip.com' is no longer using Zulip.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1517, in validate_recipient_user_profiles
    raise ValidationError(_(""'%s' is no longer using Zulip."") % (user_profile.email,))
django.core.exceptions.ValidationError: [""'defunct-1@zulip.com' is no longer using Zulip.""]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1811, in _internal_prep_message
    content, realm=realm)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1763, in check_message
    raise JsonableError(e.messages[0])
zerver.lib.exceptions.JsonableError: 'defunct-1@zulip.com' is no longer using Zulip.
2017-10-27 22:23:35.852 ERR  [] Error queueing internal message by welcome-bot@zulip.com: 'defunct-2@zulip.com' is no longer using Zulip.
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1760, in check_message
    forwarder_user_profile, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1544, in recipient_for_user_profiles
    recipient_profile_ids = validate_recipient_user_profiles(user_profiles, sender)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1517, in validate_recipient_user_profiles
    raise ValidationError(_(""'%s' is no longer using Zulip."") % (user_profile.email,))
django.core.exceptions.ValidationError: [""'defunct-2@zulip.com' is no longer using Zulip.""]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1811, in _internal_prep_message
    content, realm=realm)
  File ""/home/tabbott/zulip/zerver/lib/actions.py"", line 1763, in check_message
    raise JsonableError(e.messages[0])
zerver.lib.exceptions.JsonableError: 'defunct-2@zulip.com' is no longer using Zulip.
```

(it's cutoff, because `internal_send_message` doesn't reraise).

I think the right fix for this is to make `do_create_user`, when passed `active=False`, create the user normally and then call `do_deactivate_user` on it.  It shouldn't be too hard to do, and would make this sort of testing more faithful (in that the users would be guaranteed to be setup normally).

@showell do you have time to take care of this one?",timabbott,b'area: refactoring area: testing-infrastructure bug',2017-10-27T22:28:00Z,2017-10-28T17:37:25Z
7193,Fix styling for missing/invalid/expired confirmation link errors,"This is what it looks like right now:

![image](https://user-images.githubusercontent.com/2746074/32122762-5d53bffc-bb16-11e7-8741-e59b97fd5d6b.png)

There's more we'll want to do to improve these errors (e.g. to distinguish missing from expired, etc.), but this is good for now.",timabbott,b'area: onboarding area: portico bug',2017-10-27T19:58:17Z,2018-03-20T17:03:23Z
7189,user settings: Improve Uploaded Files design.,"Two issues I've noticed with the Uploaded Files design:

- [ ] Really long files names break the table display (can't find any of the other icons or table headers here).  ![screenshot at oct 27 09-25-57](https://user-images.githubusercontent.com/15116870/32114689-ec9cb9e8-baf8-11e7-85e8-7d4d46e62fdc.png)
    
    Likely an issue with not specifying `max-width` + `overflow` +`whitespace` properties.

- [ ] Table headers scroll along with table body. The correct behavior should be a sticky table header like the ones found in the Users/Bots tables of Organization settings.",synicalsyntax,b'area: settings (user) area: settings UI bug design',2017-10-27T16:28:47Z,2017-11-06T20:15:32Z
7179,Mysterious `Could not find UserMessage with message_id <messageid>` bug,"Today I saw a strange set of symptoms on chat.zulip.org:

* We got exception emails of the form `Could not find UserMessage with message_id <messageid>`.  The code path in question is when the push notifications queue processor tries to look up the UserMessage row for the message.  In theory, this should be impossible, because we created UserMessage rows in an atomic operation earlier in `do_send_messages`.
* I confirmed that as of 10 minutes later, the UserMessage row does in fact exist.  So it's not failing to be created.
* I confirmed the user in question was 5 days old and not `long_term_idle`.  

So I'm forced to believe that the problem here is probably an issue where our use of `transaction.atomic` in `do_send_messages` is insufficient for ensuring that change actually makes it to the database in a way visible to other clients before we do the `queue_json_publish` that eventually leads to the push notification code running.

This is a topic for an advanced developer with a strong understanding of Django's transaction semantics.",timabbott,b'area: misc bug priority: high',2017-10-26T21:34:11Z,2018-03-20T23:57:45Z
7158,Styling of messages in search is wonky for some queries,"I did a search in our zulip instance and the styling of search results look like this:
![image](https://user-images.githubusercontent.com/1857780/32013412-dde37b42-b96f-11e7-8a7c-3af76b5fe6bd.png)


The last message before the formatting goes off the rails is a PR notification from github bot:
![image](https://user-images.githubusercontent.com/1857780/32013303-8b4df0d8-b96f-11e7-88dd-7ab0ffb6b472.png)

The contents of this message is approximately:
```
akaptur opened [PR](https://github.com/Zapgram/zapgram/pull/687)
from `migrate-infer` to `test-migrations`

~~~ quote
Blah blah `contains` blah blah blah `contains_word` blah.

Doc: https://paper.dropbox.com/doc/VLE5Os3LhmQMCqSK9374D
Summary: https://paper.dropbox.com/doc/SRYhRrLy30vVsdMjvRnwf

Fixes #439.
~~~
```",akaptur,b'area: search bug priority: high',2017-10-25T17:36:25Z,2018-03-28T20:51:35Z
7153,Fix is-active checks in popover code.,"Right now, `exports.realm_user_is_active_human_or_bot` doesn't have a way to tell whether or not a bot user is deactivated, so user popovers will always appear as though the bot is an active, even when it it has been deactivated.  Fixing this is somewhat related to #4322, but a bit independent.

While we're working on this, it might be nice to add the ""bot"" icon we have next to the user's name in the Zulip feed as ornamentation in the user popovers as well, so it's clear those are bots.

@showell FYI.",timabbott,b'area: message view bug priority: high',2017-10-24T22:59:19Z,2017-10-26T20:57:12Z
7137,integrations: Fix weird underline under just the back arrow,"![image](https://user-images.githubusercontent.com/2746074/31914025-f6ea55fc-b7fd-11e7-9282-3bb4727b8ec0.png)
",timabbott,b'area: integrations area: portico bug',2017-10-23T21:25:29Z,2017-10-24T23:39:44Z
7132,NoneType object has no attribute uri,"When I start my dev server and select All Reams from the `/devlogin` page, I get this error:
```
2017-10-23 17:16:47.003 ERR  [django.request] Internal Server Error: /devlogin/
Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/exception.py"", line 41, in inner
    response = get_response(request)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/srv/zulip-py3-venv/lib/python3.4/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip/zerver/views/auth.py"", line 517, in login_page
    return HttpResponseRedirect(realm.uri)
AttributeError: 'NoneType' object has no attribute 'uri'
```

@zulipbot claim",darshanime,b'area: provision bug',2017-10-23T18:35:50Z,2018-01-16T22:56:37Z
7131,encoding issue with docker dev env,"I setup my dev env using docker according to the documentation, and I am getting `UnicodeEncodeError` for file `zulip/zproject/backends.py in log_email`

```
UnicodeEncodeError at /accounts/login/local/
'ascii' codec can't encode character '\xa0' in position 2618: ordinal not in range(128)
```

I made some print statements 
```python
print(locale.getpreferredencoding(False))
ANSI_X3.4-1968
print(locale.getpreferredencoding())
ANSI_X3.4-1968
print(sys.stdout.encoding)
ANSI_X3.4-1968
print(sys.getfilesystemencoding())
ascii
```
One easy fix is to open the file with `encoding='utf-8'` and it works
```python
        with open(settings.EMAIL_CONTENT_LOG_PATH, ""w+"", encoding='utf-8') as f:
            f.write(new_email + previous_emails)
```
But why is this happening?
@zulipbot claim",darshanime,b'area: provision bug',2017-10-23T17:58:06Z,2018-10-16T22:28:58Z
7123,`n` hotkey still works when lightbox is open,"0. Make sure you have multiple topics unread.
1. Click on an image to open lightbox.
2. Press `n` and look at the link you are on. It will change as you press `n`.",lonerz,b'area: keyboard UI bug',2017-10-22T16:16:58Z,2017-11-03T22:44:46Z
7105,Tracebacks related to notifications prompt on iOS Safari,"@brockwhittaker can you fix this?  Seems to be new with your notifications panel PR merged, even with the latest master.

```
Message:
undefined is not an object (evaluating 'window.Notification.permission')

Stacktrace:
permission_state@https://chat.zulip.org/static/min/app.ce94e8b92b80.js:1872:238
       = static/js/notifications.js line 102 column 12
initialize@https://chat.zulip.org/static/min/app.ce94e8b92b80.js:2137:659
       = static/js/desktop_notifications_panel.js line 33 column 9
https://chat.zulip.org/static/min/app.ce94e8b92b80.js:2118:414
       = static/js/ui_init.js line 276 column 5
n@https://chat.zulip.org/static/webpack-bundles/common-0af515d20687e7387150.d7ea0521a11d.js:1:3455
       = webpack:///./static/js/blueslip.js line 225 column 1
M@https://chat.zulip.org/static/webpack-bundles/common-0af515d20687e7387150.d7ea0521a11d.js:24:25140
       = webpack:////srv/zulip-npm-cache/0b56021fa6f0358674e9f4a32cf91946299872d1/~/jquery/dist/jquery.js?1046 line 3583 column 1
https://chat.zulip.org/static/webpack-bundles/common-0af515d20687e7387150.d7ea0521a11d.js:24:25450
       = webpack:////srv/zulip-npm-cache/0b56021fa6f0358674e9f4a32cf91946299872d1/~/jquery/dist/jquery.js?1046 line 3651 column 1

User agent: Mozilla/5.0 (iPhone; CPU iPhone OS 11_0_2 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A421 Safari/604.1
```",timabbott,b'area: notifications (messages) bug priority: blocker',2017-10-20T16:37:31Z,2017-10-20T20:11:55Z
7093,left_sidebar: Rendering glitch on clicking `more topics` in firefox.,"Sometimes on clicking the 'more topics' in firefox, the UI is rendered like this:
![image](https://user-images.githubusercontent.com/16687990/31793575-405918c2-b53d-11e7-8631-f6ba56ed482c.png)
which is clearly buggy. This commit helps in reproducing the issue reliably: https://github.com/HarshitOnGitHub/zulip/commit/abcfb2c7e0cb43bba62096b044adf0b8832a13fe

Browser info: Firefox 56.0 (64-bit) on ubuntu 16.04.

@zulipbot label ""bug"" ""area: left-sidebar""",HarshitOnGitHub,b'area: browser-support area: left-sidebar bug',2017-10-19T20:52:23Z,2019-02-26T18:32:16Z
7076,i18n: Fix missing translation tags in `validate_stream_message_address_info`,"The `validate_stream_message_address_info` function in our compose code path doesn't tag all of the strings it uses for internationalization.  

Fixing this is a great bite-size issue for someone new, but make sure to read about how i18n.t works and the i18next library.  See https://zulip.readthedocs.io/en/latest/translating.html as a useful resource.",timabbott,b'area: i18n bug good first issue',2017-10-19T00:06:32Z,2018-02-06T00:30:27Z
7072,message_edit: Message feed looses focus when the message edit form is closed using ESC key in Firefox.,"If I use the left arrow hotkey to edit the last sent message but instead of editing the message I simply close the form using ESC key, I am unable to navigate in the message feed using arrow keys. The issue here is probably that we are not probably focusing correctly after closing the message edit form.

(Seems to be a firefox only issue, working fine on Chrome)

@zulipbot label ""bug"" ""good first issue"" ""area: message-editing""",HarshitOnGitHub,b'area: message-editing bug good first issue',2017-10-18T22:25:23Z,2017-10-28T00:14:55Z
7069,Offset when clicking anchor links to /help/ documentation,"If you click on a link to e.g. this:
http://127.0.0.1:9991/help/desktop-app-install-guide#installing-on-windows

You get to here:

![image](https://user-images.githubusercontent.com/2746074/31743279-6b58d3b6-b40f-11e7-861c-9625cfd52ca7.png)

We should be like 15 pixels further down, I think.


",timabbott,b'area: documentation (user) bug',2017-10-18T21:20:36Z,2017-10-19T00:06:19Z
7064,Group PMs unread counts have incorrect offset in right sidebar compared ,"As you can see, it's almost going off the screen:

![image](https://user-images.githubusercontent.com/2746074/31730411-aecc4eda-b3e6-11e7-88b4-7a150dd05416.png)

The other unread counts in the right sidebar are in the right place.

@brockwhittaker can you fix this one today?
",timabbott,b'bug priority: blocker',2017-10-18T16:29:09Z,2017-10-19T01:10:32Z
7059,push notifications go to muted topics on streams with stream_push_notify set,"I think to fix this, we'll want to change `get_recipient_info` to accept the `topic` as an argument and do a `MutedTopic.objects.filter(stream=stream, topic=topic)` query to see if anyone has it muted, and if so, filter them from the `stream_push_notify` list.

While we're at this, we should probably add `db_index=True` for some columns in `MutedTopic`  to make this query fast.

This is a follow-up to https://github.com/zulip/zulip-mobile/issues/1314.  I added a failing test for this logic as the second-to-last case in `test_end_to_end_missedmessage_hook`, so we should be able to just change a `True` to a `False` there when we fix this.

@showell this is probably a good project for you to take care of, since the only tricky thing is doing the MutedTopic table query correctly in `get_recipient_info`, and you have good context on that table.",timabbott,b'area: notifications (messages) bug priority: high',2017-10-18T05:48:56Z,2017-10-24T00:28:05Z
7058,Clean up error message for sending to a stream you're not subscribed to,"![image](https://user-images.githubusercontent.com/2746074/31702200-40da291c-b38a-11e7-9477-4b2ee3e6c5db.png)

We should make this prettier and also have a button to just subscribe yourself.

(You can get here by just typing `stream:Scotland` in the top search box) ",timabbott,b'bug priority: high',2017-10-18T05:27:29Z,2018-04-23T04:25:26Z
7047,Email Auth Registration Bug,"Scenario:

Email Auth Enabled to Create Organisation
LDAP then enabled and tested, works fine.
Email Auth then disabled and server restarted.

However it still lets you register a user via email (who is none LDAP)
Sends confirmation email
Link in confirmation email will let them set a password and then log them in.
However if you log out and try logging back, auth will fail. 

The registration by emails except those found in LDAP should be disabled whilst email auth is disabled.

Issue first reported by another user on chat.zulip.org, I replicated and got the same results. 
",adambirds,b'area: authentication bug priority: blocker',2017-10-17T22:37:07Z,2017-10-24T20:45:22Z
7045,Disable space-makes-code blocks feature of markdown renderer for email gateway,"Since every stream has an email address it is useful to use this feature to forward emails to a specific stream.
Usually emails are not written with markdown syntax in mind and the emails sometimes render in strange ways.
I think it would be a good idea to add a feature to disable the markdown render for the email gateway bot (emailgateway@zulip.com) 
",waotzi,b'area: markdown area: notifications (messages) bug priority: high',2017-10-17T18:11:55Z,2017-11-09T17:57:50Z
7031,Sometimes duplicate notification emails,"Since we merged @showell's and my work on the editing notifications (etc.), I've gotten a few times now 2 copies of a PM notification email, 2 minutes apart.  We need to investigate the possibility that missedmessage_hook is sending duplicate notifications, because that's very likely what's happening here.

(The message edit code path is definitely not involved, in that in neither case where I've seen this was the message edited, and in one case the message was from notification bot, which doesn't edit things)",timabbott,b'bug priority: blocker',2017-10-17T05:30:36Z,2017-10-18T05:10:37Z
7021,Search highlighting misalignment due to unicode characters,"Unicode characters with multiple code points should be handled correctly. See https://chat.zulip.org/#narrow/stream/issues/topic/Misaligned.20search.20highlight for more information.

![screenshot-2017-10-16 1971 sort imports - zulip community - zulip](https://user-images.githubusercontent.com/18504232/31621064-befe440e-b290-11e7-8dd1-812e0b01c400.png)

The `ö` here is causing the issue.

@zulipbot label ""area: search"" ""bug""
@zulipbot claim",tommyip,b'area: search bug',2017-10-16T15:42:44Z,2017-10-31T16:07:31Z
7018,Integrations logos not showing on /integrations/ page.,"On the /integrations/ page, not all the logos display correctly as in the below screenshot:
![image](https://user-images.githubusercontent.com/13500254/31590198-2da05966-b204-11e7-8228-65ee01a77659.png)
The below shows in Chrome Dev Tools:
![image](https://user-images.githubusercontent.com/13500254/31590212-56a2f12a-b204-11e7-80fb-3aa9b9a9653c.png)
We get the below errors in the nginx error.log file:
```
2017/10/15 22:57:44 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/airbrake.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/airbrake.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/appfollow.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/appfollow.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/asana.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/asana.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/bitbucket.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/bitbucket.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/basecamp.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/basecamp.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/capistrano.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/capistrano.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/codeship.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/codeship.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/gogs.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/gogs.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/gitlab.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/gitlab.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/crashlytics.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/crashlytics.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/freshdesk.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/freshdesk.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/git.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/git.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/delighted.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/delighted.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/github.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/github.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/email.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/email.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/circleci.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/circleci.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:44 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/codebase.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/codebase.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/greenhouse.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/greenhouse.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/google-calendar.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/google-calendar.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/gosquared.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/gosquared.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/helloworld.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/helloworld.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/hellosign.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/hellosign.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/homeassistant.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/homeassistant.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/ifttt.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/ifttt.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/heroku.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/heroku.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/jenkins.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/jenkins.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/jira.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/jira.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/librato.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/librato.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/mention.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/mention.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/mercurial.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/mercurial.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/nagios.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/nagios.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/newrelic.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/newrelic.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/openshift.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/openshift.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/pagerduty.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/pagerduty.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/papertrail.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/papertrail.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/perforce.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/perforce.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/phabricator.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/phabricator.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/pingdom.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/pingdom.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/pivotal.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/pivotal.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/puppet.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/puppet.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/redmine.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/redmine.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/rss.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/rss.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/semaphore.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/semaphore.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/sentry.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/sentry.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/slack.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/slack.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/solano.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/solano.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/splunk.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/splunk.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/subversion.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/subversion.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:45 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/taiga.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/taiga.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/teamcity.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/teamcity.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/trac.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/trac.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/transifex.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/transifex.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/travis.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/travis.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/trello.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/trello.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/updown.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/updown.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/twitter.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/twitter.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/wordpress.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/wordpress.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/yo.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/yo.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/zapier.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/zapier.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/zendesk.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/zendesk.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/assembla.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/assembla.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/bonusly.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/bonusly.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1767 open() ""/home/zulip/prod-static/images/integrations/logos/chartbeat.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/chartbeat.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1771 open() ""/home/zulip/prod-static/images/integrations/logos/google-hangouts.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/google-hangouts.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1768 open() ""/home/zulip/prod-static/images/integrations/logos/mailchimp.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/mailchimp.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1766 open() ""/home/zulip/prod-static/images/integrations/logos/google-translate.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/google-translate.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
2017/10/15 22:57:46 [error] 18785#18785: *1769 open() ""/home/zulip/prod-static/images/integrations/logos/youtube.png"" failed (2: No such file or directory), client:  1.1.1.1, server: , request: ""GET /static/images/integrations/logos/youtube.png HTTP/1.1"", host: ""chat.adbtechltd.co.uk"", referrer: ""https://chat.adbtechltd.co.uk/integrations/""
```
",adambirds,b'bug priority: blocker',2017-10-15T23:00:47Z,2017-10-18T19:11:51Z
6999,perfect scrollbar on /help/ pages not working,"![image](https://user-images.githubusercontent.com/2746074/31577275-498fe474-b0c0-11e7-8738-464289a1b267.png)

@brockwhittaker we seem to have regressed to the old scrollbar.",timabbott,b'bug priority: blocker',2017-10-14T16:16:25Z,2017-10-18T00:43:48Z
6984,Broken search results for query `handle 'zulip_admin'`,"### Reproduction

1. Search for `handle 'zulip_admins'`.
2. The search results should look similarly broken to this:
![image](https://user-images.githubusercontent.com/7950151/31551265-48d50d02-b034-11e7-945d-4b16cda19269.png)

*Note: `handle 'zulip_admin'` is the shortest string I found that breaks the results. Queries like `handl 'zulip_admin'` work fine for me. Also, the results break for me only **after August 16th**: Everything before that (starting with a message from August 9th) is displayed fine.",roberthoenig,b'area: search bug',2017-10-13T14:37:51Z,2017-11-07T21:13:54Z
6978,User mentions incorrectly considers deactivated users,"If there's 2 users with the same name, one of them deactivated, mentioning can end up targeting the wrong user.

This seems to be a regression in `get_full_name_info`, which doesn't filter on `is_active=True`.

@showell can you take this one?  Seems like it should be quick to fix and test.",timabbott,b'area: markdown bug priority: blocker',2017-10-12T21:10:17Z,2017-10-13T00:14:38Z
6977,Replacing a removed custom emoji doesn't work,"I added a custom emoji in the Linux desktop app, and it worked fine.  I then decided I didn't like it, deleted it.  I then tried to add a different png of the same name and received an error: ""Failed: Realm emoji with this Realm and Name already exists.""

I then went to my web browser and logged in to my zulip instance from there.  All is well.  The unwanted emoji is gone and the new one is in place.  It works just fine.  The problem is simply that the desktop client gives a spurious error message.

					-
					Zulip 1.5.0
					Electron 1.6.14
					linux x64 4.11.0-1-amd64",jvasile,b'area: emoji bug priority: high',2017-10-12T20:50:54Z,2018-03-22T18:28:08Z
6966,Filter spammy sockjs.tornado errors more specifically,"See #6959 . This issue is for the follow-up to make a more narrowly-targeted fix, like the one discussed there.
",gnprice,b'area: production bug',2017-10-12T03:57:46Z,2020-10-09T00:31:03Z
6962,ZulipLimiter seems to not work with memcached being down,"Something related to either our Python 3 migration or our recent logging refactor means that ZulipLimiter is no longer correctly rate-limiting the emails when Zulip is down due to something like memcached being down.

One interesting observation is that the memcached tracebacks seem to have a fairly random number in them (37562480) which could explain what we're seeing.

However, we also recently had the error email format get super verbose, it's possible the right fix is to correct the tracebacks, and that will magically fix the ZulipLimiter problem.

```
Internal Server Error: /json/messages

ServerDown at /json/messages
error 47 from memcached_set: (37562480) SERVER HAS FAILED AND IS DISABLED UNTIL TIMED RETRY, host: 127.0.0.1:11211 -> libmemcached/connect.cc:612
```",timabbott,b'area: production bug',2017-10-11T23:47:18Z,2020-02-07T22:45:24Z
6961,Exceptions in websockets code,"I got this exception in our websockets code path in production:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-10-06-23-10-28/zulip-py3-venv/lib/python3.5/site-packages/tornado/websocket.py"", line 494, in _run_callback
    result = callback(*args, **kwargs)
  File ""/home/zulip/deployments/2017-10-06-23-10-28/zulip-py3-venv/lib/python3.5/site-packages/sockjs/tornado/transports/websocket.py"", line 32, in open
    self.stream.socket.setsockopt(socket.SOL_TCP, socket.TCP_NODELAY, 1)
AttributeError: 'NoneType' object has no attribute 'setsockopt'
```

Here's another:
```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-10-06-22-35-44/zulip-py3-venv/lib/python3.4/site-packages/sockjs/tornado/transports/websocket.py"", line 60, in on_message
    self.session.on_messages(msg)
  File ""/home/zulip/deployments/2017-10-06-22-35-44/zulip-py3-venv/lib/python3.4/site-packages/sockjs/tornado/session.py"", line 419, in on_messages
    self.conn.on_message(msg)
  File ""/home/zulip/deployments/2017-10-06-22-35-44/zerver/tornado/socket.py"", line 188, in on_message
    self.authenticate_client(msg)
  File ""/home/zulip/deployments/2017-10-06-22-35-44/zerver/tornado/socket.py"", line 132, in authenticate_client
    if not _compare_salted_tokens(msg['request']['csrf_token'], self.csrf_token):
KeyError: 'csrf_token'
```

These seems like the sort of thing that shouldn't be possible (at least, the second should probably provide a less intense error, since it sounds like an invalid request, unless it indicates a client-side bug).  Regardless, it deserves some investigation.

",timabbott,b'area: production bug',2017-10-11T23:42:13Z,2018-03-31T16:33:33Z
6960,Investigate and potentially suppress social auth AuthStateMissing errors,"We've been getting this exception occasionally in production:

```
Traceback (most recent call last):
  File ""./zproject/backends.py"", line 255, in auth_complete
    return super(SocialAuthMixin, self).auth_complete(*args, **kwargs)  # type: ignore # monkey-patching
  File ""/home/zulip/deployments/2017-10-06-23-10-28/zulip-py3-venv/lib/python3.5/site-packages/social_core/utils.py"", line 252, in wrapper
    return func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-10-06-23-10-28/zulip-py3-venv/lib/python3.5/site-packages/social_core/backends/oauth.py"", line 387, in auth_complete
    state = self.validate_state()
  File ""/home/zulip/deployments/2017-10-06-23-10-28/zulip-py3-venv/lib/python3.5/site-packages/social_core/backends/oauth.py"", line 89, in validate_state
    raise AuthStateMissing(self, 'state')
social_core.exceptions.AuthStateMissing: Session value state missing.
```

Either this is a bug in our auth integration, or more likely, it's what happens when you hit the ""back"" button somewhere in the social-auth flow.  If the former, we should fix; if the latter, we should make sure something reasonable happens and not throw a 500.",timabbott,b'area: authentication bug',2017-10-11T23:41:09Z,2017-10-14T00:16:51Z
6959,logging: Spammy error emails with `Attempted to attach to session ... from different IP ...`,"Since we stopped suppressing third-party logging, we've started getting a ton of logging messages as described in this issue title from the `tornado.general` logger.

@gnprice I'm going to fix this with direct suppression of that logger, but I think there's clearly 2 other bugs in our new logging code:
* The ZulipLimiter is clearly not working
* We're sending error emails for `logging.error`, whereas I think that may have used be just for exceptions.",timabbott,b'area: production bug',2017-10-11T23:38:27Z,2017-10-12T03:55:55Z
6955,Minor issues with the real-time sync state in streams management,"* If you use the ""subscribe"" button in the upper-right, somehow the stream row on the left doesn't get selected after the stream is subscribed to.
* If as Iago, you unsubscribe using the checkbox on the left, the count changes, but the list of subscribers still contains Iago.
",timabbott,b'accessibility bug priority: blocker',2017-10-11T19:50:24Z,2017-10-18T18:50:25Z
6948,Issue with message list being rendered out of order causing scrolling problems,"Today I encountered a rare issue where the message list on a given narrow was out-of-order.  The displayed order was:
```
296453
296455
296454
296457
```

Trying to scroll past 296455 would throw the following exception (and not proceed):

![image](https://user-images.githubusercontent.com/2746074/31457508-d6882978-ae71-11e7-8538-814a2fd36ca5.png)

I've seen that exception a number of times in our exception reporting, but never been able to figure out what caused it.  Now we know.  

I got to this narrow by clicking on it, and all the messages are from last night (though my browser was open overnight), and I didn't send any of them, so this isn't a local echo bug.  It's also not a message editing bug, because none of the involved messages were edited.

So, I think the bug must be that these were actually inserted into the message list in the wrong order.

Reloading makes the problem go away, so the bug is in the ""new message arrives"" code path for `home_msg_list` and `all_msg_list` (and thus got to the narrow from there).",timabbott,b'area: message view bug priority: high',2017-10-11T17:55:12Z,2017-10-11T22:58:30Z
6946,Alert words styles are not applied in own send messages.,"<img width=""285"" alt=""screen shot 2017-10-11 at 10 35 48 pm"" src=""https://user-images.githubusercontent.com/18511177/31456292-e9a33aec-aed6-11e7-99bb-f227db85063d.png"">
",jainkuniya,b'area: markdown area: notifications (other) bug',2017-10-11T17:23:31Z,2017-10-12T21:07:02Z
6923,Left sidebar faded a stream even though it has an unread message,"This shouldn't be possible, and suggest some sort of bug in the state update system:

![image](https://user-images.githubusercontent.com/2746074/31327864-c26d73f4-ac86-11e7-9a77-1eb7cb31dc04.png)
",timabbott,b'area: left-sidebar bug',2017-10-09T07:14:45Z,2020-01-31T20:57:15Z
6866,Messages from notifications_bot aren't tagged for translation,"You can find these and similar strings by searching the codebase for `get_system_bot`, since most things sent by system bots are this sort of notification.  We may want to take the opportunity to edit the text a bit when tagging for translation as well.

In terms of what language to use, for private messages, we should use the language of the recipient user.  For stream messages, we should use the default language for the organization.  We may need to call the Django methods to change the language in these internal_send_message type code paths for this to work at runtime.  But I think it's be reasonable to start with just tagging the strings so translators can start working on them.

A related set of strings we'll want to translate is those in `zerver/lib/onboarding.py`, but I think we might want to defer that until @rishig does another pass on the text, since they're fairly long?

https://zulip.readthedocs.io/en/latest/translating.html is relevant context for how to do the tags.",timabbott,b'area: i18n bug priority: high',2017-10-05T06:49:09Z,2020-09-03T00:49:28Z
6835,using `!` in linkification regex,"I'm trying to make a custom linkification filter that recognizes the GitLab convention of a `!` prefix to identify a merge request.

I've tried several variants:

```
!(?P<id>[0-9]+)
\!(?P<id>[0-9]+)
[!](?P<id>[0-9]+)
[\!](?P<id>[0-9]+)
\041(?P<id>[0-9]+)
```

but it always comes back with

> Failed: Invalid filter pattern, you must use the following format OPTIONAL_PREFIX(?P<id>.+)",keturn,b'area: markdown bug',2017-10-03T20:18:14Z,2018-01-17T19:52:13Z
6827,emoji picker: Make the mouse hover cursor be the same as the hotkeys navigation cursor,"Ideally, if you're switching back and forth between using the hotkeys and mouse to navigate the emoji picker, the keyboard and mouse cursors would be the same, not 2 different things:

![image](https://user-images.githubusercontent.com/2746074/31141057-282524cc-a82b-11e7-8d4f-04d188d13738.png)

We should also pick whichever visuals we prefer.

This is I think the one remaining major issue with our emoji picker, so tagging it medium.  Hopefully we can get this fixed before the release.",timabbott,b'area: emoji area: keyboard UI bug help wanted priority: high',2017-10-03T18:09:09Z,2017-10-05T16:09:37Z
6821,`window.location.reload(true);` seems to sometimes not actually reload ,"We've had a few issues where a browser was continuing to run the Zulip presence/socket code, throwing lots of errors, after its event queue had been garbage-collected.  The root problem seems to be that `window.location.reload(true)` was called, but didn't actually reload the browser.  May be a new browser bug.  

I say this on @brockwhittaker's machine running Chrome on Mac today; have seen a few copies of this in our browser errors reporting as well.

We should do something about this, even if it's just making sure we retry the reload when getting these errors rather than reporting them to the server.",timabbott,b'area: misc bug priority: blocker',2017-10-02T23:13:40Z,2017-10-12T03:43:19Z
6798,Stream setting panel isn't visible just after changing subscription status.,"![ezgif com-video-to-gif-6](https://user-images.githubusercontent.com/18511177/31048005-8ca88754-a632-11e7-9903-69e27a858119.gif)


https://chat.zulip.org/#narrow/stream/issues/topic/Better.20handling.20of.20subscriptions.20add.2Fremove",jainkuniya,b'area: stream settings bug priority: blocker',2017-09-30T17:28:46Z,2017-10-11T19:51:56Z
6797,Subscribers list isn't updated just after changing subscription status. ,"![ezgif com-video-to-gif-6](https://user-images.githubusercontent.com/18511177/31048005-8ca88754-a632-11e7-9903-69e27a858119.gif)


https://chat.zulip.org/#narrow/stream/issues/topic/Better.20handling.20of.20subscriptions.20add.2Fremove",jainkuniya,b'area: stream settings bug priority: high',2017-09-30T17:27:55Z,2018-01-16T22:56:37Z
6776,Improve error handling of import failures,"If you try to import something that doesn't exist, our test suite provides a pretty unhelpful error message.  Technically, you can read from the logs that the problem is in `test_audit_log` (example problem in the diff below), but I think only because I ran that file rather than the whole suite.

```
(zulip-py3-venv) tabbott@zaset:~/zulip$ ./tools/test-backend test_audit_log
-- Running tests in serial mode.
Destroying test database for alias 'default'...
Using existing clone for alias 'default'...

======================================================================
ERROR: test_audit_log (unittest.loader._FailedTest)
----------------------------------------------------------------------
Exception: Test doesn't have _pre_setup; something is wrong.

----------------------------------------------------------------------
Ran 0 tests in 0.000s

FAILED (errors=1)
Destroying test database for alias 'default'...
(zulip-py3-venv) tabbott@zaset:~/zulip$ git diff
diff --git a/zerver/tests/test_audit_log.py b/zerver/tests/test_audit_log.py
index 7502643..29673ab 100644
--- a/zerver/tests/test_audit_log.py
+++ b/zerver/tests/test_audit_log.py
@@ -1,5 +1,5 @@
 
-from django.utils.timezone import now as timezone_now
+from django.utils.timezone import no as timezone_now
 
 from zerver.lib.actions import do_create_user, do_deactivate_user, \
     do_activate_user, do_reactivate_user, do_change_password, \
```

In particular, if you run the whole suite, you get this instead:
```
======================================================================
ERROR: zerver (unittest.loader._FailedTest)
----------------------------------------------------------------------
Exception: Test doesn't have _pre_setup; something is wrong.

----------------------------------------------------------------------
```

Ideally, we'd provide a nice clear message that we got a failure importing the given file, and print both the file and ideally, the actual exception one gets trying to import it.  If you look in `test_runner.py`, there's a section for `_pre_setup` that should help here, but it seems to not be working now (probably because that workaround only works on Python 2).",timabbott,b'area: testing-infrastructure bug priority: high',2017-09-29T17:35:42Z,2018-01-05T17:06:40Z
6775,Some styles aren't applied to account confirmation mail.,"Screenshot for rediffmail. (background color of confirm button is not visible.)
<img width=""805"" alt=""screen shot 2017-09-29 at 5 46 46 pm"" src=""https://user-images.githubusercontent.com/18511177/31027628-8146771a-a568-11e7-97e1-839261bb8bdf.png"">

(BTW it is visible on gmail.)",jainkuniya,b'area: notifications (other) bug priority: blocker',2017-09-29T17:22:40Z,2017-10-03T01:02:26Z
6770,user docs: Block access to macros in /include/ directory.,"Our documentation macros are located in the `templates/zerver/help/include` folder. However, these same macros are being rendered by the markdown parser as independent articles (ex: `http://localhost:9991/help/include/go-to-the`). Accessing these macros should redirect the user to a 404 page (`missing.md`) instead.",synicalsyntax,b'area: documentation (user) bug',2017-09-29T16:06:57Z,2017-10-03T18:19:50Z
6757,Lightbox hotkey bugs,"1. Open the lightbox. Pressing `j` or `k` closes the lightbox.

2. Open the lightbox. Pressing `d` opens the draft modal. Then pressing ESC closes the lightbox, but leaves the draft modal open, which can't be closed unless you refresh the page.",lonerz,b'area: keyboard UI area: misc bug',2017-09-28T21:01:41Z,2017-10-03T15:45:11Z
6738,right sidebar: Should run perfectScrollbar.update() when hitting backspace in right sidebar,"In the right sidebar, if you do the following:
* In a large realm, fliter to a subset of users that's long enough that still has a scrollbar (e.g. type ""a"").
* Scroll down in that list
* Hit backspace one or more times to unfilter
* move the mousewheel in the right sidebar area

Then at the last step, the scrollbar visibly resizes significantly, suggesting that probably it wasn't updated in step 3.",timabbott,b'area: right-sidebar bug',2017-09-28T03:24:45Z,2017-10-05T17:33:43Z
6730,Fix /help/ scrollbar visibility on mobile,"As a follow-up to #6717, I just noticed a new problems on mobile, which is that with the scrollable area closed, you see a scrollbar, which seems wrong:

![image](https://user-images.githubusercontent.com/2746074/30943784-1788c678-a3a8-11e7-841e-ded2652273ac.png)



",timabbott,b'area: documentation (user) bug',2017-09-28T00:21:02Z,2017-09-28T18:06:22Z
6714,help: Links to anchor tags from left sidebar don't work.,"To repro:
On localhost:9991/help, click ""Send a status message"" in the left sidebar. It takes you to the top of ""Format your message using Markdown"", even though the URL is correct. (E.g. if you open another tab and go to that URL directly, it'll take you to the correct place.)

We do some fancy stuff when you click links in the left sidebar to avoid reloading the page, so the error is probably somewhere in that logic.",rishig,b'area: documentation (user) bug good first issue help wanted',2017-09-27T16:01:56Z,2018-02-14T17:32:04Z
6713,/apps page loses the download link on ultra-wide screens,"I had to zoom out a lot to reproduce this:

![image](https://user-images.githubusercontent.com/2746074/30922787-ff005f9c-a35e-11e7-8cd1-578c3185bfc5.png)
",timabbott,b'area: portico bug priority: blocker',2017-09-27T15:37:21Z,2017-09-28T21:05:04Z
6706,Final page in email change flow could use some design work to use white box,"This looks fairly broken:

![image](https://user-images.githubusercontent.com/2746074/30896113-81793022-a303-11e7-8df3-57629104e9e2.png)

@brockwhittaker can you take this one?  

",timabbott,b'area: portico bug priority: blocker',2017-09-27T04:42:41Z,2017-09-28T00:47:48Z
6700,user docs: Cannot scroll through sidebar on small screen devices.,"It's currently impossible to scroll through the user docs sidebar on mobile devices, which is troubling for any user that wants to access a different user doc article through their smartphone.

[![https://gyazo.com/3c63003ee353e50b3589e3e5b3fff866](https://i.gyazo.com/3c63003ee353e50b3589e3e5b3fff866.gif)](https://gyazo.com/3c63003ee353e50b3589e3e5b3fff866)

(behavior is reproducible on mobile device too)

Pinging @brockwhittaker to take a look at this issue.",synicalsyntax,b'area: documentation (user) bug priority: blocker',2017-09-27T01:00:13Z,2017-09-28T00:22:18Z
6674,Suppress pika/RabbitMQ logging,"Following #6671, we now have the ""Connecting to"" and ""Created channel"" items below being logged in all of our worker logs every time they restart.  We should suppress these, since they're not really useful; probably it's one of the loggers in the `pika` library that `disable_existing_loggers` was turning off for us.

```
2017-09-25 22:46:10,639 INFO     Worker 0 disconnecting from queue signups
2017-09-25 22:46:40,307 INFO     Worker 0 connecting to queue signups
2017-09-25 22:46:40,309 INFO     Connecting to 127.0.0.1:5672
2017-09-25 22:46:40,329 INFO     Created channel=1
2017-09-25 23:14:48,062 INFO     Worker 0 disconnecting from queue signups
```",timabbott,b'bug priority: blocker',2017-09-25T23:17:27Z,2017-09-27T04:05:58Z
6667,"Improve visuals for ""organization does not exist"" error","We should probably put this in a nice white box we use for similar features:

![image](https://user-images.githubusercontent.com/2746074/30831207-7c04f0bc-a1fb-11e7-9c04-17c5f788b3a5.png)

Accessible by visiting an invalid subdomain in development with REALMS_HAVE_SUBDOMAINS=True.
",timabbott,b'area: portico bug',2017-09-25T21:13:12Z,2017-09-27T00:04:10Z
6666,"""Custom invitation message"" has initial content of like 20 blank spaces","This seems like a priority issue, since it feels kinda broken to need to enter text here.

",timabbott,b'area: onboarding bug priority: high',2017-09-25T21:11:29Z,2017-09-26T21:15:58Z
6665,"CSS for new organization signup email form clips ""g"" characters","Here's an example:

![image](https://user-images.githubusercontent.com/2746074/30831054-f1145ede-a1fa-11e7-9d0b-e8eefc1489f3.png)

@brockwhittaker can you fix this?  Should be a quick bug.
",timabbott,b'area: portico bug priority: blocker',2017-09-25T21:08:47Z,2017-09-26T18:51:55Z
6663,Fix test_registration_through_ldap use of `realm_name` and `realm_subdomain`,"We want to do something similar to 5159151e5fd5bef787fbee814f833d38e982dad1 for `test_registration_through_ldap`.  That test is incorrect/confusing, in that it (1) currently does not properly pass `from_confirmation` to a lot of its submissions of the registration form (and thus is doing part 2 of registration, not part 1, unexpectedly), (2) passes the `realm_name` and realm_subdomain` fields to that form, which should only be included for realm creation, not user registration, and (3) is counting on the fact that passing those arguments make the form error to get to see the registration part 1 form after trying to submit part 2.  

Ideally, we should redo this test to cover what it currently covers, but perhaps to actaully create users using the correct flow, and check that the `full_name` is set properly based on which case was followed.

@umairwaheed can you take this one?  ",timabbott,b'area: authentication area: testing-coverage bug',2017-09-25T13:50:08Z,2017-10-19T06:11:05Z
6652,Stream subscription message does not decode HTML entities.,"Chat: https://chat.zulip.org/#narrow/stream/issues/topic/Stream.20subscription.20msg

![img_20170924_092947](https://user-images.githubusercontent.com/18504232/30780900-6c9fa4b2-a10d-11e7-83e4-d9e1b0a562a8.jpg)

The stream name should be `ML / NLP`.",tommyip,b'area: message view bug good first issue',2017-09-24T08:50:06Z,2017-10-11T17:04:16Z
6639,Improve error message for unregistered server from push notification bouncer,"Dave Cadwallader: cool. seems to be working well. i did however get this email when someone just logged in something like this: `zerver.lib.exceptions.JsonableError: Invalid Zulip server: <uuid>`

I believe this is going through this code path in `send_to_push_bouncer`:
```
    elif res.status_code >= 400:                                                                                                
        try:                                                                                                                    
            msg = ujson.loads(res.content)['msg']                                                                               
        except Exception:                                                                                                       
            raise JsonableError(_(""Error received from push notification bouncer""))                                             
        raise JsonableError(msg)                                                                                                
```

What we should do is use an actual error code so we can reliably check for this specific error (which is sent by the push bouncer server).  Then, the client aka individual Zulip server should raise an exception that's much more clear that the problem is their credentials are not registered for the push bouncer service.

@gnprice can you take this one?  Since it's a client-side code change for the push bouncer and should be a small change, we should get it in for the release (aka do it in the next few days.",timabbott,b'area: production bug priority: blocker',2017-09-22T21:59:43Z,2017-10-12T03:21:15Z
6632,Make default mode of cache-cleaning scripts much less verbose,"After doing a production deployment, one gets a ton of distracting output like this about our caches:

```
Cleaning unused deployments...
Keeping used deployment: /root/zulip
Deployments cleaned successfully...
Cleaning orphaned/unused caches...
Starting cache cleaning scripts...
Cleaning unused venv caches...
Cleaning unused venv cache: /srv/zulip-venv-cache/35a350faaf6419b4abd739cd5b44d1da3d9836d1
Keeping used venv cache: /srv/zulip-venv-cache/2728dae9e9eba13777198f53d6ad90a67c884b83
Keeping used venv cache: /srv/zulip-venv-cache/d49157aabff5cb2b491a415a8564604a6763ca36
Keeping used venv cache: /srv/zulip-venv-cache/f3fa0d8fc2b1032dafe673157b71b00cf355790f
Done!

Cleaning unused node modules caches...
Keeping used node modules cache: /srv/zulip-npm-cache/b6511c4dbd9aa30fd325556fe513de7ad8384aad
Done!

Cleaning unused emoji caches...
Cleaning unused emoji cache: /srv/zulip-emoji-cache/8b1fc402e74282ea8d711781c007e9ed2e0b1062
Keeping used emoji cache: /srv/zulip-emoji-cache/de773e45f080e1d0858d2894cb5064cec277fa21
Done!

Done!

```

That output is great for debugging, but we probably only want it with a `--verbose` flag.

@HarshitOnGitHub FYI -- do you want to take this?",timabbott,b'area: production installer bug priority: blocker',2017-09-22T16:55:00Z,2017-09-24T11:43:37Z
6628,Scrolling up sometimes stops loading messages,"Sometimes scrolling to the top triggers a fetch for new messages, but they're not drawn on the screen.

Steps to reproduce:

1. Visit https://chat.zulip.org/#
2. Press `home` to scroll to top, waiting for the older messages to appear on screen
3. Press `home` again to scroll to top, waiting for still-older messages to appear on screen
4. Press `home` again (etc)

Sometimes the spinner icon spins then reverts to 
![image](https://user-images.githubusercontent.com/313089/30754181-5fe7d424-9f87-11e7-80e8-d512af8b8da2.png) without any messages appearing at the top of the screen.

In dev tools, I can see that a request went out and a response came back with the older message content.

Scrolling  back down (e.g. by pressing `j`) causes the older messages to then appear.
",jmandel,b'area: message view bug priority: blocker',2017-09-22T16:18:26Z,2017-10-03T18:39:44Z
6626,Scrollbars overlap if you scroll over right sidebar and home view near simultaneously,[![https://gyazo.com/5b35336feef3f3abedb89e0d0d8951f4](https://i.gyazo.com/5b35336feef3f3abedb89e0d0d8951f4.gif)](https://gyazo.com/5b35336feef3f3abedb89e0d0d8951f4),synicalsyntax,b'area: message view bug duplicate',2017-09-22T12:18:24Z,2018-01-01T19:27:18Z
6612,Error in missed_message hook when user first goes offline,"We've begun seeing exceptions like this one on chat.zulip.org:
```
2017-09-19 22:35:36,955 ERROR    Problem handling data on queue missedmessage_mobile_notifications
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-09-16-11-37-40/zerver/worker/queue_processors.py"", line 120, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2017-09-16-11-37-40/zerver/worker/queue_processors.py"", line 262, in consume
    handle_push_notification(data['user_profile_id'], data)
  File ""/home/zulip/deployments/2017-09-16-11-37-40/zerver/decorator.py"", line 624, in wrapped_func
    ret = func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-09-16-11-37-40/zerver/lib/push_notifications.py"", line 402, in handle_push_notification
    triggers = missed_message['triggers']
KeyError: 'triggers'
```

Here `missed_message` is the parameter of `handle_push_notification` that is just the data that was in the queue -- so that data is missing the `triggers` field. This `triggers` field was added recently, in the code eventually merged on #6535.

Reading the code, it looks like there are two places we put things into the `missedmessage_mobile_notifications` queue which this comes from:
* `process_message_event`, which is called when a message is first sent, and which got this logic;
* `missedmessage_hook`, which is called when a user's event queue is GC'd, and which didn't get this logic.

So the latter should populate `triggers` too. Possibly that logic should get factored out to avoid duplication.
",gnprice,b'area: notifications (other) bug',2017-09-20T23:57:32Z,2017-09-27T23:01:38Z
6606,Subscribe to new thread scrolls to top of window,"I subscribed to a bunch of threads a while back, and found it a little frustrating because every time I clicked the check button to subscribe, it would scroll my window to the top of the page. I'd then have to scroll back down to where I was before, which when you're subscribing to a lot of streams adds a whole lot of time. I don't know if this is desired behavior, but I think it would be better if subscribing did not change the current scroll position.

Reproduce:

1. Open the streams management page
2. Scroll down to a stream that you haven't subscribed
3. Click subscribe
===> Window scrolls to the top of the page

Expected/Suggested Behavior:

3. Click subscribe
===> Window does not scroll",nwshane,b'area: stream settings bug priority: blocker',2017-09-20T16:18:49Z,2017-09-21T16:11:41Z
6601,Left bar is scrolled to end after automatic reload.,"After reload of the page, (reloads which occurs automatically after resuming Zulip tab after a long time) streams list is always scrolled to end . Facing this issue from last few days, before it was working fine.

<img width=""248"" alt=""screen shot 2017-09-20 at 5 10 50 pm"" src=""https://user-images.githubusercontent.com/18511177/30643350-3342c052-9e2c-11e7-8008-f6d4d50fca8a.png"">

https://chat.zulip.org/#narrow/stream/issues/topic/left.20bar.20scroll",jainkuniya,b'area: left-sidebar bug',2017-09-20T12:21:16Z,2018-04-28T19:42:51Z
6579,missed_messages: Fix the misalignment of emojis with text.,"This seems to be a recent regression to me.
![image](https://user-images.githubusercontent.com/16687990/30525282-3a0f2860-9c21-11e7-93ba-7abfe47afc5b.png)

@zulipbot label ""area: notifications"" ""area: emoji"" ""bug""",HarshitOnGitHub,b'area: emoji area: notifications (other) bug',2017-09-17T21:58:33Z,2017-09-20T17:34:24Z
6578,sign_up: Strip the whitespaces before and after the email address.,"If I copy and paste an email address from somewhere and that email address happens to contain some trailing or leading whitespace then an error is shown stating that it is an invalid email address which may be confusing. We should strip off the trailing or leading whitespaces before checking for the validity of an email address. Same thing happens on sign in page.
![image](https://user-images.githubusercontent.com/16687990/30525226-4f9a1c36-9c20-11e7-876a-608d52d58228.png)

To my utter surprise this is working fine for me on google chrome but not on mozilla firefox.",HarshitOnGitHub,b'area: authentication area: portico bug',2017-09-17T21:51:05Z,2017-09-28T18:56:44Z
6575,hotspots: Narrow links don't work if user hasn't completed tutorial.,"If a new user tries to open a narrow link while he is doing the tutorial, it redirects them to the `is:private` narrow.

More discussion here: https://chat.zulip.org/#narrow/stream/issues/topic/narrow

The problem seems to be with this piece of code in `tutorial.js`

```js
exports.initialize = function () {
    if (page_params.needs_tutorial) {
        set_tutorial_status(""started"");
        narrow.by('is', 'private', {select_first_unread: true, trigger: 'sidebar'});
    }
};
```",sampritipanda,b'area: misc bug',2017-09-17T20:23:45Z,2017-09-22T12:02:46Z
6566,UI to change email is broken: can't click into text box in modal,"This is a pretty bad regression.

See https://chat.zulip.org/#narrow/stream/issues/subject/not.20able.20to.20change.20email.20address/near/282919",timabbott,b'area: settings UI bug priority: blocker',2017-09-16T09:29:04Z,2017-09-16T10:48:55Z
6520,Exception with NULL characters in emails going into the email mirror,"I got this exception in the email mirror code path in production:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/worker/queue_processors.py"", line 120, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/worker/queue_processors.py"", line 412, in consume
    rcpt_to=event[""rcpt_to""], pre_checked=True)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/email_mirror.py"", line 349, in process_message
    process_stream_message(to, subject, message, debug_info)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/email_mirror.py"", line 315, in process_stream_message
    send_zulip(settings.EMAIL_GATEWAY_BOT, stream, subject, body)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/email_mirror.py"", line 200, in send_zulip
    content[:2000])
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/actions.py"", line 1502, in internal_send_message
    do_send_messages([msg])
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/actions.py"", line 798, in do_send_messages
    Message.objects.bulk_create([message['message'] for message in messages])
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 443, in bulk_create
    ids = self._batched_insert(objs_without_pk, fields, batch_size)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 1093, in _batched_insert
    inserted_id = self._insert(item, fields=fields, using=self.db, return_id=True)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 1076, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 1107, in execute_sql
    cursor.execute(sql, params)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/db.py"", line 32, in execute
    return wrapper_execute(self, super(TimeTrackingCursor, self).execute, query, vars)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/db.py"", line 19, in wrapper_execute
    return action(sql, params)
ValueError: A string literal cannot contain NUL (0x00) characters.
```

I don't think the email mirror has a clear maintainer, so probably someone will just need to dig into the code to investigate this.  It's fairly likely that the correct fix probably involves discarding the NULL characters from the email.

For someone working on this, I'd first write a (failing) test that includes an email with a NULL character in it (might need to do some more general email mirror testing work (improving coverage, etc.) if `test_email_mirror.py` doesn't have something similar), and then we can do the fix.  The hard part will be getting the test to trigger.  ",timabbott,b'area: notifications (other) bug help wanted',2017-09-14T15:14:34Z,2017-10-12T17:49:48Z
6519,Errors when deleting uploads are not displayed to the user,"If you modify the `delete_message_image` function to throw an exception (or otherwise throw an error, I imagine), there's no user-facing feedback about the error when a use tries to delete a file in the web UI (in settings -> Your uploaded files), which is confusing.  We should be able to fix this using our standard `ui_report.error` system.",timabbott,b'area: settings (user) area: settings UI bug help wanted',2017-09-14T15:03:28Z,2017-09-28T00:55:25Z
6518,Add some sort of reasonable retry support for missed_message queued emailed,"For missed-message emails, we now somewhat regularly get exceptions like this in production:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/worker/queue_processors.py"", line 120, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/worker/queue_processors.py"", line 253, in consume
    send_email_from_dict(data)
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/send_email.py"", line 79, in send_email_from_dict
    send_email(**dict(email_dict))
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zerver/lib/send_email.py"", line 74, in send_email
    if mail.send() == 0:
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/core/mail/message.py"", line 348, in send
    return self.get_connection(fail_silently).send_messages([self])
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/core/mail/backends/smtp.py"", line 104, in send_messages
    new_conn_created = self.open()
  File ""/home/zulip/deployments/2017-08-30-16-41-05/zulip-py3-venv/lib/python3.5/site-packages/django/core/mail/backends/smtp.py"", line 64, in open
    self.connection = self.connection_class(self.host, self.port, **connection_params)
  File ""/usr/lib/python3.5/smtplib.py"", line 251, in __init__
    (code, msg) = self.connect(host, port)
  File ""/usr/lib/python3.5/smtplib.py"", line 337, in connect
    (code, msg) = self.getreply()
  File ""/usr/lib/python3.5/smtplib.py"", line 393, in getreply
    raise SMTPServerDisconnected(""Connection unexpectedly closed"")
smtplib.SMTPServerDisconnected: Connection unexpectedly closed
```

(Another version is:
```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zerver/worker/queue_processors.py"", line 120, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zerver/worker/queue_processors.py"", line 253, in consume
    send_email_from_dict(data)
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zerver/lib/send_email.py"", line 79, in send_email_from_dict
    send_email(**dict(email_dict))
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zerver/lib/send_email.py"", line 74, in send_email
    if mail.send() == 0:
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zulip-py3-venv/lib/python3.4/site-packages/django/core/mail/message.py"", line 348, in send
    return self.get_connection(fail_silently).send_messages([self])
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zulip-py3-venv/lib/python3.4/site-packages/django/core/mail/backends/smtp.py"", line 104, in send_messages
    new_conn_created = self.open()
  File ""/home/zulip/deployments/2017-09-12-09-35-56/zulip-py3-venv/lib/python3.4/site-packages/django/core/mail/backends/smtp.py"", line 64, in open
    self.connection = self.connection_class(self.host, self.port, **connection_params)
  File ""/usr/lib/python3.4/smtplib.py"", line 242, in __init__
    (code, msg) = self.connect(host, port)
  File ""/usr/lib/python3.4/smtplib.py"", line 321, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File ""/usr/lib/python3.4/smtplib.py"", line 292, in _get_socket
    self.source_address)
  File ""/usr/lib/python3.4/socket.py"", line 494, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File ""/usr/lib/python3.4/socket.py"", line 533, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known
```
)

I think we want catch these two classes of exceptions in the queue worker email code paths, and just re-enqueue the event to be handled later once things are working again (maybe with some limited retry count like 3 per item), and only throw an exception if it fails every time.  That should make things reliable.

The main one is going to be the `missed_message` worker, but ideally we'd be able to just have a decorator function that we can wrap all the email sending worker `consume` functions with that just takes care of this: Checking the retry account, calling the wrapped function inside a `try/except`, and if it throws specific exceptions that are usually network problems, retry.

@umairwaheed would you be up for taking a pass at this one?      

",timabbott,b'area: notifications (other) bug',2017-09-14T14:48:34Z,2017-10-03T17:39:02Z
6516,Buggy upgrade process from 1.4.x to 1.6.x and above,"Migration 0032_verify_all_medium_avatar_images.py uses code from `zerver.lib.upload`, which was changed between 1.5 and 1.6 to make different assumptions about the paths avatars are in (there's a later migration that takes care of this, 0060_move_avatars_to_be_uid_based.py; the change was to add the realm_id as a directory in the paths, and also to hash on user ID, not email).  

What we need to do to fix this is replace the `zerver.lib.upload` import with a copy or monkey-patched version or something of the code of that code from Zulip 1.4.3, so that one can safely upgrade a server with at least one avatar uploaded from 1.4.3 to master.  Should be easy to test in a development environment.  The exception is this:

```
  Applying zerver.0029_realm_subdomain... OK
  Applying zerver.0030_realm_org_type... OK
  Applying zerver.0031_remove_system_avatar_source... OK
  Applying zerver.0032_verify_all_medium_avatar_images...Traceback (most recent call last):
  File ""./manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 367, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 359, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 294, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 345, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/core/management/commands/migrate.py"", line 204, in handle
    fake_initial=fake_initial,
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/db/migrations/executor.py"", line 115, in migrate
    state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/db/migrations/executor.py"", line 145, in _migrate_all_forwards
    state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/db/migrations/executor.py"", line 244, in apply_migration
    state = migration.apply(state, schema_editor)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/db/migrations/migration.py"", line 129, in apply
    operation.database_forwards(self.app_label, schema_editor, old_state, project_state)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zulip-venv/lib/python2.7/site-packages/django/db/migrations/operations/special.py"", line 189, in database_forwards
    self.code(from_state.apps, schema_editor)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zerver/migrations/0032_verify_all_medium_avatar_images.py"", line 15, in verify_medium_avatar_image
    upload_backend.ensure_medium_avatar_image(user_profile)
  File ""/home/zulip/deployments/2017-09-14-10-42-45/zerver/lib/upload.py"", line 523, in ensure_medium_avatar_image
    image_data = open(image_path, ""rb"").read()
IOError: [Errno 2] No such file or directory: u'/home/zulip/uploads/avatars/2/abcd1234abcd1234abcd1234abcd1234abcd1234.original'
```

@adnrs96 do you have time for this one?  ",timabbott,b'area: uploads bug priority: blocker',2017-09-14T13:55:13Z,2017-09-16T10:31:10Z
6515,"search typeahead: Doesn't handle spaces in people's names when typing ""sender:tim abbott ""","If you try to do e.g. ""sender:tim abbott"", it treats the two parts of the person's name as separate tokens, and thus offers things like ""sent by tim, pm with Tim Abbott"":
![image](https://user-images.githubusercontent.com/2746074/30432438-8f2dfbf4-9916-11e7-9114-8cae29bf0f75.png)


This seems like something our typeahead could figure out.  

@cory2067 this might be quick for you :)",timabbott,b'area: search bug priority: high',2017-09-14T13:33:25Z,2018-05-25T16:11:59Z
6493,"Message displays weird behaviour when using /me, newline, and quote mark after editing","When I send a message and edit it with text that contains `/me`, `newline`, and quote mark, the message displays weird behaviour.

See https://chat.zulip.org/#narrow/stream/issues/topic/end.20of.20message.20feed for further information.

![meedit](https://user-images.githubusercontent.com/20320125/30358231-77b9ad3c-986d-11e7-99f0-cbeecb659557.gif)

How to reproduce:
1. Create a message, the content is up to you. For example:
```
up to you
```
2. Send the message.
3. Edit the message, now change the content into something that contains `/me`, `newline`, and quotemark. For example:
![screenshot_20170913_101940](https://user-images.githubusercontent.com/20320125/30358173-15c97c4c-986d-11e7-8ba5-61ed40f1d5ad.png)
4. Save the message

Then you will see the message displays weird behaviour, like this:
![screenshot_20170913_132552](https://user-images.githubusercontent.com/20320125/30362633-232c0188-9887-11e7-88de-ffcea7928727.png)

This weird behaviour becomes normal when the user reloads the page.

Expected behaviour:
The message shouldn't display as `/me` message, it should be displayed as a normal message.",refeed,b'bug help wanted',2017-09-13T06:39:20Z,2018-01-23T14:29:43Z
6488,bugdown: Allow spaces between $$ for tex.,"Currently $$x = 5$$ works, but $$ x = 5 $$ doesn't, for getting tex formatting. We should fix the latter to work as well. 

Some discussion at https://chat.zulip.org/#narrow/stream/issues/topic/latex.20spaces.",rishig,b'area: LaTeX area: markdown good first issue help wanted',2017-09-13T00:19:48Z,2020-04-01T22:04:46Z
6473,message-view: Compose box closes when clicking on topic narrow.,"To reproduce:
* Go to some stream
* `r` to open a compose box, with the stream name populated
* Click on either a stream or topic narrow in the stream that you're composing to, either in the left-sidebar, or recipient bar

Expected behavior is compose stays open, current behavior is close composes.

For an example of the expected behavior, repeat the above, but click on a stream or topic narrow in any other stream.",rishig,b'area: message view bug good first issue help wanted priority: blocker',2017-09-11T23:48:32Z,2018-04-05T22:25:34Z
6426,Unnecessary close button persists when clicking back on Home.,"When one manually clicks on any of the options other than **Home**, say, **Private messages** and then again clicks on the **Home** option, the close button next to the search button still persists, even though its unnecessary, since it performs nothing useful.",invinciblycool,b'area: general UI area: search bug',2017-09-07T18:36:34Z,2017-09-08T18:13:08Z
6412,compose: Messages suddenly disappear mid-edit when another message is sent during editing,"When someone is editing a previous message and another user (or self) sends another message to the same stream/topic/PM, the edited message content and compose box completely disappear altogether.

[![https://gyazo.com/47c2865170e997d58444e93d8332c728](https://i.gyazo.com/47c2865170e997d58444e93d8332c728.gif)](https://gyazo.com/47c2865170e997d58444e93d8332c728)

Similar behavior occurs when one is editing a message and selects a draft to compose.",synicalsyntax,b'area: compose area: message-editing bug priority: blocker',2017-09-06T01:46:36Z,2017-09-11T16:27:13Z
6391,admin/org settings: under default streams-> cannot scroll streams,"In organization Settings-> ""Default streams"", the list of streams are not scrollable and admin is forced is to use the scrollbar to access other streams. Also, it seems that instead of getting the list scrolled, its parent gets scrolled. 
![peek 2017-09-03 21-57](https://user-images.githubusercontent.com/22238472/30006123-fb981c30-910e-11e7-89dd-62c18455f311.gif)

This issue is somewhere similar to #6351.",shubhamdhama,b'area: settings UI bug priority: blocker',2017-09-03T19:50:23Z,2017-09-27T05:56:28Z
6366,@ mention autocomplete are rendered at top instead of near input box in Safari iOS,At least they didn't in our corporate zulip in my iPhone. If this isn't easily reproducible I can get more details,mcmanuss8,b'area: compose area: general UI bug',2017-08-31T21:53:09Z,2017-10-05T00:43:33Z
6362,Message disappears on undoing instead of a emoji. ,"When undoing(using Ctrl+Z) while typing a message followed by an emoji (just in case the user wants to change the emoji) , the phrase is removed on hitting Ctrl+Z instead of the emoji itself.",invinciblycool,b'area: compose bug',2017-08-31T18:46:06Z,2017-12-10T12:12:58Z
6361,Fix the half visible text in the textbox just below the color picker in stream settings popup.,"This issue seems to be specific to firefox, displaying fine for me on google chrome.
![image](https://user-images.githubusercontent.com/16687990/29939034-34ae6cd6-8ea8-11e7-872c-c961c7cd1a20.png)
",HarshitOnGitHub,b'bug priority: blocker',2017-08-31T18:28:05Z,2017-09-26T18:51:55Z
6351,admin/org settings: Cannot scroll through Notifications stream dropdown menu to select options.,"Clicking on the **Notifications stream** option on the **Organizations settings** page produces a dropdown menu allowing organization administrators to change the default notifications stream for the organization.

![screenshot at aug 30 10-03-27](https://user-images.githubusercontent.com/15116870/29885133-7f592b2a-8d6a-11e7-8653-79ba415e06d8.png)

However, if there are more than 8 streams that an admin can select, the other options are cut off from the dropdown menu, and the admin needs to rely on the Filter streams input to find the appropriate stream that was cut off. This behavior potentially misleads admins into thinking that the streams that aren't included at the top of the menu aren't possible candidates for notifcations stream.

To resolve this issue, I propose that the dropdown menu either be implemented as a `<select>` like input or use a scrollbar to scroll through all options.

(This was discovered while I was documenting the **Notifications stream** option, and the behavior left me highly confused, and I suspect that new admins would also encounter the same issue as well)",synicalsyntax,b'area: settings (admin/org) area: settings UI bug feedback wanted priority: blocker',2017-08-30T17:05:09Z,2017-09-28T01:47:12Z
6332,ujson causes UnicodeEncodeError in email mirror,"We've gotten a few exceptions like this recently on zulipchat.com:
```
  File ""./zerver/views/email_mirror.py"", line 22, in email_mirror_message
    result = mirror_email_message(ujson.loads(request.POST['data']))
  File ""./zerver/lib/email_mirror.py"", line 382, in mirror_email_message
    lambda x: None
  File ""./zerver/lib/queue.py"", line 306, in queue_json_publish
    get_queue_client().json_publish(queue_name, event)
  File ""./zerver/lib/queue.py"", line 115, in json_publish
    self.publish(queue_name, ujson.dumps(body))
UnicodeEncodeError: 'utf-8' codec can't encode character '\udcef' in position 6226: surrogates not allowed
```

The request data in this example looks like
```
- POST: {'secret': ['**********'], 'data': ['{""msg_text"": ""Received: from [...]\\udcef\\udcbf\\udcbd[...]"", ""recipient"": ""***""}']}
```

The core of the issue appears to be that `ujson` will decode a JSON document that looks like this, but will then fail if you ask it to encode the result:
```
In [39]: ujson.loads('""\\udcef\\udcbf\\udcbd""')
Out[39]: '\udcef\udcbf\udcbd'

In [40]: ujson.dumps(ujson.loads('""\\udcef\\udcbf\\udcbd""'))
---------------------------------------------------------------------------
UnicodeEncodeError                        Traceback (most recent call last)
<ipython-input-40-6b0b01834cc7> in <module>()
----> 1 ujson.dumps(ujson.loads('""\\udcef\\udcbf\\udcbd""'))

UnicodeEncodeError: 'utf-8' codec can't encode character '\udcef' in position 0: surrogates not allowed
```
(The result of `loads` there is a string of three characters, each of which is not a real character but rather a surrogate value. The surrogates were originally carved out for use in UTF-16, to encode Unicode in 16-bit elements, but in Python they're now used for losslessly encoding mostly-UTF-8 bytestrings, like Unix filenames, in Python text strings. This particular sequence of three surrogates doesn't seem to fit either of those uses, so it's a mystery where it came from. If you take the low 8 bits from each of these surrogates as a sequence of bytes, you do get the UTF-8 encoding of [U+FFFD REPLACEMENT CHARACTER](http://unicode.org/cldr/utility/character.jsp?a=FFFD) -- so there are probably multiple layers of wrongness involved here.)

Compare `json` from the stdlib, which handles the round-trip with no trouble:
```
In [41]: json.dumps(ujson.loads('""\\udcef\\udcbf\\udcbd""'))
Out[41]: '""\\udcef\\udcbf\\udcbd""'
```

The ujson tracker has [had this issue open](https://github.com/esnme/ultrajson/issues/156) since 2014.

The number of segfaults, crashes, and memory corruption issues in the [ujson open issues](https://github.com/esnme/ultrajson/issues) suggest this may not be a super reliable or vigorously-maintained library. The benchmarks in its README are impressive, but if we can we may be better off using the stdlib's `json` (aka `simplejson`).
",gnprice,b'area: notifications (other) bug',2017-08-29T00:06:22Z,2017-08-29T23:19:34Z
6331,"Disabled checkboxes ""organization settings"" as a non-admin user are unreadable","See this for example:

![image](https://user-images.githubusercontent.com/2746074/29798235-abb74950-8c10-11e7-9039-e959600a8e02.png)

@brockwhittaker can you work on this?  Also, I think you were going to make our checkmark darker?",timabbott,b'bug help wanted priority: blocker',2017-08-28T23:49:04Z,2017-10-11T20:56:47Z
6321,Stream reset talking to APNs,"With the new APNs provider implementation that landed a couple of days ago, we're sometimes (~20% of the time) seeing this exception on zulipchat.com:

```
  File ""./zilencer/views.py"", line 106, in remote_server_notify_push
    send_apple_push_notification(user_id, apple_devices, apns_payload)
  File ""./zerver/decorator.py"", line 631, in wrapped_func
    ret = func(*args, **kwargs)
  File ""./zerver/lib/push_notifications.py"", line 81, in send_apple_push_notification
    result = client.get_notification_result(stream_id)
  File ""/home/zulip/deployments/2017-08-26-21-27-36/zulip-py3-venv/lib/python3.5/site-packages/apns2/client.py"", line 82, in get_notification_result
    with self._connection.get_response(stream_id) as response:
  File ""/home/zulip/deployments/2017-08-26-21-27-36/zulip-py3-venv/lib/python3.5/site-packages/hyper/http20/connection.py"", line 312, in get_response
    return HTTP20Response(stream.getheaders(), stream)
  File ""/home/zulip/deployments/2017-08-26-21-27-36/zulip-py3-venv/lib/python3.5/site-packages/hyper/http20/stream.py"", line 230, in getheaders
    self._recv_cb(stream_id=self.stream_id)
  File ""/home/zulip/deployments/2017-08-26-21-27-36/zulip-py3-venv/lib/python3.5/site-packages/hyper/http20/connection.py"", line 768, in _recv_cb
    self._get_stream(stream_id)
  File ""/home/zulip/deployments/2017-08-26-21-27-36/zulip-py3-venv/lib/python3.5/site-packages/hyper/http20/connection.py"", line 289, in _get_stream
    raise StreamResetError(""Stream forcefully closed"")
hyper.http20.exceptions.StreamResetError: Stream forcefully closed
```

I'm not 100% sure what this means, but it sounds like the APNs server is closing the connection. With this frequency, that probably means something we're doing wrong, either in our application code or in the `apns2` or `hyper` libraries underneath.

Our application code for this is super simple:
```
        stream_id = client.send_notification_async(
            device.token, payload, topic='org.zulip.Zulip',
            expiration=expiration)
        result = client.get_notification_result(stream_id)
```
so I think the issue is likely to be in one of the libraries.

On some study of these two libraries, I'm not excited about trying to debug the issue right now. The `hyper` library (which implements HTTP/2) is explicitly not mature -- the docs say it's ""very early alpha"", and more recently the author says it's past that but still [""I'm not sure that people will get much joy out of using it in production""](https://github.com/Lukasa/hyper/issues/288). I think I'll add a retry loop and call it a day -- that's apparently [worked for someone else](https://stackoverflow.com/questions/41211416/im-not-able-to-find-any-information-on-this-error-im-seeing-streamreseterror) with the same problem.

It would be neat to fix the bug, as either a service to the Python community (if it is in one of the libraries) or a little voyage of discovery (if not -- and even then, it can probably become a doc patch to one or both libraries, again a service to the Python community.)

Alternatively, the most robust and full-featured HTTP implementation for Python has long been `pycurl`, which is a thin layer over `libcurl` -- and [curl supports HTTP/2](https://curl.haxx.se/docs/http2.html). So for a really solid implementation of talking to APNs we may just end up using that. It'll be more code to write -- the major downside of pycurl is that it's a lower-level interface than alternatives -- so not right now.
",gnprice,b'area: notifications (other) area: production bug',2017-08-28T21:16:59Z,2017-10-04T00:34:51Z
6319,portico: zxcvbn checker doesn't update when password filled from keepass.,Possibly also the case with lastpass and other password managers.,rishig,b'area: onboarding area: portico bug good first issue help wanted priority: high',2017-08-28T19:34:20Z,2017-09-22T19:46:35Z
6315,integrations: Fix categories picker scrolling area going too far down,"![image](https://user-images.githubusercontent.com/2746074/29788320-ffbb6010-8be6-11e7-8051-065ab20c91bf.png)
",timabbott,b'area: integrations bug design',2017-08-28T18:50:22Z,2017-08-28T19:25:02Z
6295,streams: Fix confusing display of invite-only streams one isn't on for admins,"Right now, if you're an organization administrator, you get to see in the ""All streams"" view those invite-only streams you're not subscribed to.  

But you don't see the subscribers and you can't actually administer them, which can be really confusing and make you think that Zulip is totally broken.

While this is closer to the model we want than the pre-#6220 state (see #3786), since at least we handle stream deletion correctly now, I think this is still a somewhat critical problem we should fix for Zulip 1.7.

@rishig thoughts on how we want this to work?  ",timabbott,b'bug help wanted priority: blocker',2017-08-28T02:19:04Z,2019-03-31T06:36:41Z
6291,Make emoji picker pop as a modal in mobile screens,"Currently, we have a nice setup for hotspots, where we pop the modals to `viewport_center` (aka the center of the view) and they look nice on mobile screens.

I think that strategy would be a really good idea for the emoji picker as well, since then we don't need to deal with things ending up off-screen.  See #6277 for some backstory.

@HarshitOnGitHub let me know if you need any help understanding how the hotspots thing works.  

Also @jackrzhang FYI.",timabbott,b'area: emoji bug help wanted priority: blocker',2017-08-27T19:30:34Z,2017-09-26T21:30:42Z
6286,emoji_picker: Fix two different titles of an emoji in emoji picker.,"![anim](https://user-images.githubusercontent.com/16687990/29743557-9ae2516a-8ab2-11e7-81de-31845ed27d87.gif)

@zulipbot claim",HarshitOnGitHub,b'area: emoji bug',2017-08-26T17:33:02Z,2017-08-28T00:39:16Z
6273,"Debug flaky test failures with ""mentions"" data in unread_msgs data structure","See https://travis-ci.org/zulip/zulip/jobs/268203335 for an example.

@showell is probably best positioned to debug this.",timabbott,b'area: testing-infrastructure bug priority: high',2017-08-25T03:06:28Z,2017-10-12T04:36:53Z
6271,Weird scrollbar after filtering user settings to 0 items,"![image](https://user-images.githubusercontent.com/2746074/29695783-b146fd44-88f9-11e7-9033-eed8f7e5d56b.png)
",timabbott,b'area: settings UI bug',2017-08-25T01:26:29Z,2017-08-28T16:27:54Z
6241,@-mention pink background overlaps with the left border,"I think the title is comprehensive.

![image](https://user-images.githubusercontent.com/12458563/29633091-5e8b9776-885a-11e7-974b-71c71029b5a7.png)
",Shayan-To,b'area: message view bug design',2017-08-23T18:56:16Z,2017-08-25T06:38:36Z
6225,"500s if you deactivate your ""announcement"" stream","I got a report from a user who was having a hard time creating new users in Zulip because they had deactivated the announcement stream that would receive new-user-signup messages sent by `send_signup_message`.  The problem is that we don't check whether the stream has been deactivated; we just check that it isn't None.

We have the same problem in `add_subscriptions_backend`.",timabbott,b'bug help wanted priority: blocker',2017-08-23T05:27:25Z,2017-08-24T00:58:00Z
6224,Stop threading PM threads with multiple groups of users in a single email,"Occasionally, a missed_message email will have emails from multiple different PM senders with you as the recipient mixed together in a single email.  This is a confusing user experience that might make users worry about security issues.  

I think the bug is that `handle_missedmessage_emails` groups messages by `(recipient_id, topic)` pairs, but PMs directly to you actually all have your user ID as the `recipient_id`.  So I think we need to just make that grouping use e.g. the sender message ID as the second part of the tuple for PMs.

It'd also be great to add a test for this sort of situation if we can do so easily.",timabbott,b'bug help wanted priority: blocker',2017-08-23T04:51:11Z,2017-08-25T03:01:57Z
6221,Markdown syntax for creating links allows sending blank messages.,"Using markdown to create links in Zulip has a way to send blank messages that break the UI a bit.
Repro:
* Compose new message.
* Put `[](foobar)` in the message.
* Send the message.
Result:
Message is sent and looks bad in UI.
Expected:
We should be at least be performing some kind of conditional testing for having empty link titles. So that a link without something visible doesn't go it.",adnrs96,b'area: markdown bug help wanted',2017-08-22T22:59:35Z,2019-08-26T04:43:51Z
6219,"Escape characters (in green message) while toggling ""Email Digests"" in Notification settings","1. Go to [notification settings](https://chat.zulip.org/#settings/notifications).
2. Toggle the ""Email Digest"" setting (should be the last one).
3. Look at the green message and notice that there are escape characters.

![escape](https://chat.zulip.org/user_uploads/2/c2/bbbbmMcgDpZt0tTRgyvmAbiX/escapes.png)
",lonerz,b'area: settings (user) bug good first issue',2017-08-22T21:29:05Z,2017-08-23T07:24:25Z
6215,stream_settings: Unable to scroll stream membership list using mouse wheel.,"![anim](https://user-images.githubusercontent.com/16687990/29583083-8cb22944-879c-11e7-9a37-7869a223ad4b.gif)

On getting to the stream settings page, I am unable to scroll the stream membership list on stream settings page using mouse wheel. I definitely remember that I was able to do this some time earlier so this seems to be a recent regression to me.",HarshitOnGitHub,b'bug priority: blocker',2017-08-22T19:15:51Z,2017-08-28T16:52:15Z
6191,Error in connect bot to trello integration,"On https://myserver/integrations/#trello it is written:
```
Next, on your Zulip settings page, create a bot for Trello. Construct the URL for the Trello bot using the bot API key and stream name:

https://chat.critical.su/api/v1/external/trello?api_key=abcdefgh&stream=trello
```
I do as it is written, and get an error
```
msg | ""Malformed JSON""
-- | --
result | ""error""
```

Video - [zulip.zip](https://github.com/zulip/zulip/files/1236186/zulip.zip)
",fleytman,b'area: integrations bug',2017-08-19T09:18:23Z,2017-08-20T00:55:01Z
6177,/apps: Linux machines are redirected to /apps/mac,"To reproduce, go to chat.zulip.org/apps on a linux machine. It redirects to https://zulipchat.com/apps/mac. Tested with Chrome on Ubuntu and Chrome and Firefox on Debian.",rishig,b'area: portico bug good first issue help wanted',2017-08-18T05:05:17Z,2017-08-21T05:11:57Z
6153,Weird exception related to switch to Python 3,"I got this traceback today, which I hadn't seen before, from the UserActivity queue worker:

```
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zerver/worker/queue_processors.py"", line 120, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zerver/worker/queue_processors.py"", line 207, in consume
    do_update_user_activity(user_profile, client, query, log_time)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zerver/decorator.py"", line 623, in wrapped_func
    ret = func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zerver/lib/actions.py"", line 2483, in do_update_user_activity
    defaults={'last_visit': log_time, 'count': 0})
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/manager.py"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 464, in get_or_create
    return self.get(**lookup), False
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 374, in get
    num = len(clone)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 232, in __len__
    self._fetch_all()
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 1105, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py"", line 53, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 886, in execute_sql
    raise original_exception
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/sql/compiler.py"", line 876, in execute_sql
    cursor.execute(sql, params)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zulip-py3-venv/lib/python3.5/site-packages/django/db/backends/utils.py"", line 65, in execute
    return self.cursor.execute(sql, params)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zerver/lib/db.py"", line 32, in execute
    return wrapper_execute(self, super(TimeTrackingCursor, self).execute, query, vars)
  File ""/home/zulip/deployments/2017-08-16-14-17-59/zerver/lib/db.py"", line 19, in wrapper_execute
    return action(sql, params)
  File ""/usr/lib/python3.5/encodings/utf_8.py"", line 16, in decode
    return codecs.utf_8_decode(input, errors, True)
SystemError: <built-in function utf_8_decode> returned a result with an error set
```

@gnprice this is pretty clearly Python 3 related; can you investigate?",timabbott,b'area: dependencies area: production bug priority: blocker',2017-08-16T17:00:55Z,2017-08-17T00:58:47Z
6150,Narrowing to a group PM thread with no messages looks weird,"This is probably a recent regression, in that I've never seen it before, though I'm not 100% sure, because this isn't a type of narrow one looks at often.

![image](https://user-images.githubusercontent.com/2746074/29369539-b842faa6-8257-11e7-9de1-f82a401be74b.png)
",timabbott,b'bug help wanted priority: high',2017-08-16T14:52:09Z,2017-09-06T16:17:13Z
6142,@zulip is treated as a UserMention,"`@zulip` as a message is treated as a UserMention, which even capitalizes Zulip.",lonerz,b'area: markdown bug',2017-08-16T06:57:25Z,2017-08-16T18:21:14Z
6127,Outgoing webhooks shouldn't throw an exception on network errors,"I think we try to suppress these in `do_rest_call`, but the exception list is clearly not complete.

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zerver/lib/outgoing_webhook.py"", line 192, in do_rest_call
    response = requests.request(http_method, final_url, data=request_data, **request_kwargs)
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/requests/api.py"", line 58, in request
    return session.request(method=method, url=url, **kwargs)
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/requests/sessions.py"", line 502, in request
    resp = self.send(prep, **send_kwargs)
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/requests/sessions.py"", line 612, in send
    r = adapter.send(request, **kwargs)
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/requests/adapters.py"", line 504, in send
    raise ConnectionError(e, request=request)
ConnectionError: HTTPSConnectionPool(host='zulipbotserver.herokuapp.com', port=33507): Max retries exceeded with url: /bots/converter (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x7fc5ebd84490>: Failed to establish a new connection: [Errno 111] Connection refused',))
```

This is a fairly high-priority issue, since it will result in a lot of error email spam to administrators of servers using outgoing webhooks (at least if their users configure them wrong...).

A secondary issue we should think about after resolving the initial problem is how to send feedback to the user about the fact that their webhook isn't working.  I think it might make sense to have them get a PM from the bot or something notifying them.",timabbott,b'area: api area: bots bug priority: high',2017-08-15T15:49:09Z,2017-09-30T17:18:11Z
6118,Exception unpacking values in `messages_in_narrow_backend`,"I just got this exception on chat.zulip.org, which I don't think I've seen before:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 123, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2017-08-14-16-02-48/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 553, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 531, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 711, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 175, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/messages.py"", line 1194, in messages_in_narrow_backend
    (message_id, subject, rendered_content, content_matches, subject_matches) = row
ValueError: need more than 3 values to unpack
```

This happened with a user using the webapp on chat.zulip.org today, the bug is actually triggereable by normal use.

@showell FYI; reading the code, it's not obvious to me why we're expecting 5 items in each row in the first place.  Note that this is the code path for receiving a new message while narrowing to full-text search.",timabbott,b'area: api bug priority: high',2017-08-15T00:57:11Z,2017-08-23T16:56:19Z
6116,"Remove or fix broken ""simple"" realm in default test data","The ""simple"" realm (originally show in /devlogin as ""community users"") is created in an invalid in several ways; there's no organization administrator, no message history or streams, etc.  The end result is that trying to use it is basically always a bad experience.  

@showell @rishig should we remove it or fix?  I think it'd probably be better to fix it to create a new default-configuration empty realm if we can do that in a robust way...",timabbott,b'area: provision area: testing-infrastructure bug help wanted',2017-08-15T00:02:18Z,2017-11-16T06:47:29Z
6109,Scrollback in stream stops prematurely,"In multiple streams on chat.zulip.org, I observe the following behavior:
* Narrow to an old topic, scroll to the top.
* Switch to stream narrow, and scroll to the top.
* The top is nowhere near the actual beginning of the stream, but no further message loading happens, and the gray Zulip-logo ""this is the beginning"" marker sits inert and doesn't do its spinner animation.

First example: I was playing with the new, expanded ""more topics"", so I hit that widget on #**design** on chat.zulip.org . Went to the topic at the bottom of the list, scrolled to the top of that topic ([here](https://chat.zulip.org/#narrow/stream/design/subject/Night.20Mode/near/181210)), then hit `s` to zoom out to the stream. The top of that was only a little higher ([here](https://chat.zulip.org/#narrow/stream/design/near/1778180)), and sure didn't look like the start of the stream. But hitting page-up to scroll didn't do anything, and the little dark-gray Zulip logo marking the start wasn't spinning like anything was still loading -- it just sat there. Switching back to `S`, I could scroll up further. With maybe 5 more quick repetitions of `s`, scroll to top, `S`, scroll to top, repeat, I got to the [actual start](https://chat.zulip.org/#narrow/stream/design/subject/new.20stream/near/150417) of the stream.

Then I tried the same thing on #**issues**. Same thing happened -- alternating `S` with `s` and scrolling up made incremental progress, where the scrollback on `s` repeatedly ended more recently than the actual beginning of the stream.
",gnprice,b'bug priority: blocker',2017-08-14T18:56:53Z,2017-08-14T19:16:31Z
6090,"""more topics"" CSS / indentation looks wrong","This is really all one needs to see the issue:

![image](https://user-images.githubusercontent.com/2746074/29230273-1a319b4c-7e97-11e7-851c-b2915c49a77e.png)

@brockwhittaker can you deal?  @showell @rishig FYI. ",timabbott,b'area: left-sidebar bug',2017-08-11T20:16:04Z,2017-08-23T07:59:38Z
6070,"""Go back to login"" choice in GitHub login flow shows weird duplicate errors badly","Here's a screenshot of the issue:

![image](https://user-images.githubusercontent.com/2746074/29141495-5214aab2-7d03-11e7-8204-fdc62abdcba5.png)

To get here:
(1) You'll need to setup http://zulip.readthedocs.io/en/latest/settings.html#testing-google-github-authentication
(2) Set REALMS_HAVE_SUBDOMAINS and make the main ""zulip"" realm not require a ""zulip.com"" domain.
(3) Try to login with GitHub and click ""Go back to login""

@jackrzhang @vaidap I think you two have the right context for investigating this.  ",timabbott,b'area: authentication bug priority: high',2017-08-09T20:06:49Z,2017-08-28T14:11:30Z
6059,popovers sometimes go off the edges of the page,"Sometimes when I click on a user's name in a message block, the user popover extends off the bottom  of my screen like this: 
<img width=""761"" alt=""screenshot 2017-08-08 15 44 05"" src=""https://user-images.githubusercontent.com/5571464/29091413-e0993f4a-7c50-11e7-879c-4a61d294043a.png"">

There's only a narrow range of screen positions where this happens for me: roughly when the name is between 20% (below which the popover displays above the name) and 33% of the way up the screen (above which the popover displayed in this position is fine since there is enough space for it all to appear).
",jrowan,b'area: message view bug help wanted',2017-08-08T19:52:32Z,2019-02-15T00:59:27Z
6042,Capitalization when changing topics,"When editing a topic, if you just change capitalization it appears to revert to the old topic, even though the change was successful. If you narrow to another stream and then come back, it appears correctly (and the change also happens immediately in the list of streams on the left).",roed314,b'area: message-editing area: topics bug',2017-08-06T18:05:28Z,2017-08-16T23:10:34Z
6038,/help/ responsive view hides the menu too well so that it is not discoverable,"When chatting with some users the other day, I experienced a user being super confused about where the /help/ actual content was in a reasonably wide but not large window (e.g. 700px wide).  

I think we should either make the hamburger menu more visible (e.g. making it have a label like ""menu"") or otherwise make this more discoverable.  

@brockwhittaker any ideas?",timabbott,b'area: documentation (user) bug help wanted priority: blocker',2017-08-06T00:38:12Z,2017-08-24T20:42:00Z
6035,Error changing an email back to an email address you just stopped using,"This is almost certainly a caching regression.  Just change your email address, and then change it back, and you'll get this error.

![image](https://user-images.githubusercontent.com/2746074/28997434-9e3cff4e-79c9-11e7-9d17-b2b9bf98b602.png)
",timabbott,b'area: settings (user) bug good first issue',2017-08-05T17:34:44Z,2017-08-05T17:51:16Z
6003,bugdown: Whitespace gets eaten in messages.,"To reproduce, send the message:
a       [lots of spaces]         b

It'll show up as ""a b"". 
",rishig,b'area: markdown bug good first issue help wanted',2017-08-02T02:19:27Z,2017-08-02T02:40:44Z
6002,"""Copy link to conversation"" doesn't work when reached from keyboard","If on a message I hit `i` to pull up the message actions menu, then `down` a bunch to get to the ""Copy link to conversation"" option, and `enter` to select it:
* I get the nice green ""Copied!"" message that tells me the link was copied, but
* nothing is actually copied. When I go paste from the clipboard elsewhere, I get whatever was previously there. (This is true of both the ctrl-v and the middle-click clipboards.)

On the other hand if I do the same thing with the mouse, hitting the down-caret to open the menu and then the ""Copy link to conversation"" option, it works fine. (It goes into both clipboards, in fact.)

I'm pretty sure this used to work, so it seems to be a regression.
",gnprice,b'area: keyboard UI area: message view bug',2017-08-01T21:42:15Z,2017-08-23T19:30:49Z
5981,Figure out how to handle caching in `var/` around Vagrant rebuilds,"We now have a bunch of super useful caching tooling as part of `provision`.  Most of it generates things under places like `/srv/zulip-venv-cache`, which is nice, in that if you use the same Zulip checkout for multiple Vagrant guests (or for Vagrant + the root machine), everything works fine, since those paths aren't shared.

However, we've recently added a few stamp files that live under `var/`:
* provision_version
* postgres_init_test_db_hash
* populate_db_hash
* migration_status_test
* migration_status_dev
* available-migrations
* apt_dependenices_hash

Unfortunately, none of these files gets cleared if you destroy and recreate your Vagrant guest.  

A few notes:
* I don't see a way in Vagrant to run code whenever we destroy a guest.
* We want `var/` to be shared with the host for convenient access to log files, etc.  This probably excludes solutions like making `var/` a symlink in a Vagrant guest.

1) Having a model in Vagrant where the bundle of stamp files gets moved to live somewhere under `srv/` alongside the caches.
2) Adding a file under `/srv/` containing a string like `ZULIP_DEV_UUID=UUID`, and then basically have all these files live in paths of the form `var/%(zulip_dev_uuid)/populate_db_hash`.  

I think approach (2) feels pretty reasonable; we'll want to add a common function somewhere in `tools/lib/` that our various tools can interact with to get the correct `zulip_dev_uuid` subdirectory.
",timabbott,b'area: provision bug help wanted priority: high',2017-07-31T22:33:02Z,2017-10-18T04:20:20Z
5974,tooling: Editing help and other markdown files requires reload in dev environment.,"To reproduce:
* kill and restart the server
* Go to localhost:9991/for/open-source
* Change some text in templates/zerver/for/open-source.md
* Reload localhost:9991/for/open-source
* See the changes reflected
* Repeat steps 3-5 a few times. After a few iterations, I stop seeing the changes reflected.

Further discussion at 
https://chat.zulip.org/#narrow/stream/development.20help/topic/edit.20.2Emd.20without.20reload",rishig,b'area: tooling bug good first issue help wanted',2017-07-31T02:18:43Z,2017-07-31T21:56:12Z
5973,Twitter profile pic overlaps with surrounding border for embedded tweets,"If a tweet is short in length, the surrounding border around the tweet is partially covered by the profile pic of the tweet author.

![screen shot 2017-07-30 at 5 58 24 pm](https://user-images.githubusercontent.com/12992571/28759381-56c02028-7551-11e7-9c45-d52cb451c7a0.png)
",lonerz,b'area: integrations bug good first issue help wanted',2017-07-31T01:03:25Z,2017-08-29T03:36:48Z
5971,build-release-tarball has two copies of all assets,This makes the tarball much larger than needed. Also in practice one version of the assets is unversioned so when release code depends on those files it tends to break running code.,pweaver,b'area: production installer bug help wanted',2017-07-30T18:08:02Z,2018-07-24T16:53:29Z
5951,Restoring message draft doesn't update rendered preview,"Steps to reproduce:

1. Start writing a message.
2. Switch the editor to preview mode.
3. Click ""Drafts"" and select a different draft to edit.  Notice that the destination field is updated but the message preview is not.
4. Switch back to write mode.  The draft is correctly restored.
5. Switch back to preview mode.  The preview is now correct.",bgilbert,b'GCI task area: compose bug good first issue help wanted',2017-07-28T07:48:35Z,2017-12-22T14:00:41Z
5936,Webpack bundle source maps aren't placed where ,"I got the below exception in the Zulip error reporting code path trying to access the source maps for `common.js` in production.  I bet the same issue applies to all of our other webpack files.

There appear to be source maps for the webpack bundles in `/home/zulip/prod-static/webpack-bundles/`:
```
 ls -l /home/zulip/prod-static/webpack-bundles/common-3420187abfa02bb6e4e5.*
-rw-r--r-- 1 zulip zulip 380534 Jul 27 06:25 /home/zulip/prod-static/webpack-bundles/common-3420187abfa02bb6e4e5.9e1f4b5b22ec.js
-rw-r--r-- 1 zulip zulip 380534 Jul 27 06:25 /home/zulip/prod-static/webpack-bundles/common-3420187abfa02bb6e4e5.js
-rw-r--r-- 1 zulip zulip 937893 Jul 27 06:25 /home/zulip/prod-static/webpack-bundles/common-3420187abfa02bb6e4e5.js.9fb5d1d49dcb.map
-rw-r--r-- 1 zulip zulip 937893 Jul 27 06:25 /home/zulip/prod-static/webpack-bundles/common-3420187abfa02bb6e4e5.js.map
```

But our code is looking in `~/deployments/current/prod-static/source-map`, which just has the source map files generated not using webpack:
```
$ ls -l /home/zulip/deployments/current/prod-static/source-map/
total 4076
-rw-r--r-- 1 zulip zulip 1550538 Jul 27 06:25 app.js.9f3b343261e5.map
-rw-r--r-- 1 zulip zulip 1550538 Jul 27 06:25 app.js.map
-rw-r--r-- 1 zulip zulip   64810 Jul 27 06:25 sockjs-0.3.4.min.js.82200f546335.map
-rw-r--r-- 1 zulip zulip   64810 Jul 27 06:25 sockjs-0.3.4.min.js.map
```

I suspect we just need to update this section of `tools/update-prod-static` to move the `webpack-bundles` pieces as well:
```
# Move the source maps out of the serve/ directory and into their                  
# proper place.                                                                    
subprocess.check_call(['rm', '-rf', 'prod-static/source-map'],                     
                      stdout=fp, stderr=fp)                                        
subprocess.check_call(['mkdir', '-p', 'prod-static'],  # Needed if PRODUCTION      
                      stdout=fp, stderr=fp)                                        
subprocess.check_call(['mv', os.path.join(settings.STATIC_ROOT, 'source-map'),     
                       'prod-static/source-map'],                                  
                      stdout=fp, stderr=fp)                                        
```

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-07-27-06-24-28/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/decorator.py"", line 118, in wrapper
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 162, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 544, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""./zerver/decorator.py"", line 531, in authenticate_log_and_execute_json
    return rate_limit()(view_func)(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 710, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 162, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/views/report.py"", line 93, in json_report_error
    stacktrace = js_source_map.annotate_stacktrace(stacktrace)
  File ""./zerver/lib/unminify.py"", line 38, in annotate_stacktrace
    index = self._index_for(minified_src)
  File ""./zerver/lib/unminify.py"", line 24, in _index_for
    with open(os.path.join(self._dir, minified_src + '.map')) as fp:
IOError: [Errno 2] No such file or directory: u'/home/zulip/deployments/2017-07-27-06-24-28/zproject/../prod-static/source-map/common.js.map'
```

@pweaver FYI, do you have a chance to investigate?
",timabbott,b'area: dependencies bug help wanted priority: blocker',2017-07-27T06:37:40Z,2017-08-15T22:32:43Z
5906,mentions: Home is still selected when you refresh mentions page,"1. Go to https://chat.zulip.org/#narrow/is/mentioned
2. Home will be selected in the upper left corner.",lonerz,b'area: general UI bug good first issue help wanted priority: blocker',2017-07-25T02:20:03Z,2017-08-16T19:55:46Z
5898,"""Apply to all of my subscriptions"" option for changing stream notification settings uses a loop","I just heard from a user who got rate-limited using this feature because they had more 100 subscriptions.  

To reproduce:
* Create + subscribe to more than 100 streams in development; I think there's a `manage.py populate_db` option that will do this for you.  Or skip this step and just watch  the 15 queries on the `run-dev.py` console that don't hit the rate limit; it's not really essential to fix it to see the ultimate failure mode.
* Go to notification settings, and toggle one of the stream settings.  It'll offer to change them all.  Accept.

To fix, we should just make this operation use a single bulk query to the server.

I think the code to modify is `_update_page` in `settings_notifications.js`, though we may need to tweak the backend to support the query we want.",timabbott,b'area: notifications (messages) area: stream settings bug help wanted',2017-07-24T20:49:20Z,2018-02-16T19:33:03Z
5887,clean-repo: Also delete `.pyc` files with same timestamp as the `.py` file,"I encountered a bug the other day which turned out to be fixed by deleting a certain `.pyc` file that had the same timestamp as the corresponding `.py` file but didn't actually match (caused, I think, by some rebase race).  

This is a follow-up issue introduced by #5768.   Tagging it as a priority since the issue took a bit for me to debug, so I imagine most folks would just get confused and demoralized...",timabbott,b'area: tooling bug priority: high',2017-07-21T20:33:43Z,2017-07-31T00:24:56Z
5886,Bug in text formatting,"When formatting text(italics, bold, etc),  if I click anywhere in the blue highlighted box, the typed message gets deleted. 
<img width=""939"" alt=""screen shot 2017-07-22 at 12 58 17 am"" src=""https://user-images.githubusercontent.com/18073126/28479187-f04db7d0-6e78-11e7-8571-ef1229d2701d.png"">

Shifted from electron repo : [https://github.com/zulip/zulip-electron/issues/232
](https://github.com/zulip/zulip-electron/issues/232)
@timabbott [](url)",fragm3,b'area: compose bug',2017-07-21T20:11:05Z,2017-07-22T19:06:33Z
5875,portico: broken link on hubot integration page,"(this is happening for me on both zulipchat.com/integrations/#hubot and chat.zulip.org/integrations/hubot)

At the bottom of `/integrations/#hubot`, there is a link reading ""Check out additional Zulip integrations available via Hubot"" and pointing to `/integrations/#hubot-integrations`, but the link just takes you back to the `/integrations` page.",jrowan,b'area: portico bug',2017-07-21T02:54:10Z,2017-08-10T17:24:54Z
5863,"linting: Linter trips on ""with"" tags in Jinja.","Currently the code below fails with the error:

```
templates | Traceback (most recent call last):
templates |   File ""tools/check-templates"", line 168, in <module>
templates |     check_our_files(args.modified, args.all_dups, args.targets)
templates |   File ""tools/check-templates"", line 36, in check_our_files
templates |     check_html_templates(by_lang['html'], args.all_dups)
templates |   File ""tools/check-templates"", line 115, in check_html_templates
templates |     validate(fn=fn, check_indent=(fn not in bad_files))
templates |   File ""/srv/zulip/tools/lib/template_parser.py"", line 270, in validate
templates |     state.matcher(token)
templates |   File ""/srv/zulip/tools/lib/template_parser.py"", line 247, in f
templates |     ''' % (fn, problem, start_token.s, start_line, start_col, end_tag, end_line, end_col))
templates | lib.template_parser.TemplateParserException:
templates |                     fn: templates/zerver/features.html
templates |                     Mismatched tag.
templates |                     start:
templates |                         {% block portico_content %}
templates |                         line 11, col 1
templates |                     end tag:
templates |                         with
templates |                         line 15, col 5
templates | 
```

This seems to be because the linter doesn't understand the ""with"" and ""endwith"" tag being used in the templates. Here's the following code to trigger it:

```html
{% block portico_content %}

    {% with className=""white"" %}
        {% include 'zerver/landing_nav.html' %}
    {% endwith %}

{% endblock %}
```",brockwhittaker,b'area: tooling bug help wanted',2017-07-19T17:51:27Z,2017-07-19T20:39:55Z
5824,dev: Server drops responses after Django reloads,https://chat.zulip.org/#narrow/stream/development.20help/subject/sockets.20in.20dev/near/251932,showell,b'area: testing-infrastructure bug',2017-07-17T18:32:02Z,2017-07-21T18:20:26Z
5798,/help/ homepage footer overlaps with content in mobile view,"This is pretty self-explanatory:

![image](https://user-images.githubusercontent.com/2746074/28199189-a3747d88-6818-11e7-80e9-ee0eda0e769d.png)
",timabbott,b'area: documentation (user) bug priority: blocker',2017-07-14T05:15:11Z,2017-07-17T18:40:10Z
5797,Allow clicking the <li> element of left sidebar links in /help/ page,"We should be able to click the `<li>` element that holds the link element in the left sidebar of [help page](https://chat.zulip.org/help/).

![screen shot 2017-07-13 at 9 07 52 pm](https://user-images.githubusercontent.com/12992571/28197977-668427d8-680f-11e7-8609-66f9b65cc92e.png)
",lonerz,b'area: documentation (user) bug good first issue help wanted',2017-07-14T04:09:07Z,2017-07-14T16:54:58Z
5794,topics: Trigger a narrow change if the message topic gets changed.,"If someone sends a message with some topic and a user narrows to that topic and later the topic of the message gets changed, the user still remains narrowed to the old topic and misses further replies to that message. We should trigger a narrow change if a user is narrowed to a topic which gets changed later. This is mostly useful in cases where the original sender of the message forgets to add a topic to the message and later edits the topic. Meanwhile if a user narrowed to it, he will loose further replies to that message until he figures out and changes the narrow. For example, consider the screenshot below:

![image](https://user-images.githubusercontent.com/16687990/28188389-a7e55b90-683f-11e7-8825-1094e2fe25ee.png)

Message in the example was sent initially without a topic and later the topic was changed to `tr apostrophe`, the topic of the message was updated successfully in UI but narrow was not changed and hence further replies to that message were not visible.",HarshitOnGitHub,b'area: topics bug',2017-07-13T21:28:59Z,2018-04-28T21:01:20Z
5769,bug: Fix custom emoji settings.,"When you say that only admins can edit emojis, it seems to lock out the admin as well.  The admin can change the setting so that anybody can do the modification, but then it doesn't live-update.

Another thing that's awkward is that the flag for flipping admin powers on custom emojis isn't on the custom emojis tab.  Instead, it's with all the other boolean settings.",showell,b'area: settings (admin/org) bug',2017-07-11T13:56:50Z,2017-07-13T21:09:25Z
5758,Improve exception handling sending push notifications,"I got the below exception recently, which looks like a classic transient network error.  I think we probably want to implement some sort of automatic re-enqueue-and-retry logic for this kind of network error.

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-06-19-15-53-49/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2017-06-19-15-53-49/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/rest.py"", line 123, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2017-06-19-15-53-49/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/decorator.py"", line 468, in _wrapped_func_arguments
    return rate_limit()(view_func)(request, profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 705, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 166, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zilencer/views.py"", line 106, in remote_server_notify_push
    badge=1, zulip=apns_payload)
  File ""./zerver/decorator.py"", line 639, in wrapped_func
    ret = func(*args, **kwargs)
  File ""./zerver/lib/push_notifications.py"", line 199, in send_apple_push_notification
    _do_push_to_apns_service(user_id, zulip_message, connection)
  File ""./zerver/lib/push_notifications.py"", line 168, in _do_push_to_apns_service
    apns_connection.gateway_server.send_notification_multiple(frame)
  File ""/home/zulip/deployments/2017-06-19-15-53-49/zulip-venv/lib/python2.7/site-packages/apns.py"", line 557, in send_notification_multiple
    return self.write(frame.get_frame())
  File ""/home/zulip/deployments/2017-06-19-15-53-49/zulip-venv/lib/python2.7/site-packages/apns.py"", line 263, in write
    length = self._connection().sendall(string)
  File ""/usr/lib/python2.7/ssl.py"", line 743, in sendall
    v = self.send(data[count:])
  File ""/usr/lib/python2.7/ssl.py"", line 709, in send
    v = self._sslobj.write(data)
error: [Errno 32] Broken pipe
```",timabbott,b'area: notifications (other) bug',2017-07-10T18:28:48Z,2017-08-26T21:15:52Z
5724,Log rotation settings in supervisor.d keeps too much data,"The zulip installation guide recommends a 10GB disk.
The puppet configuration for supervisor (/etc/supervisor/conf.d/zulip.conf) is set to rotate logs at 1GB and keep 10 copies of each log.
See https://github.com/zulip/zulip/blob/940cf9db3b42ed41ededa3d580370f5ef0214a51/puppet/zulip/templates/supervisor/zulip.conf.template.erb
This will eventually fill the disk with logs - my installation is a VM with a 40GB disk and hit a nagios low disk space alarm after a couple of years.

The settings should probably default to a much smaller value and be locally configurable so it's possible to keep lots of logs for a large scale deployment.

Also /etc/logrotate.d/zulip has the same 1GB / 10 copies setting",shane-kearns,b'area: production bug',2017-07-07T16:58:22Z,2017-07-07T20:13:06Z
5722,developer docs: strange context given for a search,"I searched the developer docs for the phrase ""email mirror,"" and I got the following result:

<img width=""960"" alt=""screenshot 2017-07-07 12 08 59"" src=""https://user-images.githubusercontent.com/5571464/27966827-a88fa414-630e-11e7-8255-916e50775313.png"">

Getting almost the entire page in the context for where the search term was found was a little weird/unhelpful.  I'm not sure what's causing this (I searched for other phrases found only in block code blocks and got reasonable contexts, and I can't see anything obviously weird about the `prod-troubleshooting.md` Markdown file).",jrowan,b'area: documentation (developer) bug',2017-07-07T16:23:10Z,2017-07-08T02:39:14Z
5712,Weird behaviour with mentioning users and a PR using #directive in a single message.,"I have been seeing this issue from sometime now. What happens is when you mention a user and a PR number in the same message (or maybe a two consecutive messages as well, remember happening), the name of the person mentioned repeats itself in a weird way in the entire message body. Attaching a gif to get the reader a taste of what's happening.

![output_dlflis](https://user-images.githubusercontent.com/17237412/27934789-0b34b28e-62c5-11e7-979b-89ca5f2747e9.gif)

Repro steps:

* Create a new message with body like 
```
#5435 foobarfoobarfoobarfoobarfoobarfoobarfoobarfoobarfoobarfoobarfoobar
@username
```
* Send the message and watch the issue as seen in gif.",adnrs96,b'area: markdown bug',2017-07-06T22:08:12Z,2017-07-18T07:12:26Z
5693,/for/open-source/ page CSS isn't quite right,"With a moderately wide screen, things get misaligned in the responsive CSS:

![image](https://user-images.githubusercontent.com/2746074/27887588-56c5e7e8-6196-11e7-8aaa-225081e2bbd0.png)

",timabbott,b'area: portico bug priority: high',2017-07-05T22:27:07Z,2017-07-24T17:45:52Z
5692,Realm emoji should use absolute URLs when referenced in missed-message emails,"If you PM someone with a realm emoji in the message, the URL it generates for the missed-message email is like this:
```
                <div class='message_content_block' style=""padding-left: 6px;font-weight: normal;"">
                    <p>yay <img alt="":dumpster_fire:"" height=""20px"" src=""/user_avatars/2/emoji/dumpster_fire.png"" title="":dumpster_fire:""></p>
```

Which of course is a broken link, because it's being included in your email, and that doesn't have the same server as your Zulip server.

We need to use absolute URLs here.

I feel like this might be a regression.  @HarshitOnGitHub can you look into this one?  ",timabbott,b'area: emails area: emoji bug help wanted priority: high',2017-07-05T22:16:29Z,2017-07-08T17:55:13Z
5629,Message edit history breaks with some large messages,"In particular, see this message: https://chat.zulip.org/#narrow/stream/issues/subject/quote.20autocomplete/near/236165

![image](https://user-images.githubusercontent.com/8433005/27721262-4218c9fe-5d2d-11e7-9260-b64a33e95739.png)

I'm not sure what exactly is causing this to happen. Played around with it for a while and have yet to reproduce it.",cory2067,b'area: message-editing bug',2017-06-30T04:46:14Z,2019-07-23T14:21:39Z
5623,streams settings: Don't show deactivated users in stream membership.,We don't deliver messages to deactivated users while they are deactivated. Also see https://chat.zulip.org/#narrow/stream/feedback/topic/deactivating.20users.,rishig,b'area: stream settings bug help wanted',2017-06-29T23:31:39Z,2018-04-09T00:09:17Z
5599,"Switching to a narrow clears ""Unable to connect"" warning box","While I was experiencing the ""Unable to connect"" issue described in #5598 (actually ""Fehler beim Verbinden"", since the issue was triggered by my having the UI set to German), I found that if I switched to a narrow, the warning box went away.

The underlying problem hadn't gone away -- I still didn't get the messages that had been sent since I was last connected -- and the box eventually came back.

@timabbott [suggested](https://chat.zulip.org/#narrow/stream/issues/subject/losing.20connection/near/238796):
> I think the fact that switching the narrow hides the warning is probably [...] caused by our having merged the ""can't connect to server"" warnings for `get_events` and `get_messages`; it's probably clearing the network error state when `get_messages` succeeds from switching the narrow, which is not correct, since the events feed is still not working.
",gnprice,b'area: message view area: real-time sync bug',2017-06-28T00:58:06Z,2018-11-29T20:35:16Z
5574,Hitting enter while in preview mode should not try to send empty messages.,"So currently if we try to preview an empty message, given we have `enter to send` option enabled, hitting enter will result front end code to try send the empty message. What we would like to have here is the same behaviour we have for `send` button which displays a `Nothing to send` message in such a case.

Reproducing steps:
* Try to compose a message.
* Enable `enter to send` option if not already enabled.
* Preview the message without adding any content to message compose box.
* Hit enter to send.

Result: 

UI tries to send message.

Expected:

Message warning person composing message that there is nothing to send.",adnrs96,b'area: compose bug priority: high',2017-06-26T19:05:32Z,2017-07-26T02:33:24Z
5554,"left sidebar: Clicking on topic scrolls to end in ""more topics"" view.","To reproduce:
Click ""more topics"" for some stream with many topics.
Click on any topic in the left sidebar.

The list of topics will scroll to the end.",rishig,b'area: left-sidebar bug good first issue help wanted',2017-06-24T17:25:10Z,2017-08-11T20:34:15Z
5552,Scrollbar overlaps stream menu buttons.,"![recording 6](https://user-images.githubusercontent.com/8433005/27506210-c287fee4-5881-11e7-8a2b-34019b307e2f.gif)
You can't see the cursor in this gif, but I'm trying to click that down chevron. Every time I go near it, the scrollbar expands out and covers the icon, so I cant click it. Basically, the only way for me to open the popover there is to perfectly aim for the left edge.",cory2067,b'area: left-sidebar bug',2017-06-24T06:07:42Z,2017-06-28T10:55:32Z
5545,i18next caching seems too eager,"I'm not sure of the scope of this in production -- hopefully it's not an issue there, but I haven't investigated. It was very confusing in dev and cost me probably half an hour of puzzlement today.

In development, if you edit `static/locale/LANG/translations.json` for your chosen `LANG`, it doesn't take effect. Reloading the tab doesn't do it; even shift-reloading, to force the browser to reload all resources, doesn't do it.

Looking in `static/js/translations.js`, which is where we invoke i18next and configure it, I find that if I disable caching there:
```
 var cacheOptions = {
-    enabled: true,
+    enabled: false,
     prefix: 'i18next:' + page_params.server_generation + ':',
     expirationTime: 2*7*24*60*60*1000,  // 2 weeks
 };
```
that resolves the issue. So apparently i18next is caching the `translations.json` -- a very reasonable and useful thing to do -- and here it is caching it much too hard, holding onto it even when the file has actually changed.

One possible clue is that `curl -I` on various static files in dev always returns the same value for the `Etag` header -- the SHA-1 hash of the empty string, it turns out -- but the `Last-Modified` header is correct. Perhaps i18next is relying on `Etag`, and maybe that's a thing you shouldn't do in 2017 (I have no idea.)

Or maybe its cache just totally ignores any metadata it could get from the server and it unconditionally caches for the given `expirationTime`. In that case, that'd be a problem in prod -- it'd be unfortunate for everyone using a non-English language we have good translations for to see every new string we add or edit in English for the first 2 weeks or so after their server gets the new code.
",gnprice,b'area: i18n bug help wanted',2017-06-23T21:08:24Z,2017-07-28T18:04:44Z
5538,New Users Require Invite Regardless of Configuration Settings,"Since the 1.6.0 upgrade, our users have been unable to register without being invited, despite the configuration being set to not require invitations.

Because we use an SSO (RemoteUser) process, registration doesn't really make sense in our environment.

CC: @gnprice ",hlieberman,b'area: authentication area: settings (admin/org) bug',2017-06-23T15:24:04Z,2018-04-28T17:37:35Z
5530,Aborting a commit makes lint hook throw errors,"If you have installed `setup-git-repo` to get the automatic linter, when you abort a commit (i.e. have an empty commit message so it aborts), an error is thrown. It's an index error, so gitlint is trying to look at the first word of the commit message when there is none (or something like that).",cory2067,b'area: testing-infrastructure bug good first issue',2017-06-23T06:32:05Z,2017-06-25T15:29:15Z
5522,zulipbot test,,lonerz,b'area: refactoring area: right-sidebar area: stream settings bug',2017-06-22T17:35:21Z,2017-06-22T17:57:54Z
5516,compose: Autocompleting emoji on new line adds extra space.,"To reproduce, type the following into a new message:
```
line1
:octo 
```
and then Enter. An extra space is inserted before the `:`. This doesn't happen if line1 isn't there, or if you autocomplete a stream, like `#gene`. ",rishig,b'area: compose bug good first issue help wanted',2017-06-22T06:40:19Z,2017-06-22T18:17:19Z
5515,message edit: Typeahead auto-complete sends cursor to end of message.,"To reproduce: Send a message like
```
line1 
line2
```

Edit the message, and use the emoji autocomplete or streams autocomplete to add an emoji to the first line (e.g. type "":octop"" + Enter, or ""#gene"" + Enter). The cursor will jump to the end of line2.

",rishig,b'area: message-editing bug good first issue help wanted',2017-06-22T06:33:50Z,2017-06-22T18:16:45Z
5487,The REST API allows creating bots with empty username,"# Description

Using the `/bots` endpoint in the REST API, it's possible to create a bot with an empty username, which results in it having `-bot@<domain>` as the email address.

# Steps to reproduce

1. Start the development server.
2. Get an API key for Iago, using the `/dev_fetch_api_key` endpoint:

        curl -X POST -F 'username=iago@zulip.com' \
            http://localhost:9991/api/v1/dev_fetch_api_key

3. Send an HTTP POST request to the `/bots` endpoint, using Basic auth (`iago@zulip.com:<api_key>`), and the following form-data content in the body:

       full_name: ""Foo""
       short_name: """"

    For instance, using cURL:

       curl -X POST -u 'iago@zulip.com:<api_key>' \
           -F 'full_name=Foo' -F 'short_name=' \
           http://localhost:9991/api/v1/bots

4. The server will reply with an HTTP 200 status code (success).
5. The result is a bot with an empty `short_name`, that looks like this in the bot settings UI:

    ![Bot with empty username](https://user-images.githubusercontent.com/7356565/27352532-59a34794-5601-11e7-8427-b35e4fddfc06.png)

Meanwhile, the server should reply with an HTTP 400 (bad request), and an error message indicating that the format is invalid:

    {""result"":""error"", ""msg"":""Bad name or username""}


---

@zulipbot label ""area: api"" ""bug""
",YagoGG,b'area: api bug',2017-06-20T19:56:23Z,2017-06-21T14:11:09Z
5468,bugdown: Remove shortname mention syntax.,"We used shortnames for mentioning users before we had autocomplete feature. Since we now have autocomplete typeahead, this syntax is no more useful and just causes problems so it is better to remove it.

Fixes: #4189.",HarshitOnGitHub,None,2017-06-19T17:47:51Z,2017-06-19T20:58:10Z
5440,Something is wrong with the default value for bot_type for bots,"I appear to have some bots with no valid bot type on chat.zulip.org.

![image](https://user-images.githubusercontent.com/2746074/27241160-7c0284c6-528c-11e7-8861-3863959014f5.png)

I checked in the DB, and indeed the `bot_type` is None.  Seems to be common among very old bots.  So I think we need a migrate to set the `bot_type` of anything with `is_bot=True` and a `None` `bot_type` to `1` (the only bot type that existed until recently).",timabbott,b'area: bots bug help wanted',2017-06-16T19:11:33Z,2017-06-20T15:34:42Z
5431,500 server error on LDAP login,"I'm not sure if this is related to server configuration, as I've not successfully gotten LDAP login to work yet. But `manage.py query_ldap` is fine, so I thought that should mean my Zulip configuration is correct. 

When I login using the user's email and pw, Zulip contacts the directory server but then I get an error page. If I provide an incorrect pw I get the expected message, so it appears to be authenticating. 

The server is Open Directory on OS X Server 10.11.4. It's not currently configured for SSL (cert issues.)

```
Jun 15 19:44:43 myserver kdc[5536]: AS-REQ diradmin@myserver.com from 127.0.0.1:57971 for krbtgt/myserver.com@myserver.com
Jun 15 19:44:43 myserver sandboxd[150] ([5536]): kdc(5536) deny file-read-data /private/etc/krb5.conf
Jun 15 19:44:43 myserver kdc[5536]: AS-REQ diradmin@myserver.com from 127.0.0.1:57971 for krbtgt/myserver.com@myserver.com
Jun 15 19:44:43 myserver kdc[5536]: Client sent patypes: REQ-ENC-PA-REP
Jun 15 19:44:43 myserver kdc[5536]: Need to use PA-ENC-TIMESTAMP/PA-PK-AS-REQ
Jun 15 19:44:43 myserver kdc[5536]: AS-REQ diradmin@myserver.com from 127.0.0.1:62639 for krbtgt/myserver.com@myserver.com
Jun 15 19:44:43 --- last message repeated 1 time ---
Jun 15 19:44:43 myserver kdc[5536]: Client sent patypes: ENC-TS, REQ-ENC-PA-REP
Jun 15 19:44:43 myserver kdc[5536]: ENC-TS pre-authentication succeeded -- diradmin@myserver.com
Jun 15 19:44:43 myserver kdc[5536]: DSUpdateLoginStatus: Unable to synchronize login time for diradmin: 77009 
Jun 15 19:44:43 myserver kdc[5536]: Client supported enctypes: aes256-cts-hmac-sha1-96, aes128-cts-hmac-sha1-96, des3-cbc-sha1, arcfour-hmac-md5, using aes256-cts-hmac-sha1-96/aes256-cts-hmac-sha1-96
Jun 15 19:44:43 myserver kdc[5536]: Requested flags: forwardable
Jun 15 19:44:43 myserver kdc[5536]: AS-REQ zulipuser@myserver.com from 127.0.0.1:57431 for krbtgt/myserver.com@myserver.com
Jun 15 19:44:43 --- last message repeated 1 time ---
Jun 15 19:44:43 myserver kdc[5536]: Client sent patypes: REQ-ENC-PA-REP
Jun 15 19:44:43 myserver kdc[5536]: Need to use PA-ENC-TIMESTAMP/PA-PK-AS-REQ
Jun 15 19:44:43 myserver kdc[5536]: AS-REQ zulipuser@myserver.com from 127.0.0.1:58873 for krbtgt/myserver.com@myserver.com
Jun 15 19:44:43 --- last message repeated 1 time ---
Jun 15 19:44:43 myserver kdc[5536]: Client sent patypes: ENC-TS, REQ-ENC-PA-REP
Jun 15 19:44:43 myserver kdc[5536]: ENC-TS pre-authentication succeeded -- zulipuser@myserver.com
Jun 15 19:44:44 myserver kdc[5536]: DSUpdateLoginStatus: Unable to synchronize login time for zulipuser: 77009 
Jun 15 19:44:44 myserver kdc[5536]: Client supported enctypes: aes256-cts-hmac-sha1-96, aes128-cts-hmac-sha1-96, des3-cbc-sha1, arcfour-hmac-md5, using aes256-cts-hmac-sha1-96/aes256-cts-hmac-sha1-96
Jun 15 19:44:44 myserver kdc[5536]: Requested flags: forwardable
```
```
zulip@minmi:~/deployments/current$ ./manage.py query_ldap zulipuser@mydomain.com
full_name: [u'zulipuser']
```

```
# URI of your LDAP server. If set, LDAP is used to prepopulate a user's name in                     
# Zulip. Example: ""ldaps://ldap.example.com""                                                        
AUTH_LDAP_SERVER_URI = ""ldap://mydomain.com""

# This DN will be used to bind to your server. If unset, anonymous                                  
# binds are performed.  If set, you need to specify the password as                                 
# 'auth_ldap_bind_password' in zulip-secrets.conf.                                                  
AUTH_LDAP_BIND_DN = ""uid=diradmin,cn=users,dc=mydomain,dc=com""

# Specify the search base and the property to filter on that corresponds to the                     
# username.                                                                                         
AUTH_LDAP_USER_SEARCH = LDAPSearch(""cn=users,dc=mydomain,dc=com"",
                                   ldap.SCOPE_SUBTREE, ""(uid=%(user)s)"")

# If the value of a user's ""uid"" (or similar) property is not their email                           
# address, specify the domain to append here.                                                       
LDAP_APPEND_DOMAIN = ""mydomain.com""
```
```
2017-06-16 02:56:29,703 ERROR    Internal Server Error: /accounts/login/
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py"", line 42, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 249, in _legacy_get_response
    response = self._get_response(request)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/views/auth.py"", line 445, in login_page
    extra_context=extra_context, **kwargs)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py"", line 47, in inner
    return func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/views/decorators/debug.py"", line 76, in sensitive_post_parameters_wrapper
    return view(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/views/decorators/cache.py"", line 57, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py"", line 81, in login
    if form.is_valid():
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/forms/forms.py"", line 169, in is_valid
    return self.is_bound and not self.errors
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/forms/forms.py"", line 161, in errors
    self.full_clean()
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/forms/forms.py"", line 371, in full_clean
    self._clean_form()
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/forms/forms.py"", line 398, in _clean_form
    cleaned_data = self.clean()
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/forms.py"", line 191, in clean
    self.user_cache = authenticate(username=username, password=password)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/__init__.py"", line 74, in authenticate
    user = backend.authenticate(**credentials)
  File ""./zproject/backends.py"", line 422, in authenticate
    user_profile = ZulipLDAPAuthBackendBase.authenticate(self, username, password)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py"", line 169, in authenticate
    user = ldap_user.authenticate(password)
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py"", line 344, in authenticate
    self._get_or_create_user()
  File ""/home/zulip/deployments/2017-06-05-14-27-45/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py"", line 553, in _get_or_create_user
    self._user, created = self.backend.get_or_create_user(username, self)
  File ""./zproject/backends.py"", line 444, in get_or_create_user
    if self._realm.deactivated:
AttributeError: 'NoneType' object has no attribute 'deactivated'
```
```
Request info:
- path: /accounts/login/
- POST: {u'username': [u'********************'], u'csrfmiddlewaretoken': [u'**********'], u'password': [u'**********'], u'button': [u'********************']}
- REMOTE_ADDR: ""[u'1.2.3.4']""
- QUERY_STRING: ""[u'next=']""
- SERVER_NAME: ""[u'']""
```",feorlen,b'area: authentication bug',2017-06-16T03:29:28Z,2017-06-23T03:41:37Z
5428,Keyboard cursor reappears while typing a message,"I'm not sure if anyone has solved this issue yet, but I found when I type message and move the cursor, it will reappear as a solid line.

<img width=""413"" alt=""screen shot 2017-06-15 at 10 57 38 pm"" src=""https://user-images.githubusercontent.com/10102961/27210173-88852ca8-521e-11e7-8669-67524a25b68d.png"">
",wilsonandusa,b'area: compose bug',2017-06-16T03:01:34Z,2017-07-08T02:27:39Z
5419,Stream search doesn't give up focus.,"To reproduce, click on the magnifying glass here:
![image](https://user-images.githubusercontent.com/890911/27200909-7a890208-51d0-11e7-8831-81350065e16b.png)

and then click out. Clicking on other buttons (New Topic, etc), or typing keyboard shortcuts won't work until you X out the streams search box. ",rishig,b'area: left-sidebar bug good first issue help wanted',2017-06-15T20:45:02Z,2017-06-15T20:49:18Z
5412,Some of codeblock typeahead doesn't work,"There are some codeblock typeaheads (from pygments) that doesn't work when I try it in Zulip, such as `c#`, I think `c#` breaks the codeblock syntax since there is an `#` in it. Btw, we could use `csharp` for alternative of `c#`.

~~--And why there's a `pycon` typeahead, I think it's not a programming language?~~
Edit: `pycon` is a abbreviation of `python console` so it's a normal behaviour

I think we could solve this by removing them (typeahead that doesn't work) from codeblock typeahead list (`tools/setup/lang.json`), and some places that generate those typeaheads..

![peek 2017-06-15 23-41](https://user-images.githubusercontent.com/20320125/27192362-4041332c-5225-11e7-8fd7-dd444d7acc6d.gif)

How to reproduce:

1. Type triple backticks (`) and type c.
2. Then there will appear some options, select c#
3. Type a code, and send the message",refeed,b'area: compose bug help wanted priority: high',2017-06-15T17:02:51Z,2017-06-19T10:53:27Z
5387,Weird error,"Hello:

I am implementing a new installation of Zulip in production and seem to have everything in place.  When I attempt to register the Admin user with the one-time link I get:

Error generated by Anonymous user (not logged in) on zulip.waypointcentre.ca deployment

Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-06-14-14-09-22/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py"", line 42, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2017-06-14-14-09-22/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 249, in _legacy_get_response
    response = self._get_response(request)
  File ""/home/zulip/deployments/2017-06-14-14-09-22/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2017-06-14-14-09-22/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/decorator.py"", line 118, in wrapper
    return func(request, *args, **kwargs)
  File ""./zerver/views/registration.py"", line 192, in accounts_register
    org_type = int(form.cleaned_data['realm_org_type'])
ValueError: invalid literal for int() with base 10: ''

I have searched the error here but haven't found anything.  Any help appreciated!

",WPTechnician,b'area: production installer bug help wanted',2017-06-14T20:00:59Z,2017-06-15T18:09:58Z
5384,bug: recent PMs > more conversations too long and without scroll bar,"when I click on 'more conversations' under `Private Messages` a huge list opens that extends beyond my screen. Stream disappear entirely. Only a click on `Home` rescues me from it. 

It should be a lot shorter and with a scroll bar. 

![more conversations, many more](https://user-images.githubusercontent.com/26190934/27138082-f8ab5278-511f-11e7-8d7d-3c902386d8ca.png)
",penCsharpener,b'area: left-sidebar bug design good first issue help wanted priority: high',2017-06-14T14:39:39Z,2019-02-18T22:23:17Z
5374,"Keyboard navigation doesn't work after using ""Copy link to conversation""","On chat.zulip.org right now, if I use the ""Copy link to conversation"" menu item on a message, I can't seem to do any keyboard navigation -- including `n`, `up`/`down`, or `enter`.
",gnprice,b'area: keyboard UI area: message view bug priority: high',2017-06-14T00:39:47Z,2017-06-20T18:27:17Z
5371,"""Unsubscribe"" page has partially occluded text","Unsubscribing from digest mails (`https://chat.zulip.org/accounts/unsubscribe/digest/1234…`) leads to a page where the text is partially occluded.  Note how in the first line, the upper parts of the letters are cut off, for example with `t`s and `d`s.

Setup:  Firefox 45.9.0 ESR (moderately outdated, I know, but I'm sure there are nonzero other users) on Debian.

---
![bildschirmfoto_2017-06-14_00-48-38](https://user-images.githubusercontent.com/2690845/27108124-d54c32fe-509b-11e7-85a0-6d83bdd4c005.png)",BenWiederhake,b'area: general UI bug good first issue',2017-06-13T22:57:12Z,2017-06-15T06:34:11Z
5368,Portico overlaps with content,"On pages with the login/register bar at the top (I think this is `zerver/portico.html`), it seems to cover content at the top of the screen if no extra spacing is added. Example:
![image](https://user-images.githubusercontent.com/8433005/27102276-9ee8ce64-5052-11e7-8974-78a114c48c09.png)
(from https://chat.zulip.org/terms/ )",cory2067,b'area: general UI bug good first issue help wanted priority: blocker',2017-06-13T20:16:28Z,2017-06-15T01:38:01Z
5326,Scrolling through messages works with lightbox open,"When the lightbox is open, the `up` and `down` arrow keys still move the message view. We probably want to disable that.",lonerz,b'area: keyboard UI bug good first issue',2017-06-10T02:45:53Z,2017-06-13T16:18:44Z
5317,bug: red background to @all mention gone after opened in link,"current behaviour:
* sent a longish instructional/announcy message with three screenshots to `@ everyone` on our server
* msg had it's red background
* I noticed a few typos and edited them
* later I wanted to point someone again to that msg
* so created a link to the msg and send it to that person
* I clicked the link to see whether it would open in electron or browser (opened in electron)
* after clicking the link I only saw the msg with white background as if it had no mention (not just in electron)
* everyone else also now sees the msg as white even if they had no link to  it 

it seems that if you open a msg that you are mentioned in via link it loses it's red background colour which is a shame because it should keep standing out. ",penCsharpener,b'area: message view bug',2017-06-09T14:46:48Z,2017-08-25T07:00:13Z
5312,[More...] tags are appearing on every message rendered in the background,"I've noticed as of Zulip 1.6.0 `[More...]`tags are appearing on every message that's beed loaded offscreen while Zulip was in the background.

**Steps to reproduce:**
1. open https://chat.zulip.org
2. scroll down to the bottom of `Home`
3. leave it running in a background tab for 10+ min and let new messages accumulate without interacting with the tab 
4. come back to zulip, and scroll down
5. all (almost all?) new messages that were loaded below the scroll point will have `[More...]` tags, despite being short messages

Clicking the `[Condense this message]` confirms that the expanded and condensed versions are same height & same content.

Confirmed in `Chrome >=v59` & `Electron` consistently for me, and `Firefox` occasionally for [Reid](https://chat.zulip.org/#narrow/stream/issues/subject/.5Bmore.5D.20tags.20on.20every.20message/near/219667).

**The Fix:**
This likely has to do with how zulip computes the height of messages by rendering them first, then getting the height off the rendered html element.
If you can find that code, just run a test using `setTimeout` to make sure it's reporting non-zero heights when rendering in the background in `Chrome` and `Firefox`.
If it does report 0px heights when background rendering, check to make sure it's using `getBoundingClientRect` and not `outerWidth`/`innerWidth`, which have issues with 0px reporting.

Related links:
- further speculation in the [zulip thread](https://chat.zulip.org/#narrow/stream/issues/topic/.5Bmore.5D.20tags.20on.20every.20message)
- semi-related ticket https://github.com/zulip/zulip/issues/3819 about the `library for estimating height of zulip messages without rendering`

<img src=""https://user-images.githubusercontent.com/511499/26963778-ee8fe88c-4cb3-11e7-8da1-ed2eaa669edd.PNG"" width=200/>
",pirate,b'area: message view bug',2017-06-09T06:37:33Z,2018-03-27T16:55:16Z
5310,Stream links in email bodies are relative,"I got a private message while I was away, which triggered an email to me with the message. The message contained a link to a stream (e.g. #frontend). I tried to click the stream link, but got confused when it just loaded my gmail inbox.

It looks like the link is relative:
```html
<a class=""stream"" data-stream-id=""6"" href=""/#narrow/stream/frontend"">#frontend</a>
```

Is there a place in the code that does some processing on the message body before sending an email? The domain could be inserted into all relative links like this before sending the email.",thallada,b'area: notifications (other) bug good first issue help wanted priority: blocker',2017-06-09T04:31:34Z,2017-07-16T20:56:36Z
5306,Return the correct missing line numbers when running node coverage,"Currently, the missing lines that are given in `coverage.json` are incorrect and they need to be pulled from a different section of the JSON file.",lonerz,b'area: testing-infrastructure bug good first issue',2017-06-09T03:49:55Z,2017-06-22T16:06:23Z
5301,Occasional DNS tracebacks bouncing push notifications,"I got this traceback on chat.zulip.org.  I find these pretty puzzling, because I don't understand why one would have DNS issues resolving https://push.zulipchat.com. 

We should at least figure out a way to make some sort of reasonable retry happen.

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/worker/queue_processors.py"", line 108, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/worker/queue_processors.py"", line 246, in consume
    handle_push_notification(data['user_profile_id'], data)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/decorator.py"", line 639, in wrapped_func
    ret = func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/lib/push_notifications.py"", line 366, in handle_push_notification
    gcm_payload)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/lib/push_notifications.py"", line 393, in send_notifications_to_bouncer
    send_json_to_push_bouncer('POST', 'notify', post_data)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/lib/push_notifications.py"", line 456, in send_json_to_push_bouncer
    extra_headers={""Content-type"": ""application/json""},
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zerver/lib/push_notifications.py"", line 476, in send_to_push_bouncer
    headers=headers)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zulip-venv/lib/python2.7/site-packages/requests/api.py"", line 58, in request
    return session.request(method=method, url=url, **kwargs)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zulip-venv/lib/python2.7/site-packages/requests/sessions.py"", line 518, in request
    resp = self.send(prep, **send_kwargs)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zulip-venv/lib/python2.7/site-packages/requests/sessions.py"", line 639, in send
    r = adapter.send(request, **kwargs)
  File ""/home/zulip/deployments/2017-06-07-13-25-05/zulip-venv/lib/python2.7/site-packages/requests/adapters.py"", line 502, in send
    raise ConnectionError(e, request=request)
ConnectionError: HTTPSConnectionPool(host='push.zulipchat.com', port=443): Max retries exceeded with url: /api/v1/remotes/push/notify (Caused by NewConnectionError('<requests.packages.urllib3.connection.VerifiedHTTPSConnection object at 0x7f0d641b8f50>: Failed to establish a new connection: [Errno -2] Name or service not known',))
```",timabbott,b'area: production bug help wanted priority: high',2017-06-08T21:59:10Z,2017-08-22T18:24:26Z
5277,A scrollbar appear in image list on image overlay when the images are too many,"A scrollbar appear in image list on image overlay when the images in it are too many. It shouldn't be happen, since we already have the chevron button there.

![screenshot_20170607_162214](https://user-images.githubusercontent.com/20320125/26871971-2ae25f56-4b9f-11e7-8d06-6158f6d9f762.png)

How to reproduce:
1. Upload many images in one topic
2. Then, click on an image in that topic to view the image overlay.",refeed,b'area: message view bug help wanted',2017-06-07T09:33:10Z,2017-06-15T10:42:55Z
5268,Add loading spinner when creating a new stream,"Since creating a new stream with 1000s of initial subscribers can be an expensive operation, we should add a loading spinner for it, so that the user isn't confused into thinking that nothing is happening.

For developing this, I'd just temporarily add a `sleep` to the relevant view code so that you can easily reproduce it taking a while.",timabbott,b'area: stream settings bug good first issue help wanted',2017-06-06T23:54:13Z,2017-11-07T20:30:48Z
5261,translations: Translated words identical in English mistaken as untranslated.,"`zerver/management/commands/compilemessages.py` counts untranslated words in a language by comparing a translated string with the English version, and increasing a counter if they match.

This causes problems when the translated word is identical to the English version, leading to languages mistakenly being displayed as `99% translated` (when only a couple of words are identical), even though they are fully translated.",roberthoenig,b'area: i18n bug help wanted',2017-06-06T20:09:42Z,2017-10-06T06:12:30Z
5260,Hamburger menu on mobile-web landing page can't be exited,"On either Chrome or Safari on my iPhone, when I tap the hamburger menu on the landing page I get this state:
<img height=320 src=""https://user-images.githubusercontent.com/28173/26846331-31201562-4aae-11e7-8ad1-8485f9c50b44.PNG"">
from which it seems to be impossible to exit back to reading the page. (I tried tapping and scrolling various ways and nothing worked.)

This feels pretty uncomfortable as a user. Other pages with similar menus (e.g. apple.com, slack.com) have an ""X"" icon somewhere to close the menu and return to the page. I like how apple.com does it -- the hamburger is in the upper-left, and when you tap it it just turns into the ""X"", while the menu comes out.
",gnprice,b'bug design good first issue help wanted',2017-06-06T18:50:06Z,2017-06-13T04:32:51Z
5259,"Hamburger menu on landing page gets ""selected"" when used, on Android Firefox","When browsing the landing home page in mobile Firefox, on Android, trying to use the hamburger menu can result in it confusingly being ""selected"" as if it's text. See screenshot:
<img height=640px src=""https://user-images.githubusercontent.com/28173/26845695-332ba076-4aac-11e7-8c17-07b0df7b2915.png"">

I can't seem to reproduce this in the mobile browsers I have handy: Chrome or Safari on iOS.

(Thanks @drakedevel for the report and screenshot!)
",gnprice,b'bug design good first issue help wanted priority: high',2017-06-06T18:43:43Z,2017-07-11T22:35:58Z
5238,"Narrow to PMs starts from global oldest-unread, not oldest unread PM","On chat.zulip.org, when I hit `P` to get the ""Private messages"" narrow, my cursor goes to a message that's a few days old, even though I have a couple of screenfuls of newer PMs and I've read all of them. (And when I've had unread PMs, I think it still went to that old message.) So that's a bug.

As it happens, that message is the first PM after the oldest stream message I haven't read. I'm guessing that is not a coincidence.
",gnprice,b'area: keyboard UI bug',2017-06-05T21:58:57Z,2017-06-05T22:23:36Z
5237,message list: Remove duplicate subscribe/unsubscribed stream bookends.,"When you're viewing messages, there's little ""bookends"" or sections that denote the status of your subscription to the messages of the corresponding stream. They look like:

![screenshot at jun 05 14-08-10](https://cloud.githubusercontent.com/assets/15116870/26803282/6f38ec0e-49f8-11e7-9b02-7c72bc59a46f.png)

However, as seen in the image above, the bookends are displayed for every subscribe/unsubscribe event instead of appearing only once at the bottom of the message list, which is the expected behavior.

Fixing this issue will likely involve updating the `update_trailing_bookend` function in `static/js/message_list.js` (lines 360-383)",synicalsyntax,b'area: message view bug good first issue help wanted',2017-06-05T21:10:18Z,2017-06-05T23:47:27Z
5232,"Typing ""S"" while editing a stream's description unsubscribes you and doesn't print ""S""","**Steps to reproduce:**
1. Go to ""Manage streams,"" select a stream, and click the edit icon next to the description.
2. Type an uppercase ""S"" (e.g., try to make the description ""Seems like a bug!"").

*Expected result:* The description you type shows up.
*Actual result:* You get unsubscribed from the stream and the ""S"" doesn't appear in the text area.

This is particularly annoying with invite-only streams, since there's no confirmation and you can't resubscribe yourself (it also makes the stream settings dialog confusing, since you no longer have permission to edit the settings in it).",nicholasbs,b'bug good first issue help wanted priority: blocker',2017-06-05T16:16:23Z,2017-06-05T20:54:26Z
5216,Settings menu breaks when not enough vertical space available.,"Reproduction:

1. Open a dev server tab.
2. Shrink this tab vertically.
3. Go to the settings menu,  which should look like this:
![image](https://cloud.githubusercontent.com/assets/7950151/26763823/6b1e5f1c-495a-11e7-833d-a20fe36c51b6.png)

4. Toggle the `Settings | Organization` bar.
5. Watch the layout break:
![image](https://cloud.githubusercontent.com/assets/7950151/26763788/ec0ab78e-4959-11e7-9187-3ecae295da7c.png)

In specific, the `Settings | Organization` bar has been split. This is probably due to the newly appeared scroll bar. This scroll bar has not been present before.",roberthoenig,b'area: settings UI bug good first issue help wanted priority: high',2017-06-04T17:17:24Z,2017-08-16T15:24:10Z
5211,Stream typeahead highlighting doesn't work with stream names containing spaces,"# Description

The typeahead system puts in bold the part of the suggested results that matches your query.

When you're typing a stream name the compose box, this highlighting feature doesn't work if your query contains a space.

# Steps to reproduce
1. Log in as Iago.
2. Create a new stream called ""foo bar"".
3. Go to the compose box to ""create a new topic"".
4. In the ""Stream"" field, type ""foo "" (foo and a space).
5. Notice that, as soon as you type the space, the bold in the suggestion at the typeahead box disappears.
    ![image](https://cloud.githubusercontent.com/assets/7356565/26757937/13aa1a8c-48ce-11e7-9571-ac5eb64416b0.png)

# Additional notes

Surprisingly enough, this doesn't happen in the topic typeahead, so it may be worth checking out the difference between both highlighting functions.",YagoGG,b'area: compose bug good first issue help wanted',2017-06-04T00:34:07Z,2017-06-07T04:20:29Z
5209,1.6 RC1: upgrade corrupts existing zulip-secrets,"Upgrade 1.5.2 - RC1 and suddenly my email backend is not working, new items in zulip-secrets.conf mangled my email password. (It was the last line in the file, I don't remember if there was a newline after it.)

```
[secrets]
shared_secret = cabb386e70e69c7452f7028bfc9611fcb33528fb5e32ec534ccbd3723977e308
avatar_salt = a4a6465b8dd07f18a2dadc4225037ae52f1a0b85746cfd1fc169175b32367d33
rabbitmq_password = 9615986d8b3d901f02778eb46780d3b3d2f6755855ea0cb46053fc690cdf93b9
local_database_password = ae3beda0754efb456bb43eb66c43cf75bfc92011198cb93e29dd4c47056e7dd2
initial_password_salt = f51abadc809b34a029959c9030009c2cb477fa44dd47bbc44e5e5d07ff0f1625
secret_key = zmz+e09(6$$p7_33m65_1f4zx21ialbp%065e!qcaxd69d_#76                                     
camo_key = 2fgA8nfhjzmTVBwH9R9kRRf3GV70nwdR3lwdbNDywHbDapgZ29UgtwJZaUyXNTLb
email_password = [my-gmail-pw]zulip_org_key = kpHEzUkQZvF5F6acYjdFSKHQA4zYbgPQVxdXlVdQoXt0f0XhRj2aasTUeOtkZ9fm
zulip_org_id = 2200ca30-b10b-49bf-9210-aeeb0cf1017f

```",feorlen,b'area: production bug priority: blocker',2017-06-03T21:36:58Z,2017-06-04T06:17:40Z
5208,1.6 RC1: 500 if sending login notification email fails,"This appears to be just about sending the email, because I get the same thing when I do password recovery. I get the ""Internal server error"" page. The email fails because upgrade corrupted zulip-secrets.conf (new issue forthcoming.)

(Also: was I supposed to be logged out after upgrade?)

```
2017-06-03 21:06:20,545 ERROR    Internal Server Error: /accounts/login/
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py"", line 42, in inner
    response = get_response(request)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 249, in _legacy_get_response
    response = self._get_response(request)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""./zerver/views/auth.py"", line 445, in login_page
    extra_context=extra_context, **kwargs)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py"", line 47, in inner
    return func(*args, **kwargs)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/views/decorators/debug.py"", line 76, in sensitive_post_parameters_wrapper
    return view(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py"", line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/views/decorators/cache.py"", line 57, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py"", line 82, in login
    auth_login(request, form.get_user())
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/__init__.py"", line 130, in login
    user_logged_in.send(sender=user.__class__, request=request, user=user)
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/dispatch/dispatcher.py"", line 191, in send
    response = receiver(signal=self, sender=sender, **named)
  File ""./zerver/signals.py"", line 88, in email_on_new_login
    send_email_to_user('zerver/emails/notify_new_login', user, context=context)
  File ""./zerver/lib/send_email.py"", line 41, in send_email_to_user
    return send_email(template_prefix, display_email(user), from_email=from_email, context=context)
  File ""./zerver/lib/send_email.py"", line 37, in send_email
    return mail.send() > 0
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/mail/message.py"", line 342, in send
    return self.get_connection(fail_silently).send_messages([self])
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/mail/backends/smtp.py"", line 100, in send_messages
    new_conn_created = self.open()
  File ""/home/zulip/deployments/2017-06-03-21-00-49/zulip-venv/lib/python2.7/site-packages/django/core/mail/backends/smtp.py"", line 67, in open
    self.connection.login(self.username, self.password)
  File ""/usr/lib/python2.7/smtplib.py"", line 622, in login
    raise SMTPAuthenticationError(code, resp)
SMTPAuthenticationError: (535, '5.7.8 Username and Password not accepted. Learn more at\n5.7.8  https://support.google.com/mail/?p=BadCredentials e64sm46681872pfl.49 - gsmtp')
2017-06-03 21:06:20,555 INFO     64.81.53.74     POST    500 562ms (db: 3ms/4q) /accounts/login/ (unauth via ?)
```",feorlen,b'area: authentication bug',2017-06-03T21:32:44Z,2017-06-09T22:03:45Z
5207,bug_down: Fix modal_link.,"The `data-toggle` property prevents modals from launching. This still doesn't work for the overlays that doesn't use the hashchange system, see #5206.",tommyip,None,2017-06-03T20:40:55Z,2017-06-04T01:43:37Z
5202,Missing date separator bars when sending a message with a new date to an existing thread,"Here's a screenshot:

![image](https://cloud.githubusercontent.com/assets/2746074/26755873/783a1192-484b-11e7-8d61-674d6dd99f69.png)

There should be a date separator bar before the new message I just sent. 

I suspect this is a regression introduced by 00c7f7d42f5384ac0315429f673ba8c3b4e9deef",timabbott,b'area: message view bug help wanted',2017-06-03T17:59:10Z,2017-06-06T05:16:21Z
5190,Math block shows wzxhzdk:0 when parsing error occurred,"When we send a text that's not match with KaTeX syntax (especially that makes parsing error) in a math block, math block changed to `wzxhzdk:0`.

![screenshot from 2017-06-03 04-44-16](https://cloud.githubusercontent.com/assets/20320125/26745997/7f523740-4817-11e7-8f32-ad84253ef11f.png)


How to reproduce:
1. Enter a text to Math block which makes parsing error, like ``````````````````````````.
2. Send the message, and the message will changed to `wzxhzdk:0`.

My preferred solution for this is showing the log when KaTeX parsing error occured (like Gitter does with its Latex), or just showing a text that tells people that parsing error has been occurred.",refeed,b'area: LaTeX area: markdown bug',2017-06-02T21:47:32Z,2020-04-01T22:00:34Z
5160,Fix manual provision instructions for Debian to fix an emoji path bug,"Apparently, our manual dev environment setup instructions don't work on Debian (etc.) right now, because we need to create some directories for the emoji cache.  We should come up with the right solution for this.

See https://github.com/zulip/zulip/issues/4998 for the consequences of the wrong fix to this.

Part 2 of this might be to just enabled `tools/provision` for Debian Jessie.",timabbott,b'bug good first issue help wanted priority: blocker',2017-06-01T21:32:20Z,2017-06-02T22:24:33Z
5154,realm_filters: Difference in rendering between markdown and bugdown.,"There is a difference in rendering of realm filters between bugdown and markdown:
![anim](https://cloud.githubusercontent.com/assets/16687990/26693642/8345a7ba-4722-11e7-8d35-98a1060f4859.gif)
A realm filter should match only after a start of a line, whitespace or opening delimiters.(See comment in `bugdown/__init__.py` `prepare_realm_patter()`). Seems like markdown is not configured to respect those rules.
To more clearly understand the issue try rendering pr#123, markdown will linkify it but bugdown will not(bugdown's behavior is correct).",HarshitOnGitHub,b'area: markdown bug good first issue help wanted priority: high',2017-06-01T18:09:17Z,2017-07-31T19:42:38Z
5149,Reserved subdomain unavailable still has green checkmark in field,"When you are signing up for a Zulip community, typing any subdomain will give a green checkmark next to it even though it is a reserved subdomain, which is very confusing. See the image below:

![screen shot 2017-05-31 at 11 47 39 pm](https://cloud.githubusercontent.com/assets/12992571/26667994/99cce7c6-465c-11e7-879e-d693b623405a.png)
",lonerz,b'area: onboarding bug good first issue help wanted priority: high',2017-06-01T06:55:20Z,2017-06-26T21:18:35Z
5146,Searching for a pasted link doesn't work,"1. Send `http://www.foo.com/` to the chat.
2. Search for `foo.com`.
3. No search items will pop up.

Even if you send `[http://www.foo.com/](http://www.foo.com/)`, you still can't search for the link.

Actually, with further investigation when you send `foo.com` to the chat and search for it, it works, meaning our search only looks at the prefix of each word.",lonerz,b'area: search bug',2017-06-01T01:33:50Z,2019-06-08T12:07:46Z
5130,emoji: Realm emojis disappear from the emoji settings page.,"Steps to reproduce:
1: Open Emoji Settings page.
![image](https://cloud.githubusercontent.com/assets/16687990/26633229/5a16b37c-4630-11e7-9da3-87b3f6a2b13d.png)
2: Upload a realm emoji.
![image](https://cloud.githubusercontent.com/assets/16687990/26633181/2a8cdb36-4630-11e7-85a1-c842baabb202.png)
3: Close the Organisation Settings dialog.
4: Reopen the organisation settings dialog, the uploaded emoji will not appear in the list.
![image](https://cloud.githubusercontent.com/assets/16687990/26633131/fd30af96-462f-11e7-8ea8-90f2d1a09aae.png)
5: Emoji will re-appear in the list after refreshing.",HarshitOnGitHub,b'area: emoji bug',2017-05-31T13:09:43Z,2017-05-31T16:13:38Z
5128,floating recipient bar: does not auto-update timestamp on the same topic,"When talking on the same topic before and after midnight with no interruptions of other conversations, the conversation before midnight still says ""Today."" However, all conversations of a different topic before midnight say ""Yesterday."" 

@timabbott says ""So I think the bug here is that we copy the timerender object from the message recipient bar to the floating recipient bar, and that copying probably loses the auto-timestamp-update system. static/js/floating_recipient_bar.js has code.""

![screen shot 2017-05-31 at 12 02 25 am](https://cloud.githubusercontent.com/assets/12992571/26621194/bb5b6a6a-459a-11e7-861e-b085ac5f44b3.png)
",lonerz,b'area: message view bug good first issue help wanted',2017-05-31T07:47:35Z,2017-06-07T03:02:01Z
5118,UI not displaying messages for remote client browser,"I have a fresh dev install, on a clean VM, and I can't see any messages after logging in with a browser on another host. Trying to create a new one hangs the UI. 

If I start Zulip with `run-dev.py --interface=''` then I can access the UI correctly from the same host it's running on (either by localhost or ip address) but not another one. If I provide the ip address instead of just '', it doesn't even work from the same host.

git bisect says this is where the problem is:
commit 3f5d0e69fbf801a59aa367398ea93b51be7bb940
Author: Mehanig <mehanig@gmail.com>
Date:   Tue May 23 15:03:53 2017 -0700
    Build and handle jsfiles using webpack instead of django-pipeline.
    Also renames bundle.js to translations.js. 

UI hanging trying to create a new message. Note the default dev streams exist, but there are no messages in them.
![screen shot 2017-05-30 at 16 41 39](https://cloud.githubusercontent.com/assets/95028/26611996/c316295e-4566-11e7-9757-63fa5c17d813.png)

The browser reports these errors:
![screen shot 2017-05-30 at 16 47 05](https://cloud.githubusercontent.com/assets/95028/26612005/d874f12c-4566-11e7-8e77-2a6a54b11268.png)",feorlen,b'area: provision bug',2017-05-31T01:43:51Z,2017-05-31T16:32:03Z
5095,Bite size: Wikipedia bot crashes for the query `!!!!@#$%` .,"The bot crashes with the following Indexerror
```
Traceback (most recent call last):
  File ""run.py"", line 72, in <module>
    run()
  File ""run.py"", line 68, in run
    quiet=options.quiet
  File ""/srv/zulip/contrib_bots/bot_lib.py"", line 177, in run_message_handler_for_bot
    client.call_on_each_message(handle_message)
  File ""../api/zulip/__init__.py"", line 500, in call_on_each_message
    self.call_on_each_event(event_callback, ['message'])
  File ""../api/zulip/__init__.py"", line 492, in call_on_each_event
    callback(event)
  File ""../api/zulip/__init__.py"", line 499, in event_callback
    callback(event['message'])
  File ""/srv/zulip/contrib_bots/bot_lib.py"", line 171, in handle_message
    state_handler=state_handler
  File ""/srv/zulip/contrib_bots/bots/wikipedia/wikipedia.py"", line 30, in handle_message
    bot_response = self.get_bot_wiki_response(message, client)
  File ""/srv/zulip/contrib_bots/bots/wikipedia/wikipedia.py"", line 52, in get_bot_wiki_response
    if len(data.json()['query']['search']) == 0:
  File ""/usr/local/lib/python3.4/dist-packages/requests/models.py"", line 885, in json
    return complexjson.loads(self.text, **kwargs)
  File ""/usr/lib/python3.4/json/__init__.py"", line 318, in loads
    return _default_decoder.decode(s)
  File ""/usr/lib/python3.4/json/decoder.py"", line 343, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File ""/usr/lib/python3.4/json/decoder.py"", line 361, in raw_decode
    raise ValueError(errmsg(""Expecting value"", s, err.value)) from None
ValueError: Expecting value: line 1 column 1 (char 0)
```",abhijeetkaur,b'area: bots bug good first issue help wanted',2017-05-28T00:22:00Z,2017-06-03T00:29:33Z
5088,Ugly escaping of `'` characters in missed message email subject lines,"If you have a user with a name like `Fred O'Connor`, and they send mention you in Zulip, you'll end up getting an email with a subject line like this: 

`Fred O&#39;Connor mentioned you in Zulip Community`

We should fix subject lines to not be HTML-escaped, since email subjects aren't HTML anyway.",timabbott,b'area: notifications (other) bug good first issue help wanted priority: blocker',2017-05-26T22:52:30Z,2017-06-03T23:06:16Z
5074,upload: Removing attachment from text disallows attaching the file again,"This is how to reproduce the error:

1. Press the 'attach file' button in the compose box.
2. Select a file to attach. This will upload the file to the server and place a link in the compose box.
3. Don't press send, discard the message.
4. Now try to send a message with the same attachment.

When you select a file using the attach file button, nothing will happen (a link should have been placed in the compose box instead).",sharmaeklavya2,b'area: compose bug good first issue help wanted',2017-05-25T23:17:08Z,2017-06-09T02:54:33Z
5052,onboarding: Improve messaging from our password strength checker.,"We use https://github.com/dropbox/zxcvbn for password strength checking. If someone's password is too weak, we just say ""password is too weak"" without telling them what rules we are using to determine their password strength.

zxcvbn already provides more detailed messages for passwords that are too weak, like `this is a top-10 common password` (see result.feedback on https://github.com/dropbox/zxcvbn), which we should expose to the user.

Marking this as a bug, since it frustrated multiple people trying to register for chat.zulip.org at the pycon sprints.
",rishig,b'area: portico bug good first issue help wanted priority: high',2017-05-25T16:42:50Z,2017-07-08T18:46:45Z
5039,Send notify_new_login emails through outgoing email queue,"Under some circumstances (not yet clear to me exactly what they are) a user logging in results in that user being sent an email by `email_on_new_login`. Currently this email is sent directly through the Django email subsystem. If the configured SMTP server is down/unreachable/misconfigured/etc., then the result is a 500 error and the user is unable to log in at all.

I think It would be better to send these emails through the outgoing email queue, so they would not block the login process.",rwbarton,b'bug',2017-05-25T00:54:27Z,2018-04-26T18:11:41Z
5032,"""read"" flag appearing twice in `message_store.get(msd_id)`","I think this is some sort of minor bug in the frontend's handling of message flags:

![image](https://cloud.githubusercontent.com/assets/2746074/26430380/a4942de2-40a1-11e7-9665-fe7117f37586.png)

I saw this once, but I bet with some tracing one can find the code path that causes it.",timabbott,b'area: message view bug help wanted priority: high',2017-05-24T23:55:05Z,2017-08-04T21:11:40Z
5020,@all mentions not consistently appearing in mentions view,"I've noticed some weird behavior lately wrt `@all` mentions. If I load the app and have mentions, I'll click on `@ Mentions` to narrow to them (/#narrow/is/mentioned). When I do this, I see the recent `@all` mentions. However, if I reload the page while on this view, the only messages that appear are the ones where I was specifically mentioned. And then if I click on another stream and then click on `@ Mentions` again to come back to the narrowed view, the `@all` mentions appear again. And even so, there are only ~3 `@all` mentions in the list, even though I'm pretty sure there have been way more.",alexandrinaw,b'area: message view area: search bug help wanted priority: blocker',2017-05-24T21:44:59Z,2017-08-16T18:30:17Z
5018,markdown: @-mentions rendering glitch,"When @-mentioning someone on a new line, the rendering glitches for a split second.

Some visuals below:
- `<text> <link> <newline> @-mention`
![triple @-mention](https://cloud.githubusercontent.com/assets/3491502/26426210/8367c742-408c-11e7-81cb-8c5fc3d05e06.png)
- `<text> <newline> @-mention`
![image](https://cloud.githubusercontent.com/assets/3491502/26426276/c3f9bc2a-408c-11e7-9910-dbb64458f455.png)
- `@-mention <newline> @-mention`
![image](https://cloud.githubusercontent.com/assets/3491502/26426301/e1f296e8-408c-11e7-8858-5c96c1a8ae6f.png)

After getting a response back from the server, the message rerenders properly.

It's due to an issue with frontend markdown rendering, check [the documentation](https://zulip.readthedocs.io/en/latest/markdown.html) to get started on this issue.",trueskawka,b'area: markdown bug good first issue help wanted priority: high',2017-05-24T21:28:36Z,2017-07-18T07:13:59Z
5007,Path detection issue in 'contrib_bots/bot_lib.py',"Running the command 
`python3 ./contrib_bots/run.py ./contrib_bots/bots/define/define.py` from ~/zulip throws the following error.

```
(zulip-venv)vagrant@vagrant-base-trusty-amd64:~/zulip$ python3 ./contrib_bots/run.py ./contrib_bots/bots/define/define.py
Traceback (most recent call last):
  File ""./contrib_bots/run.py"", line 13, in <module>
    from bot_lib import run_message_handler_for_bot
  File ""/srv/zulip/contrib_bots/bot_lib.py"", line 16, in <module>
    from zulip import Client
ImportError: No module named 'zulip'
```

Whereas the command:
`python3 run.py bots/define/define.py` from ~/zulip/contrib_bots works perfectly fine!",abhijeetkaur,b'area: bots bug question',2017-05-24T19:09:46Z,2017-05-29T02:04:09Z
4998,"upgrade-from-git as requires ""zulip"" user password","The script `tools/setup/emoji/build_emoji` runs as the zulip user, but required root privs for the following command:

`:run([""sudo"", ""chown"", ""%s:%s"" % (user_id, user_id), EMOJI_CACHE_PATH])`

`generate_secrets: No new secrets to generate.
2017-05-24 17:13:44,861 upgrade-zulip-stage-2: Building static assets...
Using cached node modules from /srv/zulip-npm-cache/3e52fd648131a3b9f77cc5a5c1b83371a7744234/node_modules
+ rm -rf node_modules
+ ln -nsf /srv/zulip-npm-cache/3e52fd648131a3b9f77cc5a5c1b83371a7744234/node_modules node_modules
[sudo] password for zulip: `
",joshland,b'area: production bug priority: blocker',2017-05-24T17:17:28Z,2018-06-24T15:57:33Z
4997,One timerender span ID is always duplicated,"An accessibility audit of the main UI page turns up that one of the spans with an ID for the form ""timerender{integer}"" appears twice on the page.  The exact number is different each time, but the duplicate seems to be an element which contains the date in the header for the currently selected stream; perhaps the DOM element is being copied, ID and all?  It looks like these IDs are used to maintain a list of all dates on the page that need to be updated as time passes; perhaps using a shared class name for all these would work better than maintaining that ID list?  That may also help eliminate the code for coping with IDs in the list for elements which are no longer in the DOM.",jmbowman,b'area: message view bug good first issue help wanted',2017-05-24T17:16:50Z,2017-06-07T03:02:01Z
4995,install script does not run build_emoji,"I am trying to get a production install running - I believe that I have followed all of the directions. After settings.py was complete, I attempted to initialize the database.  This is the resulting error.




` ✘ ⚙ zulipdev@joshland  ~  sudo su zulip -c /home/zulip/deployments/current/scripts/setup/initialize-database
++ dirname /home/zulip/deployments/current/scripts/setup/initialize-database
+ cd /home/zulip/deployments/current/scripts/setup/../..
+ ./manage.py checkconfig
Traceback (most recent call last):
  File ""./manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 367, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 359, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 294, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 342, in execute
    self.check()
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 374, in check
    include_deployment_checks=include_deployment_checks,
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 361, in _run_checks
    return checks.run_checks(**kwargs)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/checks/registry.py"", line 81, in run_checks
    new_errors = check(app_configs=app_configs)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/checks/urls.py"", line 14, in check_url_config
    return check_resolver(resolver)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/core/checks/urls.py"", line 24, in check_resolver
    for pattern in resolver.url_patterns:
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/utils/functional.py"", line 35, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/urls/resolvers.py"", line 313, in url_patterns
    patterns = getattr(self.urlconf_module, ""urlpatterns"", self.urlconf_module)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/utils/functional.py"", line 35, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zulip-venv/lib/python2.7/site-packages/django/urls/resolvers.py"", line 306, in urlconf_module
    return import_module(self.urlconf_name)
  File ""/usr/lib/python2.7/importlib/__init__.py"", line 37, in import_module
    __import__(name)
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zproject/urls.py"", line 7, in <module>
    import zerver.forms
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zerver/forms.py"", line 14, in <module>
    from zerver.lib.actions import do_change_password, is_inactive, user_email_is_unique
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zerver/lib/actions.py"", line 13, in <module>
    from zerver.lib.bugdown import (
  File ""/home/zulip/deployments/2017-05-24-15-01-03/zerver/lib/bugdown/__init__.py"", line 716, in <module>
    name_to_codepoint = ujson.load(open(path_to_name_to_codepoint))
IOError: [Errno 2] No such file or directory: '/home/zulip/prod-static/generated/emoji/name_to_codepoint.json'
`",joshland,b'area: production installer bug question',2017-05-24T15:25:20Z,2017-05-26T22:41:41Z
4983,Fix running `tools/test-backend AvatarTest` (with a test class),"This seems to have regressed recently.  Running with other classes seems to work, so this one is a bit mysterious.

The traceback is:
```
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/test_runner.py"", line 462, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/test/runner.py"", line 437, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File ""/usr/lib/python2.7/unittest/loader.py"", line 100, in loadTestsFromName
    parent, obj = obj, getattr(obj, part)
AttributeError: 'module' object has no attribute 'AvatarTest'

  This is often caused by a test module/class/function that doesn't exist or 
  import properly. You can usually debug in a `manage.py shell` via e.g. 
    import zerver.tests.test_messages
    from zerver.tests.test_messages import StreamMessagesTest
    StreamMessagesTest.test_message_to_stream

```",timabbott,b'area: testing-infrastructure bug good first issue good sprint project help wanted',2017-05-24T01:38:44Z,2017-06-20T12:35:08Z
4960,Define bot: occasionally shows a warning/error,"I'm not sure how to reproduce this, or if it is a zulip issue or related to the library or server used, but on occasion an error appears on the console where the bot is run:

INFO:urllib3.connectionpool:Starting new HTTPS connection (1): owlbot.info
ERROR:root:Expecting value: line 2 column 1 (char 1)
Traceback (most recent call last):
  File ""bots/define/define.py"", line 49, in get_bot_define_response
    definitions = api_result.json()
  File ""/usr/lib/python2.7/dist-packages/requests/models.py"", line 793, in json
    return json.loads(self.text, **kwargs)
  File ""/usr/lib/python2.7/dist-packages/simplejson/__init__.py"", line 505, in loads
    return _default_decoder.decode(s)
  File ""/usr/lib/python2.7/dist-packages/simplejson/decoder.py"", line 370, in decode
    obj, end = self.raw_decode(s)
  File ""/usr/lib/python2.7/dist-packages/simplejson/decoder.py"", line 400, in raw_decode
    return self.scan_once(s, idx=_w(s, idx).end())
JSONDecodeError: Expecting value: line 2 column 1 (char 1)
",neiljp,b'area: bots bug',2017-05-23T23:47:50Z,2017-07-06T19:07:11Z
4937,GitHub auth doesn't report a useful error message with no public email,"If a GitHub account has no public email address associated with it, then GitHub registration gives a confusing ""Field is required"" error message.

I think we should do one of these 2 things:
(1) See if we should be asking for additional permissions from GitHub Oauth that include a private email.
(2) Give a better error message explaining the user needs to set a public email

@umairwaheed can you look into this one?",timabbott,b'area: authentication bug help wanted',2017-05-23T19:28:29Z,2017-05-24T15:25:24Z
4862,email: Characters are converted to HTML entities in the email subject ,"As a result, a name such as `Test User W'14` will render as `Test User W&#39;14` in the subject of a private message email.",neerajwahi,b'area: notifications (other) bug good first issue help wanted',2017-05-22T07:53:30Z,2017-06-03T23:09:13Z
4861,Inline emojis are not rendered properly on Safari 10.1.1,"This is browser specific.

on Safari
![ac3ea30e-5824-4a2f-bf37-4e6c1b5e25cc](https://cloud.githubusercontent.com/assets/18511177/26292337/bcb27a62-3ed2-11e7-8b66-233d3123adf4.jpg)

on Firefox
![b61102eb-50b0-42ab-afd3-e8b2fa078b34](https://cloud.githubusercontent.com/assets/18511177/26292448/aebd85cc-3ed3-11e7-9c8e-c18315af35d9.jpg)
",jainkuniya,b'area: message view bug help wanted priority: blocker',2017-05-22T04:17:50Z,2017-09-20T17:31:08Z
4851,Non-existing emails in dev_fetch_api_key API endpoint return a 500 error,"# Description
The `dev_fetch_api_key` API endpoint is designed to provide an API key with access to accounts in a development server.

When an invalid user account is provided, the server returns a 500 error and throws the following exception:

```
File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""/srv/zulip/zerver/decorator.py"", line 118, in wrapper
    return func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/lib/request.py"", line 166, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""/srv/zulip/zerver/views/auth.py"", line 504, in api_dev_fetch_api_key
    login(request, user_profile)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/contrib/auth/__init__.py"", line 119, in login
    'You have multiple authentication backends configured and '
ValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.
```

# Steps to reproduce
1. Start a development server.
2. Send a POST HTTP request to `localhost:9991/api/v1/dev_fetch_api_key`, with a form-data encoded body containing a key ""username"", which value is ""foo@bar.com"".
3. The result is an HTTP 500 response, with an internal server error. The abovementioned traceback appears in the server's log.

The expected result would be a different HTTP code (403, probably), and a descriptive error message, with no exceptions.",YagoGG,b'area: api bug',2017-05-21T20:11:45Z,2017-05-24T16:40:38Z
4844,Date doesn't appear when new topic at top of screen,"It appears that when a new topic is just at the top of the page (ie, the top message is a different topic from the message that's just barely offscreen), the date string (eg, ""yesterday"") goes away. As a relatively naive user, it wasn't obvious why the date wasn't there (or how to get it back), which left me confused about when a discussion actually happened.

[Tim says](https://chat.zulip.org/#narrow/stream/issues/subject/date/near/205010):  It's somewhat tricky, since it's only relevant when the floating recipient bar is hidden due to what would be an ugly overlap with the top message's recipient bar, but this means that we'd need to modify the styling of the top message in view to show the date temporarily. But I think should be fixable with a bit of work.

Some pictures:

Behaving as expected:
![2017-05-date-showing](https://cloud.githubusercontent.com/assets/85198/26265126/c120118a-3cad-11e7-9059-4e358b2c75cb.png)

With a new topic at top of screen:
![2017-05-date](https://cloud.githubusercontent.com/assets/85198/26265125/c11df1ca-3cad-11e7-8574-0ac128988025.png)
",dehnert,b'area: message view bug help wanted',2017-05-19T20:11:08Z,2017-06-07T03:02:01Z
4841,Restricting users to domain(s) loses org info on login screen,"The organization setting ""New users restricted to the following domains"" seems to change the way the login screen shows org details:

- With the option unchecked, the login page is correct and shows org info along with email/password
- With the option checked and domain(s) entered, the login page only shows email/password, I.E. no org info

Expected result is that this option shouldn't affect whether the org info is shown or not",SteveCliff,b'area: settings (admin/org) bug good first issue help wanted priority: blocker',2017-05-18T21:07:04Z,2017-06-02T22:00:47Z
4839,Make Zulip give a better error for Google Compute Platform weird boto configuration,"GCE has an /etc/boto.cfg, which GCP prepopulates in its image to include:
```
[Plugin]
plugin_directory = /usr/lib/python3/dist-packages/google_compute_engine/boto
```

The boto library reads this, an ends up being totally broken on import with Python 2.  We should at least add code in our production installer to detect this situation and tell the user to fix it.

@jmandel FYI; did you end up opening an issue with Google about this?",timabbott,b'area: production installer bug good first issue help wanted priority: high',2017-05-18T19:48:15Z,2017-10-09T02:47:49Z
4818,Fix line breaks in emoji picker related to realm emoji on chat.zulip.org,"There's a weird issue with realm emoji causing line breaks in the emoji/reactions picker.  You can see this if you scroll down to `:glenda:` in the chat.zulip.org emoji picker.

Note that chat.zulip.org is running tabbott/master which has a few extra commits that are emoji-related and could partially cause this; those extra commits will be merged into master soon, so it's worth fixing this regardless.

",timabbott,b'area: emoji bug good first issue help wanted priority: blocker',2017-05-17T07:05:33Z,2017-05-17T19:50:16Z
4812,real-time sync when adding subscribers with a filter isn't correct,"It appears that we're using the wrong function to add subscribers, and appending them to the HTML, rather than appending them to the `list_render.js` list of users and then re-filtering.

As a result, users who don't match the current filter will appear temporarily in the list when subscribed.",timabbott,b'area: stream settings bug good first issue help wanted priority: high',2017-05-17T03:11:26Z,2017-06-20T19:45:23Z
4811,settings: change email popup when ESC is pressed leaves gray overlay,"1. Go to [your-account](https://chat.zulip.org/#settings/your-account) settings.
2. Go to where your email is and click `[Change]`.
3. When the change email popup comes up, press `Esc`.
4. This should leave a gray overlay on your home screen.
5. Click the screen to get rid of the gray overlay.

We can either have `Esc` go back to [your-account](https://chat.zulip.org/#settings/your-account) settings or have it go back to the home screen. I think it makes sense to go back to the settings modal. Any thoughts?",lonerz,b'area: settings UI bug good first issue help wanted',2017-05-17T02:51:24Z,2017-08-28T19:03:58Z
4810,settings: Saving changes in your-account settings brings current message to an earlier message,"1. Go to [your-account](https://chat.zulip.org/#settings/your-account) settings.
2. Press ""Save Changes"".
3. Exit and go to your home screen to see that your current message has changed to an earlier message.

(Seems to be the same with ""Change email"")",lonerz,b'area: settings (user) bug help wanted priority: blocker',2017-05-17T02:46:00Z,2017-05-17T03:40:50Z
4806,emoji picker sort order is worse than typeahead sort order,"If you filter `:one`, in the emoji picker, you get everything with ""one"" in it, e.g. 
![image](https://cloud.githubusercontent.com/assets/2746074/26128371/11091f9e-3a41-11e7-9436-a831b872ec8f.png), whereas if you type `:one` in the compose box, it correctly shows the exact match at the top.  We should fix the emoji picker to prioritize exact start-of-string matches above others that match the text.
",timabbott,b'area: emoji bug good first issue help wanted',2017-05-16T21:08:45Z,2017-06-08T04:54:43Z
4799,analytics: the key for Messages sent by Recipient Type (Me/Last Year-All time) graphs covers graph in some versions of Chrome on Mac,"Under [analytics](https://chat.zulip.org/stats), go to the pie chart Messages Sent by Recipient Type. Now, set the chart to ""Me"" and ""Last year"" and you'll see the key for the chart move over the chart.

![screen shot 2017-05-15 at 8 50 02 pm](https://cloud.githubusercontent.com/assets/12992571/26089171/79e99a2a-39b0-11e7-8002-824ebe52263c.png)
",lonerz,b'area: analytics bug good first issue help wanted',2017-05-16T03:53:05Z,2017-07-08T01:43:24Z
4797,Make `scripts/setup/generate_secrets.py --production` safe to run after installation,"Currently, if you run this after installation, it'll blow away any settings you have that it doesn't generate (though at least it'll preserve the ones that it does).  

Ideally, it'd only add things, and never remove them; then, we could use it as part of the upgrade path when we add new secrets that every server should have.",timabbott,b'area: production installer bug good first issue help wanted',2017-05-15T23:40:13Z,2017-05-17T05:16:09Z
4795,Add support for GitLab merge request hook reopen event,"See the below traceback:
```
2017-05-15 21:41:36,080 ERROR    Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-05-15-20-46-44/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2017-05-15-20-46-44/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/request.py"", line 166, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 262, in _wrapped_func_arguments
    return view_func(request, user_profile, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 166, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/webhooks/gitlab/view.py"", line 287, in api_gitlab_webhook
    event = get_event(request, payload, branches)
  File ""./zerver/webhooks/gitlab/view.py"", line 369, in get_event
    raise UnknownEventType(u'Event {} is unknown and cannot be handled'.format(event))
UnknownEventType: Event Merge Request Hook reopen is unknown and cannot be handled
```
",timabbott,b'area: integrations bug good first issue help wanted',2017-05-15T21:42:13Z,2017-05-31T05:12:21Z
4789,org settings: Minor aesthetic bugs,"- [x] In [org settings](https://chat.zulip.org/#organization/organization-settings), the upload icon/delete icon buttons lighten up on hover– not sure if this is supposed to happen?

- [x] On chat.zulip.org, it seems like under [auth-methods](https://chat.zulip.org/#organization/auth-methods), the checkboxes are still clickable (#4754), but maybe fixed on master already. (edit: fixed in master)

- [x] Under [default streams](https://chat.zulip.org/#organization/default-streams-list), the Filter Stream input is disabled (it shouldn't), even though for [users](https://chat.zulip.org/#organization/user-list-admin) and [bots](https://chat.zulip.org/#organization/bot-list-admin) the filter input is enabled. We probably want to make this consistent.

- [x] Under [org settings](https://chat.zulip.org/#organization/organization-settings), it seems like ""Only admins may invite"" (3rd bullet point) is a lot lighter than all other text, not sure if that's a bug or feature.",lonerz,b'area: settings (admin/org) bug good first issue help wanted',2017-05-14T05:50:25Z,2017-05-15T18:38:08Z
4779,Stream subscription rows disappear after rapid subscribing and unsubscribing,"As seen in the GIF below, a weird behavior involving the disappearance of a stream row occurs if a user rapidly subscribes and unsubscribes from a stream row in the Streams modal.

![gif demonstration](https://i.gyazo.com/be8c0d140f84663c768e792bdeb042c3.gif)",synicalsyntax,b'area: stream settings bug help wanted',2017-05-13T02:15:44Z,2018-04-30T18:42:51Z
4775,:two: emoji has wrong image,The `:two:` emoji looks like a C inside a circle.,strugee,b'area: emoji bug good first issue help wanted priority: blocker',2017-05-12T20:58:10Z,2017-05-16T21:38:41Z
4764,"When realm emoji is selected, realm emoji in reaction menu shows text instead of emoji","React with a message like `:zulip:` and then go to the reaction menu and search for `zulip`, the emoji itself shows `:zul`.

![screen shot 2017-05-11 at 3 01 13 pm](https://cloud.githubusercontent.com/assets/12992571/25973846/ba0d9254-365a-11e7-8d8a-ba7105729066.png)
",lonerz,b'area: emoji bug good first issue help wanted',2017-05-11T22:01:39Z,2017-05-30T04:47:44Z
4762,Emoji reactions with realm emoji aren't scaled properly,"This is a fairly important regression we'll want to fix before Zulip 1.6.

![image](https://cloud.githubusercontent.com/assets/2746074/25972944/e5203c3e-3656-11e7-8f66-ad9325eb51a8.png)
",timabbott,b'area: emoji bug good first issue help wanted priority: blocker',2017-05-11T21:34:29Z,2017-05-11T21:41:14Z
4757,Too many redirects for a account during login of deactivated account,"I deactivated my Zulip account and then signed up again and tried to sign in. For wrong password, it showed wrong password, when i entered correct credentials, chrome showed
```
chat.zulip.org redirected you too many times.
Try clearing your cookies.
ERR_TOO_MANY_REDIRECTS
```
Clearing cookies did not work as a solution for it.",AyushyaChitransh,b'area: authentication bug help wanted priority: blocker',2017-05-11T13:27:52Z,2017-06-20T15:38:59Z
4754,Authentication methods checkboxes are clickable as a user,[Authentication methods](https://chat.zulip.org/#organization/auth-methods) checkboxes are clickable even as a user. These probably should be disabled like the checkboxes in [org settings](https://chat.zulip.org/#organization/organization-settings).,lonerz,b'area: settings (admin/org) bug good first issue help wanted',2017-05-11T00:58:44Z,2017-05-17T19:00:43Z
4750,Handle deleted realm emoji (and other removed emoji styles) with past reactions,"Currently, if you do the following question:
* Add a realm emoji ""foo""
* React with ""foo"" to a message 
* send a message containing the ""foo"" emoji
* Remove the realm emoji ""foo""

The one will get a lot of unpleasant bugs.  There's basically 2 strategies we can take to deal with this:
(1) Change realm emoji to be referenced in the code by ID, and just deactivate (rather than deleting) them when a user deletes a realm emoji in the admin UI.  That way, existing ones can still be rendered, and the ""delete"" button just stops you from creating new uses of that emoji.
(2) Delete any reactions using a given emoji when the emoji is deleted.  Seems kinda ugly.
(3) Just ignore unknown emoji names in the frontend code, etc.

I think I like the (1) approach to solving this problem best, since it feels like it'd probably produce the best user experience with the most robust implementation.
",timabbott,b'area: emoji bug help wanted priority: high',2017-05-10T23:43:57Z,2017-07-05T20:01:50Z
4749,Exception in popovers.actions_menu_handle_keyboard,"I got the below exception from logs, so I don't know what causes it exactly, but the top of the traceback is in get_action_menu_menu_items, which is a 1-line function, and the code path to there is pretty clear.  I'm not entirely sure what the code in question is supposed to do, so I suspect with some spelunking, this won't be hard to fix.

```
Stacktrace:
TypeError: Cannot read property '$tip' of undefined
    at h (static/min/app.580329556832.js:1611:766)
       = static/js/popovers.js line 176 column 44

    at Object.c.actions_menu_handle_keyboard (static/min/app.580329556832.js:1614:334)
       = static/js/popovers.js line 196 column 17

    at Object.a.process_enter_key (static/min/app.580329556832.js:1680:426)
       = static/js/hotkey.js line 258 column 9

    at Object.a.process_hotkey (static/min/app.580329556832.js:1683:260)
       = static/js/hotkey.js line 385 column 20

    at Object.a.process_keydown (static/min/app.580329556832.js:1690:465)
       = static/js/hotkey.js line 661 column 12

    at HTMLDocument.<anonymous> (static/min/app.580329556832.js:1690:520)
       = static/js/hotkey.js line 665 column 9

    at HTMLDocument.g (static/min/common.4584f908a1d2.js:251:25)
       = static/js/blueslip.js line 221 column 20

    at HTMLDocument.dispatch (static/min/common.4584f908a1d2.js:125:73)
       = static/node_modules/jquery/dist/jquery.js line 5225 column 16

    at HTMLDocument.h.handle (static/min/common.4584f908a1d2.js:118:327)
       = static/node_modules/jquery/dist/jquery.js line 4878 column 6

```",timabbott,b'area: message view bug good first issue help wanted',2017-05-10T23:32:55Z,2017-07-31T19:41:52Z
4746,Make table headers fixed,"Currently the headers(column names) of the table names also scroll along the the rows which makes it kind of difficult sometimes to go through the table. 

**Before scrolling**
![screenshot from 2017-05-10 23 37 17](https://cloud.githubusercontent.com/assets/7190633/25913940/30d7b800-35da-11e7-8d33-36b0cb8080f0.png)


**After scrolling a bit**
![screenshot from 2017-05-10 23 39 23](https://cloud.githubusercontent.com/assets/7190633/25913931/1fcdfb1e-35da-11e7-9557-b7aba2ec7c73.png)

I can work on this if this is worth spending some time on.",hackerkid,b'area: settings UI bug good first issue help wanted',2017-05-10T18:12:55Z,2017-07-07T19:20:12Z
4744,Non-webhook integrations links broken on /integrations,"Email, Twitter, Git are example non-webhook integrations, and clicking their links seems to be totally broken right now.

This is a high-priority issue.",timabbott,b'area: documentation (user) bug good first issue help wanted priority: blocker',2017-05-10T18:03:43Z,2017-05-10T18:34:06Z
4742,Exception formatting GitHub events,"I don't have whatever payload caused this, but here's the exception:

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-05-10-06-16-16/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2017-05-10-06-16-16/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/webhooks/github_dispatcher.py"", line 15, in api_github_webhook_dispatch
    return api_github_landing(request)
  File ""/home/zulip/deployments/2017-05-10-06-16-16/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/decorator.py"", line 104, in wrapper
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 166, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 384, in _wrapped_func_arguments
    return limited_func(request, user_profile, *args, **kwargs)
  File ""./zerver/decorator.py"", line 664, in wrapped_func
    return func(request, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 166, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/webhooks/github/view.py"", line 270, in api_github_landing
    **kwargs)
  File ""./zerver/webhooks/github/view.py"", line 175, in api_github_v2
    created=payload['created'])
  File ""./zerver/webhooks/github/view.py"", line 294, in build_message_from_gitlog
    content = get_push_commits_event_message(pusher, url, short_ref, commits)
  File ""./zerver/lib/webhooks/git.py"", line 64, in get_push_commits_event_message
    committers_details = ""{} ({})"".format(*committers_items[0])
IndexError: list index out of range
```

For future debugging, a thought: maybe we should add a log file where raw requests that throw an exception in `api_key_only_webhook_view` are logged in test fixture format.  
\",timabbott,b'area: integrations bug good first issue help wanted',2017-05-10T17:00:03Z,2017-05-16T03:08:27Z
4736,Exception using hotkeys to navigate around compose emoji picker,"The reproducer is simple:

* Go to an empty narrow
* Open compose, click emoji picker
* Use arrow keys to move around the picker
* Hit enter -> exception.

Here's the exception:
```
common.4584f908a1d2.js:251 Uncaught TypeError: Cannot read property 'reactions' of undefined
    at h (app.729a836d1395.js:1923)
    at Object.toggle_reaction (app.729a836d1395.js:1925)
    at Object.a.process_enter_key (app.729a836d1395.js:1680)
    at Object.a.process_hotkey (app.729a836d1395.js:1683)
    at Object.a.process_keydown (app.729a836d1395.js:1690)
    at HTMLDocument.<anonymous> (app.729a836d1395.js:1690)
    at HTMLDocument.g (common.4584f908a1d2.js:251)
    at HTMLDocument.dispatch (common.4584f908a1d2.js:125)
    at HTMLDocument.h.handle (common.4584f908a1d2.js:118)
```

I think structurally, there are 2 possibilities:
* Either we shouldn't set `current_message_emoji_popover_elem` when opening the compose emoji picker, and the hotkeys just won't do anything
* Or, better, we should have some check for which popover it is, and have the hotkey act as though one had clicked that emoji.

@jackrzhang FYI, I think this is a regression from your merger.",timabbott,b'area: emoji bug good first issue help wanted priority: blocker',2017-05-09T21:56:25Z,2017-05-10T23:27:56Z
4734,Default streams UI floats oddly if you have a lot of default streams,"This is a regression introduced recently by the progressive list rerendering code, I think:

![image](https://cloud.githubusercontent.com/assets/2746074/25867550/bb125d9a-34ae-11e7-9489-1d5fe41e30d9.png)
![image](https://cloud.githubusercontent.com/assets/2746074/25867579/d57789a8-34ae-11e7-8652-1a2a1a49f8ae.png)
",timabbott,b'area: stream settings bug good first issue help wanted priority: blocker',2017-05-09T18:58:59Z,2017-05-10T23:57:05Z
4720,Mysterious bug causes incorrect scrolling to bottom of page (and messes unread counts),"When I logged onto Zulip this morning via my Desktop, I had 96 unread messages but I did not read any of them.

I decided to look at my messages through my mobile which immediately marked all my unread messages as read and moved the pointer all the way to the bottom.

I then checked back on my Desktop and saw that all 96 unread messages were marked as read on Desktop as well.

Before on desktop:
![unreadmessages](https://cloud.githubusercontent.com/assets/8403088/25824615/e8153566-33f4-11e7-8ee4-660a105bc001.png)

Mobile view immediately after accessing on Desktop
![img_0204](https://cloud.githubusercontent.com/assets/8403088/25824664/0ece4fc6-33f5-11e7-97d7-ff7a83fd7a0e.PNG)

",wangjames,b'area: message view bug priority: high',2017-05-08T20:50:43Z,2018-04-26T18:08:43Z
4716,Fix --rerun option for tools/test-backend.,"The --rerun option for tools/test-backend seems to have broken since we added multi-threading.

ping @umairwaheed ",showell,b'area: testing-infrastructure bug',2017-05-08T18:09:32Z,2017-05-09T16:37:36Z
4710,emoji: Emoji no longer appear in desktop notifications.,"Haven't tried this myself, but I think a way to reproduce it would be to open the development environment in two different browsers with two different users, and send an emoji-filled PM from one to the other. 
You can also test on chat.zulip.org by asking someone to send you an PM with an emoji :).

@HarshitOnGitHub, in case you have any ideas.",rishig,b'area: emoji bug good first issue help wanted',2017-05-08T07:15:24Z,2017-05-16T20:56:30Z
4703,"alerts: ""Unable to connect to Zulip"" alert gets duplicated.","To reproduce: Go to the ""Network"" tab of the Chrome Developers Tools, and click ""Offline"". In a few seconds you'll see two ""Unable to connect to Zulip"" alerts drop from the top.

The two alerts have different messages, but showing one or the other would be better than showing both.",rishig,b'area: notifications (other) bug good first issue help wanted',2017-05-06T20:25:49Z,2017-05-09T18:15:58Z
4686,Subscribe offer shows up immediately after renaming a stream when narrowed,"This is a bug, triggered by being narrowed to a stream+topic and renaming the stream, and then exiting the streams modal (while still narrowed):

![image](https://cloud.githubusercontent.com/assets/2746074/25721026/d7a4c70c-30c3-11e7-94f4-6567e5a434b9.png)

While we're at this, we should clean up that styling for that text (at least the `---` should go).",timabbott,b'area: message view bug good first issue help wanted',2017-05-04T19:20:04Z,2017-05-14T04:59:46Z
4679,bugdown: Add domain-name to relative image-url in open graph data.,"fixes #4608

Need advice on whether this needs testing, and if yes, how. Since it requires querying external services that might change their behavior someday, I'm confused what to do.

![image](https://cloud.githubusercontent.com/assets/8033238/25686090/6618b34e-3089-11e7-995e-c0c79d544d85.png)
",aero31aero,None,2017-05-03T23:50:41Z,2017-05-04T23:54:43Z
4678,bugdown: Frontend echo puts extra line space in quote with #.,"To reproduce, use the following message, with ' replaced with `.
```
'''quote
# line 1
# line 2
'''
```

The frontend renders it with what looks like 1.5 line spacing, which is then fixed once we get the result from the backend.

You need the `#` to get the incorrect behavior. 
",rishig,b'area: markdown good first issue help wanted',2017-05-03T22:18:35Z,2017-07-18T18:09:22Z
4670,bugdown: Convert GitHub image-preview urls to image urls.,"Adds a new function as proposed by @rishig so that websites that provide image-previews instead of direct access to image-urls don't break the parser. This function sets the image source in accordance with the url pattern followed by the website- here, github.com",aero31aero,None,2017-05-03T17:21:57Z,2017-05-09T18:23:29Z
4669,Reduce size of user-info pop-up for screen width less than 600px,"I was checking out the web-app's UI in my mobile.
Found this issue. The size of pop-up showing user info by clicking the user name should be reduced for mobile devices, especially for screen size less than 600px. 

![userinfoissue1](https://cloud.githubusercontent.com/assets/13533873/25671083/73b28832-304c-11e7-81dc-12dfa9d4af82.jpg)
![userinfoissue2](https://cloud.githubusercontent.com/assets/13533873/25671084/73b5cd94-304c-11e7-9ff0-be0f8906dc0e.jpg)
",Lplenka,b'area: message view bug good first issue help wanted',2017-05-03T16:35:48Z,2017-05-10T23:50:43Z
4666,bug: emoij picker search is case sensitive,"emoij picker search is case sensitive

but it shouldn't be

also @timabbott said in the [zulip chat](https://chat.zulip.org/#narrow/stream/issues/topic/reactions.20picker):
```quote
we'd want to make realm emoji need to be lower-case, which is a good idea anyway I think
```
",penCsharpener,b'area: emoji bug good first issue',2017-05-02T20:16:23Z,2017-05-12T02:12:08Z
4660,Scrolling through messages fast with touchpad flashes gray rectangles,"If I scroll quickly up and down through the main view using my touchpad, I get conspicuous flashes of gray where a bunch of newly-scrolled-in messages will just be gray rectangles for like 100ms before they properly render. This is in Chrome on Linux.

This doesn't happen if I use the keyboard (PgUp/PgDn), no matter how fast I go.

This often doesn't happen if I've already scrolled around the same messages some -- there must be some caching effect. I consistently reproduce if I reload a https://chat.zulip.org/ tab and scroll up with the touchpad.
",gnprice,b'area: emoji bug',2017-05-01T04:48:47Z,2017-05-03T21:52:39Z
4659,"Message area can scroll right, into blank space","When scrolling around the main view with my touchpad, rather than keys like PgUp/PgDn or a scroll wheel, I'll naturally often scroll to the side a bit.

When I do, I find I can scroll rightward over the messages -- all the messages move left, exposing blank space to their right that moves into the message area. This works to a finite distance which is a little more than half the width of the message area.

The right behavior is that left-right scrolling of the message area should do nothing.

I'm using Chrome on Linux, and seeing this on chat.zulip.org.
",gnprice,b'area: message view bug help wanted priority: blocker',2017-05-01T04:43:54Z,2017-05-08T16:57:19Z
4658,bugdown: Don't pull images for image files at github.com and similar sites.,"If you send a message with the following URL in zulip, you'll get a broken image:
https://github.com/zulip/zulip/blob/master/static/images/logo/zulip-icon-128x128.png

That's because our markdown processor thinks anything that ends in `.png` is an image file.

There are two steps to solving this issue:
* Brainstorm a list of sites that have URLs ending in image file names that aren't actually the images. It's fine if you don't get all of them, we can always add more as we think of them. You can look at zulip.org/integrations to get an idea for other version control sites that might have similar behavior to github, and post to #general on chat.zulip.com. 
* Modify `zerver/lib/bugdown/__init__.py` to not mark URLs from those domains as images. This is likely the piece of code that will need to be modified:
```
    def is_image(self, url):
        # type: (Text) -> bool
        if not image_preview_enabled_for_realm():
            return False
        parsed_url = urllib.parse.urlparse(url)
        # List from http://support.google.com/chromeos/bin/answer.py?hl=en&answer=183093
        for ext in ["".bmp"", "".gif"", "".jpg"", ""jpeg"", "".png"", "".webp""]:
            if parsed_url.path.lower().endswith(ext):
                return True
        return False
```",rishig,b'area: markdown good first issue help wanted',2017-05-01T00:04:31Z,2017-05-09T18:23:28Z
4657,TeX summations display incorrectly,"# Description

Using the `\sum` command in centered display TeX math causes some strange overlapping because the sigma symbol is misaligned.

# Steps to reproduce

1. Send a message containing the following:

    ```
    ~~~math
    \sum_0^1x_i
    ~~~
    ```

2. The following appears:

    ![TeX summation overlapping](https://cloud.githubusercontent.com/assets/7356565/25568386/0b88deb0-2e02-11e7-92be-f44783477f1f.png)

# Additional information

This doesn't seem to be related to KaTeX, since it properly displays summations outside Zulip. You can test it in [KaTeX's website](https://khan.github.io/KaTeX/).",YagoGG,b'area: LaTeX area: markdown bug',2017-04-30T22:09:13Z,2020-04-01T22:00:39Z
4655,Unread count in bankruptcy modal doesn't match unread counts elsewhere,"I unsubscribed from some streams which still had unread messages in them.  I then caught up on all other streams by narrowing to them.  Result:

- The favicon, the page title, and the ""Home"" row in the stream list pane all claimed that I had 0 unreads.
- Upon reloading the page, I was offered to declare bankruptcy on 950+ unreads.
- Upon declining bankruptcy, the home view scrolled to old unread messages in the unsubscribed streams.
- I tried manually scrolling forward a few messages in the home view, waiting a few seconds for sync, and then reloading the page.  After reload, the message cursor consistently returned to where I had just left it, and the unread count in the bankruptcy modal had the following behavior:
  - It always decreased by at least the number of unreads I had marked read.
  - It often decreased even if I had only scrolled past read messages, but by fewer than the total number of messages I had scrolled past.
  - If I reloaded immediately before reading a block of unreads and also immediately after, the bankruptcy counter decreased by exactly the number I marked read; this didn't ""shake loose"" any other phantom unreads.
- Eventually I was no longer offered bankruptcy, but the cursor still didn't automatically scroll forward to the end of the home view.

This seems consistent with the bankruptcy modal's unread count coming from the visible unsubscribed unreads in the home view plus invisible unsubscribed messages in muted topics.

I know the cursor behavior is expected, and I'd guess unread messages predating unsubscription are intentionally visible in the home view.  But it seems as though both unread counts are wrong: the bankruptcy modal apparently counts muted messages, and the unread count shown elsewhere doesn't include all visible unreads in the home view.  In any event, it's confusing that the bankruptcy modal's unread count doesn't match the one in the rest of the UI.",bgilbert,b'area: misc bug',2017-04-30T06:02:00Z,2019-08-26T21:15:18Z
4651,Clicking link that is a search term opens compose box,"When a search term is linked and you click on it, it opens the compose box.

For example, search [chiron](https://chat.zulip.org/#narrow/search/chiron).

Click the link above which takes you to the search link. Then click the highlighted link (because it matches the search term) again to open link in new tab AND it opens the compose box.",lonerz,b'area: compose bug good first issue help wanted priority: blocker',2017-04-29T03:52:26Z,2017-05-08T18:39:32Z
4639,Editing timeout message persists,"Somehow (I'm not sure how) I ended up with the ""This organization is configured to restrict editing of message content to 30 minutes after it is sent."" bubble sticking around, AFAICT forever. I'm using Firefox on Ubuntu.
![floating-edit-timeout-message](https://cloud.githubusercontent.com/assets/85198/25508602/335ad3f4-2b81-11e7-9c9b-0fe93b8eb605.png)
",dehnert,b'area: settings UI bug good first issue help wanted',2017-04-27T23:40:12Z,2019-07-23T14:22:04Z
4638,Edit history contents overlap with timestamps,"When I view the edit history of messages, the timestamps overlap with the messages. I'm seeing this on a couple different messages with Firefox on Ubuntu and OSX. Sample picture attached; messages in question are around https://chat.zulip.org/#narrow/near/193783/stream/general/topic/edit.20history.
![edit-history-overlap](https://cloud.githubusercontent.com/assets/85198/25508429/f305d23c-2b7f-11e7-9d2d-9d7e3a949314.png)
",dehnert,b'area: message-editing bug good first issue help wanted priority: blocker',2017-04-27T23:30:36Z,2017-06-06T18:06:29Z
4609,Fix left sidebar unread counts alignment issue,"
See https://github.com/zulip/zulip/pull/4539#issuecomment-297162134 for the issue; this is a recent regression.",timabbott,b'area: left-sidebar bug good first issue',2017-04-25T21:58:13Z,2017-04-26T20:44:38Z
4608,Inline URL previews don't handle relative URLs in open graph data,"The youtube image that should be here:

![image](https://cloud.githubusercontent.com/assets/2746074/25407489/5855c1dc-29bf-11e7-85c8-6f8b671b84c5.png)

is broken because we're not converting the relatively URL (starting with `/`) they provide in their open graph data into an absolute URL.  

Easy to reproduce, just send `youtube.com` in development.

Code should be in `add_embed` in `zerver/lib/bugdown/__init__.py`.",timabbott,b'area: markdown bug good first issue help wanted',2017-04-25T21:02:10Z,2017-05-04T23:54:52Z
4591,user settings: Avatar upload broken when you return to settings.,"To reproduce:
* Go to Settings
* Upload new avatar
* Exit settings
* Go to Settings

Expected behavior is that you'd see the new avatar, instead you see the old gravitar. Reloading fixes the problem.",rishig,b'area: settings (user) bug good first issue help wanted priority: blocker',2017-04-23T06:48:56Z,2017-05-11T18:41:49Z
4590,message edit: Pasting images is broken in message edit.,"To reproduce: 
* Copy a picture (e.g. a screenshot)
* Paste it into a compose box, to verify you have a picture in your clipboard
* Paste it into a message edit box

Observed behavior is nothing happens when pasting into the message edit box (either when pasting via keyboard shortcut or via right-click -> paste using mouse). ",rishig,b'area: message-editing bug help wanted priority: high',2017-04-22T22:44:05Z,2018-02-21T05:56:35Z
4581,message view: Remove day separator at top of message feed.,"Currently we do something like this at the top of every narrow:
![image](https://cloud.githubusercontent.com/assets/890911/25302141/5cddc6c6-26ec-11e7-908c-548c4d796710.png)

The ""--- April 18 ---"" shouldn't be there.

To investigate, I would start by looking at `timerender.js`, though the actual change needed may or may not be in that file.",rishig,b'area: message view bug good first issue help wanted priority: blocker',2017-04-22T06:47:51Z,2017-05-16T21:49:13Z
4573,message edit: Can horizontally resize past the edge of the page,"If you try to use the resize icon in the bottom right corner of the textarea, weird things can happen:
![image](https://cloud.githubusercontent.com/assets/8433005/25295216/aedbd6c0-26b0-11e7-96b9-fcd12c2da9f0.png)

Since that resize icon is basically nonfunctional besides that, I think it would be be best just to get rid of resize. Alternatively, we could enable vertical resize to make it kind of useful, and then lock the horizontal resizing.
",cory2067,b'area: message-editing bug good first issue help wanted',2017-04-21T20:38:24Z,2017-04-28T19:20:35Z
4569,A/D hotkeys cannot cross <hr> that separate active/inactive streams,"Using the A/D hotkeys I cannot go from active streams to inactive streams. I can only iterate through the streams of the same activity, all active or all inactive.

I'm pretty sure this is not the wanted behavior.",lonerz,b'area: keyboard UI area: left-sidebar bug good first issue help wanted priority: high',2017-04-21T07:40:48Z,2017-08-16T22:47:46Z
4560,"After upgrade to Zulip 1.5.1, Desktop App Message entry is half-width","After upgrade to Zulip 1.51, the message entry box has shrunk: 

![zulip-message-entry](https://cloud.githubusercontent.com/assets/5858581/25254617/d054e7a2-2669-11e7-8168-435c6f1c8d7b.png)

It still looks right in the direct web client (at least, in Chrome)",grahamegrieve,b'bug question',2017-04-20T22:09:40Z,2017-04-20T22:19:21Z
4557,Password reset request sends link for wrong zulipchat.com subdomain ,"My steps:

* Went to https://wikimedia.zulipchat.com and clicked ""register"".
* Entered my email address.
* Was told I already had an account and that I should enter my password.
* Clicked ""forgot password"", entered the email address, and clicked the reset button.
* Got to https://wikimedia.zulipchat.com/accounts/password/reset/done/ and was told I'd get an email to help me do the reset.
* Received ""Zulip password reset"" email giving me a reset link for a different Zulip organization which I'll call ""otherrealmname"": https://[otherrealmname].zulipchat.com/accounts/password/reset/[string] .

This is an outcome of #4284; will we fix that pretty soon, or should we have some kind of workaround until then to warn the user about the issue and help them work around it?",brainwane,b'area: authentication bug',2017-04-20T18:43:16Z,2017-04-25T05:00:06Z
4552,Make login/registration using GitHub authentication more seamless,"My steps:

* I went to https://wikimedia.zulipchat.com for the first time as a new user who hadn't registered for that instance yet.
* I clicked the ""log in with GitHub"" button.
* I confirmed that I wanted to allow the GitHub auth.
* The next page was https://zulipchat.com/find_my_team/ , which was confusing since I had come through the `wikimedia` team.
* I was a little confused (#3128) but entered my own email address and got the ""find my team"" confirmation page.
* I went back to https://wikimedia.zulipchat.com and clicked the ""Log in with GitHub"" button, and got directed to an error on https://wikimedia.zulipchat.com/accounts/login/?subdomain=1 : ""Your Zulip account is not a member of the organization associated with this subdomain. Please contact support@zulipchat.com with any questions!.""
* I realized I might need to register as its own step, instead of Zulip just auto-registering me via the GitHub login. I went to https://wikimedia.zulipchat.com/register/ and saw that there was a ""Sign Up with Google"" button but not a ""Sign Up with GitHub"" button.

So I have a few requests and figured I'd mention them here and we could decide which were worth splitting out into their own bugs:

1. Let users register & create accounts via GitHub auth, as we do with Google auth.
2. If the user tries to log in with GitHub but doesn't yet have an account, and it has open registration, tell them ""hey it sounds like you want to register an account for this instance since you don't have one yet?"" and lead them through registration.
3. Fix the extra punctuation in ""any questions!.""",brainwane,b'area: onboarding bug help wanted',2017-04-19T19:47:28Z,2017-06-15T10:19:33Z
4550,Internal Server Error When Signing in With GitHub,"Steps to Reproduce:
1. Open Zulip Electron or browser, and then enter `https://chat.zulip.org`.
2. Choose `Sign in with GitHub`.
3. Boom.

![screen shot 2017-04-19 at 10 33 57 pm](https://cloud.githubusercontent.com/assets/7262715/25185783/db0ee432-2550-11e7-9670-599c00fee20b.png)

Failed Request:
```
GET https://chat.zulip.org/complete/github/?redirect_state=MHjJP8pt7vOgNEocIAGK…sv0Sw6aIk&code=be6b6b7fe7a12e960f92&state=MHjJP8pt7vOgNEocIAGKd8Jsv0Sw6aIk 500 ()
```

This error happens to me 100% time and thus I cannot sign in. ",geeeeeeeeek,b'area: authentication bug',2017-04-19T14:47:07Z,2017-04-25T17:43:04Z
4545,Fix local storage leak from automatic reload system.,"When reloading a browser, we store in local storage some data to be accessed again as soon as it finishes loading.  However, if the reload fails, we never garbage-collect the old values.  See, for example:

![image](https://cloud.githubusercontent.com/assets/2746074/25163977/d5135168-2482-11e7-949e-152af717cb19.png)

We should do something similar to #4443 to clear these extra items, probably called from `reload.preserve_state` or something.

",timabbott,b'area: misc bug good first issue help wanted',2017-04-19T05:05:03Z,2017-04-26T16:15:37Z
4507,bugdown: Don't rstrip inline code blocks.,"We currently rstrip regular code blocks, to make copy-pasting from the terminal easier (see #3998). However, inline code blocks should keep all their spaces.

To work on this issue, I would start by reading http://zulip.readthedocs.io/en/latest/markdown.html and trying to understanding the code in #4185.
",rishig,b'area: markdown good first issue help wanted',2017-04-14T20:11:00Z,2017-12-14T12:48:11Z
4479,registration: Reset password form changes in size due to error messages.,"To reproduce in the dev environment:
* Go to the login page
* Click ""normal login page""
* Click ""Forgot password""
* Click on the link in the console
* Put a short password (like `a`)
* Click in another field, like confirm password. 

My guess is it has something to do with the error message, since the form changes in size every time the error message changes or appears/disappears.",rishig,b'area: authentication bug good first issue help wanted',2017-04-12T04:57:46Z,2017-05-05T21:52:27Z
4453,Inline image previews are not sorted in the same order as the links,"Apparently, our markdown inline image previews show the images in a random order, not the same order that the links to the images appeared in the message.  This can be quite confusing!

See, for example, https://chat.zulip.org/#narrow/near/186339/stream/design/topic/Starred.20messages.20in.20app",timabbott,b'area: markdown bug good first issue help wanted',2017-04-07T19:07:42Z,2017-04-18T03:48:49Z
4444,White space overlapping floating recipient bar on iPad blocking content,"See this screenshot (ignore the network error, the problem is the top recipient bar being half-cutoff):

![img_0307](https://cloud.githubusercontent.com/assets/2746074/24771887/2fb3a6cc-1ac4-11e7-881d-4dd85f81150c.PNG)

I can't reproduce this in Chrome on Linux, so I suspect it's an iPad-specific CSS issue.  

Reported by @ThePsychicVictini.
",timabbott,b'area: message view bug help wanted priority: blocker',2017-04-06T19:28:09Z,2017-05-16T21:49:13Z
4443,i18n local storage leak,"We seem to have an issue where Zulip's i18next caching of translation strings is being done in local storage, and doesn't have a mechanism to clear itself either over or time or when we deploy a new version of the Zulip server.  This means that on servers like chat.zulip.org that are deployed frequently, we end up with hundreds of entries in local storage:

![image](https://cloud.githubusercontent.com/assets/2746074/24771621/240b68e2-1ac3-11e7-96bc-e2ebbb944d19.png)

Each of these entries is quite large:

```
{""translation"":{""\n            This stream is currently <span class=\""icon-vector-globe\""></span> <b>a public stream</b>\n            which means anyone in the organization can join it. Making it private will mean that\n            only the invited members can join and access its content. Members of the stream can\n            invite others.\n            "":""\n            This stream is currently <span class=\""icon-vector-globe\""></span> <b>a public stream</b>\n            which means anyone in the organization can join it. Making it private will mean that\n            only the invited members can join and access its content. Members of the stream can\n            invite others.\n            "",""\n            This stream is currently <span class=\""icon-vector-lock\""></span> <b>an invite-only stream</b>\n            which means only invited members can join and access its content. Making it public will make\n            it possible for anyone in your organization to join and access it.\n            "":""\n            This stream is currently <span class=\""icon-vector-lock\""></span> <b>an invite-only stream</b>\n            which means only invited members can join and access its content. Making it public will make\n            it possible for anyone in your organization to join and access it.\n            "",""\n        <b>Streams</b> are like chat rooms or mailing lists. You can easily\n        <b>join</b>, <b>leave</b>, and <b>make</b> them.\n        "":""\n        <b>Streams</b> are like chat rooms or mailing lists. You can easily\n        <b>join</b>, <b>leave</b>, and <b>make</b> them.\n        "",""\n        <p class=\""api-key-note\"">For most bots using the API, you'll want to give each bot\n          its own name and API key using the above section.  But if you\n          want to write a bot that can access your own private\n          messages, you should use your personal API key.\n        </p>\n        "":""\n        <p class=\""api-key-note\"">For most bots using the API, you'll want to give each bot\n          its own name and API key using the above section.  But if you\n          want to write a bot that can access your own private\n          messages, you should use your personal API key.\n        </p>\n        "",""\n        The <b>topic</b> of a conversation is one or two words that describe\n        what it is about, for example: <b>Bug #345</b>, <b>lunch</b>, or\n        <b>logo</b>. Don't overthink it.\n        "":""\n        The <b>topic</b> of a conversation is one or two words that describe\n        what it is about, for example: <b>Bug #345</b>, <b>lunch</b>, or\n        <b>logo</b>. Don't overthink it.\n        "",""\n      <p>Please re-enter your password to confirm your identity.\n        (<a href=\""/accounts/password/reset/\"" target=\""_blank\"">Forgotten it?</a>)</p>\n      "":""\n      <p>Please re-enter your password to confirm your identity.\n        (<a href=\""/accounts/password/reset/\"" target=\""_blank\"">Forgotten it?</a>)</p>\n      "",""\n      Configure regular expression patterns that will be\n      automatically linkified when used in Zulip message bodies or\n      topics.  For example to automatically linkify commit IDs and\n      issue numbers (e.g. #123) to the corresponding items in a GitHub\n      project, you could use the following:\n      "":""\n      Configure regular expression patterns that will be\n      automatically linkified when used in Zulip message bodies or\n      topics.  For example to automatically linkify commit IDs and\n      issue numbers (e.g. #123) to the corresponding items in a GitHub\n      project, you could use the following:\n      "",""\n    <p class=\""bot-settings-note padded-container\"">\n      Looking for our <a href=\""/integrations\"" target=\""_blank\"">Integrations</a>\n      or <a href=\""{{ server_uri }}/api\"" target=\""_blank\"">API</a> documentation?\n    </p>\n    "":""\n    <p class=\""bot-settings-note padded-container\"">\n      Looking for our <a href=\""/integrations\"" target=\""_blank\"">Integrations</a>\n      or <a href=\""{{ server_uri }}/api\"" target=\""_blank\"">API</a> documentation?\n    </p>\n    "",""\n    <p><b>Reply</b> to a message by <b>clicking on it</b>. The stream\n        and topic will automatically be filled in.</p>\n    "":""\n    <p><b>Reply</b> to a message by <b>clicking on it</b>. The stream\n        and topic will automatically be filled in.</p>\n    "",""\n    <p>Lets everyone know about the new stream,<br />\n    even if you don't add them.</p>\n    "":""\n    <p>Lets everyone know about the new stream,<br />\n    even if you don't add them.</p>\n    "",""\n    <p>You can <b>narrow</b> to a stream or topic by <b>clicking on it</b>, or\n       see messages from all streams at once from your Home view.</p>\n    "":""\n    <p>You can <b>narrow</b> to a stream or topic by <b>clicking on it</b>, or\n       see messages from all streams at once from your Home view.</p>\n    "","" was too large; the maximum file size is 25MiB."":"" was too large; the maximum file size is 25MiB."",""(no topic)"":""(no topic)"",""<p>Messages in __page_params.product_name__ go to a <b>stream</b> and have a <b>topic</b>.</p>"":""<p>Messages in __page_params.product_name__ go to a <b>stream</b> and have a <b>topic</b>.</p>"",""<strong>__name__</strong> is not subscribed to this stream."":""<strong>__name__</strong> is not subscribed to this stream."",""@ Compose a message @-mentioning <b>__name__</b>"":""@ Compose a message @-mentioning <b>__name__</b>"",""@ Compose a reply @-mentioning __message.sender_full_name__"":""@ Compose a reply @-mentioning __message.sender_full_name__"",""A stream needs to have a name"":""A stream needs to have a name"",""A stream with this name already exists"":""A stream with this name already exists"",""API Key"":""API Key"",""Action"":""Action"",""Actions"":""Actions"",""Add"":""Add"",""Add a new alert word"":""Add a new alert word"",""Add a new emoji"":""Add a new emoji"",""Add a new filter"":""Add a new filter"",""Add alert word"":""Add alert word"",""Add emoji"":""Add emoji"",""Add emoji reaction"":""Add emoji reaction"",""Add extra emoji for members of the __realm_name__ organization."":""Add extra emoji for members of the __realm_name__ organization."",""Add filter"":""Add filter"",""Add new default stream"":""Add new default stream"",""Add reaction..."":""Add reaction..."",""Added successfully!"":""Added successfully!"",""Alert Word"":""Alert Word"",""Alert words allow you to be notified as if you were @-mentioned when certain words or phrases are used in Zulip."":""Alert words allow you to be notified as if you were @-mentioned when certain words or phrases are used in Zulip."",""Alert words can't be empty!"":""Alert words can't be empty!"",""Allow Subdomains"":""Allow Subdomains"",""Allowed domains"":""Allowed domains"",""Already subscribed to __stream__"":""Already subscribed to __stream__"",""Always auto-scroll to new messages"":""Always auto-scroll to new messages"",""An unknown error occured."":""An unknown error occured."",""Announce stream"":""Announce stream"",""Any user may now add new emoji!"":""Any user may now add new emoji!"",""Any user may now create new streams!"":""Any user may now create new streams!"",""Any user may now invite new users!"":""Any user may now invite new users!"",""Anyone can join"":""Anyone can join"",""Apply this change to all stream subscriptions?"":""Apply this change to all stream subscriptions?"",""Are you sure you want to do this?"":""Are you sure you want to do this?"",""Are you sure you want to mention all <strong>__count__</strong> people in this stream?"":""Are you sure you want to mention all <strong>__count__</strong> people in this stream?"",""Audible notifications"":""Audible notifications"",""Authentication methods"":""Authentication methods"",""Authentication methods saved!"":""Authentication methods saved!"",""Author"":""Author"",""Bot"":""Bot"",""Bots"":""Bots"",""Bringing you to your latest messages…"":""Bringing you to your latest messages…"",""By deactivating <strong><span class=\""user_name\""></span></strong> &lt;<span class=\""email\""></span>&gt;, they will be logged out immediately."":""By deactivating <strong><span class=\""user_name\""></span></strong> &lt;<span class=\""email\""></span>&gt;, they will be logged out immediately."",""By deactivating your account, you will be logged out immediately."":""By deactivating your account, you will be logged out immediately."",""Cancel"":""Cancel"",""Change"":""Change"",""Change Password"":""Change Password"",""Change default language"":""Change default language"",""Change email"":""Change email"",""Change later messages to this topic"":""Change later messages to this topic"",""Change notification settings for individual streams on your <a href=\""/#subscriptions\"">Streams page</a>."":""Change notification settings for individual streams on your <a href=\""/#subscriptions\"">Streams page</a>."",""Change only this message topic"":""Change only this message topic"",""Change previous and following messages to this topic"":""Change previous and following messages to this topic"",""Change stream privacy"":""Change stream privacy"",""Check all"":""Check all"",""Choose custom color"":""Choose custom color"",""Clear avatar"":""Clear avatar"",""Close"":""Close"",""Collapse"":""Collapse"",""Compose a message to <b>__name__</b>"":""Compose a message to <b>__name__</b>"",""Compose a message to stream <b>__stream.name__</b>"":""Compose a message to stream <b>__stream.name__</b>"",""Configure the authentication methods for the __domain__ organization."":""Configure the authentication methods for the __domain__ organization."",""Configure the default streams new users are subscribed to when joining the {{domain}} organization."":""Configure the default streams new users are subscribed to when joining the {{domain}} organization."",""Confirm password"":""Confirm password"",""Content"":""Content"",""Copy from Stream"":""Copy from Stream"",""Could not add user to this stream"":""Could not add user to this stream"",""Could not fetch subscriber list"":""Could not fetch subscriber list"",""Create"":""Create"",""Create bot"":""Create bot"",""Create stream"":""Create stream"",""Current password"":""Current password"",""Custom alert words"":""Custom alert words"",""Custom emoji"":""
```

We definitely need to fix this.  Options include:
* Adding some mechanism to auto-delete the i18n caching entries with the oldest numbers in local storage if there are more than 5 such entries.
* Adding some time-based expiry mechanism.
* Something else

I discovered this because I actually ran out of quota in my browser's local storage from this...
",timabbott,b'area: i18n bug help wanted',2017-04-06T19:21:15Z,2017-04-12T16:33:44Z
4425,Phabricator integrations page is misformatted,"![image](https://cloud.githubusercontent.com/assets/2746074/24725548/3e91deb8-1a04-11e7-937c-a69150ccffc6.png)
",timabbott,b'area: integrations bug good first issue help wanted',2017-04-05T20:32:09Z,2017-04-06T00:45:55Z
4407,Trello integration help corrupts everything,"1. Go to [Trello integration help](https://chat.zulip.org/integrations/#trello).
2. Click **legacy Trello cron-based integration** link.
3. All the data from Trello help page will be carried over to Trello Legacy help page. In fact, if you try to go to any other integration help page, e.g. [Airbrake](https://chat.zulip.org/integrations/#airbrake), it will include Trello help data.",umairwaheed,b'area: integrations bug',2017-04-04T06:27:46Z,2017-04-06T20:59:51Z
4401,Previously pinned stream is still pinned when resubscribed,"1. Subscribe to a stream.
2. Pin that stream to the top.
3. Unsubscribe to that stream.
4. Witness #4395 horizontal line.
5. Resubscribe to the stream.
6. The stream is automatically pinned to the top.

Is this supposed to happen?",lonerz,b'area: left-sidebar bug good first issue',2017-04-03T18:45:51Z,2017-04-04T01:42:53Z
4395,Horizontal line stays after you unsubscribed from pinned channel,"If you have only one pinned channel and you unsubscribe from it, `<hr>` stays and dissappears after refreshing the page.
**Small addition**:  If you have regular streams + inactive and then unsubsribe from all regular, `<hr>` stays.",misteraverin,b'area: left-sidebar bug good first issue',2017-04-03T10:10:01Z,2017-04-12T00:07:23Z
4376,Pressing enter in user search when search field is empty shouldn't open compose box,"1. Press `q` (hotkey) to focus on search field in user list.
2. Press enter and the compose box opens.

This should just be a simple addition of `stopPropagation` or `preventDefault`.",lonerz,b'area: right-sidebar bug good first issue',2017-03-31T18:42:01Z,2017-04-20T05:18:31Z
4360,Message with mention stays highlighted red when deleted,"1. Mention yourself.
2. See that the message is highlighted red.
3. Delete the message, should show up as ""(deleted)""
4. The message is still red.

This is also a problem with not supporting in-edit mentions. Probably fix both for this issue.

Link to [zulip chat](https://chat.zulip.org/#narrow/near/181494/stream/design/topic/deleted.20mentioned.20message).",lonerz,b'area: message view area: message-editing bug good first issue help wanted',2017-03-30T05:26:21Z,2017-12-10T06:53:29Z
4357,markdown: Buggy local echo when having an alert word besides an emoji.,"To reproduce:
1: Add `emoji` as an alert word.
2: Type `emoji :smile:` or `:smile: emoji`.
3: It will get rendered like this:
![image](https://cloud.githubusercontent.com/assets/16687990/24479616/b991f2ee-14fd-11e7-8763-4b714f19a289.png)
4: If you have some other alert word, e.g., besides `emoji` like `abc`, then following will also have the same behavior:
`abc :smile:` or `:smile: abc`.

Removing the `emoji` from the list of alert words will restore the normal behavior. Looks like markdown parser is mucking up the rendered content as well.",HarshitOnGitHub,b'area: markdown bug good first issue help wanted',2017-03-29T22:35:42Z,2017-08-01T04:22:52Z
4351,the tornado server is interrupted in some situation,"I run zulip server in DEVELOP mod, the tornado server is interrupted every 2 or 3 days, I got this error:
below ,and found the process of tornado is also stopped. Anyone can help me to solve this ? thanks!

39228 2017-03-29 03:06:39,202 ERROR    Traceback (most recent call last):
39229   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/handlers/base.py"", line 132, in get_response
39230     response = wrapped_callback(request, *callback_args, **callback_kwargs)
39231   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
39232     return view_func(*args, **kwargs)
39233   File ""/root/qj/zulip-msg-server/zerver/lib/rest.py"", line 134, in rest_dispatch
39234     return target_function(request, **kwargs)
39235   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
39236     return view_func(*args, **kwargs)
39237   File ""/root/qj/zulip-msg-server/zerver/decorator.py"", line 395, in _wrapped_func_arguments
39238     return rate_limit()(view_func)(request, profile, *args, **kwargs)
39239   File ""/root/qj/zulip-msg-server/zerver/decorator.py"", line 606, in wrapped_func
39240     return func(request, *args, **kwargs)
39241   File ""/root/qj/zulip-msg-server/zerver/lib/request.py"", line 160, in _wrapped_view_func
39242     return view_func(request, *args, **kwargs)
39243   File ""/root/qj/zulip-msg-server/zerver/views/__init__.py"", line 1139, in api_events_register
39244     all_public_streams=all_public_streams)
39245   File ""/root/qj/zulip-msg-server/zerver/lib/request.py"", line 160, in _wrapped_view_func
39246     return view_func(request, *args, **kwargs)
39247   File ""/root/qj/zulip-msg-server/zerver/views/__init__.py"", line 1167, in events_register_backend
39248     narrow=narrow)
39249   File ""/root/qj/zulip-msg-server/zerver/lib/actions.py"", line 3110, in do_events_register
39250     narrow=narrow)
39251   File ""/root/qj/zulip-msg-server/zerver/lib/event_queue.py"", line 590, in request_event_queue
39252     params=req)
39253   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/requests/sessions.py"", line 488, in get
39254     return self.request('GET', url, **kwargs)
39255   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/requests/sessions.py"", line 475, in request
39256     resp = self.send(prep, **send_kwargs)
39257   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/requests/sessions.py"", line 596, in send
39258     r = adapter.send(request, **kwargs)
39259   File ""/srv/zulip-venv/local/lib/python2.7/site-packages/requests/adapters.py"", line 487, in send
39260     raise ConnectionError(e, request=request)
39261 ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=9993): Max retries exceeded with url: /api/v1/events?dont_block=true&lifespan_secs=0&user_client=Mozilla&client=internal&narrow=%5B%5D&apply_ma      rkdown=false&all_public_streams=false (Caused by NewConnectionError('<requests.packages.urllib3.connection.HTTPConnection object at 0x7f3394dd0390>: Failed to establish a new connection: [Errno 111] Con      nection refused',))
",qj739,b'area: tooling bug help wanted',2017-03-29T08:33:32Z,2018-05-20T23:54:26Z
4340,Drafts deletion using delete hotkey triggers stream escape in the background,"When you press `delete` to delete a selected draft in the draft overlay while narrowed in a stream, it deletes the draft, but also changes stream, causing the draft overlay to close by itself.",JPJPJPOPOP,b'area: keyboard UI bug good first issue',2017-03-28T00:57:22Z,2017-03-28T04:45:31Z
4331,Clicking a link in the message feed defocuses the compose box,"If you click a link in the message feed to another site, the compose box loses focus, which is slightly annoying if you're consulting some linked-to resource as part of drafting a reply.  

I suspect this is effectively a bug in how we fixed the earlier issue that clicking a link in the message feed would focus the link (causing `enter` to re-open the link).  ",timabbott,b'area: message view bug good first issue help wanted priority: high',2017-03-27T19:16:19Z,2017-09-08T18:30:58Z
4329,Action popover menu arrow stays visible even though exited,"The correct behavior is when you click the arrow or use the `i` hotkey, and hit `esc`, and the actions popover selection arrow disappears.

However, if you click the arrow, then click it again to close it, the actions popover selection arrow still stays visible. Similarly, if you press `i` to open and `i` a second time to close, the arrow stays visible.

![message_menu_arrow_visible](https://cloud.githubusercontent.com/assets/13565154/24339588/82e64b9e-1261-11e7-962b-7bff44fd58b7.png)
",JPJPJPOPOP,b'area: message view bug good first issue',2017-03-27T03:19:54Z,2017-06-20T10:28:58Z
4317,MacOS and Windows images not showing in /apps,Images for [MacOS](https://zulipchat.com/apps/#mac) and [Windows](https://zulipchat.com/apps/#windows) not being displayed in [https://zulipchat.com/apps](https://zulipchat.com/apps).,janakamarasena,b'bug',2017-03-26T05:21:33Z,2017-04-01T15:50:56Z
4313,"prod clean install fails on ""Invalid requirement: 'api/'""","When I do a clean prod install with a tarball built from master, I get an error running the install script. This has happened with several clean installs. But if I restart it, it completes. I don't see this in a different branch that hasn't been updated in a few days. 

There's a recent commit that added a new requirement `api/` in `requirements/common.txt`, which was formerly in `dev.txt`. Is it something about that?

https://github.com/zulip/zulip/commit/ce2c3fbb06bc18c9966ed6051eb83579cf6e3d39

Here's the last part of running `/root/zulip/scripts/setup/install`

```
Successfully installed pip wheel
Cleaning up...
Invalid requirement: 'api/'
It looks like a path. Does it exist ?
/srv/zulip-venv-cache/27ae06af0f1e1022553ce4c635e88440c06a6263/zulip-venv/local/lib/python2.7/site-packages/pip/_vendor/requests/packages/urllib3/util/ssl_.py:318: SNIMissingWarning: An HTTPS request has been made, but the SNI (Subject Name Indication) extension to TLS is not available on this platform. This may cause the server to present an incorrect TLS certificate, which can cause validation failures. You can upgrade to a newer version of Python to solve this. For more information, see https://urllib3.readthedocs.io/en/latest/security.html#snimissingwarning.
  SNIMissingWarning
/srv/zulip-venv-cache/27ae06af0f1e1022553ce4c635e88440c06a6263/zulip-venv/local/lib/python2.7/site-packages/pip/_vendor/requests/packages/urllib3/util/ssl_.py:122: InsecurePlatformWarning: A true SSLContext object is not available. This prevents urllib3 from configuring SSL appropriately and may cause certain SSL connections to fail. You can upgrade to a newer version of Python to solve this. For more information, see https://urllib3.readthedocs.io/en/latest/security.html#insecureplatformwarning.
  InsecurePlatformWarning
+ apt-get -y install build-essential libffi-dev libfreetype6-dev libz-dev libjpeg-dev libldap2-dev libmemcached-dev python3-dev python-dev python-pip python-virtualenv libxml2-dev libxslt1-dev libpq-dev
+ sudo rm -rf /srv/zulip-venv-cache/27ae06af0f1e1022553ce4c635e88440c06a6263/zulip-venv
+ sudo mkdir -p /srv/zulip-venv-cache/27ae06af0f1e1022553ce4c635e88440c06a6263/zulip-venv
+ sudo virtualenv -p python2 /srv/zulip-venv-cache/27ae06af0f1e1022553ce4c635e88440c06a6263/zulip-venv
+ sudo chown -R 0:0 /srv/zulip-venv-cache/27ae06af0f1e1022553ce4c635e88440c06a6263/zulip-venv
+ pip install -U setuptools
+ pip install --upgrade pip wheel
+ pip install --no-deps --requirement /root/zulip/requirements/py2_prod.txt

Error running a subcommand of /root/zulip/scripts/lib/create-production-venv: pip install --no-deps --requirement /root/zulip/requirements/py2_prod.txt
Actual error output for the subcommand is just above this.

Traceback (most recent call last):
  File ""/root/zulip/scripts/lib/create-production-venv"", line 28, in <module>
    virtualenv_args=['-p', 'python{}'.format(python_version)])
  File ""/root/zulip/scripts/lib/setup_venv.py"", line 215, in setup_virtualenv
    do_setup_virtualenv(cached_venv_path, requirements_file, virtualenv_args or [])
  File ""/root/zulip/scripts/lib/setup_venv.py"", line 249, in do_setup_virtualenv
    run([""pip"", ""install"", ""--no-deps"", ""--requirement"", requirements_file])
  File ""/root/zulip/scripts/lib/zulip_tools.py"", line 98, in run
    subprocess.check_call(args, **kwargs)
  File ""/usr/lib/python2.7/subprocess.py"", line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['pip', 'install', '--no-deps', '--requirement', '/root/zulip/requirements/py2_prod.txt']' returned non-zero exit status 1
```",feorlen,b'area: production installer bug',2017-03-26T01:35:36Z,2017-03-26T02:49:56Z
4312,Fix line-wrapping for integer administration settings fields,"See
![image](https://cloud.githubusercontent.com/assets/2746074/24327492/938ac8ba-1187-11e7-9cc2-ad9b38e2f00d.png)


@brockwhittaker I'm assigning this one to you since while it would seem we could just change this CSS:


```
.new-style .grid label {                                                                                                         
    width: 200px;                                                                                                                
}                                                                                                                                
```

I'm not sure whether there was a reason why 200px was selected there...  

Not that since there are labels, we want to make it look good even if the text is like 2x longer (for e.g. the German translation)",timabbott,b'area: settings UI bug good first issue',2017-03-26T01:21:19Z,2017-03-30T21:00:48Z
4311,stream creation: Small bugs in stream name and description.,"In the subscriptions modal, after clicking `+` to create a new stream.
* Up and down arrow are not correctly captured by the text boxes on the right hand panel (e.g. stream name, stream description, filter). Probably a `stopPropagation()` is all that's needed.
* If you partially fill out a name and description, leave the page, and come back (e.g. by clicking on a stream on the left), it restores the stream description but not the stream name.

",rishig,b'area: stream settings bug good first issue help wanted',2017-03-26T01:00:37Z,2017-04-05T00:22:51Z
4308,:zulip: emoji is not rendered in emoji picker.,"When using Zulip chat from web, :zulip: emoji is rendered correctly in messages but appears as a blank box in emoji picker.

Also, on Android App, :zulip: emoji doesn't render at all.",nikhilhassija,b'area: emoji bug',2017-03-25T21:51:01Z,2017-04-30T23:43:07Z
4289,traceback: accessing deactivated users for reactions,"
Message:
Cannot read property 'full_name' of undefined

Stacktrace:
TypeError: Cannot read property 'full_name' of undefined
    at d (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1817:34)
       = static/js/reactions.js line 111 column 12

    at Array.map (native)

    at a (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1817:187)
       = static/js/reactions.js line 122 column 22

    at https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1823:99
       = static/js/reactions.js line 228 column 20

    at Array.map (native)

    at Object.c.get_message_reactions (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1822:502)
       = static/js/reactions.js line 223 column 21

    at https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1220:11
       = static/js/message_list_view.js line 187 column 37

    at Function.h.each.h.forEach (https://veelo.zulipchat.com/static/min/common.4584f908a1d2.js:219:291)
       = static/node_modules/underscore/underscore.js line 153 column 9

    at MessageListView.build_message_groups (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1219:481)
       = static/js/message_list_view.js line 186 column 9

    at MessageListView.render (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1227:184)
       = static/js/message_list_view.js line 468 column 34

    at MessageListView.prepend (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1238:302)
       = static/js/message_list_view.js line 888 column 13

    at MessageList.prepend (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1250:474)
       = static/js/message_list.js line 418 column 9

    at MessageList.add_messages (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1242:368)
       = static/js/message_list.js line 74 column 13

    at Object.add_messages (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1631:503)
       = static/js/message_util.js line 21 column 5

    at h (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1639:746)
       = static/js/message_fetch.js line 37 column 9

    at k (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1640:286)
       = static/js/message_fetch.js line 73 column 5

    at success (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1642:42)
       = static/js/message_fetch.js line 104 column 13

    at Object.a.success (https://veelo.zulipchat.com/static/min/app.737d5314c023.js:1137:348)
       = static/js/channel.js line 68 column 16

    at Object.g [as success] (https://veelo.zulipchat.com/static/min/common.4584f908a1d2.js:251:25)
       = static/js/blueslip.js line 221 column 20

    at h (https://veelo.zulipchat.com/static/min/common.4584f908a1d2.js:99:423)
       = static/node_modules/jquery/dist/jquery.js line 3232 column 11

    at Object.fireWith [as resolveWith] (https://veelo.zulipchat.com/static/min/common.4584f908a1d2.js:101:153)
       = static/node_modules/jquery/dist/jquery.js line 3362 column 7

    at f (https://veelo.zulipchat.com/static/min/common.4584f908a1d2.js:190:478)
       = static/node_modules/jquery/dist/jquery.js line 9836 column 5

    at XMLHttpRequest.c (https://veelo.zulipchat.com/static/min/common.4584f908a1d2.js:203:218)
       = static/node_modules/jquery/dist/jquery.js line 10302 column 8
",showell,b'area: message view area: misc bug',2017-03-24T16:52:36Z,2017-03-26T20:09:14Z
4288,traceback: left arrow hotkey,"  at Object.l.fatal (https://recurse.zulipchat.com/static/min/common.4584f908a1d2.js:254:105)
       = static/js/blueslip.js line 400 column 27

    at MessageList.select_id (https://recurse.zulipchat.com/static/min/app.737d5314c023.js:1244:437)
       = static/js/message_list.js line 162 column 13

    at Object.e.edit_last_sent_message (https://recurse.zulipchat.com/static/min/app.737d5314c023.js:1438:362)
       = static/js/message_edit.js line 373 column 9

    at Object.a.process_hotkey (https://recurse.zulipchat.com/static/min/app.737d5314c023.js:1587:287)
       = static/js/hotkey.js line 524 column 9

    at Object.a.process_keydown (https://recurse.zulipchat.com/static/min/app.737d5314c023.js:1591:121)
       = static/js/hotkey.js line 653 column 12

    at HTMLDocument.<anonymous> (https://recurse.zulipchat.com/static/min/app.737d5314c023.js:1591:176)
       = static/js/hotkey.js line 657 column 9

    at HTMLDocument.g (https://recurse.zulipchat.com/static/min/common.4584f908a1d2.js:251:25)
       = static/js/blueslip.js line 221 column 20

    at HTMLDocument.dispatch (https://recurse.zulipchat.com/static/min/common.4584f908a1d2.js:125:73)
       = static/node_modules/jquery/dist/jquery.js line 5225 column 16

    at HTMLDocument.h.handle (https://recurse.zulipchat.com/static/min/common.4584f908a1d2.js:118:327)
       = static/node_modules/jquery/dist/jquery.js line 4878 column 6",showell,b'area: keyboard UI bug',2017-03-24T16:49:52Z,2017-03-27T16:37:53Z
4287,message edit: Edit and save removes the edit pencil.,"If you edit a message and click save, the on-hover pencil edit icon next to the timestamp doesn't show up until your mouse leaves the message box. The other two icons do. 

This should hopefully be a fairly quick fix if someone wants to take it up!",rishig,b'area: message-editing bug good first issue help wanted priority: high',2017-03-24T16:49:06Z,2017-06-15T19:25:14Z
4282,"Fix real-time sync race for presence events with new ""aggregated"" field","There's a new test in `test_events.py`, `test_presence_events`, which I added today, but is basically disabled, because our code in `zerver/lib/events.py` for handling the ""presence"" event type doesn't update the `aggregated` section of the state.  I think fixing this involves writing some short but somewhat thorny code in `zerver/lib/events.py` to merge the data for the user whose presence state was updated.

This is a follow-up to #3633.

http://zulip.readthedocs.io/en/latest/events-system.html is useful reading on how this is supposed to work.

@kkanahin probably makes sense for you to take this one, since you wrote the original aggregated code.",timabbott,b'area: real-time sync bug',2017-03-24T05:49:21Z,2017-04-26T20:20:52Z
4260,font: Ligatures like ff have strange behavior,"Copying conversation from https://chat.zulip.org/#narrow/stream/issues/topic/ligatures

--
If you type something with two f's and then left arrow back over it, you get somewhat strange behavior, since the ff is turned into a ligature. 
I managed to get stranger behavior as well by using backspace instead of left arrow, though I don't have a repro at the moment. If we turn off ligatures, would that break accented characters? (fwiw, slack and gchat seem to handle the ff case fine)

--
I have been able to reproduce the left arrow thing (or any other attempt of moving the cursor between both f's). The cursor stays after the last f, but if you type the text appears between them.
Something curious also happens if you click between both f's. The cursor should appear between the f's, but it doesn't. Actually, if you type new text, it appears after the ligature.

--
This happens in the compose box, search boxes, edit box, etc.
@brockwhittaker in case you want to take a look.

(Marking as a bug, but feel free to remove if this feels more like an enhancement than a bug.)",rishig,b'area: browser-support bug good first issue help wanted',2017-03-23T03:08:53Z,2019-04-25T04:01:36Z
4256,"stream list: Once a stream is marked as inactive, it never re-activates.","A stream is considered inactive (namely, has the CSS class `inactive_stream`), if it has no messages among the messages currently loaded in the browser. See `exports.is_active` in `static/js/stream_data.js`. 

We label streams as inactive (or not) when initially loading the webapp (see `build_stream_sidebar_row` in `stream_list.js`). However, we don't update this designation if an inactive stream gets a new message after load. (An active stream can never become inactive, since we don't garbage collect old messages from the browser, I believe.)

A good solution might be to just `removeClass('inactive_stream')` every time a new message comes in to a stream. 
",rishig,b'area: left-sidebar bug good first issue help wanted',2017-03-23T02:34:02Z,2017-04-18T22:53:57Z
4252,markdown: Backend isn't rendering second level markdown.,"The local echo seems to get this right, but the backend is not:
```
* top level item 1
  * second level item a
  * second level item b
```
This should result in the lines with items `a` and `b` being indented relative to the top line, which they currently are not.

http://zulip.readthedocs.io/en/latest/markdown.html has some information about Zulip's markdown processor.",rishig,b'area: markdown bug good first issue help wanted',2017-03-23T00:48:37Z,2017-04-07T23:15:48Z
4251,Clicking the bottom half of an avatar doesn't open the user profile panel,"Currently, if you click the top half of the avatar or the user's name, you get the (new and fancy!) user profile popover; otherwise you get start composing a reply.  We should fix it so that the profile popover shows up if you click anywhere on the avatar.

I did a bit of work on trying to figure this out, and I think the problem is that clicking on the bottom half of the avatar actually is handled as a click on the  `.message_content` area, not the `.message_top_line` area and thus in turn, the avatar.

Perhaps this comes from the avatar using `background-image` CSS?

@brockwhittaker this may be a good issue for you.",timabbott,b'area: message view bug help wanted',2017-03-22T23:24:42Z,2017-03-23T22:23:33Z
4245,Weird horizontal scrollbar with ultra-long inline code blocks,"![image](https://cloud.githubusercontent.com/assets/2746074/24221261/df8dbe18-0f0a-11e7-94cb-5bb7e645665b.png)
",timabbott,b'area: message view bug good first issue help wanted',2017-03-22T21:22:07Z,2017-03-23T22:20:01Z
4232,Form to add new default stream does not have a submit button,Admins cannot add a default stream because there is no submit button for the form that sends a request to create a default stream.,wangjames,b'area: settings (admin/org) bug good first issue help wanted',2017-03-22T05:59:36Z,2017-05-16T03:37:34Z
4223,Fix CSS for avatar upload widget ,"The ""Uploading..."" text appears in a weird place; I think probably we can just remove the text, given that we have a loading spinner anyway.

There may be a similar issue with the organization upload widget.",timabbott,b'area: uploads bug good first issue help wanted',2017-03-21T23:14:43Z,2017-04-05T19:22:20Z
4218,Reactions addition feature broken with /me messages ,"Reproducer:

* Send a message using `/me`, e.g. `/me message`
* React to it.
* Hover over the reactions area.
* The smiley button that's usually to the right of the existing reactions will only appear when your cursor is over a smaller corner of it; usually it'll look like this:

![image](https://cloud.githubusercontent.com/assets/2746074/24171948/b03ac52e-0e43-11e7-898a-74bb39e89e0b.png)

This is probably an issue with the HTML layering or something inside the `/me` messages markup.",timabbott,b'area: emoji bug good first issue help wanted',2017-03-21T21:37:51Z,2017-04-20T21:49:51Z
4210,Remove redundant lines from bottom of integration documentation,"When We click on any integrations on ```http://localhost:9991/integrations/``` then there are two redundant lines at the bottom of the integration documentations page 
```
The official Hubot integration provides an extension point for additional Zulip integrations.

A non-comprehensive list of integrations available through Hubot follows below:
```

These lines should be appeared on the homepage of integration only. (only on /integrations url)

Code to look in ```templates/zerver/integrations.html``` and ```zerver/webhooks```.",sinwar,b'area: integrations bug good first issue help wanted',2017-03-21T17:22:46Z,2017-03-22T02:04:38Z
4209,Fix buggy interaction between default streams and inviting users to join an organization,"Right now, if you use default streams and invite users to join an organization, you have a super confusing experience.  

The ""invite users"" UI predates the default streams feature, and default streams are what you get if you aren't invited with a list of streams (so default streams does nothing if you're inviting someone to join, which makes no sense).  It seems pretty clear that we should just have the default list for inviting a user match the default streams for the organization, and then the user can modify if they like while they're at it for just that one user.  
",timabbott,b'area: onboarding bug good first issue help wanted priority: blocker',2017-03-21T17:13:25Z,2017-03-25T14:11:26Z
4208,Bug in change language settings in Display settings,"![bug](https://cloud.githubusercontent.com/assets/13533873/24153137/9e8035c8-0e73-11e7-8c4d-45b41b35c6dc.png)
The popup modal to choose default language is not scrollable & gets hidden.Works fine in mobile view though.
",Lplenka,b'area: settings UI bug good first issue help wanted',2017-03-21T14:50:51Z,2017-04-04T19:19:12Z
4202,Editing stream descriptions seems to jump you to the end of the description frequently,"Try opening the stream settings UI as an administrator, and editing the stream description.  The content-editable area will highlight, you can type things at the end, but if you try typing things not at the end, the character appears but your cursor gets jumped to the end.

Also, the escape key no longer works in that widget; the cause may be the same.",timabbott,b'area: stream settings bug good first issue help wanted',2017-03-21T05:27:59Z,2017-03-22T19:21:49Z
4201,"Pressing down in gear menu stops at ""Settings""","When you tab into the gear menu and press down to go to ""User documentation,"" you get stuck at ""Settings"" and can't go further until you tab.",lonerz,b'area: keyboard UI area: settings UI bug good first issue',2017-03-21T04:24:31Z,2017-04-11T23:32:51Z
4200,ESC doesn't close the gear menu,"Open the gear menu in the top right hand corner. Press ESC. It should close the gear menu but doesn't.

This should be a recent regression from the gear hotkey push.",lonerz,b'area: keyboard UI area: settings UI bug good first issue help wanted',2017-03-21T04:20:52Z,2017-05-23T17:35:34Z
4189,"Buggy local echo when ""@foo bar"" is used to mention","To reproduce the error type `@cordelia lear` without the asterisk of mention shortcut.
The result would be somewhat of this sort: 
![image](https://cloud.githubusercontent.com/assets/16012015/24122743/07926608-0de3-11e7-81ec-3d654867d1ba.png)
You might also wanna look at #4074 .",mahimg,b'area: markdown bug help wanted priority: high',2017-03-20T21:34:39Z,2017-06-19T20:58:01Z
4182,Thumbs up '+' keyboard shortcut not working properly,"# Description

In #4153 it was implemented the possibility of adding a :+1: emoji reaction to the selected message, only by hitting `+`.

However, this isn't working properly (it only does with <kbd>Shift</kbd> + <kbd>+</kbd>, or <kbd>Shift</kbd> + <kbd>=</kbd> in the American keyboard layout).

# Steps to reproduce
1. Select a message (without opening the compose box).
2. Press <kbd>+</kbd>.
3. Nothing happens (a :+1: emoji reaction should've appeared in that message).",YagoGG,b'area: keyboard UI bug',2017-03-20T15:16:20Z,2017-03-20T16:48:07Z
4169,Running certain tests while in tools folder causes error,"If you run test-js-with-casper, test-api, or test-help-documentation.py while in the tools folder, it causes an error, but if you run these tests while in the root folder, it works. ",wangjames,b'area: tooling bug good first issue help wanted',2017-03-19T19:13:44Z,2017-09-17T18:14:29Z
4113,Search suggestion box is going out of bottom screen,"Tested on resolution 1366x768
Suggestions list while searching for keywords in searchbox is going out of window and list is not scroll-able.
![pp](https://cloud.githubusercontent.com/assets/14259718/24054876/ed81564c-0b63-11e7-95ea-87cc5c987221.jpg)
",zerocod3r,b'area: search bug good first issue help wanted',2017-03-17T17:19:41Z,2017-04-07T03:19:12Z
4091,register: Password Strength Bar doesn't work,"The password strength bar doesn't get updated on the registration page for new users. 
On inspecting the page, I found that Javascript is throwing an _ReferenceError_ for _i18n_ in _signup.js_. 

`$.validator.addMethod('password_strength', function (value) {
        return password_quality(value, undefined, $('#id_password, #id_new_password1'));
    }, i18n.t(""Password is too weak.""));`

How do we include i18n here? ( I don't know much about Node modules ). 
Or can't we just pass the string directly to the addMethod function? 
",digi0ps,b'area: i18n bug feedback wanted',2017-03-16T07:56:02Z,2017-03-18T04:58:33Z
4084,Mismatch in search highlight,"I searched for the word ""diversity"" and one of the returned result highlighted the wrong word.

![diversity](https://cloud.githubusercontent.com/assets/311929/23965940/a1c0f7f6-09df-11e7-97fe-1a2b737e66a4.png)

The exact word is one line above the highlighted words.
 ",kracekumar,b'area: search bug help wanted',2017-03-15T19:00:32Z,2017-10-31T16:07:31Z
4074,bugdown: Buggy local echo when ending with at-mention.,"Not sure what the underlying issue is, but a reproducer is
```
stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff stuff 
<@mention someone>
```

The local echo should have 15 copies of the `@mention` replacing all the `stuff`.",rishig,b'area: markdown bug good first issue help wanted',2017-03-15T06:43:40Z,2017-07-18T07:15:09Z
4059,"improvement: settings can be close by clicking outside of them, not just the x","current behaviour:
if I open the settings or administration menu I have to close it by clicking the x in the top right. 

desired behaviour:
the menus darken what's around them. This area should also work for closing the menu. The other menus for streams and drafts do it and I often find myself clicking outside the settings to close them but it doesn't work. 
Also much of the mouse action happens to the left, but the x is top right. It's a long way to go especially on large screens. 

![clicking dark area closes menu (without saving)](https://cloud.githubusercontent.com/assets/26190934/23895154/14392498-08a5-11e7-9221-c706e34e79da.png)

",penCsharpener,b'area: settings UI bug',2017-03-14T09:48:09Z,2017-03-15T19:38:32Z
4029,"Closing ""Formatting"" help popup closes message compostion","When exiting the markdown-help overlay by clicking ""x"" or outside of the overlay, the message composition quits. This is a bug, because we can assume that the user wants to continue editing the message, after looking up some markdown syntax.

This does not happen when using the ""Esc"" key to close markdown-help.
This also does not happen in the ""message edit"" view.",zormit,b'area: compose bug',2017-03-11T18:27:39Z,2017-03-22T02:04:37Z
4020,Cannot change notification settings on newly subscribed stream,"To reproduce:

1. Go to ""Manage streams"" page
2. Subscribe to a new stream from the ""All Streams"" tab
3. Click back to the ""Subscribed"" tab, noting that the new stream appears
4. Click on the stream — you don't get the settings or the email address:


![image](https://cloud.githubusercontent.com/assets/109246/23814923/5f8fdc7e-059a-11e7-9958-48bc852691ce.png)
",wdaher,b'area: stream settings bug duplicate help wanted',2017-03-10T22:04:00Z,2017-03-14T05:59:42Z
4019,"Cannot type ""!"" in iOS","Typing `!` in the message compose box does not print the character and moves the cursor to the beginning of the line. There appears to be other strange behavior when typing `!` into other text fields as well. 

I was able to reproduce the behavior across several browsers (Safari, Chrome 56.0.2924.79, and Firefox 6.1 (1)) on an iPhone 6 running iOS  10.2.1 (14D27)

EDIT: Added Chrome/Firefox App version",JLoppert,b'area: compose bug',2017-03-10T21:17:38Z,2017-03-14T04:38:54Z
4015,Live-update stream settings when other user creates public stream.,"If I happen to be in stream settings when another user creates a public stream (but doesn't subscribe me yet), then we may want to live-update the streams.  This is a relatively rare thing, but often there is discussion about creating a stream right before the stream is actually created, so you may have occasional races to create the stream between two users.  (And these races aren't down-to-the-millisecond kind of races, these are races where be both open stream settings, and one of us finishes the processes a few seconds before the other.)

If we do this sort of live update, we should make sure things like the ""View Stream"" button work properly.",showell,b'area: stream settings bug duplicate',2017-03-10T16:46:59Z,2017-03-14T05:59:23Z
4008,Escape from invite more users,"After bringing up the ""invite more users"" dialog by clicking on ""invite more users"", pressing escape should dismiss the dialog as though you pressed ""cancel"".",jbarnold,b'area: keyboard UI bug good first issue help wanted',2017-03-09T18:50:45Z,2017-03-22T02:04:37Z
4005,Actions popover menu drops below bottom of screen. ,"The popover for the message at the end of the stream is out of view because it always opens to the bottom.



![image](https://chat.zulip.org/user_uploads/2/2e/rs6w9ClZy-SLopwnnPObeWKP/Screenshot-from-2017-03-09-12-24-22.png)


**_Fix_**: The popover should open towards the top _always_ or open towards the top for the _last message_.",nitish1211,b'area: message view bug good first issue',2017-03-09T17:08:35Z,2017-03-22T02:04:37Z
3998,bugdown: rstrip code blocks.,"When people copy and paste code blocks from a terminal, often it will include many spaces to the right of the code. We should remove these spaces, since otherwise it can e.g. unnecessarily cause the addition of the scroll bar:
![image](https://cloud.githubusercontent.com/assets/890911/23733418/9c0eb2b0-042d-11e7-8673-5ffa234586b4.png)

The bugdown code is in `zerver/lib/bugdown/__init__.py`.
",rishig,b'area: markdown good first issue help wanted',2017-03-09T02:34:15Z,2017-03-22T21:19:25Z
3994,Send the test message sent by the GitHub webhook integration,"The GitHub webhook integration sends a test message.  Currently, I think we just 200 and do nothing with it; it would be better to send it through so it's clear that things worked.

This is specifically for the ""webhook"" integration; not the legacy one.",timabbott,b'area: integrations bug good first issue help wanted',2017-03-08T23:48:02Z,2017-03-22T02:04:37Z
3991,reactions: Don't rerender message if it is being edited.,"Currently, we rerender the message whenever a reaction comes in. If the message is being edited, we should defer that rerendering until the end of the message editing.

You can test this by using a couple browser windows against a development server.",rishig,b'area: message-editing bug good first issue help wanted',2017-03-08T22:21:44Z,2017-03-15T21:44:27Z
3981,i18n: Traceback running `makemessages.py` with emacs backup files of JS,"Just create the file named `static/js/.#echo.js`  run `manage.py makemessages`.
```
processing locale pl
Traceback (most recent call last):
  File ""./manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 367, in execute_from_command_line
    utility.execute()
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 359, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/base.py"", line 294, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/base.py"", line 345, in execute
    output = self.handle(*args, **options)
  File ""/home/tabbott/zulip/zerver/management/commands/makemessages.py"", line 90, in handle
    self.handle_frontend_locales(*args, **options)
  File ""/home/tabbott/zulip/zerver/management/commands/makemessages.py"", line 101, in handle_frontend_locales
    translation_strings = self.get_translation_strings()
  File ""/home/tabbott/zulip/zerver/management/commands/makemessages.py"", line 173, in get_translation_strings
    with open(os.path.join(dirname, filename)) as reader:
IOError: [Errno 2] No such file or directory: '/home/tabbott/zulip/zproject/../static/js/.#echo.js'
```",timabbott,b'area: i18n bug good first issue help wanted',2017-03-08T12:02:18Z,2017-04-05T18:10:09Z
3978,Message autocollapsing doesn't collapse newly sent messages until next message comes in,"We have this cool message auto-collapsing feature, which cuts off really tall messages like this:

![image](https://cloud.githubusercontent.com/assets/2746074/23696658/696fe368-0399-11e7-8f65-13c92100c531.png)

However, it has a bug where when a message is first sent, it sometimes isn't auto-collapsed, and its state only updates once it is no longer the most recently sent message.",timabbott,b'area: message view bug help wanted',2017-03-08T08:53:07Z,2017-03-22T02:04:37Z
3974,run-dev.py crazy traceback in URL resolvers,"We seem to get this crazy thing in development when a logged-out view throws an exception.

Reproducible by doing patch and then loading the login page:
```
diff --git a/zerver/views/auth.py b/zerver/views/auth.py
index 9276cc2..872572a4 100644
--- a/zerver/views/auth.py
+++ b/zerver/views/auth.py
@@ -341,6 +341,7 @@ def get_dev_users(extra_users_count=10):
 
 def login_page(request, **kwargs):
     # type: (HttpRequest, **Any) -> HttpResponse
+    raise Exception(""Test"")
     if request.user.is_authenticated():
         return HttpResponseRedirect(""/"")
     if is_subdomain_root_or_alias(request) and settings.REALMS_HAVE_SUBDOMAINS:
```


```
2017-03-08 05:18:07,942 DEBUG    Exception while resolving variable 'name' in template 'unknown'.
Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py"", line 39, in inner
    response = get_response(request)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 249, in _legacy_get_response
    response = self._get_response(request)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py"", line 172, in _get_response
    resolver_match = resolver.resolve(request.path_info)
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/urls/resolvers.py"", line 300, in resolve
    raise Resolver404({'tried': tried, 'path': new_path})
django.urls.exceptions.Resolver404: {'tried': [[<LocaleRegexURLResolver <RegexURLPattern list> (None:None) ^en/>], [<RegexURLPattern zerver.views.home.home ^$>], [<RegexURLPattern zerver.views.home.desktop_home ^desktop_home/$>], [<RegexURLPattern login-sso ^accounts/login/sso/$>], [<RegexURLPattern login-jwt ^accounts/login/jwt/$>], [<RegexURLPattern login-social ^accounts/login/social/(\w+)$>], [<RegexURLPattern zerver.views.auth.start_google_oauth2 ^accounts/login/google/$>], [<RegexURLPattern zerver.views.auth.send_oauth_request_to_google ^accounts/login/google/send/$>], [<RegexURLPattern zerver.views.auth.finish_google_oauth2 ^accounts/login/google/done/$>], [<RegexURLPattern zerver.views.auth.log_into_subdomain ^accounts/login/subdomain/$>], [<RegexURLPattern zerver.views.auth.dev_direct_login ^accounts/login/local/$>], [<RegexURLPattern zerver.views.auth.login_page ^accounts/login/>], [<RegexURLPattern django.contrib.auth.views.login ^accounts/login/>], [<RegexURLPattern zerver.views.auth.logout_then_login ^accounts/logout/>], [<RegexURLPattern zerver.views.zephyr.webathena_kerberos_login ^accounts/webathena_kerberos_login/>], [<RegexURLPattern django.contrib.auth.views.password_reset ^accounts/password/reset/$>], [<RegexURLPattern None ^accounts/password/reset/done/$>], [<RegexURLPattern django.contrib.auth.views.password_reset_confirm ^accounts/password/reset/(?P<uidb64>[0-9A-Za-z]+)/(?P<token>.+)/$>], [<RegexURLPattern None ^accounts/password/done/$>], [<RegexURLPattern zerver.views.users.avatar ^avatar/(?P<email_or_id>[\S]+)?/(?P<medium>[\S]+)?>], [<RegexURLPattern zerver.views.users.avatar ^avatar/(?P<email_or_id>[\S]+)?>], [<RegexURLPattern zerver.views.registration.accounts_home ^accounts/home/>], [<RegexURLPattern send_confirm ^accounts/send_confirm/(?P<email>[\S]+)?>], [<RegexURLPattern zerver.views.registration.accounts_register ^accounts/register/>], [<RegexURLPattern confirmation.views.confirm ^accounts/do_confirm/(?P<confirmation_key>[\w]+)>], [<RegexURLPattern zerver.views.user_settings.confirm_email_change ^accounts/confirm_new_email/(?P<confirmation_key>[\w]+)>], [<RegexURLPattern zerver.views.unsubscribe.email_unsubscribe ^accounts/unsubscribe/(?P<type>[\w]+)/(?P<token>[\w]+)>], [<RegexURLPattern zerver.views.home.accounts_accept_terms ^accounts/accept_terms/$>], [<RegexURLPattern zerver.views.create_realm ^create_realm/$>], [<RegexURLPattern zerver.views.create_realm ^create_realm/(?P<creation_key>[\w]+)$>], [<RegexURLPattern register ^register/$>], [<RegexURLPattern zerver.views.auth.login_page ^login/$>], [<RegexURLPattern zerver.views.registration.accounts_home_with_realm_str ^register/(?P<realm_str>\S+)/$>], [<RegexURLPattern None ^api/$>], [<RegexURLPattern zerver.views.integrations.api_endpoint_docs ^api/endpoints/$>], [<RegexURLPattern None ^integrations/$>], [<RegexURLPattern None ^about/$>], [<RegexURLPattern None ^apps/$>], [<RegexURLPattern None ^robots\.txt$>], [<RegexURLPattern landing-page ^hello/$>], [<RegexURLPattern None ^new-user/$>], [<RegexURLPattern None ^features/$>], [<RegexURLPattern zerver.views.registration.find_my_team ^find_my_team/$>], [<RegexURLPattern zerver.views.users.authors_view ^authors/$>], [<RegexURLPattern None ^terms/$>], [<RegexURLResolver <RegexURLPattern list> (None:None) ^api/v1/>], [<RegexURLResolver <RegexURLPattern list> (None:None) ^json/>], [<RegexURLPattern None ^user_uploads/(?P<realm_id_str>(\d*|unk))/(?P<filename>.*)>], [<RegexURLPattern None api/v1/external/airbrake>], [<RegexURLPattern None api/v1/external/appfollow>], [<RegexURLPattern None api/v1/external/beanstalk>], [<RegexURLPattern None api/v1/external/bitbucket2>], [<RegexURLPattern None api/v1/external/bitbucket>], [<RegexURLPattern None api/v1/external/circleci>], [<RegexURLPattern None api/v1/external/codeship>], [<RegexURLPattern None api/v1/external/crashlytics>], [<RegexURLPattern None api/v1/external/delighted>], [<RegexURLPattern None api/v1/external/deskdotcom>], [<RegexURLPattern None api/v1/external/freshdesk>], [<RegexURLPattern None api/v1/external/gitlab>], [<RegexURLPattern None api/v1/external/gosquared>], [<RegexURLPattern None api/v1/external/greenhouse>], [<RegexURLPattern None api/v1/external/hellosign>], [<RegexURLPattern None api/v1/external/helloworld>], [<RegexURLPattern None api/v1/external/heroku>], [<RegexURLPattern None api/v1/external/homeassistant>], [<RegexURLPattern None api/v1/external/ifttt>], [<RegexURLPattern None api/v1/external/jira>], [<RegexURLPattern None api/v1/external/librato>], [<RegexURLPattern None api/v1/external/mention>], [<RegexURLPattern None api/v1/external/newrelic>], [<RegexURLPattern None api/v1/external/pagerduty>], [<RegexURLPattern None api/v1/external/papertrail>], [<RegexURLPattern None api/v1/external/pingdom>], [<RegexURLPattern None api/v1/external/pivotal>], [<RegexURLPattern None api/v1/external/semaphore>], [<RegexURLPattern None api/v1/external/sentry>], [<RegexURLPattern None api/v1/external/solano>], [<RegexURLPattern None api/v1/external/stash>], [<RegexURLPattern None api/v1/external/stripe>], [<RegexURLPattern None api/v1/external/taiga>], [<RegexURLPattern None api/v1/external/teamcity>], [<RegexURLPattern None api/v1/external/transifex>], [<RegexURLPattern None api/v1/external/travis>], [<RegexURLPattern None api/v1/external/trello>], [<RegexURLPattern None api/v1/external/updown>], [<RegexURLPattern None api/v1/external/yo>], [<RegexURLPattern None api/v1/external/wordpress>], [<RegexURLPattern None api/v1/external/zapier>], [<RegexURLPattern None api/v1/external/zendesk>], [<RegexURLPattern None ^api/v1/external/github>], [<RegexURLPattern zerver.views.auth.api_get_auth_backends ^api/v1/get_auth_backends>], [<RegexURLPattern None ^compatibility$>], [<RegexURLPattern zerver.views.auth.api_fetch_api_key ^api/v1/fetch_api_key$>], [<RegexURLPattern zerver.views.auth.api_dev_fetch_api_key ^api/v1/dev_fetch_api_key$>], [<RegexURLPattern zerver.views.auth.api_dev_get_emails ^api/v1/dev_get_emails$>], [<RegexURLPattern zerver.views.auth.api_fetch_google_client_id ^api/v1/fetch_google_client_id$>], [<RegexURLResolver <module 'zilencer.urls' from '/home/tabbott/zulip/zilencer/urls.py'> (None:None) ^>, <RegexURLResolver <RegexURLPattern list> (None:None) ^api/v1/>], [<RegexURLResolver <module 'zilencer.urls' from '/home/tabbott/zulip/zilencer/urls.py'> (None:None) ^>, <RegexURLResolver <RegexURLPattern list> (None:None) ^json/>], [<RegexURLResolver <module 'analytics.urls' from '/home/tabbott/zulip/analytics/urls.py'> (None:None) ^>, <RegexURLPattern analytics.views.get_activity ^activity$>], [<RegexURLResolver <module 'analytics.urls' from '/home/tabbott/zulip/analytics/urls.py'> (None:None) ^>, <RegexURLPattern analytics.views.get_realm_activity ^realm_activity/(?P<realm_str>[\S]+)/$>], [<RegexURLResolver <module 'analytics.urls' from '/home/tabbott/zulip/analytics/urls.py'> (None:None) ^>, <RegexURLPattern analytics.views.get_user_activity ^user_activity/(?P<email>[\S]+)/$>], [<RegexURLResolver <module 'analytics.urls' from '/home/tabbott/zulip/analytics/urls.py'> (None:None) ^>, <RegexURLPattern analytics.views.stats ^stats$>], [<RegexURLResolver <module 'analytics.urls' from '/home/tabbott/zulip/analytics/urls.py'> (None:None) ^>, <RegexURLResolver <RegexURLPattern list> (None:None) ^api/v1/>], [<RegexURLResolver <module 'analytics.urls' from '/home/tabbott/zulip/analytics/urls.py'> (None:None) ^>, <RegexURLResolver <RegexURLPattern list> (None:None) ^json/>], [<RegexURLPattern zerver.tornado.views.notify ^notify_tornado$>], [<RegexURLResolver <module 'social_django.urls' from '/srv/zulip-py3-venv/lib/python3.5/site-packages/social_django/urls.py'> (social:social) ^>, <RegexURLPattern begin ^login/(?P<backend>[^/]+)/$>], [<RegexURLResolver <module 'social_django.urls' from '/srv/zulip-py3-venv/lib/python3.5/site-packages/social_django/urls.py'> (social:social) ^>, <RegexURLPattern complete ^complete/(?P<backend>[^/]+)/$>], [<RegexURLResolver <module 'social_django.urls' from '/srv/zulip-py3-venv/lib/python3.5/site-packages/social_django/urls.py'> (social:social) ^>, <RegexURLPattern disconnect ^disconnect/(?P<backend>[^/]+)/$>], [<RegexURLResolver <module 'social_django.urls' from '/srv/zulip-py3-venv/lib/python3.5/site-packages/social_django/urls.py'> (social:social) ^>, <RegexURLPattern disconnect_individual ^disconnect/(?P<backend>[^/]+)/(?P<association_id>[^/]+)/$>], [<RegexURLPattern None ^help/(?P<article>.*)$>], [<RegexURLPattern None ^static/(?P<path>.*)$>], [<RegexURLPattern None ^user_avatars/(?P<path>.*)$>], [<RegexURLPattern None ^json/invite_users$>], [<RegexURLPattern None ^json/bulk_invite_users$>], [<RegexURLPattern None ^json/refer_friend$>], [<RegexURLPattern None ^json/settings/change$>], [<RegexURLPattern None ^json/subscriptions/exists$>], [<RegexURLPattern None ^json/subscriptions/property$>], [<RegexURLPattern None ^json/fetch_api_key$>], [<RegexURLPattern None ^json/tutorial_send_message$>], [<RegexURLPattern None ^json/tutorial_status$>], [<RegexURLPattern None ^json/report_error$>], [<RegexURLPattern None ^json/report_send_time$>], [<RegexURLPattern None ^json/report_narrow_time$>], [<RegexURLPattern None ^json/report_unnarrow_time$>], [<RegexURLPattern None ^json/upload_file$>], [<RegexURLPattern None ^json/messages_in_narrow$>], [<RegexURLPattern None ^json/set_muted_topics$>]], 'path': 'favicon.ico'}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/template/base.py"", line 885, in _resolve_lookup
    current = current[bit]
TypeError: 'RegexURLResolver' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/srv/zulip-py3-venv/lib/python3.5/site-packages/django/template/base.py"", line 893, in _resolve_lookup
    current = getattr(current, bit)
AttributeError: 'RegexURLResolver' object has no attribute 'name'
```

@umairwaheed I think this showed up with the Django 1.10 upgrade, can you investigate?",timabbott,b'area: tooling bug help wanted',2017-03-08T05:25:18Z,2017-03-22T02:04:37Z
3967,JIRA Webhook encoding error after Zulip version upgrade,"After upgrading Zulip from 1.4.2 to 1.5.1, there is a '500' error in the JIRA Webhook integration.
There are no changes in JIRA.

We are using both JIRA and Zulip in a Unicode environment.
If the JIRA issue subject is in English only, no error occurs.

I wonder if there is a simple way we can solve it.

Please refer to the following log for details of the error.

Nginx access log :
`2017-03-08 07:22:49,264 INFO     10.60.100.10    POST    500  19ms (db: 4ms/2q) /api/v1/external/jira (JIRAbot-bot@domain via ZulipJIRAWebhook)`


Zulip server.log :
`2017-03-08 07:22:49,264 INFO     10.60.100.10    POST    500  19ms (db: 4ms/2q) /api/v1/external/jira (JIRAbot-bot@domain via ZulipJIRAWebhook)`

Zulip errors.log :
`2017-03-08 07:22:49,260 ERROR    Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-03-02-21-03-38/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2017-03-02-21-03-38/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""./zerver/lib/request.py"", line 165, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/decorator.py"", line 237, in _wrapped_func_arguments
    return view_func(request, user_profile, request.client, *args, **kwargs)
  File ""./zerver/lib/request.py"", line 165, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""./zerver/webhooks/jira/view.py"", line 255, in api_jira_webhook
    subject = get_issue_subject(payload)
  File ""./zerver/webhooks/jira/view.py"", line 141, in get_issue_subject
    return ""{}: {}"".format(get_issue_id(payload), get_issue_title(payload))
UnicodeEncodeError: 'ascii' codec can't encode characters in position 1-2: ordinal not in range(128)`
",southisle,b'area: integrations bug good first issue help wanted',2017-03-07T23:07:18Z,2017-03-16T03:17:03Z
3965,Missed-message emails lie to you about whether replying works if email mirror isn't setup,"Zulip's missed-message email templates, i.e. `templates/zerver/missed_message_email.*`, report that you can just reply to the email to get the reply into Zulip.  That is only correct if the email mirroring integration is enabled (settings.EMAIL_GATEWAY_PATTERN is set).  We should change the missed-message email templates to either (1) do the current thing if the setting is enabled or (2) Let users know that the email was sent from a noreply email address and thus one cannot reply directly, in the email.

We probably need to patch the caller of that template in `zerver/lib/notifications.py` as part of this, in order to pass in the variable.

(And we should have tests to confirm this works correctly!)",timabbott,b'area: notifications (other) bug good first issue help wanted',2017-03-07T19:32:24Z,2017-03-16T05:37:10Z
3963,Cannot register using organization link,"I'm trying to register using organization link:

```
zulip@dashboard-dev:~/deployments/current$ ./manage.py  generate_realm_creation_link
One time organization creation link generated
=> Please visit https://coop.scoutbee.com/create_realm/b3ce1f22dc1284f05d989e15a68165b523fd2b5c to create the organization
```

After entering email in to the form, I'm getting 500 Error page.


```
tail -f /var/log/zulip/django.log
...
Traceback (most recent call last):
  File ""./zerver/logging_handlers.py"", line 41, in emit
    user_full_name = user_profile.full_name
  File ""/home/zulip/deployments/2017-03-07-12-37-39/zulip-venv/lib/python2.7/site-packages/django/utils/functional.py"", line 235, in inner
    return func(self._wrapped, *args)
AttributeError: 'AnonymousUser' object has no attribute 'full_name'
...

```",aliev,b'bug',2017-03-07T13:12:33Z,2017-03-08T05:27:26Z
3940,Fix totally broken test test_get_old_messages_with_narrow_pm_with,"test_get_old_messages_with_narrow_pm_with in `test_narrow.py` is lacking the test data setup work (should send a few messages at the start) that is required to make it work.  It needs to be mostly rewritten to look more like `test_get_old_messages_with_narrow_stream`, though probably with several `send_message` calls to setup a good set of cases.

Fixing this will let us fix the fact that `test_narrow.py` actually doesn't have 100% test coverage, and then we can remove it from the `test-backend` exclude list.",timabbott,b'area: testing-coverage bug good first issue help wanted',2017-03-05T07:22:26Z,2017-03-22T02:04:37Z
3928,can't click to move insertion point in new message window if large fonts,"This started recently. If I'm typing a new message I can't click to move the insertion point to the first line of the edit window. When I move the pointer around, it changes to an arrow near the top. It's like the text edit area isn't all text. I can't edit the first line of a message unless I click elsewhere and then use the keyboard to move the insertion point. If I click on the first line, the edit control loses focus.

But if I paste text instead of typing it, this doesn't happen. It also doesn't happen if I turn off large fonts.

I'm using Safari 9 with minimum font size set to 18 points. Preferences - Advanced - Accessibility - Never use font sizes smaller than

![text_entry](https://cloud.githubusercontent.com/assets/95028/23580994/f4d50c02-00c0-11e7-9e3e-bbf1699c4742.jpg)
",feorlen,b'area: compose bug',2017-03-04T18:01:37Z,2017-03-22T02:04:37Z
3914,Error while installing using Docker,"The following error is encountered when installing zulip using docker(experimental) approach from [here](http://zulip.readthedocs.io/en/latest/dev-setup-non-vagrant.html#using-docker-experimental)
`mkdir: cannot create directory ‘../var’: Permission denied`
I have tried making the directory manually, but to no avail.
Script cannot be run as `sudo`.
Tried editing the script to comment out the `mkdir -p ../var/log/` but the script was readonly

I am running Kali Rolling 2016.2, which is based on deb-jessie.",hackrush01,b'area: provision bug',2017-03-03T21:13:47Z,2018-05-28T05:16:54Z
3903,Strange behavior on create bot,"Hello

I'm trying to create a new bot and I have a strange behavior in the username of the bot : the domain is bad, composed by half of the name of my company and half of 'acme.com', that give me ``name-bot@exsymol@acme.com``.

Any idea ?

![zulip-bug-hubot-1](https://cloud.githubusercontent.com/assets/2016950/23546112/680d524c-fffe-11e6-9a1b-8d927551edc2.png)
",sulian,b'area: bots area: settings UI bug',2017-03-03T09:46:16Z,2017-04-26T00:02:08Z
3897,Make translations.json generation use deterministic order,"I just noticed that running `manage.py makemessages` repeatedly, it totally regenerates the file each time, which feels pretty unnecessary (and makes it nearly impossible to read diffs to see what changed).

Reproducer: Alternative `manage.py makemessages` with `git commit -am makemessages`.

We should fix this by sorting `translations.json` by the english string.

@umairwaheed can you take care of this?",timabbott,b'area: i18n bug help wanted',2017-03-02T16:58:24Z,2017-03-22T02:04:46Z
3893,"Cannot ""remove from default"" a deleted stream","Hello

I can't remove a deleted stream from the list of default stream when a new users joins the organization, is it a bug or I have missed a function ?

![zulip-bug-screen-1](https://cloud.githubusercontent.com/assets/2016950/23510105/8d38fbd0-ff58-11e6-91de-41565412c1c9.png)
![zulip-bug-screen-2](https://cloud.githubusercontent.com/assets/2016950/23510110/8f8f08b6-ff58-11e6-9059-533aa814dbe8.png)
",sulian,b'area: settings (admin/org) bug',2017-03-02T13:58:41Z,2017-07-08T18:37:39Z
3889,Enter key doesn't delete selected text in compose box,"Browser: Firefox 51.0.1, Fedora 24

To reproduce:

1. Input some text into the compose box.
2. Highlight some of it.
3. Press Enter.

Expected result: The selected text is deleted and replaced with a newline.

Actual result: A newline is inserted, apparently at the location of the cursor.  The selected text is deselected but not deleted.",bgilbert,b'area: compose bug',2017-03-02T09:11:03Z,2017-03-08T06:05:23Z
3887,I should not be allowed to create my initial admin user without a password,"I set up a new prod install and accidentally hit return after typing my name in the [name field](http://zulip.readthedocs.io/en/latest/_static/zulip-create-user-and-org.png). This submitted the form and created my new administrator account without a password. (I also was missing an organization name.)

This form should verify that something was provided for a password (and maybe the other fields) before submitting.

 Note: that screenshot is from the docs and out of date. I don't have a current one handy.",feorlen,b'area: onboarding bug help wanted',2017-03-02T04:51:52Z,2017-07-31T23:36:01Z
3886,left sidebar: Clicking on a topic should not open compose box.,"To reproduce, make sure the compose box is closed, and then click on any topic in the left sidebar. The correct behavior is for the compose box to stay closed.

Not sure when this regression happened, but it has been there for a while. It is particularly unfortunate since it means the page up and page down keys don't work (they get taken by the compose box).",rishig,b'area: left-sidebar bug good first issue help wanted',2017-03-02T02:43:31Z,2017-04-18T05:57:18Z
3885,Lightbox closes compose box.,"To reproduce: Open compose box, type a few characters, click on an image, and then click out of the image. ",rishig,b'area: misc bug good first issue help wanted',2017-03-02T01:31:39Z,2017-03-02T04:50:04Z
3877,Error message sending to a stream you're not subscribed to is broken,"If you narrow to a stream you're not subscribed to (this is easy to do via the search bar, and will become more common when we add a preview feature in /#subscriptions), and send a message, Zulip will give you an error message like this:

![image](https://cloud.githubusercontent.com/assets/2746074/23479420/3b3af6d8-fe79-11e6-83d0-5e16a12f061b.png)

Currently, it kinda sucks, because the link takes you to the wrong part of the `/#subscriptions` page (where you browse your existing streams and need to click ""All streams"" to see things you're not on). 

But rather than fixing that link, I think maybe we should just provide a ""subscribe"" button in that error message.",timabbott,b'area: compose area: stream settings bug good first issue help wanted',2017-03-01T20:20:25Z,2018-04-06T00:19:22Z
3871,message edit: Remove More/Collapse when in message edit / view source mode,"Once you're in message edit or view source mode, it doesn't make sense to have a collapse / uncollapse link (and they are currently broken anyway). For clarity, I mean the following element:
![image](https://cloud.githubusercontent.com/assets/890911/23475310/09611b04-fe6c-11e6-9c2b-ab951b84f042.png)

They should just be removed when in message edit mode. 

Much of the message editing code is in `static/js/message_edit.js`.
",rishig,b'area: message-editing bug good first issue help wanted',2017-03-01T18:47:59Z,2017-03-22T02:04:45Z
3869,Connectivity issue alert box goes over the scroll bar.,"![screenshot from 2017-03-01 20 17 31](https://cloud.githubusercontent.com/assets/11073943/23467961/05951370-fed2-11e6-8752-1b2434f18e14.png)

**How To Reproduce**: Get disconnected for a while.
**Environment**: Mozilla Firefox 51.0.1",souravbadami,b'area: notifications (other) bug good first issue help wanted',2017-03-01T15:56:05Z,2017-05-05T22:08:05Z
3867,mobile: Edit and Delete buttons not visible in draft management popup,"![screenshot_2017-03-01-13-43-41-744_com android chrome](https://cloud.githubusercontent.com/assets/7190633/23451287/4759800e-fe85-11e6-85ce-ca90a52d64a5.png)

To access the buttons I had to swipe left. But there is no indication anywhere that there are buttons and I have to swipe left to view them.

![screenshot_2017-03-01-13-43-49-086_com android chrome](https://cloud.githubusercontent.com/assets/7190633/23451286/47584630-fe85-11e6-9f25-67973d50712c.png)

I am on Android (MI Note 3) and screen is 5.5.",hackerkid,b'area: compose bug good first issue help wanted',2017-03-01T08:18:45Z,2017-03-14T05:03:17Z
3866,New Topic and New Private Message is not visible in mobile version.,![Screenshot](https://chat.zulip.org/user_uploads/2/c7/vKxsaRGbBKNUNXjmI8efBTf7/Screenshot_2017-03-01-01-40-22-967_com.android.chrome.png),hackerkid,b'area: compose bug good first issue help wanted',2017-03-01T07:56:36Z,2017-03-13T22:29:39Z
3862,left sidebar: Unread counts are vertically a few pixels off. ,"Seems like a regression from the last few weeks, if someone wants to `git bisect` it.
![image](https://cloud.githubusercontent.com/assets/890911/23445463/71b58068-fdf0-11e6-9ad7-07fdd074dad9.png)
@brockwhittaker ",rishig,b'area: left-sidebar bug good first issue',2017-03-01T03:59:52Z,2017-03-01T19:49:44Z
3858,Stream colors change when you unsubscribe+resubscribe to a stream,"If you unsubscribe and resubscribe to a stream, the color changes, which seems completely unnecessary (since we save the original color anyway!).

I theorize this is somehow caused by our wacky setup where we have color picking code on both the frontend and backend.

Not tagging this as bite size since it might require a decent amount of code reading to fix correctly.",timabbott,b'area: stream settings bug help wanted',2017-03-01T00:28:07Z,2017-03-22T06:43:20Z
3823,Alert words settings UI styling is broken,"This screenshot is pretty self-explanatory:

![image](https://cloud.githubusercontent.com/assets/2746074/23348196/c29864fe-fc5c-11e6-9e61-2513a807023a.png)

This seems to be a very recent regression.
",timabbott,b'area: settings UI bug good first issue help wanted',2017-02-27T03:50:37Z,2017-03-22T02:04:45Z
3820,Tabbing back to the topic box from the compose box is broken,"If you start composing a message to a stream/topic pair, and hit `shift+tab` to go back to the topic box, it doesn't properly select the existing topic (or it does, temporarily, and then just leaves your cursor at the end of the topic).

This is a regression in the redesigned compose box that we just merged.",timabbott,b'area: compose bug good first issue help wanted',2017-02-27T02:43:13Z,2017-09-14T12:06:02Z
3817,New compose box has performance problem,"If you just hit `enter` to add a bunch of newlines on chat.zulip.org, the compose box is pretty laggy.

@brockwhittaker can you investigate?",timabbott,b'area: compose bug',2017-02-26T21:02:58Z,2017-02-28T18:18:38Z
3809,"Replace naive datetimes in the asana, basecamp, and codebase integrations.","Zulip is almost a 100% timezone-aware codebase! These are some of the last files with naive datetimes. The problem with naive datetimes is that they tend to fail or produce weird results during daylight savings time, or if the bot server changes timezones (e.g. if the server is running on someone's laptop). 

For each file, the goal is to change 
* `datetime.utcnow`s to `datetime.now(tz=pytz.utc)` (the same timetuple as `datetime.utcnow`, but now it has the timezone set), or to `time.time()` (number of seconds since epoch). 
* If going to `datetime.now(tz=pytz.utc)` route, also replace things like `fromtimestamp` and `utcfromtimestamp` with `datetime.fromtimestamp(timestamp, tz=pytz.utc)`.

The main way these can fail is if elsewhere in the file we subtract or compare a naive datetime to this value, in which case that naive datetime should also have its timezone added.

You can find the files with `git grep utcnow` from the `api` directory. (Depending on when you do this, there may be other `utcnow`s, but they are being taken care of in other issues.)
Instructions for manually testing the bots are at http://zulip.readthedocs.io/en/latest/bots-guide.html#how-to-deploy-a-bot.
",rishig,b'area: refactoring bug good first issue help wanted',2017-02-25T19:44:06Z,2017-03-22T02:04:45Z
3805,zulipbot debugging,My debugging of any bugs found with @zulipbot will go here.,synicalsyntax,b'area: documentation (user) bug',2017-02-25T01:50:14Z,2017-05-22T19:31:26Z
3802,View Source misbehaves for message sources already being viewed.,"WTR:

1. Choose to view source of a message having 4-5 messages after itself.
2. Again choose view source when the source is already visible.

After following above steps, the narrowed message automatically gets changed to the next message. I believe `View Source` option should not be available if source is already visible.

Supporting GIF:

![optimised](https://cloud.githubusercontent.com/assets/18065231/23318807/fba0a360-faf9-11e6-84a2-6a7d4bf779cc.gif)
",khantaalaman,b'area: message view bug good first issue help wanted',2017-02-24T20:01:34Z,2019-07-23T14:22:03Z
3797,ESC button behavior is unpredictable in message editing and viewing source,"1. Go to an old message and narrow to that topic. For example [testing123](https://chat.zulip.org/#narrow/stream/test.20here/topic/testing123).

2. Click any message and look at its source.

3. Now press ESC. This brings you back to the homepage. This shouldn't happen and should only close the viewing source ideally.

Not sure if this is supposed to happen or that it is actually a feature because when you view a source, the CLOSE button is automatically selected and you can press enter to exit viewing source.",lonerz,b'area: keyboard UI area: message-editing bug',2017-02-24T06:29:45Z,2017-05-23T19:34:54Z
3791,"settings: backdrop leaked when hitting ""escape"" with a modal open","Reproducer: Go to the settings pages, open a modal (e.g. ""change email""), and hit escape.  The modal backdrop will be leaked.

Since the backdrop doesn't appear naturally when you open the modal, this is pretty broken :/.",timabbott,b'area: settings UI bug',2017-02-23T21:33:40Z,2017-09-06T16:35:18Z
3786,Realm administrators no longer able to admin invite-only streams,"Pre-1.5, realm administrators were able to see the existence of invite-only streams that they were not invited to.  This allowed them to moderate them to remove users (as described in #424), as well as delete the streams entirely.

Since 1.5, however, realm administrators can no longer see invite-only streams.  As a result, and due to #3783 still being open, the UI presents no mechanism for anyone to remove another user from an invite-only stream unless a member of that stream invites a realm administrator into the stream.",hlieberman,b'area: stream settings bug priority: blocker',2017-02-23T19:15:28Z,2018-03-13T22:01:37Z
3779,Fix back button when adding a new stream.,"Go to manage streams, enter a new stream in the textbox, hit ""+"" to start adding the stream, and then hit the back button.  The back button disappears without doing anything obvious.  I would expect it to restore the list of streams and cancel the add-stream operation.",showell,b'area: settings UI area: stream settings bug',2017-02-23T16:37:25Z,2017-02-23T19:14:16Z
3769,Fix naive datetimes in google-calendar bot.,"We're moving away from all naive datetimes in Zulip (i.e. datetimes without timezone information), since naive datetimes introduce subtle daylight savings bugs (including here).

The events array in `/api/integrations/google/google-calendar` currently stores naive datetime objects, and it should instead store events in UTC. The two functions that touch it are `get_events()` (via `events = list(get_events())` at the bottom) and `send_reminders()`.

Also, a second issue that could be fixed in a separate commit: `get_events` should be renamed `populate_events`, and should just directly populate the events array.
 
This would be a great project for a new contributor.",rishig,b'area: bots bug good first issue help wanted',2017-02-23T04:09:59Z,2017-02-27T02:08:01Z
3766,Restore timestamp hovers.,"We should restore the pre-1.5 behavior where hovering over the timestamp gave you full date info and per-second granularity.

To make this happen we need the chevron/star/reaction menus to be to the left of the timestamp.",showell,b'area: message view bug',2017-02-23T00:27:19Z,2017-02-23T00:53:34Z
3741,Resizing browser causes message options to appear partially.,"![screenshot from 2017-02-21 14 06 04](https://cloud.githubusercontent.com/assets/11073943/23154224/4cc36362-f83f-11e6-829c-bf4a29ed586a.png)

**How To Reproduce:** 
- Try resizing the browser. Reduce the height.
- Toogle the message options icon.

**Observed Behavior:** The options appear partially.

**Environment:** Mozilla Firefox 51.0.1 (64-bit) on Linux Mint 17.2.",souravbadami,b'area: message view bug good first issue help wanted',2017-02-21T07:11:54Z,2017-03-22T02:06:54Z
3738,Left arrow hotkey to edit message conflicts with Alt+Left,"I frequently use Alt+Left in Chrome to go back. Recently, Zulip added a Left hotkey to edit the last message, which seems to take priority over Alt+Left. Can this either be fixed or another hotkey chosen?",aripollak,b'area: keyboard UI bug good first issue help wanted priority: blocker',2017-02-20T19:29:26Z,2017-03-01T19:19:51Z
3720,message edit: Countdown timer no longer works.,"To reproduce: send a message, open it for editing, and wait a few minutes. Expected behavior is for the countdown in the lower right (looks like the below) to count down, which it currently isn't.
![image](https://cloud.githubusercontent.com/assets/890911/23095007/c75c704e-f5b7-11e6-824d-ff1e3eb4f855.png)

A related issue is that when the countdown reaches 0, it should disable the save button, which it currently isn't. (I expect solving the above problem will automatically solve this problem).

For testing, I would go into admin settings and set the message edit limit to 1 minute, since in that case the timer updates every 5 seconds instead of every 60 seconds.

One relevant place to look is the `edit_message` function in `static/js/message_edit.js`. Search for `countdown_timer`.",rishig,b'area: message-editing bug good first issue help wanted',2017-02-18T16:52:12Z,2017-02-21T05:43:04Z
3719,bugdown: Indenting 4 spaces no longer produces code block,"To reproduce, send a message like the following. 
```
    this is indented 4 spaces

this is not 
```
The first line should be turned into a code block, which it currently isn't. ",rishig,b'area: misc bug good first issue help wanted',2017-02-18T16:17:28Z,2017-02-18T22:49:47Z
3707,Make it possible to have more whitespace between paragraphs in Zulip messages,"Currently, there's basically no reasonable way to compose a Zulip message with a proper paragraph break between two pieces.  What we'd like to do is have:
```
foo
bar
```
continue to just put a `<br>` tag in between, but 

```
foo

bar
```

(which currently in the rendered HTML just places the two pieces inside separate `<p>` tags) should have more space in between paragraphs, ideally without adjusting the spacing between other things (e.g. height of a 1-line message, spacing between text and a code block, etc.).

There are two approaches we can take on this:
(1) Adjust the CSS to make spaces between two `<p>` tags in message bodies look right.  This may be difficult without changing other spacing, but is in theory possible.
(2) Instead, adjust the markdown processor to do something different (e.g. put a special paragraph divider element into the HTML that we can then add CSS for)

See http://zulip.readthedocs.io/en/latest/markdown.html for relevant notes on our markdown processor.

See https://github.com/chjj/marked/issues/726 for info on how one might do this in our frontend markdown processor (marked.js).

This is the issue reported in https://github.com/zulip/zulip/pull/653, but working towards a better solution.",timabbott,b'area: markdown bug help wanted',2017-02-17T05:28:01Z,2017-04-04T00:29:12Z
3701,Sort pinned list of streams by lowercase stream name.,"Currently the unpinned streams are sorted by lowercase stream name, and the pinned streams seem to be sorted by stream name (e.g. stream ZZZ coming before stream bbb, since Z comes before b in ascii). It would be great to have the pinned streams sorted by lowercase stream name.

One place to look might be `build_stream_list` in `stream_list.js`. As a part of this PR it would be good to also figure out how the pinned streams are currently being sorted, since they don't seem to be sorted in that function, but e.g. are sorted on chat.zulip.org for me.",rishig,b'area: left-sidebar bug good first issue help wanted',2017-02-16T23:47:07Z,2017-02-20T19:05:54Z
3692,Presence API incorrectly flags inactive users as active,"Weird one: when I hit the new presence API, I'm getting active users showing as active, idle users showing as idle, and offline users showing as active.

I cherry-picked three patches onto 1.5.1, so this could be my fault.  I've got 71af0f7e2ebb6162ed507439d2376481b44d0b97, ac8b661a8f45a49b0e4b2173cfd4f6cd05f19d65, and ffc24e9f6622035a4cc70e8062a443453ef042c1 on top.",hlieberman,b'area: api bug good first issue help wanted',2017-02-16T00:22:55Z,2017-03-08T04:16:12Z
3689,bug fix: Fix error when admin renames a bot after reactivating it.,"Fix administration page javascript issue of TypeError that occurs
due to undefined variable access in static/js/bot_data.js file.
Call add op on reactivating a bot fixes this issue.
Fixes: #2840",abhijeetkaur,b'area: settings (admin/org)',2017-02-15T20:28:36Z,2017-03-01T00:13:39Z
3687,Clicking 'Yes Please!' to the xx-unread-message modal redirects to home,"When clicking 'Yes, please!' to the welcome modal that greets the user with 'You have xx unread messages',
the user gets redirected to home (i.e., chat.zulip.org/#). This is also true when a user clicks on an internal link such as https://chat.zulip.org/#narrow/stream/learning. Instead of redirecting to Home, it should stay on the url clicked by the user.

This issue may also be present when 'No, I'll catch up' button is clicked. ",jajodiaraghav,b'area: notifications (other) bug good first issue help wanted',2017-02-15T09:25:20Z,2017-03-23T06:53:16Z
3662,Renaming a stream to a name that's already taken doesn't give a user-facing error,"The title is pretty self-explanatory; it doesn't work (but appears like it did in that the content-editable area looks just like you'd saved) with no visible error.  I think we're not handling errors in the API request to the backend, basically.",timabbott,b'area: stream settings bug good first issue help wanted',2017-02-13T07:59:59Z,2018-01-05T18:47:25Z
3657,Empty invite-only streams show up broken in /#subscriptons page for administrators,"Reproduction process:
* Login as Iago, go to /#subscriptions
* Make a stream like Denmark invite-only.
* Remove all the users from Denmark (need to remove Iago last!)
* (Maybe needed) Reload browser
* Check the ""All streams"" tab; you'll still see the stream, and clicking on it will show an error fetching the subscriber list:

![image](https://cloud.githubusercontent.com/assets/2746074/22867247/6ff46b9a-f139-11e6-9d46-afe04218a110.png)

Ideally, we'd just no longer have the stream be listed on that page.

I believe that we mark invite-only streams where the last user left as ""deactivated"" in the backend.

Not tagged bite-size since this will probably involve a bit of spelunking, but this should be relatively accessible.",timabbott,b'area: stream settings bug help wanted',2017-02-12T23:43:57Z,2018-03-13T22:02:43Z
3655,ui.home_tab_obscured was broken by the various settings/subscriptions refactoring,"This is used in a bunch of places, and I think we need to audit each case to figure out the right path forward.  E.g. for hotkeys, we want to just replace it with checking if any of the new modals are open in some correct way.

I think as part of fixing this we should make a central library function that you can query to find out which of {home, settings, subscriptions, informational-overlays, etc.) is visible.

However, the subs.js call point might want to be deleted, since I think it has to do with the scrollout login that we've removed?

@brockwhittaker this is probably a project for you.",timabbott,b'area: message view bug',2017-02-12T08:23:57Z,2017-03-15T22:48:25Z
3634,Hash oscillating when reloading the browser on a settings page,"Open the settings page, click on e.g. ""your bots"", and then reload the page.  If you watch carefully, you'll see the hash flips to `#your-account` and back to `#your-bots` briefly when the page loads.

@brockwhittaker this is probably a good one for you to handle; it's the only bug I've found so far in the newly merged settings page structure redesign.  Maybe worth doing some of the refactoring we talked about to remove duplication in the hashchange code while we're at it.",timabbott,b'area: settings UI bug help wanted',2017-02-10T09:30:59Z,2017-08-01T22:38:53Z
3631,Stream deletion is incredibly slow if you have a ton of users subscribed,"Reproduction recipe: 
* Use `manage.py populate_db --extra-users=1000` to create a Zulip development instance with 1000 users, who are subscribed to random subsets of the streams.
* Delete a stream using the /#administration UI for doing so.  It'll hang for like 10 seconds
* Check the run-dev.py logs; you'll see it did like 500 database queries and memcached queries, and probably the console will scroll for a really long time about all the rabbitmq events being processed as well.

I bet the main thing is just a simple database queries in loop bug, though I noticed that doing so also sent 1K events to rabbitmq (I think one for each user being unsubscribed), so we may need to restructure that to do a bulk event instead as well.  

For working on this, I'd uncomment the section in zproject/settnigs.py that says this: `# Uncomment the following to get all database queries logged to the console` so that Django logs every database query to the console; that'll make it pretty easy to see what we're doing N times.

Once fixed, we can add a test deleting a stream with like 10 users on it, using the `assert_num_queries` to assert that less than 10 database queries are done, so that this never regresses.

For those not familiar with the events system, http://zulip.readthedocs.io/en/latest/new-feature-tutorial.html should teach what you need to know.",timabbott,b'area: settings (user) bug help wanted',2017-02-10T06:46:27Z,2017-02-17T23:49:51Z
3605,Performance leak when muting a large number of topics,"Apparently, we have a bug in our handling of muting a new topic that causes us to actually do work for every topic that's ever been muted, not just for the newly muted topics (!).  See the right half of this profile:
![screen-shot-2017-02-07-at-3 49 43-pm](https://cloud.githubusercontent.com/assets/2746074/22711410/e97afd7e-ed35-11e6-8c1f-04e5ff97af19.png)

I think the problem is in `exports.set_muted_topics` in `static/js/muting.js`; we should instead be comparing the list of muted topics against what we had previously and only doing work for the new ones.

(the left half of this profile is also not ideal, so we should look more at fixing the perf of condensed message checks, but that's a separate issue).",timabbott,b'area: message view bug good first issue help wanted',2017-02-07T21:07:04Z,2017-02-08T19:16:12Z
3598,bug fix: Clean up blue highlighting in the left corner.,"In a96fdd18b1018bd37f2f88058d01d378ec21dd4d, I introduced a few
regressions related to the blue highlighting that happens
in the top left corner for Home, Private messages, Starred
messages, and @-mentions.  Basically, we weren't clearing
the highlighting when we thought we were, so Home would stay
blue too long and the other filters wouldn't turn blue.

We went a surprising long time before noticing the regression.
This fix adds a function called deselect_top_left_corner_items()
to clear the blue backgrounds, so that will happen more explicitly.

And then I restored a line of code to pm_list.js that puts the
blue in place when you are in an is:private narrow (vs. a
specific PM narrow).",showell,None,2017-02-06T21:56:36Z,2017-02-07T00:10:55Z
3596,bug fix: Fixes wikipedia bot in case no results are found,"This change fixes #3508. Earlier, in case of no results,
an IndexError was generated as search result was being accessed
before checking whether it exists or not.",abhijeetkaur,None,2017-02-06T16:38:01Z,2017-02-09T20:21:44Z
3582,"Search terms that match inline code blocks look weird, break further messages","When I search for ""lfaraone"" in the MIT realm, all messages after a message containing \`lfaraone\` will render incorrectly.

Message source (clipped to end, but things before it are not relevant):
```
Well… more details on -c `lfaraone`
```

Way it looks in the DOM:
```
<p>Well… more details on -c <code>lf<span class=""highlight"">araone<!--</span-->code&gt;</span></code></p>
```

Way it looks on web:
![image](https://cloud.githubusercontent.com/assets/73410/22615401/0c610ee8-ea8c-11e6-9b56-f015643d6c98.png)

Later messages:
![image](https://cloud.githubusercontent.com/assets/73410/22615403/1525163c-ea8c-11e6-93a2-3978c8694cba.png)",lfaraone,b'area: search bug help wanted',2017-02-04T03:45:41Z,2017-10-12T04:44:02Z
3572,Choosing the color of stream in #subscriptions behaving weirdly,"If we select a color from the right panel or even write a hex code for color and then click outside of the color  selecting pop up. That color is set for the stream. I think instead of selecting that color it should default to whatever color the stream originally had (if the user clicks anywhere else on the screen it should not set that color until the user clicks on the ""choose"" button). ",aakash-cr7,b'area: stream settings bug help wanted',2017-02-03T16:53:16Z,2017-03-22T06:43:20Z
3560,bugdown: Restore data-user-email to user mention spans.,"(The commit q7ef4e40258280e202325c9295579c93fb948b replaced
data-user-email with data-user-id, but we still need to
support data-user-email for old clients like non-updated
androids and we still want to start the migration forward
to data-user-id.)",showell,None,2017-02-02T20:25:36Z,2017-02-02T20:32:28Z
3559,stream filtering: Fix filtering breaking with unusual characters in stream names,"This is in the stream filtering UI in the /#subscriptions page.

The bug is that we should be either escaping `o` in this block of code in subs.js:
```
        return _.any(search_terms, function (o) {                                                                                
            return new RegExp(o).test(sub_name);                                                                                 
        });                                                                                                                      
```

Probably we should just not be using a RegExp at all and just testing whether the term appears in the name, since I don't think we need regexps for the user-facing filtering logic here.

Example traceback below:
```
SyntaxError: Invalid regular expression: /c++/: Nothing to repeat
    at RegExp (<anonymous>)
    at static/min/app.d55986567f65.js:1268:20
       = static/js/subs.js line 516 column 24
    at Function.h.some.h.any (static/min/common.3ccbbb5e7fa0.js:221:113)
       = static/node_modules/underscore/underscore.js line 258 column 11
    at static/min/app.d55986567f65.js:1267:496
       = static/js/subs.js line 515 column 16
    at v (static/min/app.d55986567f65.js:1268:40)
       = static/js/subs.js line 512 column 21
    at static/min/app.d55986567f65.js:1279:376
       = static/js/subs.js line 531 column 13
```",timabbott,b'area: stream settings bug good first issue help wanted',2017-02-02T20:22:28Z,2017-02-05T21:02:18Z
3548,bug fix: Allow renaming streams to different cases.,"Before this change, you could not rename a stream
from ""denmark"" to ""Denmark"".",showell,None,2017-02-01T22:26:27Z,2017-02-01T22:49:38Z
3517,"Clicking on ""+"" icon (on the right of ""STREAMS"" text) makes `Search streams` box appear","When I click on ""+"" icon (on the right of ""STREAMS""), `Search streams` box appears automatically.

**How to reproduce**:
1. Log in to Zulip.
2. Click on ""+"" icon on the right of `STREAMS` text.
3. Then a modal will appear, and `Search streams` box is appearing also.

If you click on ""+"" icon for the second time, `Search streams` will disappear again, this behavior is same like when we click on the ""Filter streams list"" button (on the right of ""+"" icon).

![peek 2017-01-30 18-22](https://cloud.githubusercontent.com/assets/20320125/22421340/2d02d44a-e719-11e6-8379-2681a8c19cd7.gif)
",refeed,b'area: left-sidebar bug good first issue',2017-01-30T11:36:02Z,2017-01-31T18:02:03Z
3509,Typo in installation docs.,"There's a missing `wget` command in line 97. Here: `docs/dev-setup-non-vagrant.md`.
`# If on 14.04:`
`https://launchpad.net/~tabbott/+archive/ubuntu/zulip/+files/postgresql-9.3-tsearch-extras_0.1.3_amd64.deb`
`sudo dpkg -i postgresql-9.3-tsearch-extras_0.1.3_amd64.deb`.",souravbadami,b'area: documentation (developer) bug',2017-01-29T17:27:11Z,2017-01-29T19:24:54Z
3508,Wikipedia bot crashes when the query contains multiple word delimit by underscore.,The bot is under `contrib_bots/bots`.  Some error handling is needed.,tommyip,b'area: bots bug help wanted',2017-01-29T10:24:47Z,2017-02-09T20:20:53Z
3506,Links to anchors in /help/ documentation are masked by portico header,"If you click on any of the links in the /help/glossary page, you'll find that it basically doesn't work, because the actual heading you were taken to ends up below the floating portico header at the top of the screen.",timabbott,b'area: documentation (user) bug good first issue help wanted',2017-01-29T06:53:27Z,2017-02-01T06:32:55Z
3491,Compose Message: `Restore Draft` not working properly.,"Steps to reproduce:
1. Login as Cordelia.
2. Click on `New Stream Message`. Compose a message.
3. Click outside the compose message box.
4. Now compose a new message with some other topic.
5. Enter the preview mode.
6. Now press the Restore draft, the topic of the message will change but not the message content.
7. Now enter the write mode, the content of the message will also change.
8. Now press enter to send the message, it will just get lost!!

Ideally `Restore Draft` should be displayed only when in `write` mode not in the `preview` mode. -- @timabbott thoughts?",HarshitOnGitHub,b'area: compose bug good first issue help wanted',2017-01-27T21:31:41Z,2017-02-02T19:43:31Z
3489,Compose Message: Pressing 'enter' to send message not working in the preview mode.,"There are actually two related issues involved:

* While composing a `New Stream Message`, pressing enter button while being in the preview mode doesn't the message.
* While composing a `New Private Message` if you press `enter` button while being in preview mode changes the message box into a `New Stream Message` box instead of sending the message.

(Before starting make sure 'Press Enter to send' is checked.)

Steps to reproduce the first issue:
1. Login as Cordelia.
2. Press 'c' to start composing a `New Stream Message`. Compose a new message.
3. Enter into preview mode by pressing the eyeball icon.
4. Now try sending the message by pressing the enter button. It wouldn't get send.

Steps to reproduce the second issue:
1. Login as Cordelia.
2. Press 'C' to start composing a `New Private Message`. Compose a new private message.
3. Enter into preview mode by pressing the eyeball icon.
4. Now try sending the message by pressing the enter button. It wouldn't get send but instead the compose box would change in a `New Stream Message` box with the stream and topic set same as of the message currently being pointed by the pointer.",HarshitOnGitHub,b'area: compose bug good first issue help wanted',2017-01-27T20:43:42Z,2017-02-19T06:49:44Z
3465,Add downwards scrolling in narrows (relevant in rare cases),"@neerajwahi reported an interesting and subtle issue in how Zulip handles narrowing.  It's hard to catch in actual usage (just because the sorts of narrowing situations where it occurs are unusual), but the easiest way to reproduce this is to narrow to @-mentions, scroll up a lot, and then click on the **stream** (not the topic) of a message in a high-traffic stream, and then scroll down.  After about 50 messages, scrolling will stop, with no evidence there are more messages below.

http://zulip.readthedocs.io/en/latest/pointer.html is mandatory reading to understand the below.

Here's why this happens:
* When a browser loads, we fetch into the local cache (and display in the home view) around 1600 messages of history near the user's pointer (where they last left off), and then keep fetching additional history forward until we get to the present.
* When narrowing, we immediately render what can be rendered using the cache, and then fetching ~50 messages in each direction from the message that was clicked on (or the first unread message, if narrowing from the left sidebar and there are any, etc., see the doc above).
* In any view, if you scroll up, we fetch more messages as needed from the server.
* When a user narrows by clicking on e.g. the left sidebar, everything is fine, because the above means messages all the way through current will be present in the home view cache.  However, if one instead scrolls down, we currently don't fetch any more messages from anywhere.  

But if you follow the recipe above, and the 1000 messages of history above the pointer isn't enough to meet the 50 messages below the message you clicked on in that narrow that we fetch from the server, one ends up with a gap and will get buggy behavior.

The correct fix is to add automatic loading of more messages as you scroll down as well, though only active in cases where doing so will actually fetch more messages (almost always, we will be able to be confident it won't, because e.g. when we fetched messages from the server, there weren't 50 past the point we clicked on) to avoid unnecessary loading indicators.

We can probably use the same styling we have for marking the top of the feed and showing a loading indicator there today (with the row with a black Z logo in it).

",timabbott,b'area: message view bug help wanted priority: blocker',2017-01-26T06:48:28Z,2018-03-28T16:14:45Z
3460,emoji: robot_face (🤖) unicode code point not working,"To reproduce, copy and paste 🤖 into a zulip message. (For comparison, 😀 should ""work""). 
The unicode code point is `1f916`. It does appear in `unicode_emoji_names` in `static/js/emoji.js`, and `static/generated/emoji/images/emoji/unicode/1f916.png` exists and is the right thing. This emoji also goes by `:robot_face:`.

The only pattern I've noticed is that according to http://unicode.org/emoji/charts/full-emoji-list.html#1f916, it was introduced in 2015, and trying http://unicode.org/emoji/charts/full-emoji-list.html#1f913 (🤓), also introduced in 2015, has the same problem. Something I tried from 2014 did not. ",rishig,b'area: emoji bug good first issue help wanted',2017-01-26T02:10:52Z,2017-05-16T16:10:06Z
3438,bug fix: Fix recent regression with at-mentioning.,"One of my commits from yesterday erroneously set the
""mentioned"" flag on messages that weren't mentioning
the current user, so you would get the pink/salmon
background when you sent at-mentions to other people.

Now we check the user_id before setting the flag.",showell,None,2017-01-23T23:47:12Z,2017-01-24T00:42:45Z
3432,Messages I sent appear in my mentions,"Just now, I replied to someone else's message, and the message I sent is being treated as though it @-mentions me.

https://chat.zulip.org/#narrow/near/135181/stream/react.20native.20app/topic/android

It appears in https://chat.zulip.org/#narrow/is/mentioned and the background color of the message is pink.

The text of the message was: `@Chathula Sampath I believe so -- check out the README and accompanying documentation at https://github.com/zulip/zulip-mobile for more info`

This happened again with https://chat.zulip.org/#narrow/near/135184/stream/GSoC.202017/topic/Indian.20educational.20system just now.",brainwane,b'area: message view bug',2017-01-23T16:10:06Z,2017-01-27T20:09:02Z
3413,"bots: Reactivating a bot should relist it in ""Your Bots"" section in settings page.","If a disabled bot is reactivated, it doesn't get re-listed in the ""Your Bots"" section in settings page until the page is refreshed.
Steps to reproduce:

1. Login as Iago.
2. Create a test bot(if you don't have one).
3. Go to administration page.
![image](https://cloud.githubusercontent.com/assets/16687990/22175254/771b11fe-e017-11e6-864d-8de67609845b.png)

4. Deactivate your test bot, the edit bot button should have been removed while it isn't.
![image](https://cloud.githubusercontent.com/assets/16687990/22175271/c4d7ade4-e017-11e6-99c1-25c6d8856ab5.png)

5. Go to settings page. ""Yours Bots"" section will not list your deactivated as expected.
![image](https://cloud.githubusercontent.com/assets/16687990/22175298/2a546fd6-e018-11e6-9901-5a0bd4aae7eb.png)

6. Now go to administration page again. You will find that the edit bot button has disappeared but the bot name and email are no longer striked out. Reactivate your bot.
![image](https://cloud.githubusercontent.com/assets/16687990/22175312/754e3328-e018-11e6-9409-530a1a974059.png)

7. The bot will get activated but the edit bot button would not show up while it should have been.
![image](https://cloud.githubusercontent.com/assets/16687990/22175333/dc1c8258-e018-11e6-8d60-45ce601b37ee.png)

8. Now go to settings page again. Your bot will not be shown in ""Your Bots"" section while it should have been.
9. Refresh the page, the bot will get listed and the edit button in the administration page would show up again as expected.
![image](https://cloud.githubusercontent.com/assets/16687990/22175345/00db23b0-e019-11e6-8fe6-98b57ab128ee.png)

Relevant files: static/js/admin.js and static/templates/settings/admin_user_list.handlebars",HarshitOnGitHub,b'area: settings (admin/org) bug good first issue',2017-01-21T15:12:03Z,2017-03-18T04:15:22Z
3411,View returns to home after reload due to being offline,"If my computer is offline and goes back online, Zulip reloads. However, instead of returning to the narrow I was looking at before, it shows me the home view. The original narrow shows up in the URL as `oldhash` but this seems not to do anything. I'm reasonably sure this wasn't happening ~6 months ago.

Observed on `recurse.zulipchat.com`. Example URL:

```
https://recurse.zulipchat.com/#reload:send_after_reload=0+csrf_token=<deleted>+oldhash=narrow%2Fis%2Fmentioned
```

I wind up at the home view instead of looking at my mentions as I was before the reload. This also makes opening topics in new tabs kind of useless.",kamalmarhubi,b'area: misc bug help wanted',2017-01-21T03:07:07Z,2017-03-23T06:53:15Z
3392,upgrade-zulip-from-git should perhaps suppress update-authors-json errors,"Since update-zulip-from-git (our fast deployment process from a zulip Git hash) can get run several times a day, it may make sense to have it not throw an error in the event that update-authors-json fails.  (Since it's an important production management tool that shouldn't depend on a flaky GitHub API endpoint.)

```
Traceback (most recent call last):
  File ""./tools/update-prod-static"", line 71, in <module>
    subprocess.check_call(authors_cmd, stdout=fp)
  File ""/usr/lib/python2.7/subprocess.py"", line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['./tools/update-authors-json']' returned non-zero exit status 1
Traceback (most recent call last):
  File ""/home/zulip/deployments/2017-01-19-17-37-56/scripts/lib/upgrade-zulip-stage-2"", line 75, in <module>
    preexec_fn=su_to_zulip)
  File ""/usr/lib/python2.7/subprocess.py"", line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['./tools/update-prod-static', '--prev-deploy', '/home/zulip/deployments/current']' returned non-zero exit status 1
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/upgrade-zulip-from-git"", line 81, in <module>
    deploy_path, ""--from-git""] + deploy_options)
  File ""/usr/lib/python2.7/subprocess.py"", line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['sudo', '/home/zulip/deployments/2017-01-19-17-37-56/scripts/lib/upgrade-zulip-stage-2', '/home/zulip/deployments/2017-01-19-17-37-56', '--from-git', '--skip-puppet']' returned non-zero exit status 1
```

I'm not sure what the best way to encode that we're running from upgrade-zulip-from-git, since there's a few layers of scripts in there.  @tommyip do you have ideas?",timabbott,b'area: production bug good first issue help wanted',2017-01-19T22:42:36Z,2017-01-24T07:00:56Z
3391,Traceback handling realm_bot update event,"This traceback happens in production and happened for basically all the users in the organization:

```
Message:
Failed to process an event
Cannot read property 'owner' of undefined

Stacktrace:
TypeError: Cannot read property 'owner' of undefined
    at f (static/min/app.577e414b325c.js:1625:565)
       = static/js/bot_data.js line 16 column 20
    at Object.h.update (static/min/app.577e414b325c.js:1626:30)
       = static/js/bot_data.js line 38 column 9
    at h (static/min/app.577e414b325c.js:1520:431)
       = static/js/server_events.js line 94 column 13
    at static/min/app.577e414b325c.js:1527:96
       = static/js/server_events.js line 295 column 20
    at Function.h.each.h.forEach (static/min/common.531c9c89c089.js:219:291)
       = static/third/underscore/underscore.js line 153 column 9
    at k (static/min/app.577e414b325c.js:1526:362)
       = static/js/server_events.js line 299 column 5
    at success (static/min/app.577e414b325c.js:1529:242)
       = static/js/server_events.js line 376 column 17
    at Object.a.success (static/min/app.577e414b325c.js:1008:348)
       = static/js/channel.js line 68 column 16
```

I can reproduce this by opening two browser windows (one as an admin, the other not), and then editing a bot's name in the admin window.",timabbott,b'area: real-time sync bug good first issue help wanted',2017-01-19T22:00:04Z,2017-03-26T01:23:39Z
3388,subs.js traceback in production environments,"We get this traceback sometimes in production:

```
Message:
Cannot read property 'trim' of undefined

Stacktrace:
TypeError: Cannot read property 'trim' of undefined
    at t (static/min/app.577e414b325c.js:1282:458)
       = static/js/subs.js line 531 column 17
    at success (static/min/app.577e414b325c.js:1283:301)
       = static/js/subs.js line 691 column 13
    at Object.a.success (static/min/app.577e414b325c.js:1008:348)
       = static/js/channel.js line 68 column 16
    at Object.g [as success] (static/min/common.531c9c89c089.js:251:25)
       = static/js/blueslip.js line 221 column 20
    at h (static/min/common.531c9c89c089.js:99:423)
       = static/node_modules/jquery/dist/jquery.js line 3232 column 11
    at Object.fireWith [as resolveWith] (static/min/common.531c9c89c089.js:101:153)
       = static/node_modules/jquery/dist/jquery.js line 3362 column 7
    at f (static/min/common.531c9c89c089.js:190:478)
       = static/node_modules/jquery/dist/jquery.js line 9836 column 5
    at XMLHttpRequest.c (static/min/common.531c9c89c089.js:203:218)
       = static/node_modules/jquery/dist/jquery.js line 10302 column 8
```

From looking up the line number, the actual code in question is this (see the `trim()` line there):

Looking at the lines in that code path, I think what's happening is that the success handler in `ajaxSubscribe` is calling `actually_filter_streams`, but the streams modal isn't open.  

This makes sense, because ajaxSubscribe is also called from e.g. the ""subscribe"" buttons at the bottom of a narrow to a stream you're not subscribed to.

So I think we just need to add a check in that success handler for whether the streams modal is open at the time before calling `actually_filter_streams`.",timabbott,b'area: stream settings bug good first issue help wanted',2017-01-19T19:30:23Z,2017-01-19T22:27:05Z
3387,Emoji reactions traceback on click sometimes,"We occasionally get this traceback on production environments:

```
Message:
Cannot read property 'reactions' of undefined

Stacktrace:
TypeError: Cannot read property 'reactions' of undefined
    at k (static/min/app.577e414b325c.js:1626:659)
       = static/js/reactions.js line 27 column 30
    at Object.message_reaction_on_click (static/min/app.577e414b325c.js:1627:332)
       = static/js/reactions.js line 40 column 21
    at HTMLDivElement.<anonymous> (static/min/app.577e414b325c.js:1371:442)
       = static/js/click_handlers.js line 90 column 9
    at HTMLDivElement.g (static/min/common.531c9c89c089.js:251:25)
       = static/js/blueslip.js line 221 column 20
    at HTMLDivElement.dispatch (static/min/common.531c9c89c089.js:125:73)
       = static/node_modules/jquery/dist/jquery.js line 5225 column 16
    at HTMLDivElement.h.handle (static/min/common.531c9c89c089.js:118:327)
       = static/node_modules/jquery/dist/jquery.js line 4878 column 6
```

The relevant code in reactions.js is this:
```
function get_user_list_for_message_reaction(message_id, emoji_name) {                                
    var message = message_store.get(message_id);                                                     
    var matching_reactions = message.reactions.filter(function (reaction) {                          
        return reaction.emoji_name === emoji_name;                                                   
    });                                                                                              
    return matching_reactions.map(function (reaction) {                                              
        return reaction.user.id;                                                                     
    });                                                                                              
}                                                                                                    
```

Which means that we're somehow calling `message_store.get()` on a message ID not present in message_store, despite the fact that the message is currently displayed for the user.  

This will take some spelunking through the JS code to figure out how such a state is possible (message is displayed visually, but not in message store).  One idea I have is that this could be caused be local echo; I'll try adding `console.log` logging to it...",timabbott,b'area: emoji bug help wanted',2017-01-19T19:24:27Z,2017-03-23T03:25:05Z
3380,search: Handle pm-with/sender failures better.,"If a user hand types `pm-with:invalid@example.com` into the search bar, our JS code tries to update the PM list, instead of short-circuiting earlier.  This leads to some spurious errors that we could probably short circuit as soon as we determined the search was invalid.",showell,b'area: left-sidebar area: search bug help wanted priority: high',2017-01-19T03:42:40Z,2018-05-30T11:50:00Z
3371,release 1.5: It's possible to scroll the pointer off the top of the screen when scrolling down,This seems like a fairly significant regression.,timabbott,b'area: message view bug',2017-01-18T19:24:09Z,2017-02-18T00:13:55Z
3369,"Unusual behaviour when fill ""Add a new alert word"" with a space or more","When fill `Add a new alert word` box with a space or more, this happen (the bin icon flow out from the box):

![screenshot from 2017-01-19 00-12-40](https://cloud.githubusercontent.com/assets/20320125/22075263/e9527906-dddd-11e6-8637-6f07ff92e4ff.png)

How to reproduce:
1. Open **Settings**.
2. Find `Custom alert words` and fill `alert word` box with a space or more.

This issue probably slightly related with https://github.com/zulip/zulip/issues/1269",refeed,b'area: settings (user) bug good first issue help wanted',2017-01-18T17:32:41Z,2017-02-17T05:06:36Z
3345,release 1.5: Message emoji reactions showing up only after reload.,"### Note

This issue happens only in newly created streams (e.g. in `GCI class of 2017`, but not in `learning`, which was created a few days before).

### Reproduction

1. Subscribe to `GCI class of 2017`
2. React to a message (e.g. with the 👍 emoji

### Issue

Your reaction will not be displayed instantly; it will show up only after you reloaded the page (see the following gif):
![emoji-bug](https://cloud.githubusercontent.com/assets/7950151/21992103/6bce5e60-dc15-11e6-909c-b520e25bbbe5.gif)
",roberthoenig,b'area: emoji area: real-time sync bug good first issue',2017-01-16T17:00:33Z,2017-03-23T03:22:57Z
3340,"release 1.5: Allow ""home"" topics to work in the left sidebar","If you create a topic called ""home"" and then click on it in the streams/topics sidebar, the app takes you the ""Home"" view.  We must have a piece of code somewhere that makes too tax a regex or search for ""home"" in the link.",showell,b'area: left-sidebar bug',2017-01-16T14:33:52Z,2017-01-16T17:46:06Z
3316,Redirect login page to chat when user is in logged in state,"Just noticed that Zulip login page not redirected automatically to Zulip chat when user is in logged in state. We could see how Facebook handle this smoothly.

**How to reproduce**:
1. Login to Zulip.
2. Open login page, like http://chat.zulip.org/login/
3. And then you will be not redirected to Zulip chat.

**Expected behaviour**:
When user is in logged in state, login page should redirects user automatically to Zulip chat.",refeed,b'area: onboarding bug help wanted',2017-01-14T17:04:51Z,2017-01-29T00:11:15Z
3313,[More...] does not un-collapse single line messages,"[More...] does not un-collapse single line messages

STR:
1. Send a single line message (say, Hi! How's work going?).
2. Collapse this message.
3. Try to un-collapse it using the [More...] symbol.",khantaalaman,b'area: message view bug good first issue help wanted',2017-01-14T11:23:10Z,2017-02-05T20:49:35Z
3301,:black_large_square: and :black_medium_square:... aren't,"STR:

1. Type `:black_large_square:` or `:black_medium_square:` in a Zulip message
2. Notice how a blue square and an orange square appear instead of, you know, black ones",strugee,b'area: emoji bug good first issue help wanted',2017-01-13T21:57:19Z,2017-01-29T08:02:21Z
3296,Extra whitespace in streams sidebar,"When I open zulip, I see extra whitespace in the sidebar. 

I currently have my zoom in chrome set to `125%` in Chrome. When I set it down to `100%` it looks a bit less broken.

**@ 125% Zoom**
![image](https://cloud.githubusercontent.com/assets/1745854/21941455/d205c26c-d996-11e6-83a3-fee97c254d3f.png)

**@ 100% Zoom**
![image](https://cloud.githubusercontent.com/assets/1745854/21941512/0cea0190-d997-11e6-80b1-f1444ada2566.png)

Here's a screenshot of the div that's causing the issue. It looks like a margin issue.

![image](https://cloud.githubusercontent.com/assets/1745854/21941527/22bbcdf0-d997-11e6-9d07-f560d21b8a9e.png)

**I'm using:**
- Chrome (55.0.2883.95)
- Mac OS Sierra (10.12.2)
- Macbook Pro Retina

Thanks!",haroldtreen,b'area: left-sidebar bug good first issue',2017-01-13T18:50:09Z,2017-01-17T03:46:36Z
3295,Reaction box unusual behaviour,"Reaction box just went below the screen when I resized and clicked on reactions smiley
![screen shot 2017-01-14 at 12 14 06 am](https://cloud.githubusercontent.com/assets/14249589/21941505/0814b004-d9ef-11e6-9a89-d4a44e94e5ee.png)
",anirudhjain75,b'area: emoji bug help wanted',2017-01-13T18:48:56Z,2017-09-29T00:47:30Z
3294,/me breaks message layout when entered with a single subsequent space.,"#### Reproduction:

1. Type ""/me "" in the compose box (notice the space after 'me').
2. Send the message.
3. The layout breaks: 
   * Normally, the `/me` command centers the name vertically and appends the message. 
   * Now, the name's letters change from bold to normal and `/me` is appended to the message:
![image](https://cloud.githubusercontent.com/assets/7950151/21940846/6162d268-d9c6-11e6-889b-6ddc2f1c613d.png)
",roberthoenig,b'area: markdown bug feedback wanted good first issue help wanted',2017-01-13T18:28:50Z,2017-02-12T06:30:29Z
3277,Stream descriptions get cut off at the bottom in subscriptions page if they have `g`s in them,"This is presumably a minor CSS issue:

![image](https://cloud.githubusercontent.com/assets/2746074/21914218/7dd7c2cc-d8e6-11e6-9454-02059611e227.png)
",timabbott,b'area: stream settings bug good first issue help wanted',2017-01-13T00:46:02Z,2017-03-10T04:04:37Z
3271,Preview feature doesn't work with long messages,"If you put this message into the compose box and click the preview button, it doesn't work, because we try to send the entire message body as a GET URL parameter, and we overflow maximum lengths for those.

We should move this into the body of the request (probably means switching it to POST), not URL parameters.

```
012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678_012345678901234567890123456789012345678
```",timabbott,b'area: compose bug good first issue help wanted',2017-01-12T22:44:53Z,2017-01-14T00:11:52Z
3258,Broken emojis in email,"![image](https://cloud.githubusercontent.com/assets/2263909/21880176/7bf98148-d8c3-11e6-967b-67814804ce02.png)
![image](https://cloud.githubusercontent.com/assets/2263909/21880235/c7c8d2d6-d8c3-11e6-8f7e-aa4a166c3f10.png)
",akashnimare,b'area: emoji area: notifications (other) bug good first issue help wanted',2017-01-12T07:14:06Z,2017-01-22T06:28:40Z
3215,Notification bot announcements of new streams don't linkify streams properly,"Apparently, our modified notification bot announcements for new streams use the correct markdown syntax `#**streamName**`, but don't actually linkify properly, because the notification bot is in a different realm from the stream it is sending messages to.  We'll need to do something clever to make sure the right realm is used for these messages.  ",timabbott,b'area: markdown bug good first issue help wanted',2017-01-10T19:56:56Z,2017-01-22T05:38:53Z
3172,Hover menu disappears while choosing an emoji reaction,"# Description
When an emoji reaction is being chosen, the message's hover menu disappear.

The box used to choose the emoji has a little arrow, and when the hover menu disappears, it points to the timestamp, which doesn't seem to make much sense.

# Steps to reproduce
1. Log in as Cordelia.
2. Write in *all/(no topic)*:
    ```
    This is a test.
    ```
3. Log out.
4. Log in as Iago.
5. Hover over the message Cordelia sent.
6. Choose the smiley icon to add an emoji reaction.
7. Move the cursor to the box to choose a emoji.
8. The hover menu disappears, causing this:
    ![Issue #3172](https://cloud.githubusercontent.com/assets/7356565/21751876/d78c988a-d5ce-11e6-9fdc-d6a19d74df9f.png)

# Expected behavior
The hover menu should remain until the emoji reaction has been chosen.",YagoGG,b'bug good first issue help wanted',2017-01-08T17:22:12Z,2017-01-11T22:21:35Z
3155,Emoji picker doesn't add emoji after the text cursor,"When clicking on a emoji in emoji picker, the emoji picker didn't add the `emoji text` after the text cursor but the emoji picker add it after the last char. It should be added after the text cursor, not the last char.

This ticket might be a small part of https://github.com/zulip/zulip/issues/1956

![peek 2017-01-07 23-18](https://cloud.githubusercontent.com/assets/20320125/21743226/7156e1ae-d530-11e6-8e70-0bc516500733.gif)
",refeed,b'area: emoji bug good first issue',2017-01-07T16:36:12Z,2017-01-12T23:31:48Z
3151,Subscribing to a stream with is_zephyr_mirror_realm set looks weird,"This is what happens after typing in a stream name and clicking Subscribe.

![image](https://cloud.githubusercontent.com/assets/2746074/21740203/5aaaf518-d467-11e6-9739-44e7d13bbca1.png)

(1) The subscribe button is huge!
(2) It should probably not open the (broken) RHS UI for inviting users at all.
",timabbott,b'area: stream settings bug help wanted',2017-01-07T07:25:42Z,2017-03-22T06:14:49Z
3087,Fix zerver.tests.test_messages.MessageDictTest.test_bulk_message_fetching failing when run alone,See 50d67d9a135a361158813710c411dc9df087daf9 for context.,timabbott,b'area: testing-coverage bug help wanted',2017-01-04T00:26:18Z,2017-01-06T01:34:34Z
3078,Popovers are still visible when looking at lightbox image previews,"This might just be an issue where the lightbox should have a higher z-index than the popovers, but one could also imagine closing popovers when we open the lightbox.",timabbott,b'area: emoji bug good first issue help wanted',2017-01-03T19:10:23Z,2017-01-03T23:34:33Z
3077,Reaction picker popover is sometimes leaked by rerendering of messages,"I think what's happening is that e.g. new messages being sent while the popover is open results in the message containing the popover to be rerendered, destroying the element the popover is hanging off of (`current_message_reactions_popover_elem`) and thus making the code to maintain/remove that popover no longer work.

It's not entirely clear what the right solution is here.  One direction we could investigate is in the message rerendering code path, check if there are any popovers hanging off of the elements being rerendered, and if so move what they are hanging off of.  I'm not sure that's possible with the popover library we're using (from bootstrap 2.x), but if we can get that to work, it would nicely solve this category of problems (which we've had several of, e.g. #2281).",timabbott,b'area: emoji bug good first issue help wanted',2017-01-03T19:08:54Z,2017-01-12T23:07:47Z
3074,Search results not escaping HTML correctly,"# Description
If a non-ASCII display name or an email address is written in the search bar, the results display extraneous characters, coming from a badly escaped HTML.

# Steps to reproduce
## Non-ASCII display names
1. Register a new user, whose name is ""Diego Velázquez"" (notice the `á`).
2. Log in as Diego Velázquez.
3. Write in *devel/(no topic)*:
    ```
    Hey, I am @**Diego Velázquez**!
    ```
4. Type `Diego Velázquez` in the search bar.
5. Press <kbd>Enter</kbd>.
6. The following appears:
![Search bar issue, display name](https://cloud.githubusercontent.com/assets/7356565/21617021/6fb4529a-d1e4-11e6-8bec-848432be76fd.png)


## Emails
1. Log in as Hamlet.
2. Write in *all/(no topic)*:
    ```
    How are you doing, @**Othello, the Moor of Venice**?
    ```
3. Type `othello@zulip.com` in the search bar.
4. Press <kbd>Enter</kbd>.
5. The following appears:
![Search bar issue, email](https://cloud.githubusercontent.com/assets/7356565/21616103/885eb852-d1e0-11e6-96a4-a7b3559db127.png)
",YagoGG,b'area: search bug help wanted',2017-01-03T17:43:48Z,2017-04-28T22:46:16Z
3071,"search: Backend throws 500s for ""foo: bar"" searches","The Zulip server breaks (Traceback displayed in timabbots first comment) throws a 500 error when being confronted with a search that contains multiple search operators. 

*The previous version of this issue included a bug on the front-end, which is shown here for reference:
Previous title: Searchbar breaks with certain ':' colon phrases.
~~1. Enter `foo: bar` in the searchbar.~~
~~2. Press enter.~~
~~3. The window gets in an endless loop and displays the ""Unable to connect"" red pop-up.~~
~~This happened to me when searching for a `error: [Errno 111] Connection refused`~~*

**The front-end bug has been fixed, the back-end bug on the server still remains**",roberthoenig,b'area: search bug good first issue help wanted',2017-01-03T16:17:55Z,2017-01-17T03:43:20Z
3060,hotkeys: Escape key no longer closes compose box,This appears to be a recent regression.,timabbott,b'area: compose area: keyboard UI bug good first issue help wanted',2017-01-02T23:56:08Z,2017-01-03T05:11:54Z
3055,Fix frontend errors in registration form.,"To reproduce:
* Go to `http://localhost:9991/create_realm/`
* Enter your email, click `Create Organization`, and click on the confirmation link in your email. You should now be at `http://localhost:9991/accounts/register/`
* Bug 1: Click `Register`. The `This field is required.` is in an awkward place here:
![image](https://cloud.githubusercontent.com/assets/890911/21595697/bb731950-d0e5-11e6-9ee0-913655d6b80d.png)
* Bug 2: Fill out all the fields, but use `zulip` for `Short Name`, so that the registration fails (`zulip` is already taken). Clicking on Register clears the `Organization Name` and `Organization Type`.
* Enhancement: The error message looks somewhat ugly here, and different from the ""This field is required"" error messages.
![image](https://cloud.githubusercontent.com/assets/890911/21595747/2a613f7c-d0e6-11e6-9fc9-39165e03f1a2.png)
* Bug 3: If you fill out everything other than the Organization Type, you get another awkward `This field is required.` placement
![image](https://cloud.githubusercontent.com/assets/890911/21595778/7741f9ee-d0e6-11e6-9bf8-17ae0b94b372.png)
",rishig,b'area: onboarding bug good first issue help wanted',2017-01-02T20:25:33Z,2017-06-26T21:27:24Z
3025,Zulip emoji not showing in emoji selection menu,"The Zuliip emoji (!!!) is ""invisible"" when you try to search for it in the emoji selection menu. It's the very very last emoji (after `:zzz:`).",lonerz,b'area: emoji bug good first issue help wanted',2016-12-31T03:41:29Z,2017-01-28T00:14:06Z
3000,Header div remains white after opening keyboard shortcuts and search help,"div with class header (top bar) remains white after opening keyboard shortcuts, search help and invite users popups. Shouldn't it be grayed out?
![top](https://cloud.githubusercontent.com/assets/23611943/21560644/428c1816-ce06-11e6-81fd-a268f8e59c6b.PNG)
",jacklqiu,b'area: documentation (user) bug good first issue',2016-12-30T06:35:51Z,2017-01-11T04:47:10Z
2990,release 1.5: Emojis in existing messages point to the wrong link,"The emojis in the messages sent before moving to the new emoji path don't work.

The existing ones point to https://chat.zulip.org/static/third/gemoji/images/emoji/+1.png while the new emoji points to https://chat.zulip.org/static/generated/emoji/images/emoji/+1.png

Maybe we should add a redirect for all those paths to the new location.",sampritipanda,b'area: markdown bug priority: blocker',2016-12-29T23:17:31Z,2017-01-12T18:13:51Z
2968,Bugdown: Embed feature should be disabled for bots.,"The markdown processor has a feature which inlines information from websites linked in the chat. This feature should be disabled for bots because it can replicate the information that they display.

An example of what that can look like is here:
![](https://chat.zulip.org/user_uploads/2/c9/wyjj5Vn86XOOz6psz47Tu9UZ/2016-12-11-144157_1366x768_scrot.png)
",zacps,b'area: markdown bug good first issue help wanted',2016-12-28T19:22:22Z,2017-02-04T01:09:13Z
2932,"search: Fix autocomplete for ""from"".","Currently one can search for messages sent by <user> using either ""sender:<user>"" or ""from:<user>"". The ""sender"" formulation autocompletes, but the ""from"" formulation doesn't. The first place I would look is `static/js/filter.js`, and see if there is anything different in how we treat ""sender"" and ""from"".",rishig,b'area: search bug good first issue help wanted',2016-12-27T05:24:09Z,2017-01-12T00:31:24Z
2930,Adding missing encodeURIComponent on some `PATCH /json/streams/` uses,"Our frontend correctly uses encodeURIComponent(stream_name) in only half of the instances it should it when doing PATCH on `/json/streams`, and thus those other calls probably won't work in the event that the stream names contain unusual characters.",timabbott,b'area: stream settings bug good first issue help wanted',2016-12-27T00:25:15Z,2017-01-12T23:23:32Z
2913,"Left sidebar automatically closed when clicking on ""Filter stream list"" button on responsive condition","On responsive condition, when we click on ""Filter stream list"" button, the left sidebar automatically closed, I think it should be not automatically closed.

How to reproduce:
1. Login to Zulip.
2. Resize the browser window until Zulip transform to responsive.
3. Click on the **Filter stream list** button.

And the left sidebar will be automatically closed.

![peek 2016-12-26 01-58](https://cloud.githubusercontent.com/assets/20320125/21472518/10a07150-cb11-11e6-92f6-3f37c1de7d3f.gif)

(Sorry for the buggy gif)",refeed,b'area: left-sidebar bug good first issue help wanted',2016-12-25T19:18:44Z,2017-09-08T18:20:37Z
2902,Quality Assurance: Unread messages not showing after pinning,"To reproduce this bug, you first need to find a stream that has unread messages (the number to the right of a stream's name shows how many unread messages in that stream you have). Hover over that stream and press the arrow to the right of that stream's name and press **Pin stream ... to top**. The number that indicates how many unread messages in that stream you have will not be shown, until you narrow to the stream itself or reload the page. This also works with unpinning a stream.

![bugpin1](https://cloud.githubusercontent.com/assets/15861879/21468947/c3f9069a-ca30-11e6-9b9b-0229d6525b86.png)

This first screenshot was taken just after pinning the stream **test**

![bugpin2](https://cloud.githubusercontent.com/assets/15861879/21468949/d21f342e-ca30-11e6-8ff5-7a9db41b1658.png)

This second screenshot was taken after clicking the **test** stream. As you can see, in the first screenshot it doesn't show that there are 46 unread messages in test.",ghost,b'area: left-sidebar bug good first issue help wanted',2016-12-24T22:30:30Z,2017-01-17T04:07:35Z
2901,Quality Assurance: Collapse not working when viewing source,"If you view the source of a message (by pressing the arrow next to the message and pressing **View Source**), and then collapse that message (by pressing the arrow next to the message and pressing **Collapse**), the message won't be collapsed. It will just show the source of the message and a [More...] button that does nothing when pressed.

![collapsebug](https://cloud.githubusercontent.com/assets/15861879/21468927/cd5c6db4-ca2e-11e6-82f4-ae43ab4d8c12.png)

This looks to me as a bug and not a feature, as it renders the **Collapse** feature useless when viewing the source of a message. This issue probably wouldn't be too hard to fix.",ghost,b'area: message-editing bug good first issue help wanted',2016-12-24T22:17:42Z,2017-03-23T02:03:35Z
2886,Unexpected behavior if the content of a message is `>>>>>>>>>>>>>>`. ,"If the content of a message is a line of markdown quotes like this:
`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>`
Other users would see a the quotes for a fraction of a second then a blank message box with decreased height.

Input: `>>>>>>>>>>>>>>>>>>>>>>>>>>>>>`
Expected output: `>>>>>>>>>>>>>>>>>>>>>>>>>>>>>`
Actual output:
![bug_quotes](https://cloud.githubusercontent.com/assets/18504232/21452943/749e938c-c902-11e6-9ee2-02f339998b7c.png)
",tommyip,b'area: markdown bug good first issue',2016-12-23T11:27:56Z,2017-11-17T19:45:54Z
2882,Upgrade npm packages,"Got this while `./tools/provision.py`
```bash
npm WARN deprecated minimatch@0.2.14: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated minimatch@2.0.10: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated tough-cookie@2.2.2: ReDoS vulnerability parsing Set-Cookie https://nodesecurity.io/advisories/130
npm WARN deprecated node-uuid@1.4.7: use uuid module instead
```

We should probably upgrade them.",s0nskar,b'area: dependencies bug help wanted',2016-12-23T04:30:02Z,2016-12-27T19:03:15Z
2869,Quality Assurance - Emoji box blocked chat view ,"If you open up the emoji box, the compose box would block the view to the lowest chat messages and one cannot scroll down further. This doesn't cause any major issues though.
![image](https://cloud.githubusercontent.com/assets/18504232/21437001/357e34b6-c879-11e6-8f88-74c61726cdab.png)
",tommyip,b'area: compose bug good first issue help wanted',2016-12-22T19:03:57Z,2017-03-23T02:02:04Z
2862,Purge repository of bare excepts (`except:`) and add lint rule,"It's basically never a good idea to use a bare except (e.g. `except:`), since those will also block using ctrl-C to stop a process.  We should at least be using `except Exception`, but I'd also like to audit all the places we're currently using a bare except to confirm that we should actually be eating all exceptions at that point.

And then we should add a lint rule banning bare excepts from the codebase.",timabbott,b'area: refactoring bug help wanted',2016-12-22T14:41:32Z,2017-03-06T00:17:22Z
2840,Administration page javascript issue processor event coming from bot name changes,"Reproducer: Open the javascript console, and go to the admin bots page:

![image](https://cloud.githubusercontent.com/assets/2746074/21408294/1ab9f7e6-c789-11e6-9d73-d7724932f37c.png)

Deactivate a bot, and then immediately reactivate it.  Then, try changing its name.  The operation will succeed, but you'll get this traceback in the console (and the name won't change in the current browser):

![image](https://cloud.githubusercontent.com/assets/2746074/21408281/09d0e03e-c789-11e6-8b9b-1ea547ba46ce.png)

It seems likely that the server needs to send an event when a bot is reactivated (if we don't already) and what we're missing is processing for those real-time events.

This is somewhat low priority since it's an unusual use case, but worth fixing if someone has the time.",timabbott,b'area: settings (admin/org) bug good first issue',2016-12-21T22:26:13Z,2017-03-01T00:11:51Z
2838,Administration page state issue when editing users.,"On http://127.0.0.1:9991/#administration/user-list-admin, make a user an admin, remove their admin status, and then try to modify their name.  The input field for the name will incorrectly not initialize to the user's current name.",timabbott,b'area: settings (user) bug good first issue help wanted',2016-12-21T21:38:03Z,2017-01-24T21:18:42Z
2834,Notify everyone button should have bootstrap styling.,"The button is currently just default native button styling.
![all_bug](https://cloud.githubusercontent.com/assets/18504232/21400536/7d277574-c7a8-11e6-93d3-24f939da424d.png)
",tommyip,b'area: compose bug good first issue help wanted',2016-12-21T18:09:16Z,2016-12-30T20:40:00Z
2818,Quality Assurance - Stream settings cannot be closed with button,"How to reproduce:

1. Drag your browser to one side of the window
2. Click on the stream settings button
3. Click directly on the close button
4. The modal does not close unless you click slight below the button

This problem does not exist when the browser is maximized (Bootstrap desktop size grid).

(Sorry for the poor quality of the gif, github limits the file size to 10mb)
![final](https://cloud.githubusercontent.com/assets/18504232/21373934/98ac8c5a-c71a-11e6-8453-737bae21d41a.gif)
",tommyip,b'area: stream settings bug',2016-12-21T01:15:00Z,2016-12-27T02:31:46Z
2767,Quality Assurance - link in Settings does not open,"Reproduction:
1. Navigate to Settings->Notifications
2. Under Stream messages, there is the phrase
> Change notification settings for individual streams on your Streams page.
3. Click on `Streams page`.
4. You would expect to be redirected to ""https://chat.zulip.org/#subscriptions"". This link is also set in the browser address bar, but not opened. Instead, the Settings windows remains dominant.
![image](https://cloud.githubusercontent.com/assets/7950151/21294523/d1fa394a-c53e-11e6-84e1-8103f49225a6.png)
",roberthoenig,b'area: settings (user) bug',2016-12-18T15:27:48Z,2017-02-13T04:53:18Z
2735,Surprising performance problem loading the /help/ homepage,"Testing on my development environment, loading `http://127.0.0.1:9991/help/` takes like 7s to load, all in backend time, as clearly shown by the server logs.  It's unclear why.",timabbott,b'area: documentation (developer) area: misc bug help wanted',2016-12-16T05:00:36Z,2016-12-16T05:42:16Z
2734,Frontend regression managing the pointer with local echo and USE_WEBSOCKETS=False,"In the last couple days I've noticed a new issue that goes as follows:
* I send a message
* I immediately advance the pointer onto the locally echoed message (hard to do, and probably impossible to do locally, since it's a race against message delivery latency).
* The message finishes sending and is delivered to my browser (adding the timestamp in the upper-right).  This rerenders the message, and appears to defocus the message (that last bit is new).

I bet we can reproduce this reliably by just making `do_send_messages` have a 10s sleep at the start so that there's plenty of time to win the race to complete step 2 before step 3 happens.

@brockwhittaker I'm guessing this was introduced in your recent focus changes; can you investigate?

UPDATE: We've confirmed that this only happens if `settings.USE_WEBSOCKETS` is disabled (at the time of the bug report, websockets were accidentally disabled for everyone due to another bug).  This is still important since some organizations disable that setting.  ",timabbott,b'area: message view bug good first issue help wanted',2016-12-16T02:03:22Z,2019-08-08T00:17:26Z
2732,Fix sqlalchemy deprecation warnings in test suite,"`tools/test-backend test_messages test_narrow` is a reproducer, the output looks like this:
```
Running zerver.tests.test_messages.StarTests.test_change_star
/srv/zulip-py3-venv/lib/python3.5/site-packages/sqlalchemy/sql/selectable.py:43: SAWarning: Textual SQL FROM expression 'zerver_usermessage' should be explicitly declared as text('zerver_usermessage'), or use table('zerver_usermessage') for more specificity (this warning may be suppressed after 10 occurrences)
  {""expr"": util.ellipses_string(element)})
```

We should investigate these and figure out what the correct solution is to clean up the output; it will probably involve some minor changes to the actual narrowing code.  The goal is to make no functional changes.",timabbott,b'area: dependencies bug good first issue help wanted',2016-12-16T01:09:30Z,2017-02-23T04:52:44Z
2731,Silence `WARNING Not found` when 404s happen in test suite,"Zulip has various tests that intentionally check that something 404s; for some reason, the Django 1.10 test runner prints a warning for each one (at least on Python 3.5).  They are basically spam for the purposes of our output, so we should silence them.

```
Running zerver.tests.test_signup.PublicURLTest.test_public_urls
2016-12-15 20:00:26,671 WARNING  Not Found: /help/nonexistent
```

@umairwaheed this may be a good thing for you to look into.  I'[m guessing we need to add something to our LOGGERS configuration.",timabbott,b'area: testing-infrastructure bug',2016-12-16T01:07:23Z,2016-12-19T17:13:55Z
2730,Replace deprecated `self.assertEquals` with `self.assertEqual`,"If you run `test-backend`, with Django 1.10, we now get tons of these warnings.

/home/tabbott/zulip/zerver/tests/test_upload.py:582: DeprecationWarning: Please use assertEqual instead.
  self.assertEquals(sanitize_name(u'tarball.tar.gz'), u'tarball.tar.gz')

We should be able to clean them up pretty quickly with `git grep` and `sed -i`.",timabbott,b'area: testing-infrastructure bug good first issue',2016-12-16T00:48:20Z,2016-12-16T01:02:33Z
2729,Naive datetime warnings in populate_db,"This output is generated every time we provision:

```
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.072319) while time zone support is active.
  RuntimeWarning)
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.082099) while time zone support is active.
  RuntimeWarning)
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.085108) while time zone support is active.
  RuntimeWarning)
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.088053) while time zone support is active.
  RuntimeWarning)
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.090953) while time zone support is active.
  RuntimeWarning)
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.094410) while time zone support is active.
  RuntimeWarning)
/srv/zulip-venv-cache/2ded3ad4731e6a2943352f72cd4f555ecd484fc5/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/fields/__init__.py:1430: RuntimeWarning: DateTimeField UserPresence.timestamp received a naive datetime (2016-12-15 19:38:41.097529) while time zone support is active.
```

I think this is a regression introduced in #2626, but masked by the fact that these warnings may not have been displayed before the Django 1.10 upgrade.

The solution is to use timezone-aware datetime objects; we do this generally with `django.util.timezone.now()` in Zulip.",timabbott,b'area: testing-infrastructure bug good first issue',2016-12-16T00:47:05Z,2016-12-21T01:48:23Z
2727,./manage.py sync_api_key deprecation warnings,"`zilencer/management/commands/sync_api_key.py` is a useful tool that makes it easy to ensure a particular development environment user always has the same API key.  It has some deprecation warnings when run under python 3 (`source /srv/zulip-py3-venv/bin/activate` to use Python 3), however:

```
+ ./manage.py sync_api_key
/home/tabbott/zulip/zilencer/management/commands/sync_api_key.py:19: DeprecationWarning: The SafeConfigParser class has been renamed to ConfigParser in Python 3.2. This alias will be removed in future versions. Use ConfigParser directly instead.
  config = SafeConfigParser()
/home/tabbott/zulip/zilencer/management/commands/sync_api_key.py:21: DeprecationWarning: This method will be removed in future versions.  Use 'parser.read_file()' instead.
  config.readfp(f, config_file)
```

We should updated it to use current APIs.",timabbott,b'area: testing-infrastructure bug good first issue',2016-12-16T00:42:40Z,2016-12-30T19:53:06Z
2723,Travis CI failure in production test suite,"We also seem to now have this new flake: https://travis-ci.org/zulip/zulip/jobs/184210583
That's specifically a failure trying to connect to the Zulip server post-upgrade. Might be caused by the uwsgi migration.

From https://chat.zulip.org/#narrow/stream/development.20help/topic/travis.20CI.20production

@umairwaheed any ideas?  One thing we could try doing to debug is adding a `supervisorctl status` or `ps -ef` just before this to see whether the `uwsgi` service is up.",timabbott,b'area: testing-infrastructure bug',2016-12-15T20:47:18Z,2016-12-16T06:06:58Z
2707,Buggy markdown interaction of mentions with bulleted lists,"If you use this markdown syntax:
```
* @**Cordelia Lear** 
    * test
```

Bugdown will render it as:

![image](https://cloud.githubusercontent.com/assets/2746074/21199050/a619057c-c1f6-11e6-81b5-ca7a8fb5db31.png)

This is probably a subtle issue with our regular expressions.",timabbott,b'area: markdown bug help wanted',2016-12-14T20:13:15Z,2017-07-18T08:55:59Z
2701,New people.js logic breaks when interacting with deactivated users,"Reproducer: Deactivate one of the users who participated in a group PM conversation in the sample messages (using the admin UI) and reload the page.  You'll get a traceback like this:

![image](https://cloud.githubusercontent.com/assets/2746074/21174387/b5e25220-c191-11e6-94ac-51a615907d43.png)

This is a recent regression caused by the migration to use user IDs in a lot of our people logic; the problem is that the `people.js` data store doesn't have data on users who have been deactivated.  Probably a reasonable fix would be to send down basic data on deactivated users, but perhaps it's worth looking at having the frontend make skeleton users for these instead?

@showell this is probably a good bug for you :)",timabbott,b'area: real-time sync bug',2016-12-14T08:13:19Z,2016-12-16T01:47:09Z
2698,Add i18n lint rule for title= in HTML templates,I've noticed we seem to have several places where we're using the `title` feature of HTML to show titles of things on mouseover that aren't correctly tagged for translation.  We should add a lint rule and sweep the existing codebase for issues of this form.,timabbott,b'area: i18n bug',2016-12-14T04:43:52Z,2016-12-15T21:45:00Z
2697,notification settings save button reloads page,"On the /#settings page, change some notifications settings and hit save: it's reload the page.

This is likely some sort of bug where we're missing preventDefault on the click handler for the save button.",timabbott,b'area: notifications (other) area: settings (user) bug good first issue help wanted',2016-12-14T04:19:39Z,2016-12-15T00:33:36Z
2663,"Tornado 500 error, unhandled exceptions in python2.7/threading.py (?)","I'm not entirely certain these two examples are related, but they look similar aside from one with unhandled exceptions and one not. Both caused 500 errors from Tornado, after which it restarted. The client is OS X Safari, connected but idle. The server is Ubuntu 14.04 on an Intel NUC with 2GB of memory. x.x.x.74 is my firewall, so anything from that address is my laptop on the internal network (via ethernet.) The server is outside the firewall. 

The server has not yet been rebooted, although I was planning to do that soon-ish. I can wait if that is helpful, as it's not impacting other work at the moment.

I did see the first example periodically the past couple weeks, but at those times I was actively testing new webhook code that was very broken. The second example has four threads with simultaneous unhandled exceptions, so they are stepping all over each other in the tracebacks. 

There's some zombies that look to be the result of the earlier example:
```
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
feorlen  26577  0.0  0.0      0     0 pts/0    Z+   13:05   0:05 [python] <defunct>
feorlen  26579  0.0  0.0      0     0 pts/0    Z+   13:05   0:00 [python] <defunct>

$ ps -ef | grep -i tornado
feorlen  26576 26337 20 13:05 pts/0    00:51:57 /srv/zulip-venv/bin/python ./manage.py runtornado --settings=zproject.settings 127.0.0.1:9993 --traceback --traceback

$ pstree -p -s 26576
init(1)───sshd(956)───sshd(19296)───sshd(19390)───bash(19391)───python(26337)───python(26576)
```

First example:

```
2016-12-09 18:42:56,173 INFO     Tornado  26.5% busy over the past 59.9 seconds
2016-12-09 18:43:01,174 INFO     Tornado  26.2% busy over the past 59.8 seconds
2016-12-09 18:43:06,341 INFO     Tornado  26.4% busy over the past 59.5 seconds
2016-12-09 18:43:11,673 INFO     Tornado  26.4% busy over the past 59.9 seconds
2016-12-09 18:43:17,173 INFO     Tornado  26.3% busy over the past 59.9 seconds
2016-12-09 18:43:22,338 INFO     Tornado  26.3% busy over the past 60.0 seconds
2016-12-09 18:43:23,293 INFO     127.0.0.1       GET     200  27ms (lp: 47.1s) (+start: 19ms) /json/events [1481317531:0/1/heartbeat] (ZOE@zulip.com via website)
2016-12-09 18:43:27,673 INFO     Tornado  26.3% busy over the past 59.9 seconds
2016-12-09 18:43:33,174 INFO     Tornado  26.4% busy over the past 59.9 seconds
2016-12-09 18:43:33,428 INFO     Received event: {u'status': 1, u'user_profile_id': 2, u'client': u'website', u'time': 1481327013}
2016-12-09 18:43:33,563 INFO     127.0.0.1       POST    200 148ms (db: 15ms/3q) (+start: 14ms) /json/users/me/presence (ZOE@zulip.com via website)
2016-12-09 18:43:38,338 INFO     Tornado  26.3% busy over the past 60.0 seconds
2016-12-09 18:43:43,674 INFO     Tornado  26.2% busy over the past 59.9 seconds
2016-12-09 18:43:45,859 INFO     Tornado dumped 1 event queues in 0.000s
ERROR:tornado.access:599 GET /json/events?dont_block=false&queue_id=1481317531%3A0&last_event_id=114 (x.x.x.74) 22538.91ms
ERROR:tornado.access:500 GET /sockjs/info?cb=mj6lof1bau (x.x.x.74) 16.55ms
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481317531%3A0&last_event_id=114 (x.x.x.74) 17.62ms
ERROR:tornado.access:500 GET /sockjs/info?cb=x1vf99lwsr (x.x.x.74) 13.37ms
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481317531%3A0&last_event_id=114 (x.x.x.74) 7.46ms
ERROR:tornado.access:500 GET /sockjs/info?cb=8nk7bjll6h (x.x.x.74) 13.20ms
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481317531%3A0&last_event_id=114 (x.x.x.74) 14.35ms
Performing system checks...

ERROR:tornado.access:500 GET /sockjs/info?cb=lqfr6jtcbg (x.x.x.74) 5.21ms
System check identified no issues (0 silenced).
December 09, 2016 - 18:44:02
Django version 1.8.15, using settings 'zproject.settings'
Starting development server at http://127.0.0.1:9992/
Quit the server with CONTROL-C.
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481317531%3A0&last_event_id=114 (x.x.x.74) 10.68ms
Validating Django models.py...
System check identified no issues (0 silenced).

Django version 1.8.15
Tornado server is running at http://127.0.0.1:9993/
Quit the server with CTRL-C.
2016-12-09 18:44:02,711 INFO     Tornado loaded 1 event queues in 0.000s
2016-12-09 18:44:02,723 INFO     Tornado  99.1% busy over the past  0.0 seconds
2016-12-09 18:44:04,165 INFO     14 queue worker threads were launched
2016-12-09 18:44:08,075 INFO     Tornado  21.9% busy over the past  5.4 seconds

```

Second example: 

```
2016-12-09 20:08:11,206 INFO     Tornado  25.9% busy over the past 59.9 seconds
2016-12-09 20:08:16,206 INFO     Tornado  25.9% busy over the past 59.9 seconds
2016-12-09 20:08:17,783 INFO     Received event: {u'status': 1, u'user_profile_id': 2, u'client': u'website', u'time': 1481332097}
2016-12-09 20:08:17,936 INFO     127.0.0.1       POST    200 206ms (mem: 13ms/1) (db: 23ms/3q) (+start: 33ms) /json/users/me/presence (ZOE@zulip.com via website)
2016-12-09 20:08:21,207 INFO     Tornado  25.9% busy over the past 59.9 seconds
2016-12-09 20:08:26,706 INFO     Tornado  25.9% busy over the past 59.9 seconds
2016-12-09 20:08:30,887 INFO     127.0.0.1       GET     200  16ms (lp: 54.0s) (+start: 6ms) /json/events [1481327028:0/1/heartbeat] (ZOE@zulip.com via website)
2016-12-09 20:08:32,076 INFO     Tornado  26.1% busy over the past 60.0 seconds
2016-12-09 20:08:37,206 INFO     Tornado  25.9% busy over the past 59.9 seconds
2016-12-09 20:08:42,707 INFO     Tornado  25.8% busy over the past 59.8 seconds
2016-12-09 20:08:48,076 INFO     Tornado  25.8% busy over the past 60.0 seconds
2016-12-09 20:08:53,206 INFO     Tornado  25.8% busy over the past 59.9 seconds
2016-12-09 20:08:58,706 INFO     Tornado  25.7% busy over the past 59.9 seconds
2016-12-09 20:09:02,814 INFO     Tornado removed 0 idle event queues owned by 0 users in 0.000s.  Now 1 active queues, 1 handlers, latest ID 150
2016-12-09 20:09:03,707 INFO     Tornado  25.6% busy over the past 59.9 seconds
2016-12-09 20:09:07,717 INFO     Received event: {u'status': 2, u'user_profile_id': 2, u'client': u'website', u'time': 1481332147}
2016-12-09 20:09:07,899 INFO     127.0.0.1       POST    200 201ms (db: 19ms/3q) (+start: 13ms) /json/users/me/presence (ZOE@zulip.com via website)
ERROR:tornado.access:599 GET /json/events?dont_block=false&queue_id=1481327028%3A0&last_event_id=82 (x.x.x.74) 37388.04ms
2016-12-09 20:09:08,293 INFO     Tornado dumped 1 event queues in 0.000s
ERROR:tornado.access:500 GET /sockjs/info?cb=50x45m1ftu (x.x.x.74) 6.99ms
Unhandled exception in thread started by <bound method Threaded_worker.__bootstrap of <Threaded_worker(Thread-5, stopped daemon 140574771529472)>>Unhandled exception in thread started by <bound method Threaded_worker.__bootstrap of <Threaded_worker(Thread-10, stopped daemon 140574382049024)>>Unhandled exception in thread started by <bound method Threaded_worker.__bootstrap of <Threaded_worker(Thread-12, stopped daemon 140574365263616)>>Unhandled exception in thread started by <bound method Threaded_worker.__bootstrap of <Threaded_worker(Thread-14, stopped daemon 140574212486912)>>
Traceback (most recent call last):

Traceback (most recent call last):

Traceback (most recent call last):
  File ""/usr/lib/python2.7/threading.py"", line 783, in __bootstrap

Traceback (most recent call last):
  File ""/usr/lib/python2.7/threading.py"", line 783, in __bootstrap
  File ""/usr/lib/python2.7/threading.py"", line 783, in __bootstrap
  File ""/usr/lib/python2.7/threading.py"", line 783, in __bootstrap
    self.__bootstrap_inner()
          File ""/usr/lib/python2.7/threading.py"", line 823, in __bootstrap_inner
    (self.name, _format_exc()))
  File ""/usr/lib/python2.7/traceback.py"", line 241, in format_exc
self.__bootstrap_inner()
self.__bootstrap_inner()
    etype, value, tb = sys.exc_info()
AttributeError: 'NoneType' object has no attribute 'exc_info'  File ""/usr/lib/python2.7/threading.py"", line 823, in __bootstrap_inner
    (self.name, _format_exc()))
  File ""/usr/lib/python2.7/traceback.py"", line 241, in format_exc
    etype, value, tb = sys.exc_info()
AttributeError: 'NoneType' object has no attribute 'exc_info'
  File ""/usr/lib/python2.7/threading.py"", line 823, in __bootstrap_inner
    (self.name, _format_exc()))
  File ""/usr/lib/python2.7/traceback.py"", line 241, in format_exc
    etype, value, tb = sys.exc_info()
AttributeError: 'NoneType' object has no attribute 'exc_info'
    self.__bootstrap_inner()
  File ""/usr/lib/python2.7/threading.py"", line 823, in __bootstrap_inner

    (self.name, _format_exc()))
  File ""/usr/lib/python2.7/traceback.py"", line 241, in format_exc
    etype, value, tb = sys.exc_info()
AttributeError: 'NoneType' object has no attribute 'exc_info'
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481327028%3A0&last_event_id=82 (x.x.x.74) 11.86ms
ERROR:tornado.access:500 GET /sockjs/info?cb=qs6en3z5cd (x.x.x.74) 17.26ms
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481327028%3A0&last_event_id=82 (x.x.x.74) 17.37ms
ERROR:tornado.access:500 GET /sockjs/info?cb=9_kewsgg2y (x.x.x.74) 8.94ms
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481327028%3A0&last_event_id=82 (x.x.x.74) 11.23ms
Performing system checks...

System check identified no issues (0 silenced).
ERROR:tornado.access:500 GET /sockjs/info?cb=up3gbrgogy (x.x.x.74) 23.32ms
December 09, 2016 - 20:09:24
Django version 1.8.15, using settings 'zproject.settings'
Starting development server at http://127.0.0.1:9992/
Quit the server with CONTROL-C.
Validating Django models.py...
ERROR:tornado.access:500 GET /json/events?dont_block=true&queue_id=1481327028%3A0&last_event_id=82 (x.x.x.74) 14.29ms
System check identified no issues (0 silenced).

Django version 1.8.15
Tornado server is running at http://127.0.0.1:9993/
Quit the server with CTRL-C.
2016-12-09 20:09:24,785 INFO     Tornado loaded 1 event queues in 0.000s
2016-12-09 20:09:24,795 INFO     Tornado  99.3% busy over the past  0.0 seconds
2016-12-09 20:09:26,165 INFO     14 queue worker threads were launched
2016-12-09 20:09:30,166 INFO     Tornado  21.1% busy over the past  5.4 seconds
2016-12-09 20:09:35,166 INFO     Tornado  22.0% busy over the past 10.4 seconds
2016-12-09 20:09:35,405 INFO     127.0.0.1       SOCKET  200   0ms /socket/open [transport=websocket] (unknown via ?)
2016-12-09 20:09:35,497 INFO     127.0.0.1       SOCKET  200  80ms (db: 12ms/3q) /socket/auth [transport=websocket] (ZOE@zulip.com via ?)
2016-12-09 20:09:36,249 INFO     127.0.0.1       GET     200  11ms (+start: 44ms) /json/events [1481327028:0/1/restart] (ZOE@zulip.com via website)
2016-12-09 20:09:36,473 INFO     127.0.0.1       DELETE  200  20ms (+start: 8ms) /json/events [1481327028:0] (ZOE@zulip.com via website)
2016-12-09 20:09:37,951 INFO     127.0.0.1       GET     200  23ms /api/v1/events [1481332150:0/0] (ZOE@zulip.com via internal)
2016-12-09 20:09:38,479 INFO     127.0.0.1       GET     200  15ms /api/v1/events [1481332150:0/0] (ZOE@zulip.com via internal)
2016-12-09 20:09:39,877 INFO     127.0.0.1       GET     200  2.0s (mem: 8ms/7) (db: 266ms/17q) (+start: 17ms) / [1481332150:0] (ZOE@zulip.com via website)
2016-12-09 20:09:40,283 INFO     Tornado  28.6% busy over the past 15.5 seconds
```
",feorlen,b'area: provision bug help wanted',2016-12-10T01:52:21Z,2017-08-17T01:55:20Z
2659,Long bot names make Admin/bots tab unusable.,"If a bot's name is really long, it does not get line wrapped in the Administration/bots tab. It pushes all other columns out of the visible table area.

Steps to reproduce:

1.  Create a bot with very long name
2.  Log into admin account and navigate to the Admin/Bots tab.
3.  The email/owner/actions column will not be visible. ",tommyip,b'area: settings (user) bug good first issue help wanted',2016-12-09T17:23:13Z,2016-12-21T22:57:14Z
2657,Limit bots for admins on the settings page.,"If an admin goes to their own personal settings page, they see all the other others's bots now.  They should only see their own there.  When we fix this, we'll need to make sure that the admin can still see all the bots on the Administration page and be able to change them for other users.",showell,b'area: settings (user) bug',2016-12-09T15:49:32Z,2016-12-15T03:29:56Z
2650,python3: python-gcmclient doesn't work on Python 3,"One gets this traceback:
```
2016-12-08 11:58:27,225 ERROR    Problem handling data on queue missedmessage_mobile_notifications
Traceback (most recent call last):
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zerver/worker/queue_processors.py"", line 83, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zerver/worker/queue_processors.py"", line 226, in consume
    handle_push_notification(data['user_profile_id'], data)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zerver/decorator.py"", line 546, in wrapped_func
    ret = func(*args, **kwargs)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zerver/lib/actions.py"", line 3376, in handle_push_notification
    send_android_push_notification(user_profile, android_data)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zerver/decorator.py"", line 546, in wrapped_func
    ret = func(*args, **kwargs)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zerver/lib/push_notifications.py"", line 207, in send_android_push_notification
    res = gcm.send(msg)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zulip-py3-venv/lib/python3.4/site-packages/gcmclient/gcm.py"", line 498, in send
    data = message._prepare(headers)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zulip-py3-venv/lib/python3.4/site-packages/gcmclient/gcm.py"", line 146, in _prepare
    payload = self._prepare_payload(data=data, options=options)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zulip-py3-venv/lib/python3.4/site-packages/gcmclient/gcm.py"", line 134, in _prepare_payload
    payload = super(JSONMessage, self)._prepare_payload(data=data, options=options)
  File ""/home/zulip/deployments/2016-12-08-01-49-45/zulip-py3-venv/lib/python3.4/site-packages/gcmclient/gcm.py"", line 77, in _prepare_payload
    for opt, flt in self.OPTIONS.iteritems():
AttributeError: 'dict' object has no attribute 'iteritems'
```",timabbott,b'area: dependencies bug help wanted',2016-12-08T19:02:47Z,2016-12-15T20:17:51Z
2639,Make `tools/test-documentation` verify the links in the /help/ articles,"We've had a decent number of typos resulting in broken links in that content, and it seems like it'd be pretty easy to just verify them explicitly.  Probably just involves some configuration for the `test-documentation` crawler.

@kkanahin do you want to take this task?  localhost:9991/help/ is the set of pages under discussion.",timabbott,b'area: testing-coverage bug good first issue help wanted',2016-12-08T00:21:24Z,2016-12-16T17:09:35Z
2627,Emoji Menu shows 9 sets of same emoji,"To view the bug simply start a new message, open the emoji menu, and scroll through it. I looked over the menu and counted the :100: emoji 9 times. I can't include a screenshot of the bug in this issue so I uploaded an example to dropbox [here](https://www.dropbox.com/s/8dg12kvrzrekk8j/zulip%20multiple%20of%20same%20emoji.mov?dl=0). Thanks!",1Niels,b'area: emoji bug good first issue help wanted',2016-12-07T01:36:55Z,2017-01-30T01:12:09Z
2607,missedmessage_emails queue worker can backlog when inviting many users to a stream,"Currently, if someone creates a new stream and invites all 500 people in an organization (which is a reasonable thing to do sometimes), we send a PM to all 500 people, which often generates an email.  Zulip's message sending infrastructure handles this fine, but then we end up with a backlogged outgoing email queue, since sending outgoing emails is an expensive operation, intentionally made slow by providers to prevent spam.

We can't easily just parallelize the missedmessage queue worker, because it does 2 things: aggregation/construction of the emails and the actual email delivery.

I think the structural thing we want to do here is the following:
* Modify `do_send_missedmessage_events_reply_in_zulip` to put emails in a new queue worker to be sent, rather than actually sending them.  I think this might be most simply implemented by just having the `missedmessage_emails` queue worker write things out to a new queue after its every-2-minutes drain+aggregate operations.
* Add a new `missedmessage_email_senders` queue that actually sends the messages; we can then configure things to support having multiple workers processing that queue.

",timabbott,b'area: notifications (other) bug',2016-12-05T20:06:15Z,2017-03-08T04:09:21Z
2605,"Check all for invite-only stream after filtering users, checks ALL users","So I discovered this making an invite only stream, I copy and pasted a list of emails from a private message thread (to make a stream out of it). That filtered the user list to those I wanted to be invited, but then when I clicked check all (because only those I filtered out where there) I inadvertently invited everyone to the invite only thread (which besides being deeply ironic, was slightly awkward). 

I realize this is how the check all feature works, it checks all, so instead of changing that, maybe one could check if an invite only stream really needs to invite ALL users (similar to before you @mention all, there is a little warning). Or perhaps the check all feature should indeed only check those who are filtered out? I've got some time in my hand (but not much javascript under my belt), so I'll take marching orders 😸 ",fenimore,b'area: stream settings bug good first issue help wanted',2016-12-05T19:30:43Z,2017-01-13T22:12:11Z
2604,"Creating an invite only stream, stream isn't added to Streams list - needs page refresh","Hi,

So when I create an invite only stream, it doesn't get added to the streams list, I think it's because of this if statement, inside`create_stream_if_needed` :

        if not invite_only:
            event = dict(type=""stream"", op=""create"",
                         streams=[stream.to_dict()])
            send_event(event, active_user_ids(realm))


And so if the stream is created invite-only, the event isn't sent out.

I was thinking to get the subscribers of the stream and send the event out to them, but the subscribers aren't yet subscribed, so that `set` of user ids (from `get_subscribers`) is empty ... 

So there is some strange behaviour because of this:

Say, Aaron creates an invite-only stream and invites Zoe; Aaron refreshes his page and @ mentions Zoe in the invite-only stream (she has not yet refreshed the page, and this stream is not visible to her). Zoe's @mention does not receive a little tag `1` indicating that she has a new @mention. If she checks that `narrow`, however, she does see an @mention from that stream. When trying to reply, she is able, even though she gets a message saying: ""you are unsubscribed, here is the subscribe button"".

Also, the notifications created in `add_subscriptions_backend` , indicated someone has been subscribed to a stream, only appear when the page is refreshed. ie, see these lines from this method:

                for stream in subscriptions:
                    msg += ""* [%s](%s)%s\n"" % (
                        stream,
                        stream_link(stream),
                        "" (**invite-only**)"" if private_streams[stream] else """")

This message doesn't appear...

So one option is simply to take out the if statement, and broadcast to everyone that there is a new stream (and only those who are subscribed will see it as ""visible""); the downside to this is that everyone gets an event declaring that there was this super secret stream created... So I figure that option is out.",fenimore,b'area: stream settings bug help wanted',2016-12-05T19:25:15Z,2017-03-22T06:15:57Z
2602,bug fix: Handle empty at-mentions gracefully.,"An exception in the webapp was trown when an empty mention was sent.
Examples of problematic messages are ""@"" or ""@****"".

In order to fix this, the regex that identifies mentions has been modified, so it now requires the mention to have a ""content"" (by replacing the ? quantifier by +).",YagoGG,None,2016-12-05T16:19:41Z,2016-12-21T23:32:54Z
2561,"Using ""more messages"" inside ""Private messages"" in left sidebar randomly closes","This is a fairly significant regression we'll need to track down; I think what's happening is that whenever new messages become available, ""private messages"" section reverts to its unexpanded state.

@showell you've been in this code recently; any ideas?",timabbott,b'area: left-sidebar bug good first issue',2016-12-04T05:27:25Z,2016-12-27T21:37:07Z
2557,The syntax for single-line code in markdown can cause a message with longer than intended width,"If you type a message in between backticks (i.e  **\`Random Message\`**) with a long line of spaces afterwards, it causes the width of the codeblock to overflow over the width of the message. This behavior allows for horizontal scrolling (which is not intended). 
### The Original Bug:
```
`File ""./manage.py"", line 29, in <module>                                                                                                                 
   execute_from_command_line(sys.argv)`
```
Notice how there is a long string of spaces instead of a single `\n` after `<module>`.",zbreit,b'area: message view bug good first issue help wanted',2016-12-04T02:30:31Z,2017-03-23T01:56:52Z
2532,Bug: User photo and name not updating after saving,"Hi there, I tried this both on the live site and on the DigitalOcean droplet.

To reproduce this:

1. Write on a topic
2. Go to settings, change your account name or avatar. Save Changes
3. Go back to the topic you initially wrote. 
Your avatar and name will be unchanged. 

@timabbott @kevinr @showell Is this a new bug?  ",Juanvulcano,b'duplicate',2016-12-03T00:11:35Z,2016-12-03T00:13:23Z
2510,"""Left sidebar userlist"" option is buggy with a lot of streams/users","You can reproduce this easily on chat.zulip.org -- enable the setting, reload, and go to a narrow window.  Basically the whole space is taken up by the user list; it only leaves space for 2 streams, which ends up being super confusing.  ",timabbott,b'area: left-sidebar bug good first issue help wanted',2016-12-01T22:51:19Z,2017-01-13T00:54:53Z
2492,NonNumeric Django UserProfile Ids fail sort on Case Sensitivity ,"The users field for `window.activity.presence_info` is keyed by `email` on the recurse.zulipchat.com. When sort in `activity.js` is called, it creates object.keys that are case sensitive while all the emails are lower cased causing `undefined` lookups. Newer versions of Zulip on local dev show this is an numeric id object mapping now. 

Solution, migrate or to lower all the keys in `sort` or migrate keys run `tolower` in Django.

``` 
// Recurse Zulip
{""Foo@recurse.com"": {
    status: ... 
    }
}
// New zulip  
{ 1 : { 
 status: ....
   },
}
```

https://github.com/zulip/zulip/blob/3d1bcb05e195ae3aee94056c07431fa5abacbea4/static/js/activity.js#L189



Edited: 
Problem: Searching in`Users` with the term `David` throws Javascript errors. 
recurse.zulipchat.com throws JavaScript Errors 

there are over 23 david's in the zulip chat. 

<img width=""510"" alt=""screen shot 2016-11-30 at 9 59 07 pm"" src=""https://cloud.githubusercontent.com/assets/3683993/20780437/edb48e8c-b748-11e6-9a27-deee5d6880ac.png"">

<img width=""948"" alt=""screen shot 2016-11-30 at 10 03 43 pm"" src=""https://cloud.githubusercontent.com/assets/3683993/20780436/e8b63cdc-b748-11e6-86e2-22956472d470.png"">

",stzhng,b'area: right-sidebar bug',2016-12-01T03:04:20Z,2017-02-03T01:59:27Z
2487,Lower opacity when looking at topics on a muted stream,"Currently, if you mute a stream, and then click on the stream to look at the topics inside, it's really hard to read them, because we have a strong opacity filter (intended primarily for the stream name itself).  We'll need to play a bit with the details; the first thing I'd try is only making the stream line opaque, not the topic area inside.

@brockwhittaker this may be a good quick fix to do soon.",timabbott,b'area: left-sidebar bug good first issue help wanted',2016-12-01T00:23:11Z,2016-12-13T22:26:26Z
2465,Automatically test /help/foo in test_public_urls,"Currently, when you add a new user documentation article in templates/zerver/help/, you need to also add a test for it in our public URLs test system.  Ideally, we should just automatically test all the articles in that directory.",timabbott,b'area: testing-infrastructure bug good first issue',2016-11-30T00:31:50Z,2016-12-07T19:27:10Z
2464,Topic editing doesn't rerender home view properly,"Here's what I did:
* In a stream narrow, pick a thread with no topic
* Edit the topic, cascading down
* Go back to the home view.  The thread still displays ""no topic"".

Probably this is something where we only update `current_msg_list` but should also update `home_msg_list` if we're in a narrow.",timabbott,b'area: message-editing bug good first issue help wanted',2016-11-29T23:31:58Z,2016-12-30T00:12:32Z
2445,Stream settings hidden menu overflow,"1. Minimize window to mobile width (365px)
2. Press the hamburger menu icon to open list of streams
3. Press the down chevron to the right of any stream's name

The stream settings that extend after pressing the down chevron should overflow and be hidden outside of the window's view as seen in the picture.

![screenshot from 2016-11-27 18-13-44](https://cloud.githubusercontent.com/assets/7107181/20684655/91a3f796-b576-11e6-873f-a8108930e4ad.png)
",joyhchen,b'area: left-sidebar bug good first issue help wanted',2016-11-28T20:56:09Z,2018-04-09T19:29:25Z
2426,populate_db should generate some default presence data,"When we create a new development database using `populate_db`, it has no presence data, so most development is done with an empty right (users) sidebar.  We should fix this by making populate_db generate some basic `UserPresence` rows for the users it creates.",timabbott,b'area: provision bug good first issue help wanted',2016-11-26T23:13:18Z,2016-12-09T23:41:41Z
2416,Message editing: Save button needs to be pressed twice when editing unsent message.,"To reproduce: Add
```
    if messages:
        if messages[0]['message'].content[:7] == 'fail me':
            raise
```
to zerver.lib.actions.do_send_messages. Send a message starting with `fail me`; it should not go through. Click on the red edit icon, and then edit the message. Click the Save button. Nothing happens. Click the Save button again. 

Expected behavior: You should only have to click the Save button once.

The click handler for that button (`.message_edit_save`) is in `static/js/click_handlers.js`, which just points to the `save` function in `message_edit.js`. `message.failed_request` controls whether you see the red edit stuff or not. ",rishig,b'area: message-editing bug good first issue help wanted',2016-11-25T19:18:29Z,2016-12-01T18:42:35Z
2413,Fix positioning of error message that appears while adding custom alert words in settings,"![custom_alerts](https://cloud.githubusercontent.com/assets/7534680/20622086/29d9d028-b327-11e6-8609-be6f8f293480.png)
",aakash-cr7,b'area: settings (user) bug',2016-11-25T10:25:23Z,2016-11-26T18:12:21Z
2412,Pressing enter while on settings takes the user back to home,"While on the `/#settings` page, pressing enter loads the home page. This might be an issue if a user presses enter by mistake, it would take the user back.",aakash-cr7,b'area: keyboard UI area: settings UI bug good first issue help wanted priority: blocker',2016-11-25T10:15:46Z,2017-05-16T03:29:39Z
2389,ESC key doesn't work in Subscription modal window ,It is a typical behavior to expect the modal window to disappear when a user presses `ESC` key.  The current modal window doesn't respond to `ESC` key.,kracekumar,b'area: stream settings bug',2016-11-22T05:01:26Z,2016-12-09T19:57:16Z
2388,Subscription page is sluggish,"For organization containing a large number of streams like RC scrolling the page halts in midway. After a point, the page doesn't respond to mouse scroll. As a result, clicking on a stream `Book` opens `Conf` stream which is lower down the order. 
",kracekumar,b'area: stream settings bug',2016-11-22T04:50:09Z,2017-02-23T20:50:40Z
2374,Popovers on streams near bottom of left sidebar partially hidden,"If you open the popover menu for a stream that is close to the bottom of your screen in the left sidebar, it may be impossible to click on some colors or on the ""Choose custom color"" button.

![screen shot 2016-11-20 at 12 08 24 am](https://cloud.githubusercontent.com/assets/3229696/20460598/b309cab8-aeb5-11e6-8d92-9ee56b94c687.png)
",csvoss,b'area: left-sidebar bug help wanted',2016-11-20T05:10:43Z,2019-02-15T00:59:27Z
2373,Production installer fails with umask 077,"Running the [production installer](https://zulip.readthedocs.io/en/latest/prod-install.html) under `umask 077` fails with permission errors, because, e.g., /srv/zulip-venv-cache becomes readable only by root. It should probably `umask 022` near the top.",andersk,b'area: production installer bug good first issue help wanted',2016-11-20T03:28:50Z,2017-04-19T17:28:36Z
2366,UI glitches when muting a topic,"Steps to reproduce:
1. Click the drop-down arrow on a message.
1. Click ""mute the topic"".

Results:
1. The drop-down menu fails to dismiss itself.
1. The reading pane rescrolls upward, causing me to lose my place.",bgilbert,b'area: message view bug good first issue help wanted',2016-11-19T09:11:36Z,2016-11-30T00:47:30Z
2365,Subscribing to a stream from Manage Streams clears the stream filter,"Steps to reproduce:
1. Go to the Manage Streams page
1. Filter on an unsubscribed stream
1. Click the invisible checkbox to subscribe to the stream

The stream list reverts to an unfiltered state, which is disconcerting because (a) the thing I just clicked on suddenly disappears, and (b) the ""Filter by stream name"" textbox is not cleared, so it appears that filtering is still enabled.",bgilbert,b'area: stream settings bug',2016-11-19T08:49:48Z,2016-12-09T19:57:29Z
2360,"""Link to this conversation"" with group pm conversations isn't shareable","If I have a conversation with alice@example.com and bob@example.com, and want to email them a permanent link to the conversation using the ""Link to this conversation"" feature, it doesn't work, because we generate a link of the form:

`/#narrow/near/12345/pm-with/alice.40example.2Ecom.2Cbob.40example.2Ecom`

which doesn't contain me!  We should probably change the structure so that those links contain oneself, the extra person of yourself just has no effect on the actual filter.",timabbott,b'area: search bug good first issue help wanted',2016-11-19T00:41:16Z,2017-06-21T01:22:47Z
2358,`zerver.lib.actions.apply_events` does not handle `update_global_notifications` events,"Here's the traceback:
```
  File ""/home/zulip/deployments/2016-11-17-05-37-21/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2016-11-17-05-37-21/zerver/views/__init__.py"", line 482, in home
    return home_real(request)
  File ""/home/zulip/deployments/2016-11-17-05-37-21/zerver/decorator.py"", line 274, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2016-11-17-05-37-21/zerver/views/__init__.py"", line 526, in home_real
    apply_markdown=True, narrow=narrow)
  File ""/home/zulip/deployments/2016-11-17-05-37-21/zerver/lib/actions.py"", line 3181, in do_events_register
    apply_events(ret, events, user_profile)
  File ""/home/zulip/deployments/2016-11-17-05-37-21/zerver/lib/actions.py"", line 3156, in apply_events
    raise ValueError(""Unexpected event type %s"" % (event['type'],))
ValueError: Unexpected event type update_global_notifications
```

Given how these are used, we should probably move them from raw page_params to the `register_ret` data structure (so notification settings are accessible via the API), and then update the values in `apply_events`.",timabbott,b'area: real-time sync bug good first issue help wanted',2016-11-18T23:33:22Z,2016-12-14T04:23:20Z
2357,"hotkeys: It's easy to accidentally compose a message to the first user using right sidebar ""user search""","Reproducer:
Hit ""q"" to enter the users search, and then without typing anything, hit enter.  You'll start composing a message to the first user in the buddy list, which is almost certainly not what you intended.

This can be confusing it feels like this should be starting compose to reply to the latest message (since you may have just forgotten you had that focused).  I'm not sure if it should actually just handle enter normally (and reply to the selected message), or just do nothing, but I'm currently leaning towards the latter.",timabbott,b'area: keyboard UI bug feedback wanted good first issue help wanted',2016-11-18T20:51:26Z,2016-12-13T19:05:32Z
2347,People search doesn't support multiple words.,"Searching ""ti"" or ""abb"" in the ""Search people"" bar on the right sidebar gives Tim Abbott (along with others), but searching ""tim a"" does not.
",rishig,b'area: search bug good first issue help wanted',2016-11-17T21:46:04Z,2016-11-27T02:50:23Z
2346,bug fix: Fix buddy list filtering.,"When we filtered buddy lists, a recent change introduced some
bugs related to case-insensitive emails.  We now circumvent the
bug by indexing presense_info with user_ids.",showell,None,2016-11-17T20:48:45Z,2016-11-17T21:28:15Z
2343,pm-with search doesn't work with group PMs,"Hyperlinks to group private conversation doesn't work most of the time. They result to a `pm-with:user1@mail.com,user2@mail.com,user3@mail.com,...` page with:

> You have no private messages with these people yet!
> Why not start the conversation?

1. not work: pm-with:anais.bearzi@mydomain.com,lucas.stummer@mydomain.com,thais.cuellar@mydomain.com,vincent.leprat@mydomain.com,benjamin.prive@mydomain.com,celia.hanini@mydomain.com,david.loison@mydomain.com,frederick.cadet@mydomain.com,ghaith.talli@mydomain.com,julien.cloud@mydomain.com,romain.viala@mydomain.com,savannah.cartelle@mydomain.com
2. not work: pm-with:thais.cuellar@mydomain.com,celia.hanini@mydomain.com
3. work: pm-with:celia.hanini@mydomain.com
4. work: pm-with:lucas.stummer@mydomain.com,thais.cuellar@mydomain.com
5. work: pm-with:thais.cuellar@mydomain.com
6. work: pm-with:mariko.kieffer@mydomain.com,savannah.cartelle@mydomain.com

`global_filters` list:
```html
<ul class=""expanded_private_messages zoom-in"" data-name=""private"">
    
    <!-- DOESN'T MATCH -->
    <li class=""zero-subject-unreads  expanded_private_message"" data-name=""Anais.BEARZI@mydomain.com,Lucas.STUMMER@mydomain.com,Thais.CUELLAR@mydomain.com,Vincent.LEPRAT@mydomain.com,benjamin.prive@mydomain.com,celia.hanini@mydomain.com,david.loison@mydomain.com,frederick.cadet@mydomain.com,ghaith.talli@mydomain.com,julien.cloud@mydomain.com,romain.viala@mydomain.com,savannah.cartelle@mydomain.com"">
      <span class=""subject_box"">
        <a href=""#narrow/pm-with/Anais.2EBEARZI.40mydomain.2Ecom.2CLucas.2ESTUMMER.40mydomain.2Ecom.2CThais.2ECUELLAR.40mydomain.2Ecom.2CVincent.2ELEPRAT.40mydomain.2Ecom.2Cbenjamin.2Eprive.40mydomain.2Ecom.2Ccelia.2Ehanini.40mydomain.2Ecom.2Cdavid.2Eloison.40mydomain.2Ecom.2Cfrederick.2Ecadet.40mydomain.2Ecom.2Cghaith.2Etalli.40mydomain.2Ecom.2Cjulien.2Ecloud.40mydomain.2Ecom.2Cromain.2Eviala.40mydomain.2Ecom.2Csavannah.2Ecartelle.40mydomain.2Ecom"" class=""conversation-partners"">
          Anais BEARZI, Benjamin PRIVE, Celia HANINI, David LOISON, Frederick CADET, Ghaith TALLI, Julien CLOUD, Lucas STUMMER, Romain VIALA, Savannah CARTELLE, Thais CUELLAR, Vincent LEPRAT
        </a>
        <div class=""private_message_count zero_count"">
            <div class=""value"">0</div>
        </div>
      </span>
      <span class=""arrow topic-sidebar-arrow"">
        <i class=""icon-vector-chevron-down""></i>
      </span>
    </li>
    
    <!-- DOESN'T MATCH -->
    <li class=""zero-subject-unreads  expanded_private_message active-sub-filter"" data-name=""Thais.CUELLAR@mydomain.com,celia.hanini@mydomain.com"">
      <span class=""subject_box"">
        <a href=""#narrow/pm-with/Thais.2ECUELLAR.40mydomain.2Ecom.2Ccelia.2Ehanini.40mydomain.2Ecom"" class=""conversation-partners"">
          Thais CUELLAR, Celia HANINI
        </a>
        <div class=""private_message_count zero_count"">
            <div class=""value"">0</div>
        </div>
      </span>
      <span class=""arrow topic-sidebar-arrow"">
        <i class=""icon-vector-chevron-down""></i>
      </span>
    </li>
    
    <!-- MATCH -->
    <li class=""zero-subject-unreads  expanded_private_message"" data-name=""celia.hanini@mydomain.com"">
      <span class=""subject_box"">
        <a href=""#narrow/pm-with/celia.2Ehanini.40mydomain.2Ecom"" class=""conversation-partners"">
          Celia HANINI
        </a>
        <div class=""private_message_count zero_count"">
            <div class=""value"">0</div>
        </div>
      </span>
      <span class=""arrow topic-sidebar-arrow"">
        <i class=""icon-vector-chevron-down""></i>
      </span>
    </li>
    
    <!-- MATCH -->
    <li class=""zero-subject-unreads  expanded_private_message"" data-name=""Lucas.STUMMER@mydomain.com,Thais.CUELLAR@mydomain.com"">
      <span class=""subject_box"">
        <a href=""#narrow/pm-with/Lucas.2ESTUMMER.40mydomain.2Ecom.2CThais.2ECUELLAR.40mydomain.2Ecom"" class=""conversation-partners"">
          Lucas STUMMER, Thais CUELLAR
        </a>
        <div class=""private_message_count zero_count"">
            <div class=""value"">0</div>
        </div>
      </span>
      <span class=""arrow topic-sidebar-arrow"">
        <i class=""icon-vector-chevron-down""></i>
      </span>
    </li>
    
    <!-- MATCH -->
    <li class=""zero-subject-unreads zoom-out-hide expanded_private_message active-sub-filter"" data-name=""Thais.CUELLAR@mydomain.com"">
      <span class=""subject_box"">
        <a href=""#narrow/pm-with/Thais.2ECUELLAR.40mydomain.2Ecom"" class=""conversation-partners"">
          Thais CUELLAR
        </a>
        <div class=""private_message_count zero_count"">
            <div class=""value"">0</div>
        </div>
      </span>
      <span class=""arrow topic-sidebar-arrow"">
        <i class=""icon-vector-chevron-down""></i>
      </span>
    </li>

    <li class=""show-more-private-messages"" data-name=""more-private-messages"">
      <a href=""#"">(more conversations)</a>
    </li>
</ul>
```

`group-pm-list` list
```html
<div id=""group-pm-list"" style=""display: block;"">
                <div id=""group-pm-header"">
                  <h4 class=""sidebar-title"" id=""group-pm-title"">GROUP PMs</h4>
                </div>
                <ul id=""group-pms"" class=""filters scrolling_list"" style=""max-height: 119.013px;"">

<!-- DOESN'T MATCH -->
<li data-emails=""Anais.BEARZI@mydomain.com,Lucas.STUMMER@mydomain.com,Thais.CUELLAR@mydomain.com,Vincent.LEPRAT@mydomain.com,benjamin.prive@mydomain.com,celia.hanini@mydomain.com,david.loison@mydomain.com,frederick.cadet@mydomain.com,ghaith.talli@mydomain.com,julien.cloud@mydomain.com,romain.viala@mydomain.com,savannah.cartelle@mydomain.com"" class=""group-pms-sidebar-entry narrow-filter"">
  <span class=""selectable_sidebar_block"">
    <span class=""group-pm-status-indicator"" style=""background:rgba(68,194,29,0.75);""></span>
    <a href=""#"" data-name=""Anais BEARZI, Lucas STUMMER, Thais CUELLAR, Vincent LEPRAT, Benjamin PRIVE, Celia HANINI, David LOISON, Frederick CADET, Ghaith TALLI, Julien CLOUD, Romain VIALA, Savannah CARTELLE"" title=""Anais BEARZI, Lucas STUMMER, Thais CUELLAR, Vincent LEPRAT, Benjamin PRIVE, Celia HANINI, David LOISON, Frederick CADET, Ghaith TALLI, Julien CLOUD, Romain VIALA, Savannah CARTELLE"" class=""group-pm-link"">Anais BEARZI, Lucas STUMMER, Thais CUELLAR, + 9 others</a>
  </span>
  <span class=""count"" style=""display: none;""><span class=""value""></span></span>
</li>

<!-- DOESN'T MATCH -->
<li data-emails=""Thais.CUELLAR@mydomain.com,celia.hanini@mydomain.com"" class=""group-pms-sidebar-entry narrow-filter"">
  <span class=""selectable_sidebar_block"">
    <span class=""group-pm-status-indicator"" style=""background:rgba(68,194,29,1.00);""></span>
    <a href=""#"" data-name=""Thais CUELLAR, Celia HANINI"" title=""Thais CUELLAR, Celia HANINI"" class=""group-pm-link"">Thais CUELLAR, Celia HANINI</a>
  </span>
  <span class=""count"" style=""display: none;""><span class=""value""></span></span>
</li>

<!-- MATCH -->
<li data-emails=""Lucas.STUMMER@mydomain.com,Thais.CUELLAR@mydomain.com"" class=""group-pms-sidebar-entry narrow-filter"">
  <span class=""selectable_sidebar_block"">
    <span class=""group-pm-status-indicator"" style=""background:rgba(68,194,29,0.50);""></span>
    <a href=""#"" data-name=""Lucas STUMMER, Thais CUELLAR"" title=""Lucas STUMMER, Thais CUELLAR"" class=""group-pm-link"">Lucas STUMMER, Thais CUELLAR</a>
  </span>
  <span class=""count"" style=""display: none;""><span class=""value""></span></span>
</li>

<!-- DOESN'T MATCH -->
<li data-emails=""Lucas.STUMMER@mydomain.com,Thais.CUELLAR@mydomain.com,celia.hanini@mydomain.com"" class=""group-pms-sidebar-entry narrow-filter"">
  <span class=""selectable_sidebar_block"">
    <span class=""group-pm-status-indicator"" style=""background:rgba(68,194,29,0.67);""></span>
    <a href=""#"" data-name=""Lucas STUMMER, Thais CUELLAR, Celia HANINI"" title=""Lucas STUMMER, Thais CUELLAR, Celia HANINI"" class=""group-pm-link"">Lucas STUMMER, Thais CUELLAR, Celia HANINI</a>
  </span>
  <span class=""count"" style=""display: none;""><span class=""value""></span></span>
</li>

<!-- MATCH -->
<li data-emails=""Mariko.KIEFFER@mydomain.com,savannah.cartelle@mydomain.com"" class=""group-pms-sidebar-entry narrow-filter"">
  <span class=""selectable_sidebar_block"">
    <span class=""group-pm-status-indicator"" style=""background:rgba(68,194,29,0.50);""></span>
    <a href=""#"" data-name=""Mariko KIEFFER, Savannah CARTELLE"" title=""Mariko KIEFFER, Savannah CARTELLE"" class=""group-pm-link"">Mariko KIEFFER, Savannah CARTELLE</a>
  </span>
  <span class=""count"" style=""display: none;""><span class=""value""></span></span>
</li>

</ul>
</div>
```",hexaJer,b'area: search bug',2016-11-17T14:43:42Z,2017-02-15T02:12:28Z
2332,bug fixes for topics,"traceback spam is new
the bug for the second commit goes back a while",showell,None,2016-11-16T19:44:05Z,2016-11-17T06:02:10Z
2331,bug fix: Fix topic unread counts for upper-case streams.,"If stream names weren't entirely lowercase, then our function
topic_list.is_for_stream() was improperly reporting false and
failing to update unread counts for the active topic widget.

This regression was probably introduced in the fairly recent
53eea250d07e97686460294442daed49a6be4b80 commit.

Fixes #2330.",showell,None,2016-11-16T18:07:34Z,2016-11-16T18:15:27Z
2330,Unread counts aren't cleared sometimes from scrolling (regression?),"I noticed this just today and I'm fairly sure it's a recent regression.

Steps to reproduce:

1. Click on a stream in the sidebar with unread messages. The sidebar expands to show topics under that stream and has unread counts for the topics with unread messages and the total count for that stream.
2. Scroll down to read all the messages in the newly focused stream. The total unread count for the stream will be cleared automatically, but (some? all?) of the unread counts for the individual topics are still shown.",nicholasbs,b'area: left-sidebar bug',2016-11-16T17:31:19Z,2016-11-16T18:31:36Z
2328,Problem handling data on queue email_mirror,"This is a message from Zulip in the error log, when I send and email to a stream, and the mail contains unicode character.
Version: Zulip 1.4.2
In my case, the mail's body was this, sent from thunderbird:

```
To: <Jenkins+c7973fbcaff7f58e7eb23313f86293c4@myzulip>
From: =?UTF-8?B?SHJvdGvDsyBHw6Fib3I=?= <hrotkog@mydomain>
Subject: mytopic
Message-ID: <01488f67-a7f7-5bd5-3fd9-7ce9e618dbdb@mydomain>
Date: Mon, 14 Nov 2016 13:16:33 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101
 Thunderbird/45.4.0
Content-Type: text/plain; charset=""iso-8859-2""
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

pr=F3ba mailb=F3l
```

```
Problem handling data on queue email_mirror
Traceback (most recent call last):
  File ""/home/zulip/deployments/2016-09-30-12-03-05/zerver/worker/queue_processors.py"", line 80, in consume_wrapper
    self.consume(data)
  File ""/home/zulip/deployments/2016-09-30-12-03-05/zerver/worker/queue_processors.py"", line 378, in consume
    mirror_email(email.message_from_string(event[""message""]),
  File ""/usr/lib/python2.7/email/__init__.py"", line 57, in message_from_string
    return Parser(*args, **kws).parsestr(s)
  File ""/usr/lib/python2.7/email/parser.py"", line 82, in parsestr
    return self.parse(StringIO(text), headersonly=headersonly)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xf3' in position 393: ordinal not in range(128)
```",hrotkogabor,b'area: integrations bug good first issue help wanted',2016-11-16T17:09:08Z,2017-04-05T19:19:07Z
2318,Taiga webhook integration issue,"I've run my own zulip server. I'm trying to integrate Taiga by following [this tutorial](https://zulip.com/integrations/#taiga) but Taiga API doesn't accept the webhook API and returns the following error:

```JSON
{""content"": ""{""msg"":""Message must not be empty"",""result"":""error""}""}
```
the above error is in fact returned by Zulip Taiga module. 

I run a local node server to see the JSON request that Taiga sends to validate the webhook:

```JSON
{""date"": ""2016-11-15T13:39:33.279Z"", ""type"": ""test"", ""by"": {""photo"": null, ""permalink"": ""http://TAIGADOMAIN/profile/admin"", ""gravatar_id"": ""blahblah"", ""username"": ""admin"", ""full_name"": ""Administrator"", ""id"": 5}, ""data"": {""test"": ""test""}, ""action"": ""test""}
```

My zulip version: /zulip/deployments/2016-11-14-16-40-34
",mghadam,b'area: integrations bug good first issue help wanted',2016-11-15T13:41:43Z,2017-01-12T22:56:30Z
2315,Fix compose box PM recipient typeahead handling of focus,"Click ""New Private message"", start typing a recipient, and then click on the typeahead to select a recipient.  It sends focus to the message feed, and should instead either keep focus in the recipient bar, or probably better, send focus to the compose box.  ",timabbott,b'area: compose bug good first issue help wanted',2016-11-15T05:52:18Z,2016-12-08T06:14:16Z
2311,Trello webhook integration error,"I've run my own zulip server. I'm trying to integrate Trello by following [this tutorial](https://zulip.com/integrations/#trello) but Trello API doesn't accept the setup and returns the following error:

`URL (https://zulip.MYDOMAIN.TLD/api/v1/external/trello?api_key=BOT_API_KEY&stream=STREAM_NAME) did not return 200 status code, got 400`

My zulip version: /zulip/deployments/2016-11-14-16-40-34
",mghadam,b'area: integrations bug',2016-11-14T22:22:39Z,2016-11-19T00:28:07Z
2310,"Bug: Opera says ""your connection is not private""","In the last couple of days, I have noticed that using a normal or private window in Opera and trying to navigate to zulipchat leads to a cease in navigation and the following message : 

> Your connection is not private
> The server presented a certificate that was not publicly disclosed using the Certificate Transparency policy. This is a requirement for some certificates, to ensure that they are trustworthy and protect against attackers.
> You cannot proceed because the website operator has requested heightened security for this domain.
Then if I click ""Help me understand"", it further specifies:
> When you connect to a secure website, the server hosting that site presents your browser with something called a ""certificate"" to verify its identity. This certificate contains identity information, such as the address of the website, which is verified by a third party that your computer trusts. By checking that the address in the certificate matches the address of the website, it is possible to verify that you are securely communicating with the website you intended, and not a third party (such as an attacker on your network).
> You cannot visit recurse.zulipchat.com right now because the website uses HSTS. Network errors and attacks are usually temporary, so this page will probably work later.
Going to the [opera://net-internals/#hsts](Opera page for managing HSTS) and putting zulipchat in the ""Delete domain"" box makes it work again.

I can log in and use zulipchat on other browsers.

PS I'm using Linux Mint, if it matters. Let me know if I can give you any more info!",heatherbooker,b'question',2016-11-14T21:37:33Z,2016-11-15T00:00:46Z
2306,iOS mobile web messages do not send.,"When trying to send a message in iOS in either chrome or safari, the ""Sending..."" text appears and just continues to exist ad infinitum as the message never sends. It seems like there's likely a JavaScript error happening in-browser that is happening in the thread before the message is sent.

![zulip-error](https://cloud.githubusercontent.com/assets/10321399/20262852/f910a640-aa18-11e6-9102-fa3555dfde18.jpg)

",brockwhittaker,b'area: compose bug',2016-11-14T12:01:13Z,2017-03-21T04:45:02Z
2289,"Incorrect ""Subscribed to stream"" text appears after clicking Notification Bot's ""Subscribe to stream XYZ"" button","Notification bot posted a message about a new stream, and I clicked on the ""Subscribe to stream"" button. Then some text appeared saying that I had just subscribed to the stream that Notification Bot's message appeared in, not the stream to which I had just subscribed. Here's a screenshot:

![image](https://cloud.githubusercontent.com/assets/1628311/20222212/6f153572-a802-11e6-934e-28d67310976f.png)
",phsteve,b'area: message view bug help wanted',2016-11-11T16:33:25Z,2017-03-23T01:49:25Z
2281,Clear popovers on stream narrows,"If you narrow to stream A and open its popover menu, then click on stream B in the sidebar, the popover for stream A still sticks around.   Generally, we solve this by calling `popovers.hide_all();` at the start of various UI actions (or at the start of trigger event handlers).   This should be an easy change, with the following minor challenges:

* We want to avoid having lots of calls to `popovers.hide_all()` in our code, so we should be thoughtful about the best place to put these.
* When you're manually testing this fix, you should try to uncover similar bugs by doing things like narrowing from the recipient bar, searching, opening up other menus, etc.

",showell,b'area: left-sidebar bug good first issue',2016-11-11T00:19:57Z,2017-01-12T23:08:05Z
2280,"Fix ""not delivered"" element overlapping with message content.","To reproduce: Add
```
    if messages:
        if messages[0]['message'].content[:7] == 'fail me':
            raise
```
to zerver.lib.actions.do_send_messages.

Then send two messages like the following:
![not-delivered](https://cloud.githubusercontent.com/assets/890911/20198724/170426ec-a75b-11e6-8771-e9bd78bc7a40.png)

The solution is to make the red stuff fit in a smaller space, probably by removing the ""Not delivered"" text, and showing it on hover over the red icons. The red icons also need to be moved to the right a bit.",rishig,b'area: message view bug good first issue help wanted',2016-11-10T23:35:41Z,2016-11-26T18:16:36Z
2274,Private messages to yourself don't appear in the left sidebar conversations list,"This is not super important, but they should be there for consistency.",timabbott,b'area: left-sidebar bug good first issue',2016-11-10T19:55:03Z,2016-11-15T05:53:16Z
2258,bug: Allow editing of new streams (in popup/overlay),"Here's the repro:

- as Cordelia, go to Manage Streams
- click on any existing stream, and it works
- create a new stream called ""foo"" and subscribe Hamlet (or whoever, prolly)
- clear the text box so you're not filtering
- click on an old stream, it works
- click on ""foo"" and it fails

You can eventually edit ""foo"" by either reloading the app or by leaving Manage Streams and re-entering it.

The source of the problem sees to be that we're failing to render subscription_settings.handlebars when we add the new subscription and attaching it some browser element.  Then, we subsequently fail here:

```
 372 exports.show_settings_for = function (stream_name) {
 373     var sub_settings = settings_for_sub(stream_data.get_sub(stream_name));
 374     var stream = $("".subscription_settings[data-stream-name='"" + stream_name + ""']"");
 375     $("".subscription_settings[data-stream].show"").removeClass(""show"");
```

You'll see that ""stream"" is undefined.  We probably want a better variable name there, incidentally.",showell,b'area: stream settings bug',2016-11-08T19:04:15Z,2017-02-23T16:38:36Z
2247,Error when changing (some) users' names,"I'm getting a JavaScript SyntaxError when trying to change my name from the admin view (/#administration):

![image](https://cloud.githubusercontent.com/assets/50336/20072652/34dce552-a4f7-11e6-942d-9cd5922d77f0.png)

I'm able to change other users' names, and I've confirmed with another admin user for the same realm that he can change his own name but gets the same error when trying to change my name.

My name on the realm is `Nick` and my email is `me@nicholasbs.net`. I get the error if I try to change my name to `Nick Test`.",nicholasbs,b'area: settings (user) bug good first issue help wanted',2016-11-07T19:36:36Z,2017-03-24T02:07:03Z
2240,Deactivated users who sent messages recently show up in autocomplete for @-mentioning.,"Reproducer: Create a user, have it send at least one message, then deactivate it.  Other users will still that user as an option for who to send to in the autocomplete.

@showell FYI this might be a good follow-up to some of your recent `people.js` work (I'm not sure if it is a regression or not).",timabbott,b'area: real-time sync bug help wanted',2016-11-07T02:40:57Z,2016-11-10T03:21:28Z
2239,Speed up our rate limiting test,"`test_hit_ratelimits` sleeps for a second in order to verify that our rate limiting code works correctly.  We should change it to instead mock the current time and shave 1s off our total test runtime.

```
Running zerver.tests.test_external.RateLimitTests.test_hit_ratelimits
 ** Test is TOO slow: zerver.tests.test_external.RateLimitTests.test_hit_ratelimits (1.121 s)
```",timabbott,b'area: testing-infrastructure bug good first issue',2016-11-07T02:11:13Z,2016-12-09T18:53:29Z
2230,Add backend tests for sending messages with websockets,"We currently don't have any backend tests for the full code path of sending messages with websockets enabled, which is the default way we send messages in production.  This is not really OK; we recently had a regression with sending messages being broken that lasted most of a day (be3e9e3a0578e71e60bc52799d880cc5b2e5265d) before being found.

The primary code paths are:
* zerver/lib/socket.py -- receives websockets requests from Tornado and puts them in the message_sender RabbitMQ queue.
* zerver/lib/queue_processors.py (the message_sender queue worker code, which processes the above and then sends a message)
(and of course the runtornado management command does the actual routing).

We currently do backend tests for our other uses of Tornado by just checking some settings (see send_notification_http) and just call the functions rather than going through a queue processor; I think we could use the same approach here to make it easy to write backend tests for this code path.

",timabbott,b'area: testing-coverage bug',2016-11-05T18:37:50Z,2016-11-27T06:29:54Z
2227,ZulipLDAPAuthBackend relies on user email domain.,"`ZulipLDAPAuthBackend.get_or_create_user` uses
```
            domain = resolve_email_to_domain(username)
            realm = get_realm(domain)
```
to figure out which realm to create the user in. This is fine in the non-subdomains case, but doesn't work in the subdomains case where a domain no longer uniquely maps to a realm. 

I'm not sure what the right strategy is here for fixing this. Maybe somehow get their realm information from `PreregistrationUser` (but what happens if they have several entries?) Maybe do the user creation in `zerver.views.accounts_register` instead?",rishig,b'area: authentication bug help wanted',2016-11-05T15:07:46Z,2017-01-25T23:25:14Z
2223,bug fix: Send stream notifications to all users for public streams.,"If a stream is public, we now send notifications to all realm users
if the name or description of the stream changes.  For private
streams, the behavior remains the same.

We do this by introducing a method called
can_access_stream_user_ids().

(showell helped with this fix)

Fixes #2195",showell,None,2016-11-04T19:56:52Z,2016-11-05T04:42:03Z
2218,Preview of stream link doesn't show hyperlink,"If I'm typing a Zulip message and autolink to a stream using syntax like `#**general**`, and then hit the preview (eye) icon, the previewed text just shows up as bold, not as a hyperlink. I'd like for the hyperlink to show up in the preview.

Followup to  #1858.",brainwane,b'area: markdown bug',2016-11-04T14:31:19Z,2016-11-09T19:51:48Z
2212,Compose is broken on mobile web view,"This seems to be a recent change; I think it worked okay as of more than a few weeks ago. It affects Chrome and Firefox on mobile, as well as Chrome on the desktop in a ""device emulation"" mode. Anything else I can do to help?

[screenshot_20161103-180418](https://cloud.githubusercontent.com/assets/451345/19987400/516b1756-a1f1-11e6-98c7-b7d9352c749a.png)
",aripollak,b'bug duplicate',2016-11-03T22:15:07Z,2016-11-03T23:05:31Z
2211,GitHub login 500s if a user is connecting with a different host than expected.,"(not sure if this is the right forum!)

Clicking 'login with GitHub' on chat.zulip.org takes me to a 500 page, with

```
500: Internal server error.

Well oops. This one's probably our fault. Sorry about that! Updates on service availability are posted to @ZulipStatus on Twitter.

If you'd like, you can drop us a line to let us know what happened.
```",yuvipanda,b'area: authentication bug',2016-11-03T22:12:51Z,2017-01-03T19:31:30Z
2199,installation failure on ubuntu 16.04.1 LTS (Desktop) loaded in Hyper-V VM,"unable to connect to upstart: failed to connect to socket /com/ubuntu/upstart: connection refused.

I followed instructions here:

https://zulip.readthedocs.io/en/latest/prod-install.html#step-3-configure-zulip

I setup openssl certificate.

How do I troubleshoot?

I tried a fix according to this suggestion, but the same error:

http://askubuntu.com/questions/614970/vivid-failed-to-connect-to-upstart-connection-refused",denfromufa,b'area: production bug',2016-11-03T13:32:24Z,2016-11-30T03:17:41Z
2195,Fix stream name/descriptions changes not being live-updated to all realm users,"See the discussion in https://github.com/zulip/zulip/pull/2017#issuecomment-256554275.  

I think the issue is that `do_rename_stream` and `do_change_stream_description` in zerver/lib/actions.py use the `stream_user_ids` function to determine which users to notify via their `send_event` calls, which is basically the current subscribers of the stream.  However, since we recent changed the frontend to store data about streams in the realm that a user is not subscribed to, we should be changing those functions to instead pass `active_user_ids(user_profile.realm)`.  

We should be sure to add tests for this case, confirming that the right Tornado events are sent.",timabbott,b'area: stream settings bug help wanted',2016-11-03T05:43:08Z,2016-11-05T04:42:05Z
2175,Dev environment: Tornado sometimes doesn't shut down when quitting server.,"Not sure how to reproduce it, but the error message I got was 

```
(zulip-venv)vagrant@vagrant-base-trusty-amd64:~/zulip$ tools/run-dev.py
[...]
Tornado server is running at http://127.0.0.1:9993/
Quit the server with CTRL-C.
Traceback (most recent call last):
  File ""manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 354, in execute_from_command_line
    utility.execute()
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 346, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/base.py"", line 394, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/base.py"", line 445, in execute
    output = self.handle(*args, **options)
  File ""/srv/zulip/zerver/management/commands/runtornado.py"", line 134, in handle
    inner_run()
  File ""/srv/zulip/zerver/management/commands/runtornado.py"", line 122, in inner_run
    http_server.listen(int(port), address=addr)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/tornado/tcpserver.py"", line 117, in listen
    sockets = bind_sockets(port, address=address)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/tornado/netutil.py"", line 104, in bind_sockets
    sock.bind(sockaddr)
  File ""/usr/lib/python2.7/socket.py"", line 224, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 98] Address already in use
```

`ps` shows a running python process, and a workaround is to use `kill -9` to kill the running python process.",rishig,b'area: dependencies area: tooling bug help wanted',2016-11-01T22:16:47Z,2018-04-28T21:00:03Z
2171,"""Stream does not exist"" error should say which stream","I have a test that isn't correctly specifying the stream for a new message to be created. The error I get would be much more useful if it reported the name of the offending stream. 

Here is an example: 
```
Traceback (most recent call last):
  File ""/home/feorlen/zulip/dev/zulip/zerver/lib/test_runner.py"", line 129, in run_test
    test_method()
  File ""/home/feorlen/zulip/dev/zulip/zerver/tests/webhooks/test_deskdotcom.py"", line 18, in test_static_text_message
    **self.api_auth(self.TEST_USER_EMAIL))
  File ""/home/feorlen/zulip/dev/zulip/zerver/lib/test_helpers.py"", line 649, in send_and_test_stream_message
    self.STREAM_NAME, **kwargs)
  File ""/home/feorlen/zulip/dev/zulip/zerver/lib/test_helpers.py"", line 593, in send_json_payload
    self.assert_json_success(result)
  File ""/home/feorlen/zulip/dev/zulip/zerver/lib/test_helpers.py"", line 488, in assert_json_success
    self.assertEqual(result.status_code, 200, result)
  File ""/usr/lib/python2.7/unittest/case.py"", line 515, in assertEqual
    assertion_func(first, second, msg=msg)
  File ""/usr/lib/python2.7/unittest/case.py"", line 508, in _baseAssertEqual
    raise self.failureException(msg)
AssertionError: Vary: Accept-Language, Cookie
Content-Type: application/json
Content-Language: en

{""msg"":""Stream does not exist"",""result"":""error""}
```

This appears to be coming from check_message in zerver/lib/actions.py:
```
        stream = get_stream(stream_name, realm)

        send_pm_if_empty_stream(sender, stream, stream_name)

        if stream is None:
            raise JsonableError(_(""Stream does not exist""))
```

It could include stream_name in that message. 
",feorlen,b'area: stream settings area: testing-infrastructure bug good first issue',2016-11-01T17:14:30Z,2016-12-14T20:18:37Z
2159,bug fix: Avoid duplicate prepend_subscriber() call.,"We don't want to prepend new subscribers to our list of
subscribers in the settings page when they hit enter; we
want to wait till we get the event from the server.

This is a fairly new regression that was added when we
live-updated peer subscriber changes.
",showell,None,2016-10-29T21:11:09Z,2016-11-01T21:02:30Z
2156,Scroll is broken for wide code blocks.,"To reproduce, send a message like
`lots and lots of text ...`
The code block overflows the right hand side of the message box, rather than truncating and adding a scroll bar.

Adding @brockwhittaker.
",rishig,b'area: message view bug',2016-10-29T05:57:24Z,2016-11-01T00:29:18Z
2150,Exceptions raised in Tornado get eaten in development,"Reproducer: Modify some part of the Zulip Tornado codebase (zerver/lib/event_queue.py, zerver/management/commands/runtornado.py, and some of the things they call) to throw an exception and not do anything:

```
diff --git a/zerver/lib/event_queue.py b/zerver/lib/event_queue.py
index f3c6f28..2e35f98 100644
--- a/zerver/lib/event_queue.py
+++ b/zerver/lib/event_queue.py
@@ -800,6 +800,7 @@ def process_notification(notice):
     # type: (Mapping[str, Any]) -> None
     event = notice['event'] # type: Mapping[str, Any]
     users = notice['users'] # type: Union[Iterable[int], Iterable[Mapping[str, Any]]]
+    raise
     if event['type'] in [""update_message""]:
         process_userdata_event(event, cast(Iterable[Mapping[str, Any]], users))
     elif event['type'] == ""message"":
```

The app totally doesn't work (e.g. messages won't send, though they will still echo; you can tell because the timestamp never appears), but no traceback ever shows up on the run-dev.py console.
",timabbott,b'area: tooling bug',2016-10-28T16:40:05Z,2016-11-03T18:17:00Z
2149,Make UI alert for muting a topic responsive for mobile,"The UI alert for muted messages seems to not work well on mobile.  It is too wide to fit on the screen (so the close button isn't visible).

@brockwhittaker FYI.
",timabbott,b'area: message view bug good first issue help wanted',2016-10-28T06:56:49Z,2016-11-01T00:29:18Z
2148,Lengthy markdown message isn't readable,"Enter the following line in zulip stream as markdown
`270    10.949555000    192.168.1.32    vcom-tunnel 224.0.0.7   8001    UDP 224 Source port: vcom-tunnel  Destination port: vcom-tunnel`. The text `Destination port: vcom-tunnel` isn't displayed. 

Here is a screenshot

![markdown_long_message](https://cloud.githubusercontent.com/assets/311929/19793946/e81dbbcc-9c9c-11e6-82dc-49b68e08f08d.png)

But `GitHub` renders same text properly. This happens on `recurse.zulipchat.com`
",kracekumar,b'area: message view bug good first issue help wanted',2016-10-28T03:28:31Z,2016-11-02T06:19:56Z
2143,Throw full traceback when template rendering fails.,"Currently, when a template render fails in `static/js` 
we trigger a `throw ""Cannot find a template with this name: ...""`
which isn't very helpful when debugging. We should throw a full traceback.
",umkay,b'area: testing-infrastructure bug good first issue help wanted',2016-10-27T22:36:26Z,2016-10-28T05:32:38Z
2140,Testing send mail fails,"I am trying to install the server on Ubuntu virtual machine and i reached the point where i need to test send mail using manage.py

when i execute the following command 
`./manage.py send_test_email someemail@something.com`

the following error message is printed 

```
Traceback (most recent call last):
  File ""/home/zulip/deployments/2016-10-27-13-44-46/scripts/lib/log-management-command"", line 15, in <module>
    file_handler = logging.FileHandler(settings.MANAGEMENT_LOG_PATH)
  File ""/usr/lib/python2.7/logging/__init__.py"", line 913, in __init__
    StreamHandler.__init__(self, self._open())
  File ""/usr/lib/python2.7/logging/__init__.py"", line 943, in _open
    stream = open(self.baseFilename, self.mode)
IOError: [Errno 13] Permission denied: '/var/log/zulip/manage.log'
Traceback (most recent call last):
  File ""./manage.py"", line 22, in <module>
    "" "".join(sys.argv)])
  File ""/usr/lib/python2.7/subprocess.py"", line 541, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2016-10-27-13-44-46/scripts/lib/log-management-command', './manage.py send_test_email someemail@something.com']' returned non-zero exit status 1
```
",vegegoku,b'area: production bug question',2016-10-27T13:51:06Z,2017-01-06T20:25:29Z
2115,Preview doesn't work with `/me`,"The new preview functionality doesn't work with `/me`. Example attached:

![preview-me](https://cloud.githubusercontent.com/assets/1525767/19660294/26058a0c-99fd-11e6-823b-76b077294990.png)
",vaibhavsagar,b'area: compose bug good first issue help wanted',2016-10-24T19:19:07Z,2017-08-27T16:48:59Z
2113,1858 bugdown stream syntax,"bugdown extension to make links to stream with autocomplete and url quoting. 
supports any stream name
",paxapy,None,2016-10-24T17:20:30Z,2016-10-24T18:09:13Z
2091,Returning to stream narrow after reply marks all stream messages read,"Rough steps:
1. narrow to stream with `s`
2. see interesting message, narrow to topic with `s`
3. reply at end of topic (`r`, typey-type, `<enter>`)
4. return to stream narrow with `s`

**Expected outcome:** to be returned to my position before the topic narrow (step 2).

**Actual outcome:** returned to bottom of stream, with all intervening messages marked read.

**Background:** I'm often catching up on several hundred messages. I skim through the a few stream views, and hit `S` to narrow to a topic if I want to reply. After replying, hitting `s` to go back to the stream narrow drops me to the bottom of the stream and marks all messages in between as read.

I would prefer to go back to where I was before the topic narrow, and find losing my unread state frustrating.

This is different from the home view, where hitting escape after replying brings you back to where you were.

(I may have some of the behaviors mixed up because the ""state machine"" isn't super simple or intuitive.)
",kamalmarhubi,b'area: message view bug difficult priority: high',2016-10-20T19:16:56Z,2018-06-01T19:59:40Z
2077,extra padding at bottom of streams deletion table,"At `/#administration`, in the streams deletion interface (`#streams`), there's a redundant, empty row at the end of the table. See screenshot.

![off-by-one-row](https://cloud.githubusercontent.com/assets/842790/19521164/b888c31a-95e0-11e6-81ba-38d1c0fc21ce.png)
",brainwane,b'area: settings (user) area: stream settings bug',2016-10-19T13:47:58Z,2016-10-25T22:09:38Z
2068,Errors on running development server,"I did a re-provision using `./tools/provision.py`. However, my development server fails to run now. I get this as the output: 

```
learing memcached ...
Flushing memcached...
OK
Starting Zulip services on ports: web proxy: 9991, Django: 9992, Tornado: 9993, webpack: 9994
Note: only port 9991 is exposed to the host in a Vagrant environment.
2016-10-19 07:02:33,645 INFO: process_fts_updates starting
Recompiling templates
2016-10-19 03:02:35,054 INFO: Not in recovery; listening for FTS updates
done
Performing system checks...

System check identified no issues (0 silenced).
http://localhost:9994/webpack-dev-server/
webpack result is served from http://127.0.0.1:9991/webpack/
content is served from /srv/zulip
Traceback (most recent call last):
  File ""./tools/run-dev-queue-processors"", line 14, in <module>
    from zerver.worker.queue_processors import get_active_worker_queues
  File ""./tools/../zerver/worker/queue_processors.py"", line 14, in <module>
    from zerver.lib.actions import do_send_confirmation_email, \
  File ""./tools/../zerver/lib/actions.py"", line 12, in <module>
    from zerver.lib.bugdown import (
  File ""./tools/../zerver/lib/bugdown/__init__.py"", line 1132, in <module>
    maybe_update_realm_filters(domain=None)
  File ""./tools/../zerver/lib/bugdown/__init__.py"", line 1123, in maybe_update_realm_filters
    make_realm_filters(domain, filters)
  File ""./tools/../zerver/lib/bugdown/__init__.py"", line 1112, in make_realm_filters
    ""realm"": [domain, ""Realm name""]})
  File ""./tools/../zerver/lib/bugdown/__init__.py"", line 1083, in make_md_engine
    guess_lang=False
TypeError: makeExtension() got an unexpected keyword argument 'linenums'
Traceback (most recent call last):
  File ""manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 354, in execute_from_command_line
    utility.execute()
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 346, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 190, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/management/__init__.py"", line 40, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File ""/usr/lib/python2.7/importlib/__init__.py"", line 37, in import_module
    __import__(name)
  File ""/srv/zulip/zerver/management/commands/runtornado.py"", line 26, in <module>
    from zerver.lib.event_queue import process_notification, missedmessage_hook
  File ""/srv/zulip/zerver/lib/event_queue.py"", line 26, in <module>
    from zerver.lib.handlers import clear_handler_by_id, get_handler_by_id, \
  File ""/srv/zulip/zerver/lib/handlers.py"", line 2, in <module>
    from zerver.middleware import async_request_restart
  File ""/srv/zulip/zerver/middleware.py"", line 16, in <module>
    from zerver.lib.bugdown import get_bugdown_time, get_bugdown_requests
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1132, in <module>
    maybe_update_realm_filters(domain=None)
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1123, in maybe_update_realm_filters
    make_realm_filters(domain, filters)
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1112, in make_realm_filters
    ""realm"": [domain, ""Realm name""]})
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1083, in make_md_engine
    guess_lang=False
TypeError: makeExtension() got an unexpected keyword argument 'linenums'
October 19, 2016 - 03:02:48
Django version 1.8.15, using settings 'zproject.settings'
Starting development server at http://127.0.0.1:9992/
Quit the server with CONTROL-C.

webpack: bundle is now VALID.
Traceback (most recent call last):
  File ""/usr/lib/python2.7/wsgiref/handlers.py"", line 85, in run
    self.result = application(self.environ, self.start_response)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/handlers/wsgi.py"", line 170, in __call__
    self.load_middleware()
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/handlers/base.py"", line 50, in load_middleware
    mw_class = import_string(middleware_path)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/utils/module_loading.py"", line 26, in import_string
    module = import_module(module_path)
  File ""/usr/lib/python2.7/importlib/__init__.py"", line 37, in import_module
    __import__(name)
  File ""/srv/zulip/zerver/middleware.py"", line 16, in <module>
    from zerver.lib.bugdown import get_bugdown_time, get_bugdown_requests
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1132, in <module>
    maybe_update_realm_filters(domain=None)
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1123, in maybe_update_realm_filters
    make_realm_filters(domain, filters)
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1112, in make_realm_filters
    ""realm"": [domain, ""Realm name""]})
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 1083, in make_md_engine
    guess_lang=False
TypeError: makeExtension() got an unexpected keyword argument 'linenums'
[19/Oct/2016 03:02:56] ""GET / HTTP/1.0"" 500 59
Traceback (most recent call last):
  File ""/usr/lib/python2.7/wsgiref/handlers.py"", line 85, in run
    self.result = application(self.environ, self.start_response)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/handlers/wsgi.py"", line 170, in __call__
    self.load_middleware()
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/core/handlers/base.py"", line 50, in load_middleware
    mw_class = import_string(middleware_path)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/django/utils/module_loading.py"", line 26, in import_string
    module = import_module(module_path)
  File ""/usr/lib/python2.7/importlib/__init__.py"", line 37, in import_module
    __import__(name)
  File ""/srv/zulip/zerver/middleware.py"", line 16, in <module>
    from zerver.lib.bugdown import get_bugdown_time, get_bugdown_requests
  File ""/srv/zulip/zerver/lib/bugdown/__init__.py"", line 32, in <module>
    from zerver.lib.bugdown import fenced_code
ImportError: cannot import name fenced_code
[19/Oct/2016 03:02:56] ""GET /favicon.ico HTTP/1.0"" 500 59
```

Before this, I had my server running properly.
",reyha,b'area: provision bug',2016-10-19T07:17:42Z,2016-10-19T07:25:06Z
2049,bugdown: Safe mode removal,"@timabbott ptal
",umkay,None,2016-10-17T20:55:14Z,2016-10-25T22:23:28Z
2016,Change stream privacy breaks after renaming stream,"If we change the stream name from `manage stream` then try to change stream privacy without reloading the page causes an error in changing the stream privacy because it tries to change the privacy based on the previous name not the new one, so we must update the name of the stream used by the `change stream privacy button` after renaming the stream so when we try to change the stream privacy it will use the new name not the old one.
",mohsenSy,b'area: real-time sync area: stream settings bug',2016-10-15T11:06:17Z,2016-11-01T00:29:18Z
1996,Open message in stream clickable from notifications,"When online on zulip, notifications pop up towards the top right corner. ( I do not mean the desktop notifications, I mean the notifications within zulip.) It would be nice if clicking on the notification indicating the message takes the user to the stream and topic where that particular message is typed. Currently this notification box has only a close tab. I would like that and if there are more people who would find this convenient, perhaps this could be something to implement? Thanks. :)
",sup95,b'area: notifications (other) bug good first issue help wanted',2016-10-13T16:47:46Z,2016-12-24T18:17:56Z
1992,Clickable areas in streams section of left panel have non-pointer style cursors when not hovering over text,"When the cursor hovers over the stream name it changes to a pointer. Since the entire area is clickable (and results in the stream being opened), perhaps the cursor style should be set to pointer.
<img width=""247"" alt=""stream-cursor"" src=""https://cloud.githubusercontent.com/assets/62899/19340687/cd60d9b4-9147-11e6-9fb6-d22346c0c004.png"">
",arpith,b'area: left-sidebar bug',2016-10-13T07:50:37Z,2017-05-22T22:31:59Z
1991,"Expanding private messages by clicking ""more conversations"" breaks scroll","The left pane then becomes unusable and the only way out seems to be clicking home (which then de-expands the private messages list).
",arpith,b'area: left-sidebar bug good first issue help wanted',2016-10-13T07:01:52Z,2019-03-07T22:10:53Z
1988,Subscribe button not working,"Subscribe button, at the end of stream is not working and showing following error in console log:

`common.c016bb62512e.js:243 Uncaught TypeError: Cannot read property 'subscribed' of undefined`

Tested on Chrome and Safari
<img width=""1254"" alt=""screen shot 2016-10-13 at 4 08 19 am"" src=""https://cloud.githubusercontent.com/assets/5694967/19330363/9a4035e4-90fb-11e6-82f4-f46c9345d9b4.png"">
",vikas-parashar,b'area: message view bug good first issue help wanted',2016-10-12T22:46:02Z,2017-03-23T01:43:21Z
1986,Can't Set Stream Description for Streams with #,"Attempting to set the stream description for a stream named ""#POST"" causes the following error:

```
2016-10-12 15:13:17,292 ERROR    Traceback (most recent call last):
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py"", line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/lib/rest.py"", line 122, in rest_dispatch
    return target_function(request, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py"", line 110, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/decorator.py"", line 449, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/decorator.py"", line 427, in authenticate_log_and_execute_json
    return view_func(request, user_profile, *args, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/decorator.py"", line 117, in wrapper
    return func(request, user_profile, *args, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/lib/request.py"", line 160, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/views/streams.py"", line 176, in update_stream_backend
    do_change_stream_description(user_profile.realm, stream_name, description)
  File ""/home/zulip/deployments/2016-09-16-21-19-55/zerver/lib/actions.py"", line 1883, in do_change_stream_description
    stream.description = new_description
AttributeError: 'NoneType' object has no attribute 'description'
```
",hlieberman,b'area: stream settings bug good first issue help wanted',2016-10-12T19:17:30Z,2016-10-14T19:37:04Z
1982,Lightbox leaves keyboard in the wrong state on exit,"In the zulip lightbox, if you click on an image (opening the lightbox), hit escape, and then hit enter, it'll reopen the lightbox (with no image), rather than replying to whatever message is selected.

@brockwhittaker fyi
",timabbott,b'area: message view bug',2016-10-12T05:59:18Z,2016-10-25T22:01:22Z
1969,a few emoji display wrongly as blank white spots; may be missing,"I was composing a message and tried out the emoji pane, and saw that a spot looked empty:

![missing-one](https://cloud.githubusercontent.com/assets/842790/19274222/7251000e-8f9d-11e6-87bd-8b66c1d471dc.png)

If I hovered over that spot I saw that it said `:one:`I tried using that emoji in a message and it displayed as blank white space (but if I hovered over it I saw `:one:`. After some experimentation I found several other emoji that acted similarly:

`:one: :eight: :five: :four: :hash: :six: :three: :two: :zero:`

Screenshots:

![text-of-blank-emoji](https://cloud.githubusercontent.com/assets/842790/19274220/7243f7a6-8f9d-11e6-8241-c6d93e419809.png)
![blank-emoji](https://cloud.githubusercontent.com/assets/842790/19274221/72478d9e-8f9d-11e6-87fd-d0e7caeaaa3e.png)

When I look up the emoji I'm having trouble with in `tools/setup/emoji_dump/emoji_map.json`, I see that they're all associated with integers starting with 00, e.g., `""four"": ""0034""`, and none of the other emoji are. And I'm having trouble finding those emoji in `tools/setup/emoji_dump/bitmaps/`. So maybe those image files simply aren't in our bitmaps directory?
",brainwane,b'area: emoji bug good first issue help wanted',2016-10-11T14:42:29Z,2016-12-16T17:47:31Z
1961,bugdown: Fix type annotations.,"In some functions the first parameter was wrongly annotated as `markdown.Markdown`. Change that to `text_type`.

I also checked that `markdown.Markdown` is not a subclass of `str`.

@showell `git blame` says you were the last person who edited or added annotations to the functions `convert` and `do_convert`. Was it you who annotated the first parameter as `markdown.Markdown`? If yes, was there a reason for that? Maybe I'm missing something.
",sharmaeklavya2,None,2016-10-11T07:48:14Z,2016-10-11T18:31:36Z
1956,Improve usability and performance of emoji picker,"We recently added a new emoji picker; yay!  The problem is it doesn't have great usability yet.

(1) It only shows 2 rows of emoji at a time, which makes it hard to actually browse the emoji.  And there's no categories for the emoji (which may be most easily fixed by switching to a source of emoji that provides that (e.g. #209) or figuring out how to get data on that question, not building our own categorization).
(2) The new emoji picker in the compose box takes like 2s to open on my laptop.  Adding categories may be a good solution to that piece of the problem.
",timabbott,b'area: emoji bug help wanted',2016-10-10T23:18:22Z,2017-03-27T16:43:45Z
1950,Poor handling of emacs backup files in `test-backend`,"```
$ test-backend SubscriptionAPITest
Traceback (most recent call last):
  File ""/home/tabbott/zulip/tools/test-backend"", line 99, in <module>
    rewrite_arguments(suite)
  File ""/home/tabbott/zulip/tools/test-backend"", line 88, in rewrite_arguments
    for line in open(filepath):
IOError: [Errno 2] No such file or directory: 'zerver/tests/.#test_auth_backends.py'
```

To fix this, we should probably just filter out test files whose filenames start with `.`.

This would be a great project for a new contributor.
",timabbott,b'area: tooling bug good first issue help wanted',2016-10-10T17:53:18Z,2016-11-05T04:50:00Z
1941,Example texts are included in django.po,"There are example texts in `static/locale/ja/LC_MESSAGES/django.po`.

https://github.com/zulip/zulip/blob/4e33b00/static/locale/ja/LC_MESSAGES/django.po#L45-46 :

``` text
#: docs/_build/html/_sources/translating.txt:91
msgid ""English text""
```

https://github.com/zulip/zulip/blob/4e33b00/static/locale/ja/LC_MESSAGES/django.po#L49-L50

``` text
#: docs/_build/html/_sources/translating.txt:103
msgid ""This string will have""
```

https://github.com/zulip/zulip/blob/4e33b00/static/locale/ja/LC_MESSAGES/django.po#L53-L54

``` text
#: docs/_build/html/_sources/translating.txt:103
msgid ""inside""
```

https://github.com/zulip/zulip/blob/4e33b00/static/locale/ja/LC_MESSAGES/django.po#L57-L60

``` text
#: docs/_build/html/_sources/translating.txt:110
#: docs/_build/html/_sources/translating.txt:112
#, python-format
msgid ""This string will have %(value)s inside.""
```

I think that we don't need to process `docs/` directory.
",kou,b'bug',2016-10-10T05:04:08Z,2016-10-10T15:25:21Z
1934,Example text is included in translations.json,"There is an example text in [static/locale/ja/translations.json](https://github.com/zulip/zulip/blob/4e33b00/static/locale/ja/translations.json#L88)

``` text
 ""some English text"": ""some English text"", 
```

I think that it's extracted from `static/js/templates.js`:

https://github.com/zulip/zulip/blob/c671ae2/static/js/templates.js#L85 :

``` javascript
 //     {{t ""some English text""}}
```

Or https://github.com/zulip/zulip/blob/c671ae2/static/js/templates.js#L94 :

``` javascript
 //         <p>some English text</p>
```

Both of them are contents in comment. So they should be ignored.
",kou,b'bug good first issue',2016-10-09T04:12:21Z,2016-10-10T15:25:10Z
1915,cannot rename stream,"I have admin powers on zulip.tabbott.net.

I went to https://zulip.tabbott.net/#subscriptions and windowshaded to get more details on stream ""github"". I renamed it to ""git"" and hit the rename button. Then I shift-reloaded the realm, and the name of the stream was still ""github"".

(I also changed the stream _description_ and clicked the button to save the changed description, and when I reloaded the stream management interface, that description change had been saved.)
",brainwane,b'bug',2016-10-05T19:50:02Z,2016-10-05T20:51:20Z
1914,Buggy templates fetching translations.json in development,"I've started seeing these errors fetching the translations.json files in our development environment:

```
2016-10-05 14:35:47,769 WARNING  Not Found: /static/locale/{{ LANGUAGE_CODE }}/translations.json
2016-10-05 14:35:47,773 INFO     127.0.0.1       GET     404   4ms /static/locale/{{ LANGUAGE_CODE }}/translations.json (unauth via ?)
[05/Oct/2016 14:35:47] ""GET /static/locale/%7B%7B%20LANGUAGE_CODE%20%7D%7D/translations.json HTTP/1.0"" 404 1895
```

In theory, LANGUAGE_CODE should be having the actual language code (defaulting to English) substituted in.
",timabbott,b'area: i18n bug help wanted',2016-10-05T18:37:10Z,2017-03-20T08:22:31Z
1910,pageup/pagedown doesn't work in the compose box,"Easily reproduced by entering a few lines of text, going to the bottom, and hitting pageup.  

This is likely a bug in our static/js/hotkey.js code.
",timabbott,b'area: compose area: keyboard UI bug good first issue',2016-10-05T05:26:48Z,2017-03-22T02:06:53Z
1909,Some node tests fail when run individually,"When running `test-js-with-node stream_data.js` (or same with `util.js`) individually, the Node tests fail like this:

```
$ test-js-with-node util.js
running tests for util
/home/tabbott/zulip/static/js/util.js:125
    recipients = _.map(recipients.split(','), $.trim);
                                              ^

ReferenceError: $ is not defined
    at Object.exports.normalize_recipients (/home/tabbott/zulip/static/js/util.js:125:47)
    at test_normalize_recipients (/home/tabbott/zulip/frontend_tests/node_tests/util.js:102:17)
    at Object.<anonymous> (/home/tabbott/zulip/frontend_tests/node_tests/util.js:103:2)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
    at Function.Module._load (module.js:424:3)
    at Module.require (module.js:483:17)
    at require (internal/module.js:20:19)
    at /home/tabbott/zulip/frontend_tests/zjsunit/index.js:43:5
    at Array.forEach (native)
    at Object.<anonymous> (/home/tabbott/zulip/frontend_tests/zjsunit/index.js:37:7)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
    at Function.Module._load (module.js:424:3)
    at Module.runMain (module.js:590:10)
    at run (bootstrap_node.js:394:7)
    at startup (bootstrap_node.js:149:9)
    at bootstrap_node.js:509:3
FAIL - Test(s) failed
```
",timabbott,b'bug',2016-10-05T01:33:23Z,2016-10-05T01:39:11Z
1899,Odd display artifacts scrolling a long topic list,"Perhaps these mean something to a more UI-knowledgable person. They happened while office hour was going on and there were a ton of active topics in the Outreachy stream. I had the full list open but it didn't all fit in my window so I was scrolling up and down through the list of topics. I am using OS X 10.11.6 and Safari 9. I see it both with my accessible minimum font size and without, so it seems to only require that the list of topics be too long to fully display.

First may be nothing actionable, it only happened once and went away soon thereafter. Gray blobs that look like something not entirely redrawn in the top section of the left sidebar. 

![something not redrawing correctly](https://cloud.githubusercontent.com/assets/95028/19063992/2b853a6e-89bc-11e6-932c-0a4893a4039a.png)

This is a big black rectangle covering the top of the left sidebar, it flashes off and on when I scroll the list. It's still happening now, sometimes it looks like the first image, sometimes the second. 

![sidebar black rectangle1](https://cloud.githubusercontent.com/assets/95028/19064096/b6230e3a-89bc-11e6-899c-aa27668502b6.png)
![sidebar black rectangle2](https://cloud.githubusercontent.com/assets/95028/19064097/b9db7350-89bc-11e6-9538-78581d258d14.png)
",feorlen,b'area: left-sidebar bug help wanted',2016-10-04T06:50:50Z,2016-11-29T23:35:48Z
1878,twisted unhandled exception: no attribute 'writeSequence',"Found this when I came back to my desk. The server is Ubuntu 14.04 with a clean dev install of Zulip. A web client was connected, but gone idle. Time coincides with the desktop client machine coming out of screensaver mode.

Let me know if you want additional context/info. Edited for formatting derp.

```
2016-09-29 13:30:18,709 INFO     127.0.0.1       SOCKET  200   0ms (db: 5ms/2q) /socket/close [transport=xhr_streaming] (iago@zulip.com via ?)
2016-09-29 13:30:18,715 INFO     127.0.0.1       SOCKET  200  32ms (db: 5ms/2q) /socket/auth [transport=xhr_streaming] (iago@zulip.com via ?)
2016-09-29 13:30:23,182 INFO     Tornado  23.2% busy over the past 59.9 seconds
2016-09-29 13:30:27,343 INFO     Received event: {u'status': 2, u'user_profile_id': 3, u'client': u'website', u'time': 1475170227}
2016-09-29 13:30:27,496 INFO     127.0.0.1       POST    200 167ms (db: 16ms/3q) (+start: 12ms) /json/users/me/presence (iago@zulip.com via website)
2016-09-29 13:30:28,547 INFO     Tornado  23.0% busy over the past 59.9 seconds
2016-09-29 13:30:33,774 INFO     Tornado  23.1% busy over the past 59.6 seconds
2016-09-29 13:30:33,790 INFO     127.0.0.1       SOCKET  200   0ms /socket/open [transport=xhr_streaming] (unknown via ?)
2016-09-29 13:30:33,878 INFO     127.0.0.1       POST    200  16ms (lp: 15.1s) (+start: 8ms) /json/get_events [1475164988:0/1] (iago@zulip.com via website)
2016-09-29 13:30:33,896 INFO     Disconnected handler for queue 1475164988:0 (iago@zulip.com/website)
Unhandled Error
Traceback (most recent call last):
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/python/log.py"", line 101, in callWithLogger
    return callWithContext({""system"": lp}, func, *args, **kw)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/python/log.py"", line 84, in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/python/context.py"", line 118, in callWithContext
    return self.currentContext().callWithContext(ctx, func, *args, **kw)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/python/context.py"", line 81, in callWithContext
    return func(*args,**kw)
--- <exception caught here> ---
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/internet/posixbase.py"", line 597, in _doReadOrWrite
    why = selectable.doRead()
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/internet/tcp.py"", line 209, in doRead
    return self._dataReceived(data)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/internet/tcp.py"", line 215, in _dataReceived
    rval = self.protocol.dataReceived(data)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/protocols/basic.py"", line 578, in dataReceived
    why = self.rawDataReceived(data)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/web/http.py"", line 532, in rawDataReceived
    self.handleResponsePart(data)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/web/proxy.py"", line 77, in handleResponsePart
    self.father.write(buffer)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/web/server.py"", line 213, in write
    http.Request.write(self, data)
  File ""/srv/zulip-venv/local/lib/python2.7/site-packages/twisted/web/http.py"", line 955, in write
    self.channel.writeSequence(toChunk(data))
exceptions.AttributeError: 'NoneType' object has no attribute 'writeSequence'

2016-09-29 13:30:33,965 INFO     127.0.0.1       SOCKET  200   0ms (db: 15ms/2q) /socket/close [transport=xhr_streaming] (iago@zulip.com via ?)
2016-09-29 13:30:33,969 INFO     127.0.0.1       SOCKET  200  52ms (db: 15ms/2q) /socket/auth [transport=xhr_streaming] (iago@zulip.com via ?)
2016-09-29 13:30:39,084 INFO     Tornado  23.0% busy over the past 59.9 seconds
2016-09-29 13:30:44,087 INFO     Tornado  23.2% busy over the past 59.9 seconds
2016-09-29 13:30:49,317 INFO     Tornado  23.3% busy over the past 59.6 seconds
2016-09-29 13:30:49,324 INFO     127.0.0.1       POST    200  59ms (lp: 15.5s) (db: 15ms/2q) (+start: 15ms) /json/get_events [1475164988:0/1] (iago@zulip.com via website)
2016-09-29 13:30:54,550 INFO     Tornado  23.3% busy over the past 59.9 seconds
2016-09-29 13:31:00,188 INFO     Tornado  23.3% busy over the past 60.0 seconds
2016-09-29 13:31:02,933 INFO     127.0.0.1       POST    200  27ms (lp: 13.5s) (mem: 9ms/1) (+start: 17ms) /json/get_events [1475164988:0/1] (iago@zulip.com via website)
2016-09-29 13:31:05,550 INFO     Tornado  23.6% busy over the past 59.9 seconds
2016-09-29 13:31:07,853 INFO     127.0.0.1       POST    200  29ms (lp: 4.6s) (+start: 14ms) /json/get_events [1475164988:0/1] (iago@zulip.com via website)
2016-09-29 13:31:10,555 INFO     Tornado  23.7% busy over the past 59.9 seconds

```
",feorlen,b'area: tooling bug',2016-09-29T17:39:48Z,2018-07-07T17:01:33Z
1876,"""Log in with Google"" button looks wrong in languages other that English","Basically, https://zulip.tabbott.net/ru/register/ looks like this:
![2016-09-29 14 54 20](https://cloud.githubusercontent.com/assets/17989162/18952997/4ec20e24-865d-11e6-8465-624d8a786800.png)
and https://zulip.tabbott.net/de/register/ like this:
![2016-09-29 15 02 57](https://cloud.githubusercontent.com/assets/17989162/18953213/5efef10c-865e-11e6-922f-36d4b035b0ff.png)
",BasilisAndr,b'area: i18n bug good first issue',2016-09-29T11:56:48Z,2016-10-16T19:36:42Z
1875,Up/down arrow keypresses no longer navigate messages after I select a stream,"Ever since [the most recent zulip.tabbott.net deploy](https://zulip.tabbott.net/#narrow/stream/announce/subject/this.20server/near/30000) I have noticed a bit of wonkiness with up/down arrow keys. To repro:
- Go to zulip.tabbott.net 
- Click on the name of a stream
- Use up and down arrows

I expect that, once I click on a stream, I can then use the up and down arrows on my keyboard to navigate the messages posted in that stream. Instead, if I hit ""up"" or ""down"", I'm now navigating _topics_, and I don't know what keyboard shortcut I should use to get the focus back onto the messages column.

I have rebooted my browser and done a shift-refresh to clear cache, but I'm still experiencing this problem. #1696 might be relevant.
",brainwane,b'bug',2016-09-29T01:26:11Z,2016-09-30T03:52:49Z
1862,"Banner overlaps, can't dismiss, if user has set Safari accessibility font size","On first login, there is a green banner with the message ""What's better than Zulip in your browser? The Zulip desktop app!"" With an accessibility font size of 18 or 24 points, It extends into both the left and right sidebars and can't be dismissed because the close button is under the text ""USERS"".  At 24 points, the left end of the banner is under the ""Home"" label in the left sidebar. (Presumably any similar banners would have the same problem.)

These examples are from Safari 9, with minimum font size set in the Advanced preferences pane: ""Never use font sizes smaller than"". 

24 point

![zulip banner safari 24pt font](https://cloud.githubusercontent.com/assets/95028/18891536/8de6673e-84ba-11e6-8806-a8c73d01cc5a.png)

18 point

![zulip banner safari 18pt font](https://cloud.githubusercontent.com/assets/95028/18891537/8e090320-84ba-11e6-9d8e-f35648175a6a.png)
",feorlen,b'bug design good first issue help wanted',2016-09-27T21:03:09Z,2016-10-13T16:14:44Z
1831,gitlab: include branch name in topic,"currently the topic includes the name of the repository. I would like it to include the name of the branch as well, so things in different branches get split out to appropriate topics.
",keturn,b'bug good first issue',2016-09-21T22:19:33Z,2016-09-26T06:38:50Z
1830,gitlab: missing characters from branch name,"> GitLab: Rob Davis pushed 9 commits to velop branch.
> GitLab: Rob Davis pushed 0 commit to ture/svgogalog branch.

The branch names above should be ""develop"" and ""feature.""
",keturn,b'bug good first issue',2016-09-21T22:11:31Z,2016-09-23T17:05:06Z
1803,Broken encoding in generated links on pasted files with cyrillic characters,"If the file to upload in zulip contains cyrillic characters then the generated link to this file contains broken encoding.
For example, this is wrong (now)
![image](https://cloud.githubusercontent.com/assets/1013955/18582017/c8cdc1ec-7c0b-11e6-9094-3c42019ccafb.png)
but correctly is 
![image](https://cloud.githubusercontent.com/assets/1013955/18582003/b830369e-7c0b-11e6-9fda-5d87748e575c.png)
",e-tagirov,b'bug good first issue help wanted',2016-09-16T09:49:20Z,2016-09-27T04:14:21Z
1801,bugdown: Clean up and add tests for error handling.,,showell,None,2016-09-15T20:26:53Z,2016-09-16T17:02:43Z
1791,zulip logrotate fails,"I get an error with zulips logrotate on Ubuntu 14.04. 

/etc/cron.daily/logrotate:
error: zulip:4 unknown unit 'B'
error: found error in /var/log/zulip/server.log /var/log/zulip/workers.log /var/log/zulip/manage.log , skipping

I guess the size 1GB in /etc/logrotate.d/zulip should just be 1G ?
",TI-Admin,b'bug',2016-09-14T08:02:30Z,2016-09-14T17:11:34Z
1783,"""Sent!"" bar appears in browser tabs that didn't send anything","If a message is sent from browser tab A, and browser tab B has an open compose box _and_ is narrowed to not show the message, tab B will show a green status bar containing some variant of `Sent! Your message is outside your current narrow.`  As a result, when several tabs are used to participate in conversations with different narrows, they each perpetually have a green bar talking about something that happened in another tab.  Consider showing the `Sent!` bar only in the browser tab that sent the message.
",bgilbert,b'area: notifications (other) bug good first issue help wanted',2016-09-13T04:43:34Z,2017-01-13T01:08:49Z
1769,Occasional pgroonga test flakiness,"We've been seeing occasional nondeterministic test failures in CI related to pgroonga, e.g. here:
https://travis-ci.org/zulip/zulip/jobs/158890340

@kou do you have any ideas for what could be going on here?  Is there logging that would make sense to add to try to debug this?
",timabbott,b'bug',2016-09-10T17:47:44Z,2016-09-18T20:30:39Z
1762,Zulip development environment broken due to pgroonga bug,"See https://github.com/pgroonga/pgroonga/issues/22 for details, but pgroonga seems to have broken their installation process in their public apt repository.  

I'll probably need to revert pgroonga support to fix this, which is kinda annoying.
",timabbott,b'bug good first issue',2016-09-06T22:10:06Z,2016-09-07T04:19:46Z
1743,searching a realm for a URL,"I searched for

https://paper.dropbox.com/doc/Zulip-stalled-larger-pull-requests-U5q5qSPFmR3qTT0dl9ao8 

on zulip.tabbott.net and got -- instead of the ""no results"" page -- redirected to the home screen. If I enclose the URL in quotes then I do get directed to the post that mentions the URL:

https://zulip.tabbott.net/#narrow/stream/general/subject/open.20PRs/near/16436

Could we be smarter about searches for bare URLs and treat them as though they've been quoted?
",brainwane,b'area: search bug good first issue help wanted',2016-08-31T12:01:26Z,2016-10-16T22:40:10Z
1733,Message edit icon doesn't appear if the message only has multiline code blocks,"We currently use 

```
message_row.find('.message_content').find('p:last').append(edit_content_button);
```

in `static/js/us.js` to append the icon-vector-pencil to messages that can be edited. If a message only has codeblocks (or other things that don't get wrapped in `<p>`'s), the edit_content_button doesn't get attached anywhere. 
",rishig,b'area: message-editing bug good first issue',2016-08-29T18:11:15Z,2016-11-11T03:51:53Z
1713,Config for websocket connection in nginx maybe not work yet,"config now for websocket connection in nginx is  

```
# Longpolling version needed for xhr streaming support
include /etc/nginx/zulip-include/proxy_longpolling;

proxy_set_header Upgrade         $http_upgrade;
# This should override the Connection setting in zulip-include/proxy
proxy_set_header Connection      $connection_upgrade;
proxy_set_header X-Real-IP       $remote_addr;
```

but it not works for me , the brower report an websocket connection 400 error

```
WebSocket connection to 'ws://10.141.184.78:9991/sockjs/258/9hg1xz8b/websocket' failed: Error during WebSocket handshake: Unexpected response code: 400
```

so i modified the config in nginx to:

```
# This should override the Connection setting in zulip-include/proxy
proxy_http_version 1.1;
proxy_set_header Upgrade         $http_upgrade;
proxy_set_header Connection      $connection_upgrade;
proxy_set_header X-Real-IP       $remote_addr;
proxy_set_header Host $http_host;
proxy_pass_header Server;
```

and it works for me.
",sandish2222,b'area: production bug',2016-08-26T03:02:59Z,2017-05-05T22:02:58Z
1704,@References don't auto expand when editing a message that has already posted,"Enter a message and hit send
Curse because you forgot to @mention someone
Try to add the @mention
Fail...
",mark0978,b'bug duplicate',2016-08-25T17:23:09Z,2016-08-25T17:26:18Z
1696,hotkeys/buddy list: Make down arrow and enter work for user search,"If you do a search in the Users field above the buddy list and narrow it down a few users, it is intuitive to then just tab down to the user in the list who you want to talk to.  Unfortunately, the down arrow and enter keys get intercepted by our hotkeys code and start doing messages-view things, which is very jolting and surprising.  We should have some awareness that the buddy list is currently being navigated.

The hotkeys code has some awareness of `message_view_only` semantics, but its definition of being out of the message view is too narrow--it only thinks you are out of the message view if the ""home tab"" (aka message pane) is obscured.
",showell,b'bug help wanted',2016-08-24T19:21:48Z,2016-09-27T23:57:53Z
1691,bugdown: Support dashes for bulleted lists.,"We should allow the markdown syntax for bulleted lists, using dashes in column one, in addition to keeping support for the current bugdown syntax of asterisks.  The only thing we probably need to consider when making this change is how it will affect people who want to post diffs or patches to Zulip.
",showell,b'area: markdown feedback wanted',2016-08-23T21:45:15Z,2018-06-12T15:26:59Z
1690,bugdown: MetaTicket,"This is a ticket to link back to for other bugdown changes.
#1103 italics
#1691 bulleted lists
",showell,b'area: markdown',2016-08-23T21:43:10Z,2016-10-17T01:19:18Z
1678,Uploaded images not displayed properly by the Android app,"I've gotten a few reports that the Android app doesn't display images which were uploaded via the file uploads feature.  I suspect the problem is that the way uploaded image files work in Zulip on web is that the URL in the message is a special URL on the Zulip server that serves a redirect to a temporary URL containing the image.  The intent is the browser then loads that image and caches it.

I suspect the Android app is not handling that time-limited redirect in quite the right way.
",timabbott,b'bug',2016-08-23T03:05:08Z,2016-08-23T03:06:24Z
1654,Add Bugdown tests for !avatar syntax,"I wrote tests for these, and the tests match what happens in production, but I get some really weird output running this in the test suite:

```
Running Bugdown test gravatar
Traceback (most recent call last):
  File ""/home/tabbott/zulip/zerver/lib/test_runner.py"", line 129, in run_test
    test_method()
  File ""/home/tabbott/zulip/zerver/tests/test_bugdown.py"", line 159, in test_bugdown_fixtures
    self.assertEqual(converted, test['expected_output'])
  File ""/usr/lib/python2.7/unittest/case.py"", line 513, in assertEqual
    assertion_func(first, second, msg=msg)
  File ""/usr/lib/python2.7/unittest/case.py"", line 924, in assertMultiLineEqual
    self.fail(self._formatMessage(msg, standardMsg))
  File ""/usr/lib/python2.7/unittest/case.py"", line 410, in fail
    raise self.failureException(msg)
AssertionError: u'<p><img alt=""\x02klzzwxh:0000\x03"" class=""message_body_gravatar"" src=""/avatar/ [truncated]... != u'<p><img alt=""username@example.com"" class=""message_body_gravatar"" src=""/avatar/ [truncated]...
- <p><img alt=""klzzwxh:0000"" class=""message_body_gravatar"" src=""/avatar/klzzwxh:0000?s=30"" title=""klzzwxh:0000""></p>
+ <p><img alt=""username@example.com"" class=""message_body_gravatar"" src=""/avatar/username@example.com?s=30"" title=""username@example.com""></p>
```

Here's the code:
https://github.com/timabbott/zulip/commits/markdown-bugs
",timabbott,b'area: markdown bug good first issue help wanted',2016-08-18T21:51:48Z,2016-10-20T18:19:39Z
1634,firefox: notifications don't go away,"Firefox 48.0 on Ubuntu 16.04 always shows the latest 1-3 notifications when notifications is turned on. I suspect at least part of this is a bug, since e.g. the notifications should at least go away once zulip is back in focus. Can do a more thorough investigation with someone that wants to work on this. 
",rishig,b'area: notifications (other) bug good first issue help wanted',2016-08-16T22:40:10Z,2016-10-19T20:31:18Z
1633,Don't ask for password after signing in via an OAuth provider,"I registered for an account at a Zulip instance using my GitHub account, and was somewhat surprised that the first thing I was asked for after approving the login on GitHub was to create a password for my account. I would have expected not to need a password since I signed in with GitHub.
",aaronpk,b'area: portico bug good first issue help wanted',2016-08-16T20:13:29Z,2017-08-10T16:55:53Z
1593,Creating stream by hitting enter twice doesn't work,"Steps to reproduce:
- In the Streams panel, type in a stream name and hit enter (or click the Create new stream button)
- In the Create stream dialog, hit enter again. (Clicking the button does not cause this issue.)

Expected result:
- The stream is created.

Actual result:
- Navigation returns to the home view but the whole screen is dark gray as though there were still a modal dialog visible, though there isn't one. Also, the stream isn't created.
",rwbarton,b'area: stream settings bug design good first issue help wanted',2016-08-10T19:07:28Z,2017-02-17T07:54:40Z
1592,Renaming stream causes problem in changing stream type,"This is similar to #1540.
Reproducer: Rename a stream. Once successfully renamed, click on ""Make stream public/private"" button. It shows error message which says ""Error making stream private: Unknown stream {{old_stream_name}}"".
",kartikmaji,b'area: real-time sync area: stream settings bug good first issue help wanted',2016-08-10T18:02:14Z,2016-11-02T15:40:14Z
1581,Zulip Javascript modules not available in production environments,"In a Zulip production environment, we seem to have regressed the super-useful debugging featureset of being able to call functions from zulip's modules directly from the javascript console.  You can verify this by typing `page_params` in the javascript console on zulip.tabbott.net.

Interestingly, the browser will autocomplete field names like this, but actually trying to use them doesn't work:

```
page_params.password_auth_enabled
VM357:1 Uncaught ReferenceError: page_params is not defined(…)
```

(and my guess is the autocomplete is coming from the browser's history of what I've done in the javascript console, not the actual contents of the page_params object).

I'm guessing this somehow was introduced when we upgraded django-pipeline, and it's now eliminating the module exports in its minification.

I attempted to reproduce this in development by changing `PIPELINE_ENABLED=True` in a development environment, but that didn't work because `manage.py compilemessages` crashes with that setup; and after working around that, the development homepage didn't load, so I think we have some setup tools work to do in order to reproduce this for efficient debugging.  

@umairwaheed can you take a look at this?
",timabbott,b'area: production bug help wanted',2016-08-09T19:16:15Z,2017-03-06T23:27:40Z
1580,Fix translations.json 404 in production,"In Zulip production environments, we get this 404 error on page load:
`https://zulip.com/static/locale/dev/translations.json Failed to load resource: the server responded with a status of 404 (Not Found)`

@umairwaheed this is probably a quick fix, can you take a look?
",timabbott,b'bug',2016-08-09T19:13:46Z,2016-08-10T23:07:26Z
1579,rabbitmq failing in production test suite,"Apparently, Travis CI broke some aspects of their production environment, and now rabbitmq doesn't start after being installed.  We should fix this so that the production test suite will pass again.
",timabbott,b'area: testing-coverage bug priority: blocker',2016-08-09T19:04:42Z,2016-08-12T16:56:26Z
1575,Clean up logging output when running test suite,"Our APNS tests print various warnings as they run, which makes the test output messy:

```
Running zerver.tests.test_push_notifications.APNsFeedbackTest.test_feedback
2016-08-09 12:50:14,842 INFO     Found unavailable token aaaa, unavailable since 2016-08-09 16:50:14+00:00
2016-08-09 12:50:14,843 INFO     Finished checking feedback for stale tokens
Running zerver.tests.test_push_notifications.SendNotificationTest.test_connection_both_none
2016-08-09 12:50:14,962 ERROR    Attempting to send push notification, but no connection was found. This may be because we could not find the APNS Certificate file.
Running zerver.tests.test_push_notifications.SendNotificationTest.test_connection_single_none
2016-08-09 12:50:14,968 INFO     APNS: Sending apple push notification to devices: [('bbbb', 'com.zulip.Zulip', 'u7s='), ('aaaa', 'com.zulip.Zulip', 'qqo=')]
2016-08-09 12:50:14,969 INFO     Not delivering APNS message <zerver.lib.push_notifications.APNsMessage object at 0x7fd6ef53f940> to user <UserProfile: hamlet@zulip.com <Realm: zulip.com 1>> due to missing connection
2016-08-09 12:50:14,969 WARNING  APNS: Not sending notification because tokens didn't match devices: ['com.dropbox.Zulip']
Running zerver.tests.test_push_notifications.SendNotificationTest.test_do_push_to_apns_service
Running zerver.tests.test_push_notifications.SendNotificationTest.test_send_apple_push_notifiction
2016-08-09 12:50:14,978 INFO     APNS: Sending apple push notification to devices: [('bbbb', 'com.zulip.Zulip', 'u7s='), ('aaaa', 'com.zulip.Zulip', 'qqo=')]
2016-08-09 12:50:14,978 WARNING  APNS: Not sending notification because tokens didn't match devices: ['com.dropbox.Zulip']
```

@umairwaheed can you take a look at this?  I think you handled this issue using mocks in the GCM tests, and maybe the same technique would work well here.
",timabbott,b'area: testing-coverage bug good first issue',2016-08-09T16:56:55Z,2016-08-09T17:49:53Z
1566,"Slow behavior on saying no to ""mark everything as read""","I've had a report from a chat.fhir.org user who writes:

> every time I switch to the chat.fhir.org tab on my (admittedly somewhat old) Macbook Air in Chrome, it does the ""do you want me to mark everything as read"" message and when I say no it spends about 30 seconds reloading all of the content.
> 
> I'm not sure if I'm an anomaly.. i tend to try and catch up once a week on everything I haven't read, so I often have a lot of unread messages in implementors

This appears to happen with a workflow of checking zulip ~once per week, with ~2k new messages to mark as read.
",jmandel,b'area: notifications (other) bug',2016-08-08T19:25:20Z,2020-04-26T17:07:38Z
1565,Inline ```code``` does not activate a horizontal scroll bar,"You can put in a message like

```
AIL: test_lcontact_domain_for_syndication_lead_success (uniregistrar.tests.views.test_lcontact.LContactViewTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File ""/Users/markjones/dev/virtualenvs/registrar/lib/python2.7/site-packages/mock/mock.py"", line 1305, in patched
    return func(*args, **keywargs)
  File ""/Users/markjones/dev/projects/uniregistrar/uniregistrar/uniregistrar/tests/views/test_lcontact.py"", line 109, in test_lcontact_domain_for_syndication_lead_success
    self.assertDictEqual(result, expected_result)
AssertionError: {'bin_checkout_verify': False, 'background_image_blurry': 'http://example.com//s [truncated]... != {'bin_checkout_verify': False, 'domain': u'example2.com', 'source_name': 'domain [truncated]...
- {'background_image': 'http://example.com//static/assets/img/gen-bg/market/BIN-002.jpg',
-  'background_image_blurry': 'http://example.com//static/assets/img/gen-bg/market/blurry/BIN-002.jpg',
-  'background_theme_class': 'dark-theme',
-  'bin_checkout_verify': False,
? ^

+ {'bin_checkout_verify': False,
? ^

   'bin_possible': True,
   'bin_price': '300,000',
   'cobrand_logo_filename': 'logo-domaintools-trans-200x50.png',
-  'display_domain': 'Example2.com',
+  'display_domain': u'Example2.com',
?                    +

-  'domain': 'example2.com',
+  'domain': u'example2.com',
?            +

   'is_bin': True,
-  'js_page_data': '{""background_image"": ""http://example.com//static/assets/img/gen-bg/market/BIN-002.jpg"", ""background_image_blurry"": ""http://example.com//static/assets/img/gen-bg/market/blurry/BIN-002.jpg"", ""background_theme_class"": ""dark-theme"", ""bin_checkout_verify"": false, ""bin_possible"": true, ""bin_price"": ""300,000"", ""cobrand_logo_filename"": ""logo-domaintools-trans-200x50.png"", ""display_domain"": ""Example2.com"", ""domain"": ""example2.com"", ""is_bin"": true, ""offer_possible"": false, ""page_lander"": null, ""source_name"": ""domaintools""}',
+  'js_page_data': '{""bin_checkout_verify"": false, ""bin_possible"": true, ""bin_price"": ""300,000"", ""cobrand_logo_filename"": ""logo-domaintools-trans-200x50.png"", ""display_domain"": ""Example2.com"", ""domain"": ""example2.com"", ""is_bin"": true, ""offer_possible"": false, ""page_lander"": null, ""source_name"": ""domaintools""}',
   'offer_possible': False,
   'page_lander': None,
   'source_name': 'domaintools'}
```

But then you can't read parts of it because there is no horizontal scroll bar available on message view.
Github illustrates this problem a little too well.....
",mark0978,b'bug design good first issue',2016-08-08T18:07:38Z,2016-08-26T21:52:05Z
1540,Renaming stream causes to stop showing subscription settings,"Reproducer: Rename a stream. Once successfully renamed, click on subscription header to make it collapse. Now, click back on subscription header to view subscription details and it doesn't expands.
Once screen is refreshed, everything is back to normal.
",kartikmaji,b'bug good first issue help wanted',2016-08-04T06:45:18Z,2016-08-09T18:59:51Z
1509,Filtering UI for adding new subscribers to a new stream is super slow in large teams,"If you have ~1000 users in an organization, the filtering UI for adding new subscribers to a stream is super slow, making it basically unusable.  It's a little sad, since this is a feature which would otherwise be super valuable for large teams.  

To reproduce, I'd just create a few hundred extra users with `./manage.py populate_db --extra-users=500` and then use the Chrome profiler to figure out what's slow.

@krtkmj do you have time to take a look at fixing this?
",timabbott,b'area: stream settings bug',2016-08-01T19:37:40Z,2017-01-29T01:19:32Z
1505,@all spam warning when typing @all in backticks,"Sometimes it's useful to talk about @-mentioning everyone, rather than actually doing it. Normally I do this by putting @all in backticks:

```
`@all`
```

AFAIK, Zulip does not ping everyone when @all is quoted in this way, but the new ""Are you sure you want to message all N people in this stream?"" confirmation does come up regardless of whether @all is quoted or not.
# How to reproduce

Type @all in backticks in a public message and press send.
# Expected result

Zulip sends the message. Nobody is pinged.
# Actual result

I get the confirmation message, as well as an error with the following text: ""Please remove @all / @everyone or acknowledge that you will be spamming everyone!"" The message remains unsent.
",davidbalbert,b'bug good first issue help wanted priority: blocker',2016-08-01T16:18:22Z,2016-08-18T23:11:50Z
1498,Update node/jsdom to non-ancient version,"I think we only use jsdom in our node tests (see package.json for where we declare it).   

I tried upgrading to a non-ancient version, but the node tests failed:
https://travis-ci.org/timabbott/zulip/jobs/148753099

The reason I wanted to upgrade is that the current version of jsdom that we're using doesn't install properly in Ubuntu Xenial in a virtualenv.
",timabbott,b'bug good first issue',2016-08-01T00:40:13Z,2016-09-23T21:52:48Z
1491,"checkboxes in ""create stream"" modal have broken CSS in Firefox","This seems to only happen in Firefox:

![image](https://cloud.githubusercontent.com/assets/2746074/17273672/80ff7946-5672-11e6-8bda-cee9025c586b.png)
",timabbott,b'bug design good first issue',2016-07-30T23:28:16Z,2016-08-26T22:06:38Z
1490,CSS issue with line-wrapping of stream descriptions in narrow windows,"If you set a stream description as something long like:
""For important announcement notices. Use the social streams for social announcements.""
and then make the window narrow, the Susbcribe button gets line-wrapped incorrectly:

![image](https://cloud.githubusercontent.com/assets/2746074/17273593/67906252-566f-11e6-9a4f-98a8c80f272b.png)
",timabbott,b'bug good first issue help wanted',2016-07-30T23:06:52Z,2016-08-26T23:05:38Z
1486,node.js tests fail on Ubuntu Xenial,"The Zulip development environment basically works now on Ubuntu Xenial, except the node test suite fails with this interesting exception:

```
running tests for activity
running tests for alert_words
running tests for bot_data
running tests for composebox_typeahead
running tests for dict
running tests for echo
running tests for filter
running tests for hashchange
running tests for i18n
/home/tabbott/zulip/node_modules/jsdom/lib/jsdom/level1/core.js:432
  set nodeName() { throw new core.DOMException();},
              ^^

SyntaxError: Setter must have exactly one formal parameter.
    at exports.runInThisContext (vm.js:53:16)
    at Module._compile (module.js:374:25)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/home/tabbott/zulip/node_modules/jsdom/lib/jsdom/level2/core.js:1:94)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/home/tabbott/zulip/node_modules/jsdom/lib/jsdom/level3/core.js:1:83)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/home/tabbott/zulip/node_modules/jsdom/lib/jsdom/level3/index.js:3:14)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/home/tabbott/zulip/node_modules/jsdom/lib/jsdom.js:1:92)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at create (/home/tabbott/zulip/node_modules/jQuery/lib/node-jquery.js:5:14)
    at /home/tabbott/zulip/node_modules/jQuery/lib/node-jquery.js:9435:18
    at Object.<anonymous> (/home/tabbott/zulip/node_modules/jQuery/lib/node-jquery.js:9437:2)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/home/tabbott/zulip/frontend_tests/node_tests/i18n.js:26:12)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at /home/tabbott/zulip/frontend_tests/zjsunit/index.js:38:5
    at Array.forEach (native)
    at Object.<anonymous> (/home/tabbott/zulip/frontend_tests/zjsunit/index.js:36:7)
    at Module._compile (module.js:410:26)
    at Object.Module._extensions..js (module.js:417:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Function.Module.runMain (module.js:442:10)
    at startup (node.js:136:18)
    at node.js:966:3
```

My guess is that this is caused by running the tests with a newer version of nodejs itself, but I haven't verified this theory.
",timabbott,b'bug',2016-07-30T22:00:23Z,2016-08-25T21:51:08Z
1480,Traceback starting server with the new APNS module,"```
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 338, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 330, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 190, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 40, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File ""/usr/lib/python2.7/importlib/__init__.py"", line 37, in import_module
    __import__(name)
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zerver/management/commands/runtornado.py"", line 31, in <module>
    from zerver.lib.socket import get_sockjs_router, respond_send_message
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zerver/lib/socket.py"", line 20, in <module>
    from zerver.lib.actions import check_send_message, extract_recipients
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zerver/lib/actions.py"", line 62, in <module>
    from zerver.lib.push_notifications import num_push_devices_for_user, \
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zerver/lib/push_notifications.py"", line 96, in <module>
    connection.gateway_server.register_response_listener(
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zulip-venv/lib/python2.7/site-packages/apns.py"", line 168, in gateway_server
    enhanced = self.enhanced
  File ""/home/zulip/deployments/2016-07-27-22-36-47/zulip-venv/lib/python2.7/site-packages/apns.py"", line 471, in __init__
    'gateway.sandbox.push.apple.com')[use_sandbox]
TypeError: tuple indices must be integers, not str
```
",timabbott,b'bug',2016-07-30T04:17:28Z,2016-08-05T17:37:11Z
1462,Buggy HTML in footer when open realm creation is disabled,"![image](https://cloud.githubusercontent.com/assets/2746074/17233758/61d02f34-54e7-11e6-9948-6afc689f87de.png)
",timabbott,b'bug good first issue help wanted',2016-07-29T00:19:24Z,2016-07-29T15:51:31Z
1455,New casper test flake: local echo related,"I think this issue is caused by our local echo support.  

https://travis-ci.org/timabbott/zulip/jobs/148136876
",timabbott,b'area: testing-coverage bug',2016-07-28T20:28:54Z,2016-09-30T17:20:03Z
1454,Fix default streams in development environment not having colors,"I think this has to do with how populate_db creates the initial subscriptions.
",timabbott,b'bug good first issue',2016-07-28T19:01:50Z,2016-08-27T05:38:37Z
1449,Performance issue typing in Chrome on Mac,"We've gotten some reports of slowness when typing in Chrome on Mac.  Needs to be reproduced in a development environment, where we can easily profile what the cause is.
",timabbott,b'bug',2016-07-28T15:25:27Z,2016-07-28T19:05:40Z
1419,parse and use parts of name + email combinations for new user invitations,"If I paste a contact from my email client into the invite field, it often looks like: `Erin Bar <foo@example.com>`. If I paste that directly into the ""invite new user"" email field and hit the invite button, I get this error:

```
Some emails did not validate, so we didn't send any invitations.

    Erin: Invalid address.
    Bar: Invalid address.
    <foo@example.com>: Invalid address.
```

It would be nice if Zulip could parse the invitee's name and email address appropriately out of that format, and send the email invitation with the name included in the `To:` field instead of just using the bare email address. (But I can see how trying to do this would be a headache for a lot of reasons.)
",brainwane,b'bug good first issue help wanted',2016-07-26T19:33:12Z,2016-08-05T21:52:10Z
1418,misleading message when narrowed to silent user,"I narrow to all messages sent by user Foo Bar. But user Foo Bar has not yet sent any messages. The message in the middle of the screen says:

> **Nothing's been sent here yet!**
> 
> Why not start the conversation?

And the phrase ""start the conversation"" is a hyperlink; if I click it, a new message composition box appears. But I'm not Foo Bar, so me composing a message and posting it will not actually cause my search to have new results; ""Why not start the conversation?"" isn't the right message for this circumstance.

Suggested alternative:

> **This user hasn't posted anything yet!**
> 
> Why not ask them to join the conversation?

with ""ask them to join the conversation"" being a link -- clicking it should give the user a composition box pre-populated with an @-notification of Foo Bar's name.
",brainwane,b'bug good first issue help wanted',2016-07-26T19:27:53Z,2016-08-01T02:38:32Z
1411,Errors sending missed message emails on zulip.tabbott.net,"```
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 29, in <module>
    execute_from_command_line(sys.argv)
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 338, in execute_from_command_line
    utility.execute()
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zulip-venv/lib/python2.7/site-packages/django/core/management/__init__.py"", line 330, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 390, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zulip-venv/lib/python2.7/site-packages/django/core/management/base.py"", line 441, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zerver/management/commands/process_queue.py"", line 59, in handle
    worker.start()
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zerver/worker/queue_processors.py"", line 189, in start
    handle_missedmessage_emails(user_profile_id, events)
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zerver/lib/notifications.py"", line 321, in handle_missedmessage_emails
    message_count_by_recipient_subject[recipient_subject],
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zerver/decorator.py"", line 516, in wrapped_func
    ret = func(*args, **kwargs)
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zerver/lib/notifications.py"", line 261, in do_send_missedmessage_events_reply_in_zulip
    address = create_missed_message_address(user_profile, missed_messages[0])
  File ""/home/zulip/deployments/2016-07-22-17-29-14/zerver/lib/email_mirror.py"", line 115, in create_missed_message_address
    return settings.EMAIL_GATEWAY_PATTERN % (address,)
TypeError: not all arguments converted during string formatting
```

@umairwaheed I think this might be a regression introduced by switching the email backend provider...
",timabbott,b'bug',2016-07-26T18:04:28Z,2016-08-01T03:39:26Z
1378,Error on running zulip with non-ubuntu python 2,"I downloaded and built python 2.7.12 from https://www.python.org/downloads/release/python-2712/. I made a virtualenv using it. I installed zulip's dependencies in it. On running `python manage.py shell`, I got this traceback:

```
Exception importing Zulip core modules on startup!
Traceback (most recent call last):
  File ""/mnt/code/repos/forked/zulip/scripts/lib/pythonrc.py"", line 5, in <module>
    from zerver.lib.actions import * # type: ignore # Otherwise have duplicate imports with previous line
  File ""/mnt/code/repos/forked/zulip/zerver/lib/actions.py"", line 52, in <module>
    from zerver.lib import bugdown
  File ""/mnt/code/repos/forked/zulip/zerver/lib/bugdown/__init__.py"", line 1096, in <module>
    maybe_update_realm_filters(domain=None)
  File ""/mnt/code/repos/forked/zulip/zerver/lib/bugdown/__init__.py"", line 1087, in maybe_update_realm_filters
    make_realm_filters(domain, filters)
  File ""/mnt/code/repos/forked/zulip/zerver/lib/bugdown/__init__.py"", line 1076, in make_realm_filters
    ""realm"": [domain, ""Realm name""]})
  File ""/mnt/code/repos/forked/zulip/zerver/lib/bugdown/__init__.py"", line 1051, in make_md_engine
    Bugdown(opts)])
  File ""/mnt/code/venvs/zvenv2o/lib/python2.7/site-packages/markdown/__init__.py"", line 134, in __init__
    configs=kwargs.get('extension_configs', {}))
  File ""/mnt/code/venvs/zvenv2o/lib/python2.7/site-packages/markdown/__init__.py"", line 163, in registerExtensions
    ext.extendMarkdown(self, globals())
  File ""/mnt/code/repos/forked/zulip/zerver/lib/bugdown/__init__.py"", line 960, in extendMarkdown
    md.inlinePatterns.add('unicodeemoji', UnicodeEmoji(u'(?<!\\w)(?P<syntax>[\U0001F300-\U0001F64F\U0001F680-\U0001F6FF\u2600-\u26FF\u2700-\u27BF])(?!\\w)'), '_end')
  File ""/mnt/code/venvs/zvenv2o/lib/python2.7/site-packages/markdown/inlinepatterns.py"", line 161, in __init__
    re.DOTALL | re.UNICODE)
  File ""/mnt/code/venvs/zvenv2o/lib/python2.7/re.py"", line 194, in compile
    return _compile(pattern, flags)
  File ""/mnt/code/venvs/zvenv2o/lib/python2.7/re.py"", line 251, in _compile
    raise error, v # invalid expression
error: bad character range
```

I get a similar traceback with `tools/test-backend`.

I also installed python 3.4 from https://www.python.org/downloads/release/python-343/. I didn't get any errors on that.

We'll most likely need to fix this if we wish to support zulip on python2 on other platforms in the future.
",sharmaeklavya2,b'area: tooling bug help wanted',2016-07-23T10:38:47Z,2016-12-28T04:18:02Z
1376,Cleanup MitUser model,"This is a part of #1334 that is particularly relevant -- we have a whole separate PreregistrationUser clone class for the MitUser model, and I'm not sure that really makes sense.  It currently breaks signing up for a Zulip realm with an mit.edu email address that isn't a Zephyr mirroring realm.
",timabbott,b'bug',2016-07-23T00:15:21Z,2016-07-27T03:31:43Z
1375,Investigate rabbitmq not starting properly after a hostname change,"RabbitMQ reliably fails to start after one changes the hostname and then reboots, and one usually ends up needing to purge and reinstall rabbitmq in order to fix the problem.  

We should investigate whether there's something we can change in our rabbitmq configuration to make this not happen (e.g. maybe there's a setting that lets one force the rabbitmq cluster ID to not be named after the hostname of the system and instead be some constant like ""zulip"")
",timabbott,b'area: production bug help wanted priority: blocker',2016-07-22T22:13:21Z,2016-11-27T03:02:04Z
1374,provision.py fails in presence of proxy,"``` py
Collecting git+https://github.com/bear/python-twitter@7fafaf291512bd103c3de2cb478ab48377c424d5 (from -r /srv/zulip/requirements/common.txt (line 147))
  Cloning https://github.com/bear/python-twitter (to 7fafaf291512bd103c3de2cb478ab48377c424d5) to /tmp/pip-jcr0hhus-build
  Could not find a tag or branch '7fafaf291512bd103c3de2cb478ab48377c424d5', assuming commit.
    Complete output from command python setup.py egg_info:
    Download error on https://pypi.python.org/simple/pytest-runner/: hostname '172.31.1.4' doesn't match either of 'www.python.org', 'docs.python.org', 'bugs.python.org', 'wiki.python.org', 'hg.python.org', 'mail.python.org', 'pypi.python.org', 'packaging.python.org', 'login.python.org', 'discuss.python.org', 'us.pycon.org', 'pypi.io', 'docs.pypi.io' -- Some packages may not be found!
    Couldn't find index page for 'pytest-runner' (maybe misspelled?)
    Download error on https://pypi.python.org/simple/: hostname '172.31.1.4' doesn't match either of 'www.python.org', 'docs.python.org', 'bugs.python.org', 'wiki.python.org', 'hg.python.org', 'mail.python.org', 'pypi.python.org', 'packaging.python.org', 'login.python.org', 'discuss.python.org', 'us.pycon.org', 'pypi.io', 'docs.pypi.io' -- Some packages may not be found!
    No local packages or download links found for pytest-runner
    Traceback (most recent call last):
      File ""<string>"", line 1, in <module>
      File ""/tmp/pip-jcr0hhus-build/setup.py"", line 75, in <module>
        'Programming Language :: Python :: 3.5',
      File ""/usr/lib/python3.4/distutils/core.py"", line 108, in setup
        _setup_distribution = dist = klass(attrs)
      File ""/srv/zulip-venv-cache/7c9d4e0a88e575a529140f3e50e45d3aec54e2e4/zulip-py3-venv/lib/python3.4/site-packages/setuptools/dist.py"", line 239, in __init__
        self.fetch_build_eggs(attrs.pop('setup_requires'))
      File ""/srv/zulip-venv-cache/7c9d4e0a88e575a529140f3e50e45d3aec54e2e4/zulip-py3-venv/lib/python3.4/site-packages/setuptools/dist.py"", line 264, in fetch_build_eggs
        replace_conflicting=True
      File ""/srv/zulip-venv-cache/7c9d4e0a88e575a529140f3e50e45d3aec54e2e4/zulip-py3-venv/lib/python3.4/site-packages/pkg_resources.py"", line 580, in resolve
        dist = best[req.key] = env.best_match(req, ws, installer)
      File ""/srv/zulip-venv-cache/7c9d4e0a88e575a529140f3e50e45d3aec54e2e4/zulip-py3-venv/lib/python3.4/site-packages/pkg_resources.py"", line 818, in best_match
        return self.obtain(req, installer) # try and download/install
      File ""/srv/zulip-venv-cache/7c9d4e0a88e575a529140f3e50e45d3aec54e2e4/zulip-py3-venv/lib/python3.4/site-packages/pkg_resources.py"", line 830, in obtain
        return installer(requirement)
```

`172.31.1.4` is the proxy server. 

Running `pip install cryptography==1.4` works fine in VM while `pip3 install cryptography` fails. 

Commenting out lines that does does Python 3 in tools/setup/setup_venvs.py fixes the issue temporarily. 

@sharmaeklavya2 You must be interested. 
",hackerkid,b'bug good first issue help wanted',2016-07-22T21:52:55Z,2016-10-15T05:15:22Z
1358,(install) ALLOWED_HOSTS 127.0.0.1,"I put 'localhost' in ALLOWED_HOSTS, per instructions, but then I got errors until I also added 127.0.0.1.  This seemed to be a hard crash for me.

Feel free to close this if it's not actionable.
",showell,b'bug',2016-07-22T03:15:36Z,2016-08-06T04:26:41Z
1355,install script completes but then hangs,"I ran `/root/zulip/scripts/setup/install` on a scaleway ubuntu trusty instance, and the install gave me the completion message, but then it was hanging.

When I looked at the processes, I got this:

```
root@scw-cc057e:~# ps -Af | grep zulip
root      2654  4097  0 00:11 pts/0    00:00:00 /bin/bash /root/zulip/scripts/setup/install
root      2657  2654  0 00:11 pts/0    00:00:00 tee -a /var/log/zulip/install.log
zulip     5558  5556  0 00:13 ?        00:00:00 nginx: worker process
zulip     5559  5556  0 00:13 ?        00:00:00 nginx: worker process
zulip     5560  5556  0 00:13 ?        00:00:00 nginx: worker process
zulip     5561  5556  0 00:13 ?        00:00:00 nginx: worker process
root     11209  4097  0 00:19 pts/0    00:00:00 grep --color=auto zulip
root@scw-cc057e:~# ps -af | grep 2654
root      2654  4097  0 00:11 pts/0    00:00:00 /bin/bash /root/zulip/scripts/setup/install
root      2657  2654  0 00:11 pts/0    00:00:00 tee -a /var/log/zulip/install.log
root     11214  4097  0 00:19 pts/0    00:00:00 grep --color=auto 2654
```

I killed the process.  I assume it's a mostly harmless matter of not cleaning up forked processes (although we should fix that), but if it's more serious, I will try to follow up with more info.
",showell,b'bug good first issue help wanted',2016-07-22T00:33:13Z,2016-10-15T04:47:50Z
1352,Fix remaining message edit nondetermistic test failure,"Despite disabling some buggy tests, our casper tests are still failing fairly frequently with this traceback:
https://travis-ci.org/zulip/zulip/builds/146453328.  It's 

@umairwaheed this failure used to happen in the same test runs where the i18n failure that you fixed recently also happened, so it's possible we still have some issue with user_profile caching.  Maybe in addition to trying to debug this, we should implement #1322, in case that helps solve the problem.

(I think given that you debugged the i18n one, you're most qualified to debug this)

I think if we fix this, our casper tests will be reliable again.
",timabbott,b'bug help wanted',2016-07-21T19:58:48Z,2016-07-27T19:34:00Z
1344,Cannot start a sentence with a parenthesis?!!,"Hello, 

I've been very frustrated with a detail on zulip: You can't start a sentence with an opening parenthesis! The typing area simply disappears whenever you have the audacity to do so. 

I would like to be able to signify that what I'm saying isn't very important in my mind, but is worth noting... 

(I can't believe there is no open issue on this. Am I the only one using parentheses? ;) ) 

(Also, how do you manage smileys before a closing parenthesis? It's ugly ain't it? :) ) 
",moebiuseye,b'bug',2016-07-21T10:56:13Z,2016-10-15T04:48:27Z
1337,Traceback running provision from outside a virtualenv,"When running `tools/provision.py` directly, I just got this traceback:

```
+ python ./emoji_dump.py
/bin/sh: 1: ttx: not found
Traceback (most recent call last):
  File ""./emoji_dump.py"", line 117, in <module>
    main()
  File ""./emoji_dump.py"", line 93, in main
    code_point_to_fname_map = code_point_to_file_name_map(""NotoColorEmoji.ttx"")
  File ""./emoji_dump.py"", line 54, in code_point_to_file_name_map
    xml = ET.parse(ttx)
  File ""/usr/lib/python2.7/xml/etree/ElementTree.py"", line 1182, in parse
    tree.parse(source, parser)
  File ""/usr/lib/python2.7/xml/etree/ElementTree.py"", line 647, in parse
    source = open(source, ""rb"")
IOError: [Errno 2] No such file or directory: 'NotoColorEmoji.ttx'
Traceback (most recent call last):
  File ""tools/provision.py"", line 240, in <module>
    sys.exit(main())
  File ""tools/provision.py"", line 212, in main
    run([""tools/setup/emoji_dump/build_emoji""])
  File ""/home/tabbott/zulip/zulip_tools.py"", line 91, in run
    raise subprocess.CalledProcessError(rc, args) # type: ignore # https://github.com/python/typeshed/pull/329
subprocess.CalledProcessError: Command '['tools/setup/emoji_dump/build_emoji']' returned non-zero exit status 1
```

I think this is a regression introduced by 852c49a44e00edac6f9e57c5b02906da8b294765 (since the child process isn't being put into the venv); I've reverted that for now.
",timabbott,b'bug',2016-07-20T21:54:17Z,2016-07-21T01:21:06Z
1335,Clear rabbitmq when rebuilding the development database,"If you rebuild the Zulip development database (`tools/do-destroy-rebuild-database`) on your development environment after sending some messages and then letter parts of the Zulip server crash (e.g. because you did a bunch of rebasing and then ran `provision.py`), you'll often get errors like this in the development console:

```
2016-07-20 17:28:42,384 ERROR    Could not find UserMessage with message_id 76
2016-07-20 17:28:42,388 ERROR    Could not find UserMessage with message_id 77
2016-07-20 17:28:42,393 ERROR    Could not find UserMessage with message_id 79
2016-07-20 17:28:42,399 ERROR    Could not find UserMessage with message_id 83
2016-07-20 17:28:42,401 ERROR    Could not find UserMessage with message_id 83
2016-07-20 17:28:42,403 ERROR    Could not find UserMessage with message_id 84
2016-07-20 17:28:42,404 ERROR    Could not find UserMessage with message_id 84
2016-07-20 17:28:42,405 ERROR    Could not find UserMessage with message_id 86
2016-07-20 17:28:42,406 ERROR    Could not find UserMessage with message_id 90
2016-07-20 17:28:42,412 ERROR    Could not find UserMessage with message_id 93
```

These result from the Zulip queue processors trying to process events in RabbitMQ from before the database had been rebuilt.  We should write some code to drain these events from RabbitMQ to eliminate these errors.
",timabbott,b'area: tooling bug good first issue help wanted priority: high',2016-07-20T21:30:58Z,2017-09-29T01:21:44Z
1297,Find out why UserProfile.bot_owner is not set in python3.4,"When a bot is created, the bot's `bot_owner` field is set to the user owning the bot. Until aa9ada67d2fe9a8f9f44cd8ecc0112b093f4aad2 (#1290), this used to work in python 2.7 and python 3.5 but not in python 3.4. In python 3.4, it used to be set to `None` instead. In aa9ada67d2fe9a8f9f44cd8ecc0112b093f4aad2, this problem was (hackishly) solved but no one knows why this works.

This is the part of the diff from aa9ada67d2fe9a8f9f44cd8ecc0112b093f4aad2 which solved this problem:

``` diff
--- a/zerver/lib/create_user.py
+++ b/zerver/lib/create_user.py
@@ -37,9 +37,12 @@ def create_user_profile(realm, email, password, active, bot_type, full_name,
                                full_name=full_name, short_name=short_name,
                                last_login=now, date_joined=now, realm=realm,
                                pointer=-1, is_bot=bool(bot_type), bot_type=bot_type,
-                               bot_owner=bot_owner, is_mirror_dummy=is_mirror_dummy,
+                               is_mirror_dummy=is_mirror_dummy,
                                enable_stream_desktop_notifications=enable_stream_desktop_notifications,
                                onboarding_steps=ujson.dumps([]))
+    if bot_owner is not None:
+        # `user_profile.bot_owner = bot_owner` doesn't work on python 3.4
+        user_profile.bot_owner_id = bot_owner.id

     if bot_type or not active:
         password = None
```

This bug was discovered by running `zerver.tests.tests.BotTest.test_deactivate_bot` in python 3.4. An assert failure used to occur because the response was <400 ""Insufficient permission"">. This happened because the bot's supposed-to-be-owner tried to deactivate the bot but he couldn't because he's not marked as the owner. The bot's `bot_owner` field is `None` so the bot doesn't have an owner.

It's possible this could be because of a bug in our code which only reveals itself in python 3.4. It'll be great if we can get to the bottom of this issue.
",sharmaeklavya2,b'area: misc bug',2016-07-15T18:59:43Z,2017-01-14T20:23:26Z
1293,Stream color picker seems to be fixed on scroll?,"On subscription page, when we click to select stream color, the stream color picker seems to be fixed (See screenshot). So as we scroll down, the color picker stays fixed. Is this kind if behavior intended or should it be changed?

![screen shot 2016-07-15 at 10 50 55 pm](https://cloud.githubusercontent.com/assets/7534680/16883007/7ac990aa-4adf-11e6-809d-58e70271a013.png)
",aakash-cr7,b'bug good first issue help wanted',2016-07-15T17:28:19Z,2016-08-09T16:09:19Z
1272,Hitting enter in recipient bar topic edit doesn't do anything,"After editing the topic from the recipient bar, hitting enter should do the same thing as clicking on the checkbox. You'll need to log in as admin or find a message with no topic to be able to get to this input box.
![bad2](https://cloud.githubusercontent.com/assets/890911/16823740/0c4ad46a-491b-11e6-99f6-29f8ea20b045.png)
",rishig,b'area: message-editing bug design good first issue help wanted',2016-07-13T23:58:52Z,2016-10-26T05:28:58Z
1270,CSS for line wrapping topic edit propagation dropdown,"See pictures below. The relevant handlebars code is in `static/templates/message_edit_form.handlebars`, and the css is in `static/styles/zulip.css`

Good: the topic propagation dropdown is set off nicely from the topic text input box:
![good](https://cloud.githubusercontent.com/assets/890911/16823146/ac1df5c6-4916-11e6-9f02-694854e62286.png)

Bad: when the window narrows, and the dropdown wraps to the next line, there isn't enough space between the bottom of the input box and the top of the dropdown:
![bad](https://cloud.githubusercontent.com/assets/890911/16823163/ce0c5fba-4916-11e6-91e3-3ed17676bc4b.png)
",rishig,b'bug design good first issue help wanted',2016-07-13T23:28:19Z,2016-08-26T22:25:19Z
1249,Signup for deactivated realms throws an error after confirmation,"If you deactivate a realm using e.g. `./manage.py deactivate_realm zulip.com` and then go through the registration flow, it currently doesn't give you an error about the realm having been deactivated until after you click the email confirmation link.  It seems like we could reject you earlier.
",timabbott,b'area: portico bug good first issue help wanted',2016-07-13T03:41:30Z,2017-10-17T05:58:11Z
1244,Intermittant Casper fails with i18n test,"@umairwaheed I've seen this set of 2 Casper failures happen a few times recently in random pull requests; can you investigate?  

https://travis-ci.org/zulip/zulip/jobs/144292709

If I had to guess, the selector we're waiting for after reloading the page isn't the right one, and so sometimes it is checking before that section of the page is initialized.  

If you're having a hard time figuring out what the cause is, let me know and I can investigate.  

One thing that would probably help with debugging this sort of thing is if we can figure out a way to get Travis CI to upload the screenshots that Casper takes...
",timabbott,b'bug',2016-07-13T00:48:25Z,2016-07-19T15:57:54Z
1223,Improve colors in our pygments configuration,"Our default syntax highlighting of code blocks colors inline code block text in red, which I haven't seen a lot of other projects do and is probably just a mistake.

You can see some of how this looks in our integration docs:
https://zulip.com/integrations/#nagios
though of course we use the same color scheme in-app.

We should perhaps do a look through pygments.css, fix this, and think about if there's anything else we should change.
",timabbott,b'bug design good first issue',2016-07-12T04:50:17Z,2016-10-09T18:12:10Z
1194,"""Add custom alert word"" button should display an error if the input is empty","On the settings page, the ""add alert word"" button should display an error message if the input box is empty and user tries to click the button. Currently nothing happens when a user clicks the button.
",aakash-cr7,b'bug good first issue help wanted',2016-07-08T13:42:38Z,2016-07-14T04:07:22Z
1190,Need to re-source Zulip virtualenv after re-provisioning,"Currently, whenever you re-provision your Zulip development environment, you don't actually use the new dependencies until you re-source the Zulip virtualenv in your shell.

I'm not sure there's a good way to fix this, but we could at least have provision.py output a loud (red) warning that the user needs to do this at the end of the provision success output (in the event that the venv changed).
",timabbott,b'bug help wanted',2016-07-07T22:29:14Z,2016-07-21T21:12:42Z
1160,bugdown: Replace raw unicode literal with non-raw.,"Raw unicode literals are disallowed in python 3.
",sharmaeklavya2,None,2016-07-02T00:31:55Z,2016-07-02T19:09:43Z
1158,Improve translations performance on subscriptions page,"This probably affects all the other pages as well, but the /#subscriptions page is currently having significant performance problems; on a server with many hundreds of streams configured it can take 10s (or 30s under profiling) to load the /#subscriptions panel.  Here's the profile:

![image](https://cloud.githubusercontent.com/assets/2746074/16529697/3858dabc-3f79-11e6-8d32-1216eec9515b.png)

If you zoom in on the individual spikes at the bottom, you can see all the time is spent inside translations:

![image](https://cloud.githubusercontent.com/assets/2746074/16529706/42b6c910-3f79-11e6-996a-2fe063cd3259.png)

@umairwaheed can you look into this?  I think possibly the issue is that we're translating the same strings in that page many hundreds of times, so we could look into caching like https://github.com/i18next/i18next-localStorage-cache.  
",timabbott,b'bug help wanted priority: blocker',2016-07-01T17:50:01Z,2016-07-21T17:24:15Z
1155,"Translations about ""recipient not valid"" messages may be tagged wrongly  ","The two messages are used to indicate that the recipient(s) in PM is not valid. The source strings in Transifex looks strange and may be tagged wrongly: 
![image](https://cloud.githubusercontent.com/assets/19701659/16511972/e7602a6a-3f88-11e6-9b20-fbd7986cfae7.png)

Also, the translations do not work.
",Jianchun1,b'bug',2016-07-01T04:45:55Z,2016-07-15T18:13:06Z
1149,Some manual install instructions are incorrect/missing,"In the [debian/ubuntu manual install section](https://github.com/zulip/zulip/blob/master/README.dev.md#on-debian-or-ubuntu-systems), there are instructions for installing `tsearch_extras` on Ubuntu 12.04, 14.04 and 15.04, but nothing for 16.04. 16.04 has postgresql version 9.5, so we can't follow instructions for older versions. I installed the version for xenial from https://launchpad.net/~tabbott/+archive/ubuntu/zulip/+files/postgresql-9.5-tsearch-extras_0.2_amd64.deb.
",sharmaeklavya2,b'bug good first issue help wanted',2016-06-30T17:27:50Z,2016-08-16T23:23:43Z
1141,Upgrade to jQuery 1.8.x,"We no longer are using any features that were explicitly deprecated in jQuery 1.8, so it should now be time to actually upgrade.  I spent a bit of time today trying to actually do the upgrade, unsuccessfully.

I opened https://github.com/zulip/zulip/pull/1140 just to demonstrate how to upgrade the version of jQuery; it doesn't work.  In particular, the Casper tests go into an infinite loop after less than 10 tests (or you can load the Zulip homepage in the browser and get the same infinite loop).  Here's the repeating section of the infinite loop:

```
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:2945
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:3599
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:611
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:241
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:3600
  http://localhost:9981/static/js/hashchange.js:128
  http://localhost:9981/static/js/hashchange.js:176
  http://localhost:9981/static/js/blueslip.js:217
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:2945
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:3599
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:611
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:241
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:3600
  http://localhost:9981/static/js/hashchange.js:128
  http://localhost:9981/static/js/hashchange.js:176
  http://localhost:9981/static/js/blueslip.js:217
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:2945
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:3599
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:611
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:241
  http://localhost:9981/static/third/jquery/jquery-1.8.3.js:3600
  http://localhost:9981/static/js/hashchange.js:128
  http://localhost:9981/static/js/hashchange.js:176
  http://localhost:9981/static/js/blueslip.js:217
```

To provide a bit of relevant context, here's some notes on the 2 key lines inside the Zulip code:
- The hashchange.js:128 line is `$(document).trigger($.Event('hashchange.zulip'));`.  This line is a key part of how Zulip implements switching views within the single-page webapp (the hash changes whenever you narrow, go to the settings page, etc.).  If one deletes that line (just to see what happens), the site loads fine, but then changing tabs doesn't work so the tests will still fail starting with the narrowing tests.  
- `blueslip` is a Zulip-specific library for catching all javascript tracebacks and reporting them to the server.  Consequently, we have blueslip wrap basically every entry point within our javascript.  In theory, it should do nothing other than wrapping things inside a `try/except` in production.  Based on the next bullet, it appears the infinite loop here doesn't involve blueslip.
- The hashchange.js:176 line is inside the `hashchanged` function, which is called primarily from a `window.onhashchange` hook using blueslip around line 185 of that file:
  `window.onhashchange = blueslip.wrap_function(hashchanged);`.  If you remove the `blueslip.wrap_function` around `hashchanged`, the infinite loop still happens (and no longer has blueslip in the traceback).

So, in summary, I think somehow the `$(document).trigger($.Event('hashchange.zulip'));` call is resulting in the hash being (seen as?) changed; I don't understand the mechanism for this.

I'd be super excited if someone was able to debug this infinite loop issue!  
",timabbott,b'bug help wanted',2016-06-29T03:26:34Z,2016-07-08T18:11:13Z
1116,realm emoji form doesn't display a user-facing error on invalid input,"If you input an invalid url on the ""add realm emoji"" form on /#administration, the backend correctly throws a 400 error, but the frontend doesn't display the error message.  We seem to have code to do this in the `.admin_emoji_table` handlers in static/js/admin.js, it just doesn't work.  
",timabbott,b'bug good first issue help wanted',2016-06-24T23:48:18Z,2016-09-27T03:53:20Z
1095,Restarting services with supervisord is really slow,"Currently, restarting all Zulip services with supervisord takes about 40s to run.

This also means we spend about 40s in our Travis CI tests for the `production` suite restarting services using supervisord.  This time is not time spent in Zulip -- the time is essentially all supervisord overhead.  We should figure out how to either patch or replace supervisord to be reasonably efficient.

https://github.com/Supervisor/supervisor/pulls?q=is%3Apr+author%3Azbenjamin+is%3Aclosed has some work @zbenjamin did on supervisor performance a few years ago, but it seems despite some of that being merged, supervisor is still incredibly slow at restarting N processes.

The test case for this I would use is just running supervisord to start N `sleep 10000` commands.
",timabbott,b'bug help wanted',2016-06-22T17:49:52Z,2016-06-29T05:36:52Z
1032,Fix port number used in Docker container development environment.,"I follow the readme part exactly, copying and pasting these lines (replacing the container id with a real one):

```
docker build -f Dockerfile-dev -t user/zulipdev .
docker run -itv $(pwd):/srv/zulip -p 80:9991 user/zulipdev /bin/bash
$ /usr/bin/python /srv/zulip/provision.py --docker
$exit
docker ps -af ancestor=user/zulipdev
docker commit -m ""Zulip installed"" <container id> user/zulipdev:v2
docker run -itv $(pwd):/srv/zulip -p 80:9991 user/zulipdev:v2 \
    /srv/zulip/scripts/start-dockers
```

The docker starts up with this:

```
$ docker run -itv $(pwd):/srv/zulip -p 80:9991 user/zulipdev:v2 \
> /srv/zulip/scripts/start-dockers
 * Restarting message broker rabbitmq-server                                                          [ OK ] 
 * Restarting PostgreSQL 9.3 database server                                                          [ OK ] 
Stopping redis-server: redis-server.
Starting redis-server: redis-server.
Restarting memcached: start-stop-daemon: warning: failed to kill 11008: No such process
memcached.
/home/zulip/.bash_profile: line 1: .bashrc: No such file or directory
+++ dirname /srv/zulip/scripts/setup/configure-rabbitmq
++ /srv/zulip/scripts/setup/../get-django-setting RABBITMQ_USERNAME
+ RABBITMQ_USERNAME=zulip
+++ dirname /srv/zulip/scripts/setup/configure-rabbitmq
++ /srv/zulip/scripts/setup/../get-django-setting RABBITMQ_PASSWORD
+ RABBITMQ_PASSWORD=1a83b188e837cd155a24864b48f198e168bcb0c40114ae7571054060b2d86e13
+ sudo rabbitmqctl delete_user zulip
Deleting user ""zulip"" ...
Error: no_such_user: zulip
+ true
+ sudo rabbitmqctl delete_user zulip
Deleting user ""zulip"" ...
Error: no_such_user: zulip
+ true
+ sudo rabbitmqctl delete_user guest
Deleting user ""guest"" ...
...done.
+ sudo rabbitmqctl add_user zulip 1a83b188e837cd155a24864b48f198e168bcb0c40114ae7571054060b2d86e13
Creating user ""zulip"" ...
...done.
+ sudo rabbitmqctl set_user_tags zulip administrator
Setting tags for user ""zulip"" to [administrator] ...
...done.
+ sudo rabbitmqctl set_permissions -p / zulip '.*' '.*' '.*'
Setting permissions for user ""zulip"" in vhost ""/"" ...
...done.
2016-06-14 15:46:21,314 INFO: process_fts_updates starting
Recompiling templates
2016-06-14 11:46:21,383 INFO: Not in recovery; listening for FTS updates
done
http://localhost:9994/webpack-dev-server/
webpack result is served from http://localhost:9991/webpack/
content is served from /srv/zulip
Validating Django models.py...
System check identified no issues (0 silenced).

Django version 1.8
Tornado server is running at http://localhost:9993/
Quit the server with CTRL-C.
2016-06-14 11:46:21,908 INFO     Tornado loaded 0 event queues in 0.000s
2016-06-14 11:46:21,909 INFO     Tornado  81.8% busy over the past  0.0 seconds
Performing system checks...

System check identified no issues (0 silenced).
June 14, 2016 - 11:46:22
Django version 1.8, using settings 'zproject.settings'
Starting development server at http://localhost:9992/
Quit the server with CONTROL-C.

webpack: bundle is now VALID.
2016-06-14 11:46:22,356 INFO     launching queue worker thread error_reports
2016-06-14 11:46:22,357 INFO     launching queue worker thread user_presence
2016-06-14 11:46:22,357 INFO     launching queue worker thread digest_emails
2016-06-14 11:46:22,358 INFO     launching queue worker thread slow_queries
2016-06-14 11:46:22,361 INFO     launching queue worker thread missedmessage_mobile_notifications
2016-06-14 11:46:22,362 INFO     launching queue worker thread feedback_messages
2016-06-14 11:46:22,364 INFO     launching queue worker thread signups
2016-06-14 11:46:22,366 INFO     launching queue worker thread test
2016-06-14 11:46:22,367 INFO     launching queue worker thread message_sender
2016-06-14 11:46:22,417 INFO     launching queue worker thread missedmessage_emails
2016-06-14 11:46:22,417 INFO     launching queue worker thread email_mirror
2016-06-14 11:46:22,418 INFO     launching queue worker thread user_activity_interval
2016-06-14 11:46:22,421 INFO     launching queue worker thread invites
2016-06-14 11:46:22,422 INFO     launching queue worker thread user_activity
2016-06-14 11:51:21,918 INFO     Tornado removed 0 idle event queues owned by 0 users in 0.000s.  Now 0 active queues, 0 handlers, latest ID 0
2016-06-14 11:56:21,917 INFO     Tornado removed 0 idle event queues owned by 0 users in 0.000s.  Now 0 active queues, 0 handlers, latest ID 0
```

However, when I go to http://localhost:9991/ I get ""This site can’t be reached"" and tells me to check my settings. I do have other Docker containers that I can access through the web, so I know Docker is set up right.

I don't want to install this on a system because I just want to test it, and thought Docker would be best as I could just delete the images and containers.

Thanks.
",dracwyrm,b'area: documentation (developer) bug good first issue',2016-06-14T16:06:01Z,2016-06-16T07:16:23Z
1014,emoji unable to be previewed and displayed in translated UI,"The emoji is unable to be previewed and displayed in the translated UI, the screenshot:
![image](https://cloud.githubusercontent.com/assets/19701659/15991313/0210d612-30e2-11e6-9012-c18064d9ba33.png)

When inputting emoji, the console can get a series of ""Not Found"" errors:

```
2016-06-12 09:10:51,480 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/hear_no_evil.png
2016-06-12 09:10:51,514 INFO     127.0.0.1       GET     404  36ms /zh-cn/static/third/gemoji/images/emoji/hear_no_evil.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/hear_no_evil.png HTTP/1.0"" 404 21495
2016-06-12 09:10:51,530 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart.png
2016-06-12 09:10:51,545 INFO     127.0.0.1       GET     404  17ms /zh-cn/static/third/gemoji/images/emoji/heart.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart.png HTTP/1.0"" 404 21474
2016-06-12 09:10:51,560 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_eyes_cat.png
2016-06-12 09:10:51,574 INFO     127.0.0.1       GET     404  16ms /zh-cn/static/third/gemoji/images/emoji/heart_eyes_cat.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart_eyes_cat.png HTTP/1.0"" 404 21501
2016-06-12 09:10:51,588 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_eyes.png
2016-06-12 09:10:51,602 INFO     127.0.0.1       GET     404  15ms /zh-cn/static/third/gemoji/images/emoji/heart_eyes.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart_eyes.png HTTP/1.0"" 404 21489
2016-06-12 09:10:51,616 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_decoration.png
2016-06-12 09:10:51,643 INFO     127.0.0.1       GET     404  28ms /zh-cn/static/third/gemoji/images/emoji/heart_decoration.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart_decoration.png HTTP/1.0"" 404 21507
2016-06-12 09:10:51,865 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart.png
2016-06-12 09:10:51,884 INFO     127.0.0.1       GET     404  23ms /zh-cn/static/third/gemoji/images/emoji/heart.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart.png HTTP/1.0"" 404 21474
2016-06-12 09:10:51,900 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_decoration.png
2016-06-12 09:10:51,913 INFO     127.0.0.1       GET     404  15ms /zh-cn/static/third/gemoji/images/emoji/heart_decoration.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart_decoration.png HTTP/1.0"" 404 21507
2016-06-12 09:10:51,928 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_with_arrow.png
2016-06-12 09:10:51,942 INFO     127.0.0.1       GET     404  16ms /zh-cn/static/third/gemoji/images/emoji/heart_with_arrow.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart_with_arrow.png HTTP/1.0"" 404 21507
2016-06-12 09:10:51,956 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_eyes_cat.png
2016-06-12 09:10:51,969 INFO     127.0.0.1       GET     404  15ms /zh-cn/static/third/gemoji/images/emoji/heart_eyes_cat.png (unauth via ?)
[12/Jun/2016 09:10:51]""GET /zh-cn/static/third/gemoji/images/emoji/heart_eyes_cat.png HTTP/1.0"" 404 21501
2016-06-12 09:10:51,983 WARNING  Not Found: /zh-cn/static/third/gemoji/images/emoji/heart_eyes.png
2016-06-12 09:10:51,998 INFO     127.0.0.1       GET     404  16ms /zh-cn/static/third/gemoji/images/emoji/heart_eyes.png (unauth via ?)
[12/Jun/2016 09:10:52]""GET /zh-cn/static/third/gemoji/images/emoji/heart_eyes.png HTTP/1.0"" 404 21489
```
",Jianchun1,b'bug',2016-06-12T13:13:28Z,2016-06-13T16:13:34Z
1012,Clicking on desktop notification doesn't narrows properly.,"Whenever user has kept open Subscription page. 
If one desktop notification pops up, clicking on it is supposed to narrow to perspective stream and/or topic. But, still subscription page is visible in front.

Another way. Open any stream say ""Denmark"". Click on stream settings gear to open up subscription page. You might still see ""stream:Denmark"" in search box at top of page. Now, clicking on search box and pressing enter doesn't narrows to the stream.

Attached image of the same. 
![screenshot from 2016-06-11 22 59 28](https://cloud.githubusercontent.com/assets/6594924/15986627/d55d76c4-3029-11e6-9392-c7c7cb4e195c.png)

cc @neerajwahi I can work on this while existing PRs are reviewed.
",kartikmaji,b'bug help wanted',2016-06-11T17:43:16Z,2016-06-23T22:21:16Z
993,Rendering issue with `@all` fixed on reload,"When you send a message containing `@all`, it mentions everyone on the stream, but doesn't color the message red for the sender until the page is reloaded.  This problem doesn't occur using `@**all**` aka what the mention autocomplete likes.

I suspect the issue is caused by the frontend markdown processor (used to echo messages sent by the user quickly) doesn't properly color the message red.

Fixing this likely involves some changes in echo.js, specifically `handleUserMentions`.
",timabbott,b'area: compose area: message view bug good first issue help wanted',2016-06-09T21:50:53Z,2016-11-07T02:37:54Z
989,upload fails when using translations ,"I occasionally found that an error was reported when uploading a file to zulip: 
![image](https://cloud.githubusercontent.com/assets/19701659/15930220/40a2dcc8-2e84-11e6-929d-cea3bfbd9b36.png)

The issue should be related to the translation url, e.g. zh-cn, because the zulip console said:

```
2016-06-09 08:49:03,600 INFO     Received event: {u'status': 1, u'user_profile_id': 3, u'client': u'website', u'time': 1465476543}
2016-06-09 08:49:03,650 INFO     127.0.0.1       POST    200  30ms (lp: 50.0s) (mem: 7ms/1) (db: 2ms/3q) (+start: 8ms) /json/get_events [1465474916:1/1] (iago@zulip.com via website)
2016-06-09 08:49:03,666 INFO     127.0.0.1       POST    200  70ms (db: 3ms/3q) /json/users/me/presence (iago@zulip.com via website)
2016-06-09 08:49:06,200 WARNING  Not Found: /zh-cn/json/upload_file
2016-06-09 08:49:06,216 INFO     127.0.0.1       POST    404  19ms /zh-cn/json/upload_file (unauth via ?)
[09/Jun/2016 08:49:06]""POST /zh-cn/json/upload_file HTTP/1.0"" 404 21526
```
",Jianchun1,b'bug',2016-06-09T12:59:27Z,2016-06-09T19:00:31Z
982,"""Settings"" page displayed not in specified language in url","I specified the language code ""zh-cn"" in url of ""Settings"" page as below:
`http://192.168.1.2:9991/zh-cn/#settings`
but it still shows a English UI.

While I enter the page from the setting menu, it has no such problem. 
",Jianchun1,b'bug',2016-06-08T13:58:21Z,2016-06-21T06:05:01Z
981,Chinese file name unreadable after uploading into Zulip,"When a file with non-ascii character name uploaded into Zulip, its name becomes unreadable. For example, a file with name ""测试文件123.txt“ uploaded:
![image](https://cloud.githubusercontent.com/assets/19701659/15893156/865671aa-2db0-11e6-8971-a36198ea0d35.png)

And the path is like that:

```
 [KՇ123.txt](/user_uploads/1/80/A7_7wMh2jkYtKiEafSe-6TZA/KՇ123.txt) 
```

So, it's not easy to use for me. I guess it might be a common issue for non-Latin language users.
",Jianchun1,b'bug',2016-06-08T11:41:35Z,2016-06-14T22:33:04Z
971,back-end tests fails in presence of proxy server,"```
Running zerver.tests.test_upload.S3Test.test_file_upload_s3
Traceback (most recent call last):
  File ""/srv/zulip/zerver/lib/test_runner.py"", line 102, in run_test
    test_method()
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/moto/core/models.py"", line 71, in wrapper
    result = func(*args, **kwargs)
  File ""/srv/zulip/zerver/tests/test_upload.py"", line 251, in test_file_upload_s3
    bucket = conn.create_bucket(settings.S3_AUTH_UPLOADS_BUCKET)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/s3/connection.py"", line 612, in create_bucket
    data=data)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/s3/connection.py"", line 664, in make_request
    retry_handler=retry_handler
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/connection.py"", line 1071, in make_request
    retry_handler=retry_handler)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/connection.py"", line 913, in _mexe
    self.is_secure)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/connection.py"", line 705, in get_http_connection
    return self.new_http_connection(host, port, is_secure)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/connection.py"", line 747, in new_http_connection
    connection = self.proxy_ssl(host, is_secure and 443 or 80)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/boto/connection.py"", line 796, in proxy_ssl
    sock.sendall(""CONNECT %s HTTP/1.0\r\n"" % host)
  File ""/srv/zulip-venv-cache/0227edfb963fd4df12824323e220dc488bc913d4/zulip-venv/local/lib/python2.7/site-packages/httpretty/core.py"", line 405, in sendall
    headers, body = list(map(utf8, data.split(b'\r\n\r\n', 1)))
ValueError: need more than 1 value to unpack
FAILED!
```
",hackerkid,b'area: testing-infrastructure bug',2016-06-07T20:46:23Z,2017-04-22T00:18:45Z
969,"translation issues of the ""subscribe"" button ","In the subscription page, the ""subscribe"" button text turns to be English when the mouse moves on it, and it keeps untranslated even after the mouse moves away.
![image](https://cloud.githubusercontent.com/assets/19701659/15859574/45ecc2ee-2cf8-11e6-8204-0479384635a0.png)
",Jianchun1,b'bug',2016-06-07T13:39:23Z,2016-06-13T16:08:57Z
933,Nondeterministic failures in Casper tests,"@acrefoot it seems we have a new one.  See https://travis-ci.org/zulip/zulip/jobs/135360959
",timabbott,b'area: testing-coverage bug help wanted',2016-06-05T15:10:45Z,2016-10-19T19:55:10Z
932,Message - cancel editing problem,"During work on another ""/me"" ticket I found probably a bug:
Steps to reproduce (I didn't check it with other scenarios):
1. Create message like: `/me blahblah`
2. Click edit with the chevron and edit message without save
3. Click cancel.
4. Edit topic using ""pencil"" icon
5. Save edited topic
6. Be sad ;-(

Content message was edited using edition you made in ""chevron edit mode""
@timabbott Could you try to reproduce and say it is a bug or not?
",TomaszKolek,b'bug good first issue help wanted',2016-06-05T06:32:16Z,2016-06-07T19:56:36Z
930,PM with non-existing  users,"When composing a pm to non-existing user, it can be sent without any tip. Is that right?
Then it will give auto-completion when writing the non-existing user in ""You and"" text-box:
![image](https://cloud.githubusercontent.com/assets/19701659/15803781/5f87876c-2b21-11e6-8300-6cbb49cf3088.png)
",Jianchun1,b'bug priority: blocker',2016-06-05T05:31:42Z,2016-06-11T18:27:44Z
886,realms with both email auth and google auth require setting a password when registering,"At least zulip.tabbott.net had that issue (I had to set a password when registering with google auth, though I don't need to enter the password to sign in). Is it intentional? Maybe has to do with both email and google auth backends being enabled, but that's just a guess.
",rwbarton,b'area: authentication area: portico bug help wanted',2016-06-03T18:30:22Z,2017-08-09T20:45:37Z
883,The tutorial causes multiple notification permission panels in Safari.,"**SUMMARY**
After a user walks through the tutorial, they will be presented with Safari's Notification Center permission panel once for every step in the tutorial (currently five).

**EXPECTED BEHAVIOR**
The user should only see the permission panel once.

**REPRO**
For a server you have never logged in to before:
- Login to a new account to enable the tutorial.
- Click through the tutorial.
- Safari will present the notifications permission panel once for each step of the demo.

If you have previously gone through the tutorial and answered the Safari notification permissions panel, you will need to first run these steps:
- Open the Safari preferences (Safari menu -> Preferences).
- Click on the Notifications tab.
- Find the server you will log in to (usually ""localhost"" for the dev server).
- Select it and click the Remove button in the lower left.
- Create a new user with which to login and walk through the tutorial.
- [WARNING] Alternatively, from the zulip directory, run `./tools/do-destroy-rebuild-database` to destroy your database and start with the defaults.  This will destroy all existing data in the database.

**VERSIONS AFFECTED**
- Safari 9.1.1 (11601.6.17)
- Safari Technology Preview 9.1.1 (11601.6.17, 11602.1.33)

**NOTES**
- If you remove the Zulip server from Safari’s Notification Center preferences after clicking through any of the tutorial (for example, after the first four steps), Safari will still present notification permission panels for each step in the tutorial.
- Firefox and Chrome, which use custom notification frameworks and not the native Notification Center, do not have this problem.
- If you remove your server from the Safari’s notification preferences after the tutorial, reload the page, and click on the website, you will see one notification permission panel (the expected behavior).
- Only the first answer matters.  If the user selects Allow and then selects Deny on the subsequent panels, their preference will still be set to Allow. (This is a Safari bug.)
",florean,b'area: notifications (other) area: onboarding bug good first issue help wanted',2016-06-03T17:30:25Z,2017-08-23T07:55:52Z
878,Running casper tests while run-dev.py is running doesn't work,"The failure mode is hanging at ""Logging in"" in 00-login.js, and this seems to be easily reproducible.

This is a recent regression (this used to work) and would be great to debug.
",timabbott,b'bug help wanted priority: blocker',2016-06-03T06:53:08Z,2016-06-30T21:33:24Z
863,Production install isn't meant to be re-run,"At the end of the production install, /root/zulip is moved and a symlink is put in it's place.

If the install is then run again, the install fails due to symlink recursion.

While this likely isn't a common case, it should be handled differently, even if it's just a documentation update.
",pacopablo,b'area: production installer bug help wanted',2016-06-02T18:16:12Z,2017-05-17T05:18:32Z
843,Casper tests in 11-admin.js fails randomly,"```
FAIL Found ""Deactivate"" within the selector ""#admin_deactivated_users_table .user_row[id=""user_cordelia@zulip.com""]""
#    type: assertSelectorHasText
#    subject: false
#    selector: ""#admin_deactivated_users_table .user_row[id=\""user_cordelia@zulip.com\""]""
#    text: ""Deactivate""
```
",hackerkid,b'bug priority: blocker',2016-05-28T23:30:58Z,2016-06-05T01:36:38Z
836,"""(Edited)"" note cut off for one-line messages starting with ""/me""","When using ""/me"", the ""(Edited)"" note appears below the message rather than next to the person's name. For single-line messages with ""/me"", this note appears partly outside the message box. This does not occur if the message is longer than a single line.

To reproduce: Create a message with ""/me"", then edit and reload the page. ""(Edited)"" will appear partly outside the message box, and submitting another message will cut off the bottom half of the word.
",elsander,b'bug good first issue help wanted',2016-05-25T22:24:00Z,2016-06-05T17:12:06Z
835,"Editing messages to include ""/me"" does not render correctly, even after reload","Creating a message (which does not start with ""/me""), then editing it to start with ""/me"", does not render correctly, even after refreshing the page.

Possibly related to #163? 
",elsander,b'bug good first issue help wanted',2016-05-25T22:16:34Z,2016-06-24T18:20:06Z
806,Retreiving API Keys fails when authed through LDAP?,"Copied from https://groups.google.com/forum/#!topic/zulip-help/r2wMd-4kidI

>    On Wednesday, October 21, 2015 at 3:07:13 PM UTC+3, martin.ostlund wrote:

```
Hello,

Im logged in/authed as an LDAP user.

Under my Settings, 
""Please re-enter your password to confirm your identity. (Forgotten it?)""

I enter my password and hit ""Get API Key"", 
Browser reports ""Error getting API key: Your username or password is incorrect.""

Server logs says
==> server.log <==
2015-10-21 08:03:43,891 INFO     192.168.3.35    POST    400  12ms /json/fetch_api_key (admin.martin@corp.work via website)

==> django.log <==
2015-10-21 08:03:43,892 INFO     status=400, data={""msg"":""Your username or password is incorrect."",""result"":""error""}

Any ideas? Same username & password works for logging in.

/Martin
```
",qk4l,b'bug',2016-05-18T14:46:54Z,2016-06-21T23:15:14Z
800,SSO Auth Expiration triggers Basic Auth Popup,"After updating to 1.3.12 (skipping 1.3.11), we noticed that after the SSO auth cookie expires the zulip site will display a HTTP Basic auth popup requesting that users login rather than redirecting to the SSO site as we would expect. Prior to 1.3.11, this popup would happen rarely and sometimes would go away shortly after it appeared but now it does not go away at all.
",timapril,b'bug priority: blocker',2016-05-16T14:00:48Z,2016-06-21T23:21:01Z
789,Start up not showing up to date stream,"So I went online after being offline. I went to Zulip, and saw that there was a new message in a topic, so clicked on it. At the same time, Zulip was refreshing after coming back on line. When it started doing this, it went to back to displaying some old version of the stream from weeks ago, with no new message indicator. After 5 secs or so, the new message indicator came back - but the stream did not update as shown in the attached image. After that, I clicked on the topic, and it refreshed ok.
_
![image](https://cloud.githubusercontent.com/assets/5858581/15241764/8f548542-1935-11e6-9f6c-cf86ebd9e7aa.png)

It's a bit weird how it 'loses' content for that refresh period anyway
",grahamegrieve,b'area: message view bug help wanted',2016-05-13T08:08:24Z,2018-04-23T04:36:39Z
753,AttributeError: 'SocketConnection' object has no attribute 'client_id',"In the chat.fhir.org logs, I'm seeing the following 1-2 times per day on average:

```
2016-04-18 14:19:01,943 ERROR    XHR incoming
Traceback (most recent call last):
  File ""/usr/lib/python2.7/dist-packages/sockjs/tornado/transports/xhr.py"", line 85, in post
    session.on_messages(messages)
  File ""/usr/lib/python2.7/dist-packages/sockjs/tornado/session.py"", line 420, in on_messages
    self.conn.on_message(msg)
  File ""/home/zulip/deployments/2016-02-17-16-56-57/zerver/lib/socket.py"", line 160, in on_message
    self.client_id))
AttributeError: 'SocketConnection' object has no attribute 'client_id'
```

Haven't debugged but would be happy to investigate if you have suggestions on how to proceed.
",jmandel,b'bug',2016-05-05T13:01:20Z,2016-10-14T01:08:17Z
750,virtualbox guest additions for ubuntu/trusty64 not updated for VirtualBox 5.x,"The current release version of VirtualBox is 5.x.
The version of virtualbox guest additions configured for vagrantbox ubuntu/trusty64 is 4.3.x.

Zulip dev still runs when this is the case, but shared folders aren't synchronized except on vagrant up/reload. This makes development a cumbersome process.

Possible solutions:
- Modify vagrantfile to update virtualbox guest additions as needed, uninstall old packages and installing iso[1] manually.
- Use vagrant plugin[2] to update virtualbox guest additions as needed.
- Specify that developers use VirtualBox 4.3.x[3]

[1] http://download.virtualbox.org/virtualbox/5.0.16/VBoxGuestAdditions_5.0.16.iso
[2] https://github.com/dotless-de/vagrant-vbguest
[3] https://www.virtualbox.org/wiki/Download_Old_Builds_4_3
",christi3k,b'area: provision bug help wanted',2016-05-03T18:34:20Z,2018-04-28T20:57:24Z
741,Messages arriving out of order,"I've had a report from a user running the windows client to post to https://chat.fhir.org/ that messages sometimes have appeared out of order. That is, he sent ""a"", then ""b"", but the log shows ""b"" then ""a"". Is this a known issue? Do clients (or servers) attempt to defend against it (or should they)?

Apologies if this is a known issue (I saw https://github.com/zulip/zulip/issues/385 with some related discussion, but our screenshot below shows timestamps on all messages, so it doesn't appear that ""local echo"" is involved):

![image](https://cloud.githubusercontent.com/assets/313089/14954226/b6e5c13e-103e-11e6-8a8d-23e4dbba6359.png)
",jmandel,b'bug',2016-05-02T12:22:03Z,2016-05-09T17:54:34Z
740,Narrowing to non existing Stream,"When user narrows to any stream using search box. It gives subscribed streams as suggestion in a dropdown which works fine. But, if user narrows to a non existing stream say ABC. It doesn't show any error message. User may think it as a simple empty stream which he/she isn't subscribed to.
![screenshot from 2016-05-02 06 03 44](https://cloud.githubusercontent.com/assets/6594924/14945293/c8d689c2-102b-11e6-8ab7-86f14c4b155b.png)
",kartikmaji,b'area: message view bug good first issue help wanted',2016-05-02T00:35:20Z,2018-03-04T22:09:19Z
718,Error installing vagrant 1.8.1 container,"With the latest stable vagrant (1.8.1) on Ubuntu 16.04 64-bit, zulip fails to build container with the following error:

```
ERROR vagrant: /home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/sudo_wrapper.rb:51:in `block in execute'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/util/retryable.rb:17:in `retryable'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/sudo_wrapper.rb:41:in `execute'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/sudo_wrapper.rb:20:in `run'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/driver/cli.rb:160:in `run'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/driver/cli.rb:65:in `create'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/driver.rb:83:in `create'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/action/create.rb:22:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/lib/vagrant-lxc/action/handle_box_metadata.rb:41:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/builtin/handle_box.rb:56:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:95:in `block in finalize_action'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/builder.rb:116:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/runner.rb:66:in `block in run'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/util/busy.rb:19:in `busy'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/runner.rb:66:in `run'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/builtin/call.rb:53:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/builtin/config_validate.rb:25:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/warden.rb:34:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/builder.rb:116:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/runner.rb:66:in `block in run'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/util/busy.rb:19:in `busy'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/action/runner.rb:66:in `run'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/machine.rb:224:in `action_raw'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/machine.rb:199:in `block in action'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/environment.rb:561:in `lock'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/machine.rb:185:in `call'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/machine.rb:185:in `action'
/opt/vagrant/embedded/gems/gems/vagrant-1.8.1/lib/vagrant/batch_action.rb:82:in `block (2 levels) in run'
 INFO interface: error: There was an error executing [""sudo"", ""/usr/bin/env"", ""lxc-create"", ""-B"", ""best"", ""--template"", ""/home/goelakash/.vagrant.d/gems/gems/vagrant-lxc-1.2.1/scripts/lxc-template"", ""--name"", ""zulip_default_1461741288131_61982"", ""--"", ""--tarball"", ""/home/goelakash/.vagrant.d/boxes/fgrehm-VAGRANTSLASH-trusty64-lxc/1.2.0/lxc/rootfs.tar.gz"", ""--config"", ""/home/goelakash/.vagrant.d/boxes/fgrehm-VAGRANTSLASH-trusty64-lxc/1.2.0/lxc/lxc-config""]
```
",goelakash,b'bug',2016-04-27T07:20:37Z,2016-04-28T00:28:32Z
687,"Bad presenting empty blockquote ("">"")","If I type "">"" into textbox and send to the zulip, zulip has problems with present this properly.

It could be solved by add:
`display: inline-block;`

to css class:
`message_content`

Before change:

![snapshot58](https://cloud.githubusercontent.com/assets/6997361/14718056/b28de244-07f4-11e6-8bb6-a0e934a24aba.png)

![snapshot55](https://cloud.githubusercontent.com/assets/6997361/14718060/bdae44ca-07f4-11e6-9d5c-1f9046ee03ad.png)

![snapshot56](https://cloud.githubusercontent.com/assets/6997361/14718063/c56d701e-07f4-11e6-823b-8c86b5dd17b9.png)

![snapshot60](https://cloud.githubusercontent.com/assets/6997361/14718220/ae0af3fa-07f5-11e6-9720-cbbcda7ddd71.png)

![snapshot57](https://cloud.githubusercontent.com/assets/6997361/14718071/cabee066-07f4-11e6-93ad-0c7c6d004ba0.png)

After change:

![snapshot59](https://cloud.githubusercontent.com/assets/6997361/14718194/7bf6ac2e-07f5-11e6-9e0b-075cc7575098.png)
",Wolodija,b'area: markdown bug help wanted',2016-04-21T17:18:33Z,2018-02-04T20:08:52Z
587,Sign in with Google dead link,"Web page screws up if you press the ""Sign up with Google"" button on the front page whilst being online on a regular Gmail account. Subsequent entries into the form end up with a blank page.

What it is:

```
<form class=""form-inline"" id=""send_confirm"" name=""email_form"" action="""" method=""post"" novalidate=""novalidate"">
```

If you were to press the register button on the top right corner the action tag wouldn't be empty and I'm guessing it should be like this:

```
<form class=""form-inline"" id=""send_confirm"" name=""email_form"" action=""/register/"" method=""post"" novalidate=""novalidate"">
```

Code in question:               

```
           <form class=""form-inline"" id=""send_confirm"" name=""email_form""
                  action=""{{ current_url }}"" method=""post"">
```

[Link to HTML](https://github.com/zulip/zulip/blob/15dae103832f5fcefdde52d3db50e56b7a4f5056/templates/zerver/accounts_home.html)[](zulip/templates/zerver/accounts_home.html)
",Plonski,b'area: authentication bug good first issue help wanted',2016-03-25T13:32:54Z,2017-02-23T08:01:05Z
586,Potential bug with Supervisor zulip.conf,"I just merged commits made within the past few days.  On my live server, I'm now seeing repeated errors like this:

```
manage.py process_queue: error: unrecognized arguments: missedmessage_mobile_notifications
usage: manage.py process_queue [-h] [--version] [-v {0,1,2,3}]
                               [--settings SETTINGS] [--pythonpath PYTHONPATH]
                               [--traceback] [--no-color]
                               [--queue_name <queue name>]
                               [--worker_num [<worker number>]] [--all]
```

I'm light as far as configuration / DevOps, but I believe this is because `process_queue` is being executed by:  `/puppet/zulip/files/supervisor/conf.d/zulip.conf` and the contained commands not using the  `--` characters before the arguments?

[Example here](https://github.com/zulip/zulip/blob/master/puppet/zulip/files/supervisor/conf.d/zulip.conf#L102)
",danshev,b'bug good first issue priority: blocker',2016-03-25T08:05:14Z,2016-03-28T06:30:57Z
583,500 error on uploading jpg image as avatar,"I created a new user and tried changing my avatar. I got a 500 error and the web page hanged.

There should be a more graceful way to handle this.

I then tried uploading a png image. That worked.

`POST /json/set_avatar HTTP/1.0"" 500 49`

```
Traceback (most recent call last):
  File ""/mnt/Code/git_repos/forked/zvenv2/local/lib/python2.7/site-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/decorator.py"", line 86, in wrapper
    return func(request, *args, **kwargs)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/decorator.py"", line 475, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/decorator.py"", line 302, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/decorator.py"", line 291, in authenticate_log_and_execute_json
    return view_func(request, user_profile, *args, **kwargs)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/views/user_settings.py"", line 171, in json_set_avatar
    upload_avatar_image(user_file, user_profile, user_profile.email)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/lib/upload.py"", line 185, in upload_avatar_image_local
    resized_data = resize_avatar(image_data)
  File ""/mnt/Code/git_repos/forked/zulip/zerver/lib/upload.py"", line 47, in resize_avatar
    im = ImageOps.fit(im, (AVATAR_SIZE, AVATAR_SIZE), Image.ANTIALIAS)
  File ""/mnt/Code/git_repos/forked/zvenv2/local/lib/python2.7/site-packages/PIL/ImageOps.py"", line 331, in fit
    (leftSide, topSide, leftSide + cropWidth, topSide + cropHeight)
  File ""/mnt/Code/git_repos/forked/zvenv2/local/lib/python2.7/site-packages/PIL/Image.py"", line 1023, in crop
    self.load()
  File ""/mnt/Code/git_repos/forked/zvenv2/local/lib/python2.7/site-packages/PIL/ImageFile.py"", line 203, in load
    d = Image._getdecoder(self.mode, d, a, self.decoderconfig)
  File ""/mnt/Code/git_repos/forked/zvenv2/local/lib/python2.7/site-packages/PIL/Image.py"", line 419, in _getdecoder
    raise IOError(""decoder %s not available"" % decoder_name)
IOError: decoder jpeg not available
```
",sharmaeklavya2,b'bug good first issue help wanted',2016-03-24T19:50:31Z,2016-04-20T17:47:10Z
538,"APNS package is out of date, causes authentication error","Zulip currently relies on the [**apnsclient** package](https://pypi.python.org/pypi/apns-client/0.2.1) for sending Apple push notifications.  Unfortunately, that package hasn't been actively maintained since 2014.

This has become a problem as **apnsclient** still uses `OpenSSL.SSL.SSLv3_METHOD`, which Apple stopped supporting in October of 2014.  As such, if you build the current Zulip as-is, Apple will reject your attempts to send push notifications.

The simple solution (aka no changes to the Zulip code base) is to edit the apns.py file within the **apnsclient** directory directly, changing:

`self._context = OpenSSL.SSL.Context(OpenSSL.SSL.SSLv3_METHOD)`

to 

`self._context = OpenSSL.SSL.Context(OpenSSL.SSL.TLSv1_METHOD)`

**_Longer term_**, we should consider replacing the apnsclient package with a more supported version and updating the methods in `/zerver/lib/push_notifications.py`
",danshev,b'bug good first issue help wanted priority: blocker',2016-03-16T04:56:58Z,2016-07-13T17:56:33Z
519,Username change not visible in old chats.,"If a user changes their _full name_ in settings, the effect is apparent in new messages, but not in old ones.

![screen shot 2016-03-13 at 2 13 13 pm](https://cloud.githubusercontent.com/assets/7699509/13727783/84e2016e-e926-11e5-913b-7af3864f7c8b.jpg)

![screen shot 2016-03-13 at 2 13 32 pm](https://cloud.githubusercontent.com/assets/7699509/13727785/8af1672a-e926-11e5-8795-872433102e6e.jpg)
![screen shot 2016-03-13 at 2 13 26 pm](https://cloud.githubusercontent.com/assets/7699509/13727786/8afc7962-e926-11e5-8b2f-dd70a0703596.jpg)

Could this be fixed by requesting the new _full name_ while getting old messages?

![screen shot 2016-03-13 at 2 13 44 pm](https://cloud.githubusercontent.com/assets/7699509/13727784/8a4d2fc0-e926-11e5-86f7-2ca0f9659b0c.jpg)
",avikantz,b'area: real-time sync bug help wanted',2016-03-13T09:17:07Z,2017-02-17T21:26:44Z
516,Collapsing message,"In `Private messages`, whenever a user collapses any message, Following events takes place:
1. Clicking back on `[More..]` doesn't uncollapses the message(unless reloaded).
2. In Message controls, collapse button doesn't get updated to Un-collapse(unless reloaded).  ![screenshot from 2016-03-12 10 09 19](https://cloud.githubusercontent.com/assets/6594924/13720872/bbace6ba-e83a-11e5-92ef-5dab353dbd1f.png)
3. A user have to click the floor of `[More..]` to get message uncollapsed.

These problems are specific to `Starred messages`, `@-mentions` and `private messages`(works fine in `Home`)
",kartikmaji,b'bug good first issue help wanted',2016-03-12T04:59:18Z,2016-03-20T23:59:06Z
515,Alert not visible when scrolled down,"If a user scrolls down more than the screen height, alert becomes invisible as it is positioned static.
![screenshot from 2016-03-12 03 55 50](https://cloud.githubusercontent.com/assets/6582951/13717343/e09ff59a-e806-11e5-8ea6-82be1b2b2a42.png)

This could be solved by making it fixed and also there is no way to hide the alert it remains there until the next action is taken.
![screenshot from 2016-03-12 03 55 57](https://cloud.githubusercontent.com/assets/6582951/13717355/f08ca67e-e806-11e5-8941-c53689152db4.png)

Not much of a big issue but fixing it would be great for UX. 
",KrSiddharth,b'bug good first issue help wanted',2016-03-11T22:32:45Z,2016-04-09T04:06:04Z
507,Fix confusion around navigating to localhost:9992 in development environment,"I'm running in dev mode, and getting the following errors below.

Also, I am unable to receive events/message with my bot which worked just fine not long ago.

```
2016-03-10 10:23:45,791 ERROR    Traceback (most recent call last):
  File ""/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File ""zerver/decorator.py"", line 86, in wrapper
    return func(request, *args, **kwargs)
  File ""zerver/decorator.py"", line 475, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File ""zerver/decorator.py"", line 302, in _wrapped_view_func
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)
  File ""zerver/decorator.py"", line 291, in authenticate_log_and_execute_json
    return view_func(request, user_profile, *args, **kwargs)
  File ""zerver/tornadoviews.py"", line 41, in json_get_events
    return get_events_backend(request, user_profile, apply_markdown=True)
  File ""zerver/decorator.py"", line 50, in wrapper
    return method(request, handler=request._tornado_handler, *args, **kwargs)
AttributeError: 'WSGIRequest' object has no attribute '_tornado_handler'

2016-03-10 10:23:45,793 INFO     127.0.0.1       POST    500  17ms (+start: 36ms) /json/get_events (iago@zulip.com via website)
[10/Mar/2016 10:23:45]""POST /json/get_events HTTP/1.1"" 500 49
2016-03-10 10:23:51,757 WARNING  Not Found: /sockjs/info
2016-03-10 10:23:51,803 INFO     127.0.0.1       GET     404  57ms /sockjs/info (unauth via ?)
[10/Mar/2016 10:23:51]""GET /sockjs/info?cb=qk6hx5oz30 HTTP/1.1"" 404 15254
```
",SummerBulb,b'bug good first issue help wanted',2016-03-10T15:27:03Z,2016-10-10T18:34:42Z
505,UnboundLocalError: local variable 'arch' referenced before assignment,"Hi, 
I was trying to setup zulip in my machine (32-bit Ubuntu 14.04) but It is giving unbound local error in provision.py 
Command : 

```
 python /srv/zulip/provision.py
```

Traceback:

```
Traceback (most recent call last):
  File ""/srv/zulip/provision.py"", line 184, in <module>
    sys.exit(main())
  File ""/srv/zulip/provision.py"", line 105, in main
    arch,
UnboundLocalError: local variable 'arch' referenced before assignment
```
",ashishk1994,b'bug',2016-03-10T10:56:26Z,2016-03-13T19:55:52Z
502,Invited users have case-sensitive e-mail addresses?,"I invited a user to `chat.fhir.org` using a mixed-case e-mail address. It appears the resulting account only works if the user signs in with the same (case-sensitive string match) address. Is this a known issue?
",jmandel,b'bug good first issue help wanted',2016-03-09T16:29:24Z,2016-07-07T23:30:59Z
499,By-hand setup instructions do not mention installing phantomjs,"PhantomJS is needed to run Casper tests. The [Ubuntu and Debian By hand setup instructions in README.dev.md](https://github.com/zulip/zulip/blob/master/README.dev.md#on-debian-or-ubuntu-systems) does not mention installing phantomjs.

Simply installing phantomjs using apt-get is not guaranteed to work, since Zulip depends on a specific version ([1.9.8](https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-1.9.8-linux-x86_64.tar.bz2)) of phantomjs. The version in Ubuntu 15.10's repositories is currently 1.9.0.

According to @timabbott, probably the right solution is to factor out the code in provision.py that installs phantomjs into a script, and then call that script in provision.py as well as in the list of by-hand commands.
",sharmaeklavya2,b'bug good first issue help wanted',2016-03-08T19:34:04Z,2016-03-30T04:25:58Z
498,vagrant up error on windows with cygwin,"Following the [instructions](https://github.com/zulip/zulip/blob/master/README.dev.md) for a dev environment setup with Vagrant for windows with cygwin, I am getting the following errors:

[vagrant.log](https://github.com/zulip/zulip/files/163646/vagrant.txt)
[npm-debug.log](https://github.com/zulip/zulip/files/163649/npm-debug.txt)
",SummerBulb,b'area: provision bug help wanted',2016-03-08T17:36:16Z,2017-03-23T01:23:56Z
488,File uploading error in the zulip development version,"File starts uploading and then an error pops out saying ""Unknown error occurred"". 
How do I fix this?
![error](https://cloud.githubusercontent.com/assets/14835842/13539444/856d65ee-e276-11e5-9fe0-9e517ed2fcce.png)
",varshit97,b'bug good first issue help wanted',2016-03-04T20:34:22Z,2016-03-29T18:15:26Z
486,Bug457,"Hello,

I want to contribute to Zulip as a part of GSoC 2016. Kindly consider this bug fix and let me know of any improvements.

For Issue #457.

Regards,
Namit
",namit9,None,2016-03-03T03:20:56Z,2017-02-17T06:26:09Z
474,"""nc"" dependency missing","During installation it fails on ""nc"" not being found. (Assuming this is netcat6, the installation now stalls after ""OK"")
",VincentSC,b'bug good first issue help wanted',2016-02-21T07:25:18Z,2016-03-30T04:46:34Z
470,Dependency on `wget` not declared,"Attempting to provision in a minimal LXC container on Ubuntu 14.04:

```
Traceback (most recent call last):
  File ""/srv/zulip/provision.py"", line 182, in <module>
    sys.exit(main())
  File ""/srv/zulip/provision.py"", line 98, in main
    sh.wget(
  File ""/usr/lib/python2.7/dist-packages/pbs.py"", line 543, in __getattr__
    return self.env[name]
  File ""/usr/lib/python2.7/dist-packages/pbs.py"", line 495, in __missing__
    return Command._create(k)
  File ""/usr/lib/python2.7/dist-packages/pbs.py"", line 239, in _create
    if not path: raise CommandNotFound(program)
pbs.CommandNotFound: wget
```
",lfaraone,b'bug',2016-02-18T02:46:22Z,2016-02-18T04:16:45Z
463,Question about memory usage,"VM that run ~200 user realm use during working hours about ~4.5gb of RAM. 60% of that is tornado started by `python2.7 /home/zulip/deployments/current/manage.py runtornado localhost:9993`.

This is expected usage or something is leaking?
",AcidWeb,b'bug priority: blocker',2016-02-08T09:32:51Z,2016-03-20T23:54:47Z
461,Issue with Vagrant when setting up dev env on OSX,"Apologies if this is restricted to me / my system, but I followed the README instructions for setting up the environment w/OSX, specifically:
1.  Cloned the repo
2.  Installed VirtualBox and Vagrant
3.  From the cloned directory, ran `vagrant up` and only get this:

```
There was an error loading a Vagrantfile. The file being loaded
and the error message are shown below. This is usually caused by
a syntax error.

Path: <provider config: lxc>
Line number: 18
Message: Errno::ENOENT: No such file or directory - lxc-ls
```

Any suggestions?
",danshev,b'bug',2016-02-03T22:29:06Z,2016-02-09T16:26:10Z
457,Private stream cannot be deleted after no one remains,"I created a private stream. But before I could add anyone, I accidentally unsubscribed myself. Now I can't add myself back, or anyone else. And I can't delete the stream either as myself or as admin.
",tkwon,b'area: settings (admin/org) area: stream settings bug good first issue help wanted priority: high',2016-02-02T17:43:21Z,2018-04-23T04:33:24Z
456,Notification bot 'Subscribe' button does not work for streams punctuation in the name,"The subscribe button helpfully posted by the notification bot will not allow subscription in these cases. You can subscribe the to streams in the stream management interface.

Strangely, you can _unsubscribe_ from a stream using the notification bot's button, but still not resubscribe.

Observed for the stream names `where@` and `100:10:1`.
",kamalmarhubi,b'bug good first issue help wanted',2016-02-02T03:46:30Z,2016-03-10T04:38:00Z
428,Titles of muted topics in muted streams are unreadable in left sidebar,"In the left sidebar, muted topics within muted streams are shown double-dimmed.  The resulting text is so faint that it's almost unreadable.
",bgilbert,b'bug good first issue help wanted',2016-01-15T21:44:36Z,2016-03-09T18:28:36Z
427,Muting a topic with unread messages doesn't update the unread count,"Sometimes, if the user mutes a topic with unread messages, the global unread count (next to Home, in the title bar, in the favicon, etc.) is not updated to deduct the muted messages.
",bgilbert,b'bug good first issue help wanted',2016-01-15T21:42:09Z,2016-03-27T20:52:05Z
426,Notification Bot message breaks renamed or removed streams,"When someone creates a new stream, Notification Bot writes a message to the Stream _Zulip_ with the content

**Streams**
_<user>_ just created a new stream _<stream>_. `Subscribe to <stream>`

with the Subscribe being a button and changing to Unsubscribe afterwards if one is subscribed.

Now if that stream gets renamed or deleted later, the button still exists, and a click will actually create a new stream of the original name. IMO this is highly undesirable since it leads to loads of confusions like we had yesterday when someone created a stream with a typo, immediately asked an admin to rename it and all the sudden we had two streams when people kept klicking on the button in the original announce message.

I have not had the time to go and try understand exactly where this ends up in the backend but maybe it is possible to simply turn off auto creation of streams upon subscribe.
",melbel,b'area: markdown bug good first issue help wanted',2016-01-15T10:27:15Z,2016-12-16T06:49:32Z
404,Provide clearer error message for missing node dependencies when running ./tools/run-dev.py,"2016-01-04 09:38:23,340 INFO: process_fts_updates starting
2016-01-04 09:38:23,371 INFO: Not in recovery; listening for FTS updates
Recompiling templates

module.js:340
    throw err;
          ^
Error: Cannot find module '/srv/zulip/node_modules/.bin/webpack-dev-server'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3

module.js:340
    throw err;
          ^
Error: Cannot find module 'source-map'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:364:17)
    at require (module.js:380:17)
    at Object.<anonymous> (/srv/zulip/node_modules/handlebars/node_modules/uglify-js/tools/node.js:9:21)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:364:17)

PLEASE FIX!!
",ghost,b'bug good first issue help wanted',2016-01-04T09:39:38Z,2016-04-29T04:05:38Z
401,Verify new enough version of node.js in installation process,"gyp: Call to 'node -e ""require('nan')""' returned exit status 1. while trying to load binding.gyp
gyp ERR! configure error
npm http 200 https://registry.npmjs.org/cryptiles/-/cryptiles-2.0.5.tgz
gyp ERR! stack Error: `gyp` failed with exit code: 1
gyp ERR! stack     at ChildProcess.onCpExit (/usr/share/node-gyp/lib/configure.js:431:16)
gyp ERR! stack     at ChildProcess.EventEmitter.emit (events.js:98:17)
npmgyp  ERR!http 200 https://registry.npmjs.org/is-my-json-valid/-/is-my-json-valid-2.12.3.tgz
 stack     at Process.ChildProcess._handle.onexit (child_process.js:797:12)
gyp ERR! System Linux 3.13.0-74-generic
npmgyp ERR!  command ""nodejs"" ""/usr/bin/node-gyp"" ""rebuild""
http 200gyp  https://registry.npmjs.org/readable-stream/-/readable-stream-2.0.5.tgz
ERR! cwd /srv/zulip/node_modules/jsdom/node_modules/contextify
gyp ERR! node -v v0.10.25
gyp ERR! node-gyp -v v0.10.10
gyp ERR! not ok
npm WARN This failure might be due to the use of legacy binary ""node""
npm WARN For further explanations, please read
/usr/share/doc/nodejs/README.Debian

npm http 200 https://registry.npmjs.org/commander/-/commander-2.9.0.tgz
npm http GET https://registry.npmjs.org/verror/1.3.6
npm http GET https://registry.npmjs.org/extsprintf/1.0.2
npm http GET https://registry.npmjs.org/json-schema/0.2.2
npm ERR! Error: ENOENT, utime '/srv/zulip/node_modules/jsdom/node_modules/request/node_modules/http-signature/node_modules/sshpk/lib/algs.js'
npm ERR! If you need help, you may report this log at:
npm ERR!     http://github.com/isaacs/npm/issues
npm ERR! or email it to:
npm ERR!     npm-@googlegroups.com

npm ERR! System Linux 3.13.0-74-generic
npm ERR! command ""/usr/bin/nodejs"" ""/usr/bin/npm"" ""install""
npm ERR! cwd /srv/zulip
npm ERR! node -v v0.10.25
npm ERR! npm -v 1.3.10
npm ERR! path /srv/zulip/node_modules/jsdom/node_modules/request/node_modules/http-signature/node_modules/sshpk/lib/algs.js
npm ERR! fstream_path /srv/zulip/node_modules/jsdom/node_modules/request/node_modules/http-signature/node_modules/sshpk/lib/algs.js
npm ERR! fstream_type File
npm ERR! fstream_class FileWriter
npm ERR! fstream_finish_call utimes
npm ERR! code ENOENT
npm ERR! errno 34
npm ERR! fstream_stack /usr/lib/nodejs/fstream/lib/writer.js:305:19
npm ERR! fstream_stack Object.oncomplete (fs.js:107:15)
npm http 200 https://registry.npmjs.org/hoek/-/hoek-2.16.3.tgz
npm ERR! weird error 1
npm ERR! Error: ENOENT, open '/home/vagrant/tmp/npm-25719-cc9DVhs2/1451715779654-0.6371675294358283/package/.travis.yml'
npm ERR! If you need help, you may report this log at:
npm ERR!     http://github.com/isaacs/npm/issues
npm ERR! or email it to:
npm ERR!     npm-@googlegroups.com

npm ERR! System Linux 3.13.0-74-generic
npm ERR! command ""/usr/bin/nodejs"" ""/usr/bin/npm"" ""install""
npm ERR! cwd /srv/zulip
npm ERR! node -v v0.10.25
npm ERR! npm -v 1.3.10
npm ERR! path /home/vagrant/tmp/npm-25719-cc9DVhs2/1451715779654-0.6371675294358283/package/.travis.yml
npm ERR! code ENOENT
npm ERR! errno 34
npm ERR! EEXIST, mkdir '/home/vagrant/tmp/npm-25719-cc9DVhs2/1451715779515-0.691365834325552/package/lib'
File exists: /home/vagrant/tmp/npm-25719-cc9DVhs2/1451715779515-0.691365834325552/package/lib
Move it away, and try again.

npm ERR! System Linux 3.13.0-74-generic
npm ERR! command ""/usr/bin/nodejs"" ""/usr/bin/npm"" ""install""
npm ERR! cwd /srv/zulip
npm ERR! node -v v0.10.25
npm ERR! npm -v 1.3.10
npm ERR! path /home/vagrant/tmp/npm-25719-cc9DVhs2/1451715779515-0.691365834325552/package/lib
npm ERR! fstream_path /home/vagrant/tmp/npm-25719-cc9DVhs2/1451715779515-0.691365834325552/package/lib/_stream_readable.js
npm ERR! fstream_type File
npm ERR! fstream_class FileWriter
npm ERR! code EEXIST
npm ERR! errno 47
npm ERR! fstream_stack /usr/lib/nodejs/fstream/lib/writer.js:171:23
npm ERR! fstream_stack /usr/lib/nodejs/mkdirp/index.js:37:53
npm ERR! fstream_stack Object.oncomplete (fs.js:107:15)
",ghost,b'bug good first issue',2016-01-02T06:28:08Z,2016-07-07T23:49:11Z
390,bugdown: Fix links immediately preceeded by an ! character.,"Fixes #387.
",timabbott,None,2015-12-25T17:59:13Z,2017-01-17T19:14:15Z
381,Bug in Zulip Client - Right Click in Text Field,"Hello,

if you open the context menu (in the textbox where you can send new messages)

There are two entries with ""Direction"".

See Screenshot for more details:
![bug_zulipclient](https://cloud.githubusercontent.com/assets/16019165/11892367/cec40a0a-a567-11e5-817f-0e3e36ce06a0.PNG)

To Reproduce:
Install the latest Windows Client (0.5.1)... I've test it on Windows 7 x64 Pro

Greetings
",BornToBeRoot,None,2015-12-18T08:17:06Z,2015-12-18T19:03:41Z
360,Clear user filter after pressing enter,"Hi,
Thanks for the great product.  I have a workflow suggestion, which I'm hoping will be a quick no-brainer.

A common workflow for sending a private message is the following:
1. press `esc` to clear the compose box
2. press `q` to go to the USERS filter
3. type the first letters of a user's name
4. press enter to open the compose box
5. type and send a message to the user

The end result of this is that the partial user name from step 3 is still in the USERS filter.  That's bad for two reasons: 1) I can't see who's online because it only shows that one user, and 2) the next time that I try to send a private message I have to delete the previous filter, which slows me down.  It would be better to clear the filter after pressing enter.  For example, this is how Pidgin works.  I can't think of a very good reason to leave it there.
",chadrik,b'bug good first issue help wanted',2015-12-09T18:13:35Z,2016-04-29T22:06:41Z
353,Font rendering on Windows distorts numbers,"When testing Zulip 1.3.9, I've noticed that font rendering of numbers is hard to read on Windows (in both Firefox and Chrome):
![zulip_windows](https://cloud.githubusercontent.com/assets/3905723/11571892/33e707ca-99c4-11e5-8622-3a4967f58f85.png)

Note that viewing this same message on Linux does not have this problem - all of the numbers are the same height. Is it possible to correct the problem with the default font as it renders on Windows, or switch to a different font?
",asmartin,b'area: browser-support bug good first issue help wanted',2015-12-03T19:50:24Z,2017-10-12T15:39:30Z
321,Filename is changed after uploading,"For example:
- ""README"" is changed to "".readme""
- ""apache-maven-3.3.3-bin.tar.gz"" is changed to  ""apache-maven-333-bintar.gz"".
- ""테스트.txt"" is changed to ""l.txt""

It would be better that they keep their original name.
",eungjun-yi,b'bug good first issue help wanted',2015-11-20T02:00:52Z,2016-04-03T23:32:23Z
311,repeatedly install requirement.txt,"At each time I run python provision.py ,it repeatedly install deps in requirement.txt . such as Django ..and so on , in spite of it already installed previously .
",ghost,b'bug help wanted',2015-11-17T07:00:39Z,2016-06-13T16:19:56Z
302,error with running tools/run-dev.py,"/srv/zulip/node_modules/webpack-dev-server/node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling.js:23
  var xhr = new XMLHttpRequest({ xdomain: false });
            ^
TypeError: object is not a function
    at /srv/zulip/node_modules/webpack-dev-server/node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling.js:23:13
    at Object.<anonymous> (/srv/zulip/node_modules/webpack-dev-server/node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling.js:25:3)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:364:17)
    at require (module.js:380:17)
    at Object.<anonymous> (/srv/zulip/node_modules/webpack-dev-server/node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling-xhr.js:6:15)
    at Module._compile (module.js:456:26)
Validating Django models.py...
System check identified no issues (0 silenced).

How to fix this ?

Thanks!
",ghost,b'bug good first issue help wanted',2015-11-14T01:35:27Z,2016-04-22T17:51:12Z
299,@-mention suggestions stop working,"Testing in Chrome 46, I've noticed that after having the Zulip window open for a period of time, the suggestion dialog that you get when you type the `@` character followed by the start of a person's name stops appearing. Looking at the javascript console, I see `Uncaught TypeError: undefined is not a function` is thrown when trying to call `.toLowerCase` on a variable.full_name. If I refresh the browser window, this functionality works again. Also, manually inputting the entire @-mention with @**John Smith** works.

Similarly, the suggestions also stop working when trying to add someone to a stream. Again, manually typing the email address allows you to add them, but it is nicer to use the suggestion dialog.
",asmartin,b'bug duplicate',2015-11-12T16:26:15Z,2015-11-16T17:04:50Z
291,Fix nginx configuration around storing file uploads in Amazon S3 ,"When switch from saving user uploads in /home/zulip/uploads to S3, I can successfully save uploads to S3, but the links generated are broken from inside zulip interface.
",bmjjr,b'area: production area: uploads bug help wanted priority: high',2015-11-10T08:40:57Z,2018-02-16T01:50:56Z
287,Context menu in topic cannot be dismissed if new message comes in,"I have tested Zulip 1.3.7 with both Chrome 46 and Firefox, and it works great! However, I've noticed a bug - when in a topic, if I click on the little down arrow next to the timestamp from a message, it brings up a context menu with several options - Reply, Collapse, etc. If i leave this menu open while a new message comes in, I am them unable to close this context menu. It stays open without any way to close it or click on any of the items in it unless I refresh the browser window.
",asmartin,b'area: message view bug good first issue help wanted',2015-11-09T21:48:32Z,2017-01-12T23:09:56Z
281,"When starting dev through vagrant-lxc for the first time, provision.py fails due to missing bc","When following the suggested defaults for setting up the development environment, the provision.py script fails around the point where it is setting up the database due to bc not being installed by default.  This should be an easy fix if you just add the bc install to the sudo apt-get install -y python-pbs line in the Vagrantfile.
",robmccoll,b'bug',2015-11-07T22:12:39Z,2015-11-12T05:35:26Z
262,Right sidebar user list creates poor performance with large realms,"If you profile loading the Zulip homepage in a realm with 700 users, it's significantly slower than in a smaller realm, and if you use the Chrome timeline to profile the main reason is the right sidebar user list rendering.  This is probably a reasonable bug for someone new to the Zulip frontend to attack; the code is all in static/js/activity.js and the template involved is static/templates/user_presence_rows.handlebars.
",timabbott,b'bug good first issue help wanted',2015-11-04T07:19:44Z,2016-02-13T04:07:26Z
245,Fix file upload for IE 11,"When trying to upload a file in IE 11 i get:

""File upload is not yet available for your browser""

Most of my co-workers have to use Internet Explorer.
I think this comes up to many other organizations as well.
",sabotrax,b'area: browser-support bug priority: high',2015-10-28T11:01:13Z,2019-01-29T12:41:55Z
243,Username Still Exists When Removing A Bot,"Within the settings page, I created a bot with a name ""r2z2"". I removed r2z2 to try and recreate a new bot but with the same name and I am given the error: ""Username already in use"".

Is there a way to remove that user r2z2 so I can recreate the bot with the proper name?
",richardwlu,b'bug',2015-10-27T20:46:22Z,2015-11-06T04:47:22Z
230,Inviting with default subscriptions to private streams allows access to historical content,"There seems to be different behavior when I add users to a private stream in different ways.

When I add a completely new user and invite them to the private stream in that initial setup they can see all historical messages. 

However, if I invite an existing user to the stream they can only see messages after they were invited. 

Is this something I can tweak?
",ajparsons,b'bug',2015-10-26T15:37:53Z,2015-10-27T06:36:56Z
229,Avatars Should Automatically Populate After Saving,"After going to Settings, uploading an avatar, and saving, the avatars don't show up until I refresh the browser (Chrome 46.0.2490.71). My avatar showed up for other users after my save without a browser refresh. I just thought I'd mention this.
",richardwlu,b'bug help wanted',2015-10-26T15:34:15Z,2016-08-19T04:57:11Z
225,Vagrant in Ubuntu 14.04 is too old to use Zulip,"Working on Ubuntu 14.04 I had to install vagrant manually since the vagrant version in the Ubuntu repo is 1.4.3 which does not seem to work with a current `vagrant-lxc` plugin.

If I didn't do anything wrong then this should be updated.
",cpaulik,b'bug good first issue',2015-10-24T10:52:33Z,2016-03-06T04:32:06Z
224,Install Script Stalls with 'OK' and no progress for long time,"I am trying to install Zulip in [C1 instance of Scaleway.com](https://www.scaleway.com/faq/server/) ARM based servers. I followed the instructions from https://zulip.org/server.html

When I execute the

>    ./script/setup/install

the script installed the dependencies. I don't see any errors being thrown out anywhere, but one `warning` at one place nevertheless the script execution continues

>    Warning: Config file /etc/puppet/hiera.yaml not found, using Hiera defaults

Finally the script has stalled with 'OK' message after executing flush-memcached. I have stopped the script manually after waiting for more than an hour and executed the script again which brings me to the same situation again.

> sudo rabbitmqctl add_user zulip e3f1444da78409df413688c8c33bb62adbe128a37c2804a8a169e24958cda767
> Creating user ""zulip"" ...
> ...done.
> sudo rabbitmqctl set_user_tags zulip administrator
> Setting tags for user ""zulip"" to [administrator] ...
> ...done.
> sudo rabbitmqctl set_permissions -p / zulip .\* .\* .*
> Setting permissions for user ""zulip"" in vhost ""/"" ...
> ...done.
> /root/zulip/scripts/setup/postgres-init-db
> cd /
> su postgres -c psql
> ERROR:  role ""zulip"" already exists
> ALTER ROLE
> DROP DATABASE
> CREATE DATABASE
> su postgres -c psql zulip
> CREATE SCHEMA
> CREATE EXTENSION
> dirname /root/zulip/scripts/setup/postgres-init-db
> sh /root/zulip/scripts/setup/flush-memcached
> OK

No progress from here, the script never ends or doesn't throw any feedback.
",PrasannaVenkadesh,b'bug',2015-10-24T05:21:46Z,2016-07-07T23:53:11Z
208,Make Zulip server upgrade process less error-prone,"Hi there

This could just be my stupidity, or inablility to follow instructions properly.

I'm working on the instructions here: https://github.com/zulip/zulip/blob/master/README.prod.md under the section ""Maintaining Zulip in Production"".

I'm stuck on almost the first step. I have downloaded the new version:

```
root@lbox-ubuntu-zulip:~# wget https://www.zulip.com/dist/releases/zulip-server-1.3.7.tar.gz
--2015-10-20 09:55:11--  https://www.zulip.com/dist/releases/zulip-server-1.3.7.tar.gz
Resolving www.zulip.com (www.zulip.com)... 54.244.50.66
Connecting to www.zulip.com (www.zulip.com)|54.244.50.66|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 28713259 (27M) [application/octet-stream]
Saving to: ‘zulip-server-1.3.7.tar.gz’

100%[===============================================================================================================================================================================================>] 28,713,259   848KB/s   in 36s    

2015-10-20 09:55:49 (769 KB/s) - ‘zulip-server-1.3.7.tar.gz’ saved [28713259/28713259]
```

No problem there. Then changed the owner to zulip, and the permissions to 777. (just in case - because literally following the instructions failed with the same error first time around)

```
-rwxrwxrwx  1 zulip root 28713259 Oct 20 07:28 zulip-server-1.3.7.tar.gz*
```

Then I started the upgrade and it fell over instantly:

```
root@lbox-ubuntu-zulip:~# /home/zulip/deployments/current/scripts/upgrade-zulip zulip-server-1.3.7.tar.gz
2015-10-20 09:57:47,304 upgrade-zulip: Unpacking the tarball
tar: zulip-server-1.3.7.tar.gz: Cannot open: Permission denied
tar: Error is not recoverable: exiting now
Traceback (most recent call last):
  File ""/home/zulip/deployments/2015-10-04-14-32-01/scripts/lib/unpack-zulip"", line 21, in     <module>
    subprocess.check_call([""tar"", ""-xf"", tarball_path, ""-C"", extract_path])
  File ""/usr/lib/python2.7/subprocess.py"", line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['tar', '-xf', 'zulip-server-1.3.7.tar.gz', '-C',      '/tmp/tmpuWYcLa']' returned non-zero exit status 2
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/scripts/lib/upgrade-zulip"", line 49, in <module>
    tarball_path], preexec_fn=su_to_zulip)
  File ""/usr/lib/python2.7/subprocess.py"", line 573, in check_output
    raise CalledProcessError(retcode, cmd, output=output)
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2015-10-04-14-32-01    /scripts/lib/unpack-zulip', 'zulip-server-1.3.7.tar.gz']' returned non-zero exit status 1
```

It pretends to be a permissions issue, but.. I'm root?!
",wolfen351,b'bug good first issue',2015-10-20T06:09:49Z,2016-01-12T05:37:12Z
205,Images Are Broken From Zulip Emails and Zulip Messages,"Hi,

Images are showing up as broken from emails and chats. I am not sure if this is intended or if I am missing some configs?

<img width=""820"" alt=""screen shot 2015-10-19 at 11 01 42 am"" src=""https://cloud.githubusercontent.com/assets/8405384/10583141/fd8cfedc-7650-11e5-8d30-b4134c35e6a5.png"">

<img width=""900"" alt=""screen shot 2015-10-19 at 11 01 20 am"" src=""https://cloud.githubusercontent.com/assets/8405384/10583151/06bc6e34-7651-11e5-8a17-2dce6c9f2aa5.png"">

Looks like the guinea is pointing to `/user_uploads/unk/byqgM1qjol1mzje_KzeNRT5F/guinea.jpg`.
Issuing a  `root@zulip:~/zulip# find . -print | grep -i guinea` resulted nothing found.
",richardwlu,b'bug',2015-10-19T16:03:40Z,2016-01-10T06:53:11Z
194,RabbitMQ refuses to start on Ubuntu 14.04,"There's a bug in Erlang which prevents RabbitMQ from starting on Ubuntu 14.04.
Zulip actually worked from installation to first reboot.

""The bug is actually located in erlang itself. epmd fails to bind to any IPv4 address if instructed to do so""
See https://bugs.launchpad.net/ubuntu/+source/erlang/+bug/1374109

There's a workaround by commenting out 

export ERL_EPMD_ADDRESS=127.0.0.1

in /etc/default/rabbitmq-server
",sabotrax,b'area: production bug',2015-10-16T09:57:31Z,2016-11-27T02:58:26Z
163,"Editing sentences with ""/me"" doesn't re-render the result","I typed in:

> /me nosd

Edited that to

> /me nods

But it still rendered as original way, and the ""EDITED"" bit showed up funny.

Using Firefox.
",itamarst,b'bug good first issue help wanted',2015-10-08T14:48:15Z,2016-05-31T15:29:16Z
162,"python-ujson missing on Trusty i386 (""No module named ujson"")","While installing Zulip on a Ubuntu 14.04 Server VM, `scripts/setup/install` gave the following error (buried in the middle of the output; it was willing to continue in spite of this): 

```
Error: Execution of '/usr/bin/apt-get -q -y -o DPkg::Options::=--force-confold install python-ujson' returned 100: Reading package lists...
Building dependency tree...
Reading state information...
E: Unable to locate package python-ujson

Error: /Stage[main]/Zulip::App_frontend/Zulip::App_frontend::Safepackage[python-ujson]/Package[python-ujson]/ensure: change from purged to present failed: Execution of '/usr/bin/apt-get -q -y -o DPkg::Options::=--force-confold install python-ujson' returned 100: Reading package lists...
Building dependency tree...
Reading state information...
E: Unable to locate package python-ujson
```

When I tried to run `initialize-database`, it gave the following output:

```
++ dirname /home/zulip/deployments/current/scripts/setup/initialize-database
+ cd /home/zulip/deployments/current/scripts/setup/../..
+ python manage.py checkconfig
Traceback (most recent call last):
  File ""manage.py"", line 21, in <module>
    execute_from_command_line(sys.argv)
  File ""/usr/lib/python2.7/dist-packages/django/core/management/__init__.py"", line 338, in execute_from_command_line
    utility.execute()
  File ""/usr/lib/python2.7/dist-packages/django/core/management/__init__.py"", line 312, in execute
    django.setup()
  File ""/usr/lib/python2.7/dist-packages/django/__init__.py"", line 17, in setup
    configure_logging(settings.LOGGING_CONFIG, settings.LOGGING)
  File ""/usr/lib/python2.7/dist-packages/django/utils/log.py"", line 86, in configure_logging
    logging_config_func(logging_settings)
  File ""/usr/lib/python2.7/logging/config.py"", line 794, in dictConfig
    dictConfigClass(config).configure()
  File ""/usr/lib/python2.7/logging/config.py"", line 576, in configure
    '%r: %s' % (name, e))
ValueError: Unable to configure handler 'zulip_admins': Cannot resolve 'zerver.handlers.AdminZulipHandler': No module named ujson
```

This was easily fixed by running `apt-get install python-pip libpython2.7-dev; pip install ujson`, but it would obviously be better if the `python-ujson` package were properly available. It might also be better if the setup script were more thorough about error checking (or if Zulip were a traditional .deb package that could declare its own dependencies - but that's a whole other can of worms).
",joshkel,b'bug',2015-10-08T13:43:45Z,2019-06-16T06:09:26Z
153,Changes to EXTERNAL_HOST not applied to password reset emails,"Reproduction steps:
1. Deploy zulip server on temp-hostname.example.com
2. Create some users
3. Change EXTERNAL_HOST to zulip.example.com in the /etc/zulip/settings.py & restart zulip server
4. Have a user use the ""forgot password"" link.

Expected:

The email contains a https://zulip.example.com link

Actual:

The email contains a https://temp-hostname.example.com link

Analysis:

When the zulip server is initially configured, initialise_voyager_db.py copies the EXTERNAL_HOST to site.domain (presumably stored in the database)
The email template for password resets contains:

```
It's all good. Follow the link below and we'll take care of the rest:
    <{{ protocol}}://{{ domain }}{% url 'django.contrib.auth.views.password_reset_confirm' uidb64=uid token=token %}>
```

Whereas the other email templates in templates/zerver/emails are using EXTERNAL_HOST, e.g.

```
Click here to log in to Zulip and catch up: https://{{ external_host }}.
```

I've not yet investigated what else uses site.domain, or if this difference is required for multi-realm (zulip.com) installations.
",shane-kearns,b'area: misc bug good first issue help wanted',2015-10-07T14:17:28Z,2016-11-26T20:35:08Z
129,"GitHub release tarballs don't include `static`, `tools`, &c","It looks like GitHub respects `export-ignore` directives set in our [`.gitattributes`](https://github.com/zulip/zulip/blob/master/.gitattributes) file.

While convenient for building voyager tarballs, for Debian packaging I need the unminified upstream source. It'd also be a lot nicer if `tools` was included in that source distribution, so I don't need to vendor the build scripts in `debian/`.

We could solve this by amending `.gitattributes` then specifying a different blacklist for our ""binary"" release tarballs.
",lfaraone,b'area: tooling bug priority: high',2015-10-04T18:40:41Z,2017-10-12T05:08:36Z
102,Unable to sign in with Google auth on iOS app,"The iOS app update which lets you specify the Zulip endpoint has been released, but I am unable to sign in using Google auth. The server logs show a generic authentication failure

```
==> /var/log/zulip/django.log <==
2015-10-01 03:21:14,895 INFO     0.0.0.0   POST    403   5ms /api/v1/fetch_api_key (unauth via ?)

==> /var/log/zulip/server.log <==
2015-10-01 03:21:14,895 INFO     0.0.0.0   POST    403   5ms /api/v1/fetch_api_key (unauth via ?)

==> /var/log/zulip/django.log <==
2015-10-01 03:21:14,896 INFO     status=403, data={""msg"":""Your username or password is incorrect."",""reason"":""incorrect_creds"",""result"":""error""}
, uid=unauth
```

I dont think I can point the iOS app at a development environment, so I'll try and add some extra logging to our production install to see whats going on.
",DazWorrall,b'bug',2015-10-01T07:58:06Z,2015-10-07T13:56:34Z
99,Zulip notifies once per message per browser tab,"If Zulip is open in multiple browser tabs (e.g., one tab on the home screen and one narrowed to a stream/topic), an incoming message produces one notification per tab.  This could perhaps be avoided by notifying from a shared web worker, at least on Firefox/Chrome/Opera.

cc: @alliejones
",bgilbert,b'area: notifications (other) bug help wanted',2015-10-01T03:25:56Z,2017-01-03T00:59:27Z
82,Install script returns exit code 0 even when it fails,"```
$ root@zulip:~/zulip# ./scripts/setup/install
...
...
++ /root/zulip/zulip_tools.py make_deploy_path
+ deploy_path=/home/zulip/deployments/2015-09-30-02-19-01
+ mv /root/zulip /home/zulip/deployments/2015-09-30-02-19-01
+ ln -nsf /home/zulip/deployments/next /root/zulip
+ ln -nsf /home/zulip/deployments/2015-09-30-02-19-01 /home/zulip/deployments/next
+ ln -nsf /home/zulip/deployments/2015-09-30-02-19-01 /home/zulip/deployments/current
+ ln -nsf /etc/zulip/settings.py /home/zulip/deployments/2015-09-30-02-19-01/zproject/local_settings.py
ln: failed to access ‘/home/zulip/deployments/2015-09-30-02-19-01/zproject/local_settings.py’: Too many levels of symbolic links
root@zulip:~/zulip# echo $?
0
```
",fletchowns,b'bug',2015-09-30T02:22:23Z,2016-03-31T21:40:44Z
76,zulip cannot start after restarting the server ,"after restarting the server, zulip won't does not start any more...

it seems there is no autostart... maby there shouldn't be one, in that case it would be fine.

if i try to restart the application via script:

```
su zulip -c /home/zulip/deployments/current/scripts/restart-server 
```

the restarting process just take seconds and does not work. The file unix:///var/run/supervisor.sock is not found and tornado seams to have problems. Here is the server output:

```
2015-09-29 13:08:57,996 restart-server: Filling memcached caches
2015-09-29 07:08:58,618 INFO     Succesfully populated session cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,677 INFO     Succesfully populated huddle cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,776 INFO     Succesfully populated stream cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,801 INFO     Succesfully populated client cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,833 INFO     Succesfully populated user cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,947 INFO     Succesfully populated message cache!  Consumed 1 memcached queries (0.01 time)
2015-09-29 07:08:58,949 INFO     Succesfully populated recipient cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 13:08:58,981 restart-server: Stopping workers
unix:///var/run/supervisor.sock no such file
2015-09-29 13:08:59,198 restart-server: Stopping server core
unix:///var/run/supervisor.sock no such file
2015-09-29 13:08:59,267 restart-server: Starting server core
unix:///var/run/supervisor.sock no such file
2015-09-29 13:08:59,335 restart-server: Starting workers
unix:///var/run/supervisor.sock no such file
2015-09-29 13:08:59,484 restart-server: Done!
Application restarted successfully!
```

server.log:

```
2015-09-29 07:08:58,618 INFO     Succesfully populated session cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,677 INFO     Succesfully populated huddle cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,776 INFO     Succesfully populated stream cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,801 INFO     Succesfully populated client cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,833 INFO     Succesfully populated user cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:08:58,947 INFO     Succesfully populated message cache!  Consumed 1 memcached queries (0.01 time)
2015-09-29 07:08:58,949 INFO     Succesfully populated recipient cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:11:53,751 INFO     Beginning TornadoQueueClient connection
2015-09-29 07:12:06,395 INFO     Beginning TornadoQueueClient connection
2015-09-29 07:12:19,138 INFO     Beginning TornadoQueueClient connection
```

tornado.log (multiple entries):

```
2015-09-29 07:11:53,751 INFO     Beginning TornadoQueueClient connection
System check identified no issues (0 silenced).
Traceback (most recent call last):
  File ""/home/zulip/deployments/current/manage.py"", line 21, in <module>
    execute_from_command_line(sys.argv)
  File ""/usr/lib/python2.7/dist-packages/django/core/management/__init__.py"", line 338, in execute_from_command_line
    utility.execute()
  File ""/usr/lib/python2.7/dist-packages/django/core/management/__init__.py"", line 330, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File ""/usr/lib/python2.7/dist-packages/django/core/management/base.py"", line 393, in run_from_argv
    self.execute(*args, **cmd_options)
  File ""/usr/lib/python2.7/dist-packages/django/core/management/base.py"", line 444, in execute
    output = self.handle(*args, **options)
  File ""/home/zulip/deployments/2015-09-28-16-19-20/zerver/management/commands/runtornado.py"", line 118, in handle
    inner_run()
  File ""/home/zulip/deployments/2015-09-28-16-19-20/zerver/management/commands/runtornado.py"", line 83, in inner_run
    queue_client = get_queue_client()
  File ""/home/zulip/deployments/2015-09-28-16-19-20/zerver/lib/queue.py"", line 238, in get_queue_client
    queue_client = TornadoQueueClient()
  File ""/home/zulip/deployments/2015-09-28-16-19-20/zerver/lib/queue.py"", line 158, in __init__
    super(TornadoQueueClient, self).__init__()
  File ""/home/zulip/deployments/2015-09-28-16-19-20/zerver/lib/queue.py"", line 25, in __init__
    self._connect()
  File ""/home/zulip/deployments/2015-09-28-16-19-20/zerver/lib/queue.py"", line 168, in _connect
    stop_ioloop_on_close = False)
  File ""/usr/lib/python2.7/dist-packages/pika/adapters/tornado_connection.py"", line 55, in __init__
    stop_ioloop_on_close)
  File ""/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py"", line 62, in __init__
    on_close_callback)
  File ""/usr/lib/python2.7/dist-packages/pika/connection.py"", line 590, in __init__
    self.connect()
  File ""/usr/lib/python2.7/dist-packages/pika/connection.py"", line 707, in connect
    self.callbacks.process(0, self.ON_CONNECTION_ERROR, self, self)
  File ""/usr/lib/python2.7/dist-packages/pika/callback.py"", line 61, in wrapper
    return function(*tuple(args), **kwargs)
  File ""/usr/lib/python2.7/dist-packages/pika/callback.py"", line 92, in wrapper
    return function(*args, **kwargs)
  File ""/usr/lib/python2.7/dist-packages/pika/callback.py"", line 232, in process
    callback(*args, **keywords)
  File ""/usr/lib/python2.7/dist-packages/pika/connection.py"", line 1192, in _on_connection_error
    raise exceptions.AMQPConnectionError(self.params.connection_attempts)
pika.exceptions.AMQPConnectionError: 1
```

after that i tried to restart supervisor, and restartet the service again:

```
service supervisor restart
Restarting supervisor: supervisord.
```

this time the server restart took much longer, unix:///var/run/supervisor.sock was found but there were some other problems:

```
su zulip -c /home/zulip/deployments/current/scripts/restart-server 
2015-09-29 13:17:23,730 restart-server: Filling memcached caches
2015-09-29 07:17:24,657 INFO     Succesfully populated session cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:17:24,658 INFO     Succesfully populated huddle cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:17:24,666 INFO     Succesfully populated stream cache!  Consumed 1 memcached queries (0.01 time)
2015-09-29 07:17:24,670 INFO     Succesfully populated client cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 07:17:24,682 INFO     Succesfully populated user cache!  Consumed 1 memcached queries (0.01 time)
2015-09-29 07:17:24,735 INFO     Succesfully populated message cache!  Consumed 1 memcached queries (0.03 time)
2015-09-29 07:17:24,738 INFO     Succesfully populated recipient cache!  Consumed 1 memcached queries (0.0 time)
2015-09-29 13:17:24,816 restart-server: Stopping workers
zulip-events-user-presence: stopped
zulip-events-user-activity-interval: stopped
zulip-events-user-activity: stopped
zulip-events-signups: stopped
zulip-events-error_reports: stopped
zulip-deliver-enqueued-emails: stopped
zulip-events-slowqueries: stopped
zulip-events-email_mirror: stopped
zulip-events-missedmessage_mobile_notifications: stopped
zulip-events-digest_emails: stopped
zulip-events-confirmation-emails: stopped
zulip-events-missedmessage_reminders: stopped
zulip-events-feedback_messages: stopped
2015-09-29 13:17:34,920 restart-server: Stopping server core
zulip-events-message_sender-4: stopped
zulip-events-message_sender-0: stopped
zulip-events-message_sender-1: stopped
zulip-events-message_sender-2: stopped
zulip-events-message_sender-3: stopped
zulip-django: stopped
zulip-tornado: stopped
2015-09-29 13:17:41,967 restart-server: Starting server core
zulip-tornado: ERROR (abnormal termination)
zulip-django: started
zulip-events-message_sender-4: ERROR (abnormal termination)
zulip-events-message_sender-0: ERROR (abnormal termination)
zulip-events-message_sender-1: ERROR (abnormal termination)
zulip-events-message_sender-2: started
zulip-events-message_sender-3: started
2015-09-29 13:17:50,048 restart-server: Starting workers
zulip-events-user-presence: started
zulip-events-user-activity-interval: started
zulip-events-user-activity: started
zulip-events-signups: started
zulip-events-confirmation-emails: started
zulip-events-error_reports: started
zulip-deliver-enqueued-emails: started
zulip-events-slowqueries: started
zulip-events-email_mirror: started
zulip-events-missedmessage_mobile_notifications: started
zulip-events-digest_emails: started
zulip-events-missedmessage_reminders: started
zulip-events-feedback_messages: started
2015-09-29 13:18:02,435 restart-server: Done!
Application restarted successfully!
```

the tornato exception is the same one.
there is a problem with tornado, what shall i do?
it worked after installation, after the 1st reboot, it was not starting any more...

thanks
",paundl,b'bug question',2015-09-29T11:23:57Z,2015-11-18T03:08:42Z
72,Can't login using LDAP,"I installed zulip server following the instructions in zulip.org; I edited the /etc/zulip/settings.py file but I cant login using LDAP.

In the commented examples for auth backends there's no example for using LDAP, I found in a reddit comment that the backend should be:
'zproject.backends.ZulipLDAPAuthBackend'

Adding that to the authentications backends, restartint the server (even running the puppet receipe) doesn't seems to help. Nothing happens when I click on ""Log In"", nor error in the logs neither.

What is the proper way to enable LDAP Authentication?
",ralgozino,b'bug',2015-09-28T20:05:17Z,2015-10-20T11:45:42Z
64,"Using [enter] to reply to a message doesn't work in ""Home"" on first page load (need to click somewhere first)","Using up/down works everywhere, and enter can be used to reply to a message when a stream is selected but not in ""Home"", while click does work.

After clicking once, enter works too.

(Chrome 45, windows)
",carlokok,b'bug',2015-09-28T09:59:46Z,2016-08-15T06:02:58Z
45,Fix occasional tracebacks in Google oauth ,"I'm seeing a lot of tracebacks like these on zulip.com:

Traceback (most recent call last):
  File ""/usr/lib/python2.7/dist-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, _callback_args, *_callback_kwargs)
  File ""/home/zulip/deployments/2015-09-25-22-35-44/zerver/views/**init**.py"", line 695, in finish_google_oauth2
    raise Exception('Could not convert google pauth2 code to access_token\r%r' % resp.text)
Exception: Could not convert google pauth2 code to access_token
u'{\n ""error"": ""invalid_grant"",\n ""error_description"": ""Code was already redeemed.""\n}\n'

Traceback (most recent call last):
  File ""/usr/lib/python2.7/dist-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, _callback_args, *_callback_kwargs)
  File ""/home/zulip/deployments/2015-09-25-22-35-44/zerver/views/**init**.py"", line 695, in finish_google_oauth2
    raise Exception('Could not convert google pauth2 code to access_token\r%r' % resp.text)
Exception: Could not convert google pauth2 code to access_token
u'{\n ""error"": ""invalid_grant"",\n ""error_description"": ""Bad Request""\n}\n'

Traceback (most recent call last):
  File ""/usr/lib/python2.7/dist-packages/django/core/handlers/base.py"", line 132, in get_response
    response = wrapped_callback(request, _callback_args, *_callback_kwargs)
  File ""/home/zulip/deployments/2015-09-25-22-35-44/zerver/views/**init**.py"", line 695, in finish_google_oauth2
    raise Exception('Could not convert google pauth2 code to access_token\r%r' % resp.text)
Exception: Could not convert google pauth2 code to access_token
u'{\n ""error"": ""invalid_grant"",\n ""error_description"": ""Invalid code.""\n}\n'

Even if these are user error, they shouldn't be throwing exceptions.  Any ideas what's going on?
",timabbott,b'bug',2015-09-27T04:49:16Z,2016-03-31T21:38:50Z
40,"On fresh trusty server, installation fails because there's no /usr/bin/python","```
+ /root/zulip/scripts/zulip-puppet-apply -f
./scripts/lib/install: /root/zulip/scripts/zulip-puppet-apply: /usr/bin/python: bad interpreter: No such file or directory
```

Here's a `Dockerfile` to reproduce:

``` dockerfile
FROM ubuntu:trusty

ENV DEBIAN_FRONTEND noninteractive
# Bump when you want to re-run apt-get upgrade
ENV LAST_UPDATE 2

RUN apt-get update
RUN apt-get -y upgrade
RUN apt-get -y install wget

ENV ZULIP_VERSION ""1.3.4""

RUN wget https://www.zulip.com/dist/releases/zulip-server-$ZULIP_VERSION.tar.gz
RUN tar -xvf zulip-server-$ZULIP_VERSION.tar.gz
RUN rm zulip-server-$ZULIP_VERSION.tar.gz
RUN mv zulip-server-$ZULIP_VERSION /root/zulip

WORKDIR /root/zulip
RUN ./scripts/setup/install
```
",alex,b'bug',2015-09-27T02:21:44Z,2015-09-27T04:55:19Z
28,The messaging between several users don't work,"When I try to send a message to other user he don't recieve it. In the error-log I've got:

```
2015-09-26 10:33:29,381 ERROR    WebSocket
Traceback (most recent call last):
  File ""/usr/lib/python2.7/dist-packages/sockjs/tornado/transports/websocket.py"", line 59, in on_message
    self.session.on_messages(msg)
  File ""/usr/lib/python2.7/dist-packages/sockjs/tornado/session.py"", line 420, in on_messages
    self.conn.on_message(msg)
  File ""/home/zulip/deployments/2015-09-26-19-22-05/zerver/lib/socket.py"", line 167, in on_message
    self.authenticate_client(msg)
  File ""/home/zulip/deployments/2015-09-26-19-22-05/zerver/lib/socket.py"", line 139, in authenticate_client
    status = redis_client.hgetall(req_redis_key(inquiry))
  File ""/usr/lib/python2.7/dist-packages/redis/client.py"", line 1228, in hgetall
    return self.execute_command('HGETALL', name)
  File ""/usr/lib/python2.7/dist-packages/redis/client.py"", line 364, in execute_command
    connection.send_command(*args)
  File ""/usr/lib/python2.7/dist-packages/redis/connection.py"", line 301, in send_command
    self.send_packed_command(self.pack_command(*args))
  File ""/usr/lib/python2.7/dist-packages/redis/connection.py"", line 283, in send_packed_command
    self.connect()
  File ""/usr/lib/python2.7/dist-packages/redis/connection.py"", line 231, in connect
    raise ConnectionError(self._error_message(e))
ConnectionError: Error 111 connecting 127.0.0.1:6379. Connection refused.
```

I installed server on the virtual machine (Ubuntu 14.04) I followed instructions from here https://zulip.org/server.html. Also I created self-signed ssl-certificate for ip-address of my vm.
",myshov,b'bug',2015-09-26T15:22:42Z,2015-09-27T04:55:19Z
23,Puppet tries to connect to remote server,"There are some issues with how you are using Puppet.

The /etc/puppet/puppet.conf you are dropping on the system contains:

```
[main]
server = puppet.zulip.com
```

As Ubuntu automatically starts the puppet agent after the package is installed (via your install script) all servers will try to connect to puppet.zulip.com.
Thankfully that server does not exist but it is a serious security risk.
If someone were to setup a server at that address he could control all servers which installed via that install script.

Also, it is nowhere mentioned that you shouldn't run the installer on a system which is already running Puppet.
The installer will overwrite your /etc/puppet/puppet.conf and break your setup.

In my opinion you shouldn't replace the puppet.conf at all.
As far as I can tell you are using `puppet apply ...` and you should be able to specify all options directly there.
",roman-mueller,b'bug',2015-09-26T12:43:28Z,2015-09-27T04:55:19Z
